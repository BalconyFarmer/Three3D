!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.VISION=e():t.VISION=e()}(window,(function(){return function(t){var e={};function r(n){if(e[n])return e[n].exports;var i=e[n]={i:n,l:!1,exports:{}};return t[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}return r.m=t,r.c=e,r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)r.d(n,i,function(e){return t[e]}.bind(null,i));return n},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s=87)}([function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Vector3=void 0;var n=r(1),i=r(5),o=function(){function t(t,e,r){void 0===t&&(t=0),void 0===e&&(e=0),void 0===r&&(r=0),this._p=[],this._p[0]=t,this._p[1]=e,this._p[2]=r,this._notify=!0,this._onNotify=null}return Object.defineProperty(t.prototype,"_x",{get:function(){return this._p[0]},set:function(t){this._p[0]=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_y",{get:function(){return this._p[1]},set:function(t){this._p[1]=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_z",{get:function(){return this._p[2]},set:function(t){this._p[2]=t},enumerable:!1,configurable:!0}),t.Build=function(){return new t},Object.defineProperty(t,"ZERO",{get:function(){return t._zeroReadOnly},enumerable:!1,configurable:!0}),Object.defineProperty(t,"ONE",{get:function(){return t._oneReadOnly},enumerable:!1,configurable:!0}),Object.defineProperty(t,"INV_ONE",{get:function(){return t._oneInvReadOnly},enumerable:!1,configurable:!0}),Object.defineProperty(t,"UNIT_X",{get:function(){return t._unitXReadOnly},enumerable:!1,configurable:!0}),Object.defineProperty(t,"UNIT_Y",{get:function(){return t._unitYReadOnly},enumerable:!1,configurable:!0}),Object.defineProperty(t,"UNIT_Z",{get:function(){return t._unitZReadOnly},enumerable:!1,configurable:!0}),Object.defineProperty(t,"UNIT_INV_X",{get:function(){return t._unitXInvReadOnly},enumerable:!1,configurable:!0}),Object.defineProperty(t,"UNIT_INV_Y",{get:function(){return t._unitYInvReadOnly},enumerable:!1,configurable:!0}),Object.defineProperty(t,"UNIT_INV_Z",{get:function(){return t._unitZInvReadOnly},enumerable:!1,configurable:!0}),t.computeOrthogonalComplement=function(e,r){return 1==e&&(Math.abs(r[0].x)>Math.abs(r[0].y)?r[1]=new t(-r[0].z,0,+r[0].x):r[1]=new t(0,+r[0].z,-r[0].y),e=2),2==e?(r[2]=(new t).crossVectors(r[0],r[1]),t.orthonormalize(3,r)):0},t.orthonormalize=function(t,e){if(e&&1<=t&&t<=3){var r=e[0].length();e[0].normalize();for(var n=1;n<t;++n){for(var i=0;i<n;++i){var o=e[n].dot(e[i]);e[n].sub(e[i].multiplyScalar(o))}var s=e[n].length();e[n].normalize(),s<r&&(r=s)}return r}return 0},Object.defineProperty(t.prototype,"p",{get:function(){return this._p},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"x",{get:function(){return this._x},set:function(t){this._x!=t&&(this._x=t,this.triggerNotify())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"y",{get:function(){return this._y},set:function(t){this._y!=t&&(this._y=t,this.triggerNotify())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"z",{get:function(){return this._z},set:function(t){this._z!=t&&(this._z=t,this.triggerNotify())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"notify",{get:function(){return this._notify},set:function(t){this._notify=t},enumerable:!1,configurable:!0}),t.prototype.setNotifyFunc=function(t){return this._onNotify=t,this},t.prototype.triggerNotify=function(){this._notify&&this._onNotify&&this._onNotify()},t.prototype.set=function(t,e,r){return this._x=t,this._y=e,this._z=r,this.triggerNotify(),this},t.prototype.setScalar=function(t){return this._x=t,this._y=t,this._z=t,this.triggerNotify(),this},t.prototype.setX=function(t){return this._x=t,this.triggerNotify(),this},t.prototype.setY=function(t){return this._y=t,this.triggerNotify(),this},t.prototype.setZ=function(t){return this._z=t,this.triggerNotify(),this},t.prototype.setComponent=function(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;default:throw new Error("index is out of range: "+t)}return this},t.prototype.getComponent=function(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+t)}},t.prototype.maximumComponent=function(){return Math.max(this._x,Math.max(this._y,this._z))},t.prototype.minimumComponent=function(){return Math.min(this._x,Math.min(this._y,this._z))},t.prototype.clone=function(){return new t(this._x,this._y,this._z)},t.prototype.copy=function(t){return this._x=t.x,this._y=t.y,this._z=t.z,this.triggerNotify(),this},t.prototype.add=function(t){return this._x+=t.x,this._y+=t.y,this._z+=t.z,this.triggerNotify(),this},t.prototype.addScalar=function(t){return this._x+=t,this._y+=t,this._z+=t,this.triggerNotify(),this},t.prototype.addVectors=function(t,e){return this._x=t.x+e.x,this._y=t.y+e.y,this._z=t.z+e.z,this.triggerNotify(),this},t.prototype.addScaledVector=function(t,e){return this._x+=t.x*e,this._y+=t.y*e,this._z+=t.z*e,this.triggerNotify(),this},t.prototype.sub=function(t){return this._x-=t.x,this._y-=t.y,this._z-=t.z,this.triggerNotify(),this},t.prototype.subScalar=function(t){return this._x-=t,this._y-=t,this._z-=t,this.triggerNotify(),this},t.prototype.subVectors=function(t,e){return this._x=t.x-e.x,this._y=t.y-e.y,this._z=t.z-e.z,this.triggerNotify(),this},t.prototype.multiply=function(t){return this._x*=t.x,this._y*=t.y,this._z*=t.z,this.triggerNotify(),this},t.prototype.multiplyScalar=function(t){return this._x*=t,this._y*=t,this._z*=t,this.triggerNotify(),this},t.prototype.multiplyVectors=function(t,e){return this._x=t.x*e.x,this._y=t.y*e.y,this._z=t.z*e.z,this.triggerNotify(),this},t.prototype.divide=function(t){return this._x/=t.x,this._y/=t.y,this._z/=t.z,this.triggerNotify(),this},t.prototype.divideScalar=function(t){return this.multiplyScalar(1/t)},t.prototype.applyEuler=function(t){return this.applyQuaternion(i.MathTmp.Quaternion[0].setFromEuler(t))},t.prototype.applyAxisAngle=function(t,e){return this.applyQuaternion(i.MathTmp.Quaternion[0].setFromAxisAngle(t,e))},t.prototype.applyMatrix3=function(t){var e=this._x,r=this._y,n=this._z,i=t.elements;return this._x=i[0]*e+i[3]*r+i[6]*n,this._y=i[1]*e+i[4]*r+i[7]*n,this._z=i[2]*e+i[5]*r+i[8]*n,this.triggerNotify(),this},t.prototype.applyNormalMatrix=function(t){return this.applyMatrix3(t).normalize()},t.prototype.applyMatrix4=function(t){var e=this._x,r=this._y,n=this._z,i=t.elements,o=1/(i[3]*e+i[7]*r+i[11]*n+i[15]);return this._x=(i[0]*e+i[4]*r+i[8]*n+i[12])*o,this._y=(i[1]*e+i[5]*r+i[9]*n+i[13])*o,this._z=(i[2]*e+i[6]*r+i[10]*n+i[14])*o,this.triggerNotify(),this},t.prototype.applyQuaternion=function(t){var e=this._x,r=this._y,n=this._z,i=t.x,o=t.y,s=t.z,a=t.w,u=a*e+o*n-s*r,p=a*r+s*e-i*n,h=a*n+i*r-o*e,c=-i*e-o*r-s*n;return this._x=u*a+c*-i+p*-s-h*-o,this._y=p*a+c*-o+h*-i-u*-s,this._z=h*a+c*-s+u*-o-p*-i,this.triggerNotify(),this},t.prototype.project=function(t){return this.applyMatrix4(t.matrixWorldInverse).applyMatrix4(t.projectionMatrix)},t.prototype.unproject=function(t){return this.applyMatrix4(t.projectionMatrixInverse).applyMatrix4(t.matrixWorld)},t.prototype.min=function(t){return this._x=Math.min(this._x,t.x),this._y=Math.min(this._y,t.y),this._z=Math.min(this._z,t.z),this.triggerNotify(),this},t.prototype.max=function(t){return this._x=Math.max(this._x,t.x),this._y=Math.max(this._y,t.y),this._z=Math.max(this._z,t.z),this.triggerNotify(),this},t.prototype.clamp=function(t,e){return this._x=Math.max(t.x,Math.min(e.x,this._x)),this._y=Math.max(t.y,Math.min(e.y,this._y)),this._z=Math.max(t.z,Math.min(e.z,this._z)),this.triggerNotify(),this},t.prototype.clampScalar=function(t,e){return this._x=Math.max(t,Math.min(e,this._x)),this._y=Math.max(t,Math.min(e,this._y)),this._z=Math.max(t,Math.min(e,this._z)),this.triggerNotify(),this},t.prototype.clampLength=function(t,e){var r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(t,Math.min(e,r)))},t.prototype.floor=function(){return this._x=Math.floor(this._x),this._y=Math.floor(this._y),this._z=Math.floor(this._z),this.triggerNotify(),this},t.prototype.ceil=function(){return this._x=Math.ceil(this._x),this._y=Math.ceil(this._y),this._z=Math.ceil(this._z),this.triggerNotify(),this},t.prototype.round=function(){return this._x=Math.round(this._x),this._y=Math.round(this._y),this._z=Math.round(this._z),this.triggerNotify(),this},t.prototype.roundToZero=function(){return this._x=this._x<0?Math.ceil(this._x):Math.floor(this._x),this._y=this._y<0?Math.ceil(this._y):Math.floor(this._y),this._z=this._z<0?Math.ceil(this._z):Math.floor(this._z),this.triggerNotify(),this},t.prototype.negate=function(){return this._x=-this._x,this._y=-this._y,this._z=-this._z,this.triggerNotify(),this},t.prototype.dot=function(t){return this._x*t.x+this._y*t.y+this._z*t.z},t.prototype.cross=function(t){return this.crossVectors(this,t)},t.prototype.crossVectors=function(t,e){var r=t.x,n=t.y,i=t.z,o=e.x,s=e.y,a=e.z;return this._x=n*a-i*s,this._y=i*o-r*a,this._z=r*s-n*o,this.triggerNotify(),this},t.prototype.dotCross=function(t,e){return i.MathTmp.Vector3[0].crossVectors(t,e),this.dot(i.MathTmp.Vector3[0])},t.prototype.lengthSq=function(){return this._x*this._x+this._y*this._y+this._z*this._z},t.prototype.length=function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z)},t.prototype.manhattanLength=function(){return Math.abs(this._x)+Math.abs(this._y)+Math.abs(this._z)},t.prototype.manhattanDistanceTo=function(t){return Math.abs(this._x-t.x)+Math.abs(this._y-t.y)+Math.abs(this._z-t.z)},t.prototype.normalize=function(){return this.divideScalar(this.length()||1)},t.prototype.angleTo=function(t){var e=Math.sqrt(this.lengthSq()*t.lengthSq());if(0==e)return Math.PI/2;var r=this.dot(t)/e;return Math.acos(n.MathUtils.clamp(r,-1,1))},t.prototype.distanceTo=function(t){return Math.sqrt(this.distanceToSquared(t))},t.prototype.distanceToSquared=function(t){var e=this._x-t.x,r=this._y-t.y,n=this._z-t.z;return e*e+r*r+n*n},t.prototype.setLength=function(t){return this.normalize().multiplyScalar(t)},t.prototype.lerp=function(t,e){return this._x+=(t.x-this._x)*e,this._y+=(t.y-this._y)*e,this._z+=(t.z-this._z)*e,this.triggerNotify(),this},t.prototype.lerpVectors=function(t,e,r){return this._x=t.x+(e.x-t.x)*r,this._y=t.y+(e.y-t.y)*r,this._z=t.z+(e.z-t.z)*r,this.triggerNotify(),this},t.prototype.angleBetween=function(t){var e=i.MathTmp.Vector3[0].copy(this).normalize(),r=i.MathTmp.Vector3[1].copy(t).normalize(),n=e.dot(r),o=i.MathTmp.Vector3[2].crossVectors(e,r).length();return Math.atan2(o,n)},t.prototype.midpoint=function(t){return this._x=.5*(this._x+t.x),this._y=.5*(this._y+t.y),this._z=.5*(this._z+t.z),this.triggerNotify(),this},t.prototype.midpointVectors=function(t,e){return this._x=.5*(t.x+e.x),this._y=.5*(t.y+e.y),this._z=.5*(t.z+e.z),this.triggerNotify(),this},t.prototype.projectOnVector=function(t){var e=t.lengthSq();if(0==e)return this.set(0,0,0);var r=t.dot(this)/e;return this.copy(t).multiplyScalar(r)},t.prototype.projectOnPlane=function(t){return i.MathTmp.Vector3[0].copy(this).projectOnVector(t),this.sub(i.MathTmp.Vector3[0])},t.prototype.reflect=function(t){return this.sub(i.MathTmp.Vector3[0].copy(t).multiplyScalar(2*this.dot(t)))},t.prototype.mostOrthogonalAxis=function(e){return void 0===e&&(e=new t),this.x<0&&(this.x=-this.x),this.y<0&&(this.y=-this.y),this.z<0&&(this.z=-this.z),this.x<=this.y?this.x<=this.z?e.copy(t.UNIT_X):e.copy(t.UNIT_Z):this.y<=this.z?e.copy(t.UNIT_Y):e.copy(t.UNIT_Z),e},t.prototype.setFromSpherical=function(t){return this.setFromSphericalCoords(t.radius,t.phi,t.theta)},t.prototype.setFromSphericalCoords=function(t,e,r){var n=Math.sin(e)*t;return this._x=n*Math.sin(r),this._y=Math.cos(e)*t,this._z=n*Math.cos(r),this.triggerNotify(),this},t.prototype.setFromCylindrical=function(t){return this.setFromCylindricalCoords(t.radius,t.theta,t.y)},t.prototype.setFromCylindricalCoords=function(t,e,r){return this._x=t*Math.sin(e),this._y=r,this._z=t*Math.cos(e),this.triggerNotify(),this},t.prototype.setFromMatrixPosition=function(t){var e=t.elements;return this._x=e[12],this._y=e[13],this._z=e[14],this.triggerNotify(),this},t.prototype.setFromMatrixScale=function(t){var e=this.setFromMatrixColumn(t,0).length(),r=this.setFromMatrixColumn(t,1).length(),n=this.setFromMatrixColumn(t,2).length();return this._x=e,this._y=r,this._z=n,this.triggerNotify(),this},t.prototype.setFromMatrixColumn=function(t,e){return t?this.fromArray(t.elements,3*e):this.fromArray(t.elements,4*e)},t.prototype.random=function(){return this._x=Math.random(),this._y=Math.random(),this._z=Math.random(),this.triggerNotify(),this},t.prototype.equals=function(t){return t.x==this._x&&t.y==this._y&&t.z==this._z},t.prototype.equalsEpsilon=function(t,e,r){return void 0===r&&(r=null),n.MathUtils.equalsEpsilon(this._x,t.x,e,r)&&n.MathUtils.equalsEpsilon(this._y,t.y,e,r)&&n.MathUtils.equalsEpsilon(this._z,t.z,e,r)},t.prototype.fromArray=function(t,e){return void 0===e&&(e=0),this._x=t[e],this._y=t[e+1],this._z=t[e+2],this.triggerNotify(),this},t.prototype.toArray=function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t},t.prototype.fromDataBuffer=function(t){return this._x=t.readFloat32(),this._y=t.readFloat32(),this._z=t.readFloat32(),this.triggerNotify(),this},t.prototype.toDataBuffer=function(t){return t.writeFloat32(this._x),t.writeFloat32(this._y),t.writeFloat32(this._z),this},t.prototype.fromBufferAttribute=function(t,e){return this._x=t.getX(e),this._y=t.getY(e),this._z=t.getZ(e),this},t._zeroReadOnly=new t(0,0,0),t._oneReadOnly=new t(1,1,1),t._oneInvReadOnly=new t(-1,-1,-1),t._unitXReadOnly=new t(1,0,0),t._unitYReadOnly=new t(0,1,0),t._unitZReadOnly=new t(0,0,1),t._unitXInvReadOnly=new t(-1,0,0),t._unitYInvReadOnly=new t(0,-1,0),t._unitZInvReadOnly=new t(0,0,-1),t}();e.Vector3=o},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.MathUtils=void 0;for(var n=r(62),i=r(0),o=[],s=0;s<256;s++)o[s]=(s<16?"0":"")+s.toString(16);var a=1234567,u=function(){function t(){}return t.generateUUID=function(){var t=4294967295*Math.random()|0,e=4294967295*Math.random()|0,r=4294967295*Math.random()|0,n=4294967295*Math.random()|0;return(o[255&t]+o[t>>8&255]+o[t>>16&255]+o[t>>24&255]+"-"+o[255&e]+o[e>>8&255]+"-"+o[e>>16&15|64]+o[e>>24&255]+"-"+o[63&r|128]+o[r>>8&255]+"-"+o[r>>16&255]+o[r>>24&255]+o[255&n]+o[n>>8&255]+o[n>>16&255]+o[n>>24&255]).toUpperCase()},t.acosClamped=function(e){return Math.acos(t.clamp(e,-1,1))},t.asinClamped=function(e){return Math.asin(t.clamp(e,-1,1))},t.chordLength=function(t,e){return 2*e*Math.sin(.5*t)},t.clamp=function(t,e,r){return Math.max(e,Math.min(r,t))},t.wrap=function(t,e,r){if(t==r||t==e)return t;var n=r-e;return((t-e)%n+n)%n+e},t.mapLinear=function(t,e,r,n,i){return n+(t-e)*(i-n)/(r-e)},t.lerp=function(t,e,r){return(1-r)*t+r*e},t.smoothstep=function(t,e,r){return t<=e?0:t>=r?1:(t=(t-e)/(r-e))*t*(3-2*t)},t.smootherstep=function(t,e,r){return t<=e?0:t>=r?1:(t=(t-e)/(r-e))*t*t*(t*(6*t-15)+10)},t.randInt=function(t,e){return t+Math.floor(Math.random()*(e-t+1))},t.randFloat=function(t,e){return t+Math.random()*(e-t)},t.randFloatSpread=function(t){return t*(.5-Math.random())},t.seededRandom=function(t){return void 0===t&&(t=null),null!=t&&(a=t%2147483647),((a=16807*a%2147483647)-1)/2147483646},t.degToRad=function(e){return e*t.DEG2RAD},t.radToDeg=function(e){return e*t.RAD2DEG},t.isPowerOfTwo=function(t){return 0==(t&t-1)&&0!=t},t.ceilPowerOfTwo=function(t){return Math.pow(2,Math.ceil(Math.log(t)/Math.LN2))},t.floorPowerOfTwo=function(t){return Math.pow(2,Math.floor(Math.log(t)/Math.LN2))},t.signNotZero=function(t){return t<0?-1:1},t.toSNorm=function(e,r){return void 0===r&&(r=255),Math.round((.5*t.clamp(e,-1,1)+.5)*r)},t.fromSNorm=function(e,r){return void 0===r&&(r=255),t.clamp(e,0,r)/r*2-1},t.mod=function(t,e){return(t%e+e)%e},t.fog=function(t,e){var r=t*e;return 1-Math.exp(-r*r)},t.zeroToTwoPi=function(e){var r=t.mod(e,t.TWO_PI);return Math.abs(r)<t.EPSILON14&&Math.abs(e)>t.EPSILON14?t.TWO_PI:r},t.negativePiToPi=function(e){return t.zeroToTwoPi(e+t.PI)-t.PI},t.equalsZero=function(t){return t>=-1e-4&&t<=1e-4},t.equalsEpsilon=function(t,e,r,i){void 0===i&&(i=null),i=n.defaultValue(i,r);var o=Math.abs(t-e);return o<=i||o<=r*Math.max(Math.abs(t),Math.abs(e))},t.lessThan=function(t,e,r){return t-e<-r},t.lessThanOrEquals=function(t,e,r){return t-e<r},t.greaterThan=function(t,e,r){return t-e>r},t.greaterThanOrEquals=function(t,e,r){return t-e>-r},t.scaleToGeodeticSurface=function(e,r,n,o,s){void 0===s&&(s=new i.Vector3);var a=e.x,u=e.y,p=e.z,h=r.x,c=r.y,l=r.z,f=a*a*h*h,y=u*u*c*c,d=p*p*l*l,_=f+y+d,m=Math.sqrt(1/_),g=e.clone().multiplyScalar(m);if(_<o)return!!isFinite(m)&&(s.copy(g),!0);var v=n.x,x=n.y,b=n.z,S=new i.Vector3;S.x=g.x*v*2,S.y=g.y*x*2,S.z=g.z*b*2;var T,C,E,M,w,P,A,O=(1-m)*e.length()/(.5*S.length()),R=0;do{R=(T=f*(w=(C=1/(1+(O-=R)*v))*C)+y*(P=(E=1/(1+O*x))*E)+d*(A=(M=1/(1+O*b))*M)-1)/(-2*(f*(w*C)*v+y*(P*E)*x+d*(A*M)*b))}while(Math.abs(T)>t.EPSILON12);return s.x=a*C,s.y=u*E,s.z=p*M,!0},t.EPSILON1=.1,t.EPSILON2=.01,t.EPSILON3=.001,t.EPSILON4=1e-4,t.EPSILON5=1e-5,t.EPSILON6=1e-6,t.EPSILON7=1e-7,t.EPSILON8=1e-8,t.EPSILON9=1e-9,t.EPSILON10=1e-10,t.EPSILON11=1e-11,t.EPSILON12=1e-12,t.EPSILON13=1e-13,t.EPSILON14=1e-14,t.EPSILON15=1e-15,t.EPSILON16=1e-16,t.EPSILON17=1e-17,t.EPSILON18=1e-18,t.EPSILON19=1e-19,t.EPSILON20=1e-20,t.EPSILON21=1e-21,t.PI=Math.PI,t.ONE_OVER_PI=1/Math.PI,t.PI_OVER_TWO=Math.PI/2,t.PI_OVER_THREE=Math.PI/3,t.PI_OVER_FOUR=Math.PI/4,t.PI_OVER_SIX=Math.PI/6,t.THREE_PI_OVER_TWO=3*Math.PI/2,t.TWO_PI=2*Math.PI,t.ONE_OVER_TWO_PI=1/(2*Math.PI),t.SIXTY_FOUR_KILOBYTES=65536,t.DEG2RAD=Math.PI/180,t.RAD2DEG=180/Math.PI,t.RAD2ARCSECOND=Math.PI/180/3600,t}();e.MathUtils=u},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Vector2=void 0;var n=r(1),i=r(5),o=function(){function t(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this._p=[],this._p[0]=t,this._p[1]=e,this._notify=!0,this._onNotify=null}return Object.defineProperty(t.prototype,"_x",{get:function(){return this._p[0]},set:function(t){this._p[0]=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_y",{get:function(){return this._p[1]},set:function(t){this._p[1]=t},enumerable:!1,configurable:!0}),t.Build=function(){return new t},Object.defineProperty(t,"ZERO",{get:function(){return t._zeroReadOnly},enumerable:!1,configurable:!0}),Object.defineProperty(t,"ONE",{get:function(){return t._oneReadOnly},enumerable:!1,configurable:!0}),Object.defineProperty(t,"INV_ONE",{get:function(){return t._oneInvReadOnly},enumerable:!1,configurable:!0}),Object.defineProperty(t,"UNIT_X",{get:function(){return t._unitXReadOnly},enumerable:!1,configurable:!0}),Object.defineProperty(t,"UNIT_Y",{get:function(){return t._unitYReadOnly},enumerable:!1,configurable:!0}),Object.defineProperty(t,"UNIT_INV_X",{get:function(){return t._unitXInvReadOnly},enumerable:!1,configurable:!0}),Object.defineProperty(t,"UNIT_INV_Y",{get:function(){return t._unitYInvReadOnly},enumerable:!1,configurable:!0}),t.computeOrthogonalComplement=function(e,r){return 1==e?(r[1]=(new t).copy(r[0]).perp().negate(),t.orthonormalize(2,r)):0},t.orthonormalize=function(t,e){if(e&&1<=t&&t<=3){var r=e[0].length();e[0].normalize();for(var n=1;n<t;++n){for(var i=0;i<n;++i){var o=e[n].dot(e[i]);e[n].sub(e[i].multiplyScalar(o))}var s=e[n].length();e[n].normalize(),s<r&&(r=s)}return r}return 0},Object.defineProperty(t.prototype,"p",{get:function(){return this._p},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"x",{get:function(){return this._x},set:function(t){this._x!=t&&(this._x=t,this.triggerNotify())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"y",{get:function(){return this._y},set:function(t){this._y!=t&&(this._y=t,this.triggerNotify())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"width",{get:function(){return this._x},set:function(t){this._x!=t&&(this._x=t,this.triggerNotify())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this._y},set:function(t){this._y!=t&&(this._y=t,this.triggerNotify())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"notify",{get:function(){return this._notify},set:function(t){this._notify=t},enumerable:!1,configurable:!0}),t.prototype.setNotifyFunc=function(t){return this._onNotify=t,this},t.prototype.triggerNotify=function(){this._notify&&this._onNotify&&this._onNotify()},t.prototype.set=function(t,e){return this._x=t,this._y=e,this.triggerNotify(),this},t.prototype.setScalar=function(t){return this._x=t,this._y=t,this.triggerNotify(),this},t.prototype.setX=function(t){return this._x=t,this.triggerNotify(),this},t.prototype.setY=function(t){return this._y=t,this.triggerNotify(),this},t.prototype.setComponent=function(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;default:throw new Error("索引超出范围: "+t)}return this},t.prototype.getComponent=function(t){switch(t){case 0:return this.x;case 1:return this.y;default:throw new Error("索引超出范围: "+t)}},t.prototype.clone=function(){return new t(this._x,this._y)},t.prototype.copy=function(t){return this._x=t.x,this._y=t.y,this.triggerNotify(),this},t.prototype.add=function(t){return this._x+=t.x,this._y+=t.y,this.triggerNotify(),this},t.prototype.addScalar=function(t){return this._x+=t,this._y+=t,this.triggerNotify(),this},t.prototype.addVectors=function(t,e){return this._x=t.x+e.x,this._y=t.y+e.y,this.triggerNotify(),this},t.prototype.addScaledVector=function(t,e){return this._x+=t.x*e,this._y+=t.y*e,this.triggerNotify(),this},t.prototype.sub=function(t){return this._x-=t.x,this._y-=t.y,this.triggerNotify(),this},t.prototype.subScalar=function(t){return this._x-=t,this._y-=t,this.triggerNotify(),this},t.prototype.subVectors=function(t,e){return this._x=t.x-e.x,this._y=t.y-e.y,this.triggerNotify(),this},t.prototype.multiply=function(t){return this._x*=t.x,this._y*=t.y,this.triggerNotify(),this},t.prototype.multiplyScalar=function(t){return this._x*=t,this._y*=t,this.triggerNotify(),this},t.prototype.multiplyVectors=function(t,e){return this._x=t.x*e.x,this._y=t.y*e.y,this.triggerNotify(),this},t.prototype.divide=function(t){return this._x/=t.x,this._y/=t.y,this.triggerNotify(),this},t.prototype.divideScalar=function(t){return this.multiplyScalar(1/t)},t.prototype.applyMatrix3=function(t){var e=this.x,r=this.y,n=t.elements;return this._x=n[0]*e+n[3]*r+n[6],this._y=n[1]*e+n[4]*r+n[7],this.triggerNotify(),this},t.prototype.min=function(t){return this._x=Math.min(this.x,t.x),this._y=Math.min(this.y,t.y),this.triggerNotify(),this},t.prototype.max=function(t){return this._x=Math.max(this.x,t.x),this._y=Math.max(this.y,t.y),this.triggerNotify(),this},t.prototype.clamp=function(t,e){return this._x=Math.max(t.x,Math.min(e.x,this.x)),this._y=Math.max(t.y,Math.min(e.y,this.y)),this.triggerNotify(),this},t.prototype.clampScalar=function(t,e){return this._x=Math.max(t,Math.min(e,this.x)),this._y=Math.max(t,Math.min(e,this.y)),this.triggerNotify(),this},t.prototype.clampLength=function(t,e){var r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(t,Math.min(e,r)))},t.prototype.floor=function(){return this._x=Math.floor(this._x),this._y=Math.floor(this._y),this.triggerNotify(),this},t.prototype.ceil=function(){return this._x=Math.ceil(this._x),this._y=Math.ceil(this._y),this.triggerNotify(),this},t.prototype.round=function(){return this._x=Math.round(this._x),this._y=Math.round(this._y),this.triggerNotify(),this},t.prototype.roundToZero=function(){return this._x=this._x<0?Math.ceil(this._x):Math.floor(this._x),this._y=this._y<0?Math.ceil(this._y):Math.floor(this._y),this.triggerNotify(),this},t.prototype.negate=function(){return this._x=-this._x,this._y=-this._y,this.triggerNotify(),this},t.prototype.dot=function(t){return this._x*t.x+this._y*t.y},t.prototype.cross=function(t){return this._x*t.y-this._y*t.x},t.prototype.lengthSq=function(){return this._x*this._x+this._y*this._y},t.prototype.length=function(){return Math.sqrt(this._x*this._x+this._y*this._y)},t.prototype.manhattanLength=function(){return Math.abs(this._x)+Math.abs(this._y)},t.prototype.manhattanDistanceTo=function(t){return Math.abs(this._x-t.x)+Math.abs(this._y-t.y)},t.prototype.normalize=function(){return this.divideScalar(this.length()||1)},t.prototype.angle=function(){var t=Math.atan2(this._y,this._x);return t<0&&(t+=2*Math.PI),t},t.prototype.distanceToSquared=function(t){var e=this._x-t.x,r=this._y-t.y;return e*e+r*r},t.prototype.distanceTo=function(t){return Math.sqrt(this.distanceToSquared(t))},t.prototype.setLength=function(t){return this.normalize().multiplyScalar(t)},t.prototype.lerp=function(t,e){return this._x+=(t.x-this._x)*e,this._y+=(t.y-this._y)*e,this.triggerNotify(),this},t.prototype.lerpVectors=function(t,e,r){return this._x=t.x+(e.x-t.x)*r,this._y=t.y+(e.y-t.y)*r,this.triggerNotify(),this},t.prototype.perp=function(){var t=this.x,e=this.y;return this._x=e,this._y=-t,this.triggerNotify(),this},t.prototype.dotPerp=function(t){var e=i.MathTmp.Vector2[0].set(this._x,this._y).perp();return this.dot(e)},t.prototype.rotateAround=function(t,e){var r=Math.cos(e),n=Math.sin(e),i=this._x-t.x,o=this._y-t.y;return this._x=i*r-o*n+t.x,this._y=i*n+o*r+t.y,this.triggerNotify(),this},t.prototype.random=function(){return this._x=Math.random(),this._y=Math.random(),this.triggerNotify(),this},t.prototype.equals=function(t){return t.x==this._x&&t.y==this._y},t.prototype.equalsEpsilon=function(t,e,r){return void 0===r&&(r=null),n.MathUtils.equalsEpsilon(this._x,t.x,e,r)&&n.MathUtils.equalsEpsilon(this._y,t.y,e,r)},t.prototype.fromArray=function(t,e){return void 0===e&&(e=0),this._x=t[e],this._y=t[e+1],this.triggerNotify(),this},t.prototype.toArray=function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this._x,t[e+1]=this._y,t},t.prototype.fromDataBuffer=function(t){return this._x=t.readFloat32(),this._y=t.readFloat32(),this.triggerNotify(),this},t.prototype.toDataBuffer=function(t){return t.writeFloat32(this._x),t.writeFloat32(this._y),this},t.prototype.fromBufferAttribute=function(t,e){return this._x=t.getX(e),this._y=t.getY(e),this},t._zeroReadOnly=new t(0,0),t._oneReadOnly=new t(1,1),t._oneInvReadOnly=new t(-1,-1),t._unitXReadOnly=new t(1,0),t._unitYReadOnly=new t(0,1),t._unitXInvReadOnly=new t(-1,0),t._unitYInvReadOnly=new t(0,-1),t}();e.Vector2=o},function(t,e,r){"use strict";var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(e,"__esModule",{value:!0}),e.Material=void 0;var o=r(21),s=r(4),a=r(11),u=function(t){function e(){var e=t.call(this)||this;return e.uuid=s.MathUtils.generateUUID(),e.name="",e._fog=!1,e._blending=a.Constants.CombineBlending,e._side=a.Constants.FrontSide,e._flatShading=!1,e._vertexTangents=!1,e._vertexColors=!1,e._drawMode=a.Constants.TrianglesDrawMode,e._opacity=1,e._transparent=!1,e._blendSrc=a.Constants.SrcAlphaFactor,e._blendDst=a.Constants.OneMinusSrcAlphaFactor,e._blendEquation=a.Constants.AddEquation,e._blendSrcAlpha=-1,e._blendDstAlpha=-1,e._blendEquationAlpha=-1,e._blendColor=new s.ColorRGBA,e._depthFunc=a.Constants.LessEqualDepth,e._depthTest=!0,e._depthWrite=!0,e._logDepth=!0,e._disableFragLogDepth=!1,e._stencilWrite=!1,e._stencilWriteMask=255,e._stencilFunc=a.Constants.AlwaysStencilFunc,e._stencilRef=0,e._stencilFuncMask=255,e._stencilFail=a.Constants.KeepStencilOp,e._stencilZFail=a.Constants.KeepStencilOp,e._stencilZPass=a.Constants.KeepStencilOp,e._clipping=!0,e._clippingPlanes=null,e._clipIntersection=!1,e._clipEdgeWidth=0,e._clipEdgeColor=s.ColorRGB.WHITE,e._clipShadows=!1,e._colorWrite=!0,e._dithering=!1,e._polygonOffset=!1,e._polygonOffsetFactor=0,e._polygonOffsetUnits=0,e._alphaTest=0,e._premultipliedAlpha=!1,e._toneMapped=!0,e._version=0,e._reference=0,e._visible=!0,e}return i(e,t),Object.defineProperty(e.prototype,"fog",{get:function(){return this._fog},set:function(t){this._fog!=t&&(this._fog=t,this.needsUpdate=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"blending",{get:function(){return this._blending},set:function(t){this._blending!=t&&(this._blending=t,this.needsUpdate=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"side",{get:function(){return this._side},set:function(t){this._side!=t&&(this._side=t,this.needsUpdate=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"flatShading",{get:function(){return this._flatShading},set:function(t){this._flatShading!=t&&(this._flatShading=t,this.needsUpdate=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"vertexTangents",{get:function(){return this._vertexTangents},set:function(t){this._vertexTangents!=t&&(this._vertexTangents=t,this.needsUpdate=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"vertexColors",{get:function(){return this._vertexColors},set:function(t){this._vertexColors!=t&&(this._vertexColors=t,this.needsUpdate=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"drawMode",{get:function(){return this._drawMode},set:function(t){this._drawMode!=t&&(this._drawMode=t,this.needsUpdate=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"opacity",{get:function(){return this._opacity},set:function(t){this._opacity!=t&&(this._opacity=t,this.needsUpdate=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"transparent",{get:function(){return this._transparent},set:function(t){this._transparent!=t&&(this._transparent=t,this.needsUpdate=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"blendSrc",{get:function(){return this._blendSrc},set:function(t){this._blendSrc!=t&&(this._blendSrc=t,this.needsUpdate=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"blendDst",{get:function(){return this._blendDst},set:function(t){this._blendDst!=t&&(this._blendDst=t,this.needsUpdate=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"blendEquation",{get:function(){return this._blendEquation},set:function(t){this._blendEquation!=t&&(this._blendEquation=t,this.needsUpdate=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"blendSrcAlpha",{get:function(){return this._blendSrcAlpha},set:function(t){this._blendSrcAlpha!=t&&(this._blendSrcAlpha=t,this.needsUpdate=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"blendDstAlpha",{get:function(){return this._blendDstAlpha},set:function(t){this._blendDstAlpha!=t&&(this._blendDstAlpha=t,this.needsUpdate=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"blendEquationAlpha",{get:function(){return this._blendEquationAlpha},set:function(t){this._blendEquationAlpha!=t&&(this._blendEquationAlpha=t,this.needsUpdate=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"blendColor",{get:function(){return this._blendColor},set:function(t){this._blendColor!=t&&(this._blendColor=t,this.needsUpdate=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"depthFunc",{get:function(){return this._depthFunc},set:function(t){this._depthFunc!=t&&(this._depthFunc=t,this.needsUpdate=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"depthTest",{get:function(){return this._depthTest},set:function(t){this._depthTest!=t&&(this._depthTest=t,this.needsUpdate=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"depthWrite",{get:function(){return this._depthWrite},set:function(t){this._depthWrite!=t&&(this._depthWrite=t,this.needsUpdate=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"logDepth",{get:function(){return this._logDepth},set:function(t){this._logDepth!=t&&(this._logDepth=t,this.needsUpdate=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"disableFragLogDepth",{get:function(){return this._disableFragLogDepth},set:function(t){this._disableFragLogDepth!=t&&(this._disableFragLogDepth=t,this.needsUpdate=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"stencilWrite",{get:function(){return this._stencilWrite},set:function(t){this._stencilWrite!=t&&(this._stencilWrite=t,this.needsUpdate=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"stencilWriteMask",{get:function(){return this._stencilWriteMask},set:function(t){this._stencilWriteMask!=t&&(this._stencilWriteMask=t,this.needsUpdate=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"stencilFunc",{get:function(){return this._stencilFunc},set:function(t){this._stencilFunc!=t&&(this._stencilFunc=t,this.needsUpdate=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"stencilRef",{get:function(){return this._stencilRef},set:function(t){this._stencilRef!=t&&(this._stencilRef=t,this.needsUpdate=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"stencilFuncMask",{get:function(){return this._stencilFuncMask},set:function(t){this._stencilFuncMask!=t&&(this._stencilFuncMask=t,this.needsUpdate=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"stencilFail",{get:function(){return this._stencilFail},set:function(t){this._stencilFail!=t&&(this._stencilFail=t,this.needsUpdate=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"stencilZFail",{get:function(){return this._stencilZFail},set:function(t){this._stencilZFail!=t&&(this._stencilZFail=t,this.needsUpdate=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"stencilZPass",{get:function(){return this._stencilZPass},set:function(t){this._stencilZPass!=t&&(this._stencilZPass=t,this.needsUpdate=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"clipping",{get:function(){return this._clipping},set:function(t){this._clipping!=t&&(this._clipping=t,this.needsUpdate=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"clippingPlanes",{get:function(){return this._clippingPlanes},set:function(t){this._clippingPlanes!=t&&(this._clippingPlanes=t,this.needsUpdate=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"clipIntersection",{get:function(){return this._clipIntersection},set:function(t){this._clipIntersection!=t&&(this._clipIntersection=t,this.needsUpdate=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"clipEdgeWidth",{get:function(){return this._clipEdgeWidth},set:function(t){this._clipEdgeWidth!=t&&(this._clipEdgeWidth=t,this.needsUpdate=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"clipEdgeColor",{get:function(){return this._clipEdgeColor},set:function(t){this._clipEdgeColor.equals(t)||(this._clipEdgeColor.copy(t),this.needsUpdate=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"clipShadows",{get:function(){return this._clipShadows},set:function(t){this._clipShadows!=t&&(this._clipShadows=t,this.needsUpdate=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"colorWrite",{get:function(){return this._colorWrite},set:function(t){this._colorWrite!=t&&(this._colorWrite=t,this.needsUpdate=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"dithering",{get:function(){return this._dithering},set:function(t){this._dithering!=t&&(this._dithering=t,this.needsUpdate=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"polygonOffset",{get:function(){return this._polygonOffset},set:function(t){this._polygonOffset!=t&&(this._polygonOffset=t,this.needsUpdate=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"polygonOffsetFactor",{get:function(){return this._polygonOffsetFactor},set:function(t){this._polygonOffsetFactor!=t&&(this._polygonOffsetFactor=t,this.needsUpdate=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"polygonOffsetUnits",{get:function(){return this._polygonOffsetUnits},set:function(t){this._polygonOffsetUnits!=t&&(this._polygonOffsetUnits=t,this.needsUpdate=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"alphaTest",{get:function(){return this._alphaTest},set:function(t){this._alphaTest!=t&&(this._alphaTest=t,this.needsUpdate=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"premultipliedAlpha",{get:function(){return this._premultipliedAlpha},set:function(t){this._premultipliedAlpha!=t&&(this._premultipliedAlpha=t,this.needsUpdate=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"toneMapped",{get:function(){return this._toneMapped},set:function(t){this._toneMapped!=t&&(this._toneMapped=t,this.needsUpdate=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"visible",{get:function(){return this._visible},set:function(t){this._visible=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"needsUpdate",{set:function(t){t&&this._version++},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"version",{get:function(){return this._version},enumerable:!1,configurable:!0}),e.prototype.addReference=function(){this._reference++},e.prototype.dispose=function(){this._reference--,0==this._reference&&(t.prototype.dispose.call(this),this.dispatchEvent(new o.Event("dispose")))},Object.defineProperty(e.prototype,"_disableAlphaBlending",{get:function(){return!this._transparent},enumerable:!1,configurable:!0}),e.prototype.needAlphaBlending=function(){return!this._disableAlphaBlending&&this._opacity<1},e.prototype.needAlphaTesting=function(){return!(0==this._alphaTest||!this._transparent)},e.prototype.copy=function(t){return this.name=t.name,this._fog=t.fog,this._opacity=t.opacity,this._transparent=t.transparent,this._blending=t.blending,this._side=t.side,this._flatShading=t.flatShading,this._vertexTangents=t.vertexTangents,this._vertexColors=t.vertexColors,this._drawMode=t.drawMode,this._blendSrc=t.blendSrc,this._blendDst=t.blendDst,this._blendEquation=t.blendEquation,this._blendSrcAlpha=t.blendSrcAlpha,this._blendDstAlpha=t.blendDstAlpha,this._blendEquationAlpha=t.blendEquationAlpha,this._blendColor.copy(t.blendColor),this._depthFunc=t.depthFunc,this._depthTest=t.depthTest,this._depthWrite=t.depthWrite,this._logDepth=t.logDepth,this._disableFragLogDepth=t.disableFragLogDepth,this._stencilWrite=t.stencilWrite,this._stencilWriteMask=t.stencilWriteMask,this._stencilFunc=t.stencilFunc,this._stencilRef=t.stencilRef,this._stencilFuncMask=t.stencilFuncMask,this._stencilFail=t.stencilFail,this._stencilZFail=t.stencilZFail,this._stencilZPass=t.stencilZPass,this._clipping=t.clipping,this._clipShadows=t.clipShadows,this._clipIntersection=t.clipIntersection,this._clippingPlanes=t.clippingPlanes,this._clipEdgeWidth=t.clipEdgeWidth,this._clipEdgeColor.copy(t.clipEdgeColor),this._colorWrite=t.colorWrite,this._dithering=t.dithering,this._polygonOffset=t.polygonOffset,this._polygonOffsetFactor=t.polygonOffsetFactor,this._polygonOffsetUnits=t.polygonOffsetUnits,this._alphaTest=t.alphaTest,this._premultipliedAlpha=t.premultipliedAlpha,this._toneMapped=t.toneMapped,this._visible=t.visible,this},e}(o.EventDispatcher);e.Material=u},function(t,e,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(t,e,r,n){void 0===n&&(n=r),Object.defineProperty(t,n,{enumerable:!0,get:function(){return e[r]}})}:function(t,e,r,n){void 0===n&&(n=r),t[n]=e[r]}),i=this&&this.__exportStar||function(t,e){for(var r in t)"default"===r||e.hasOwnProperty(r)||n(e,t,r)};Object.defineProperty(e,"__esModule",{value:!0}),i(r(93),e),i(r(94),e),i(r(36),e),i(r(25),e),i(r(26),e),i(r(44),e),i(r(95),e),i(r(96),e),i(r(33),e),i(r(97),e),i(r(98),e),i(r(99),e),i(r(47),e),i(r(37),e),i(r(100),e),i(r(46),e),i(r(1),e),i(r(101),e),i(r(18),e),i(r(17),e),i(r(102),e),i(r(45),e),i(r(103),e),i(r(35),e),i(r(104),e),i(r(105),e),i(r(20),e),i(r(106),e),i(r(107),e),i(r(108),e),i(r(2),e),i(r(0),e),i(r(16),e),i(r(66),e),i(r(67),e),i(r(68),e),i(r(48),e),i(r(69),e),i(r(10),e),i(r(70),e),i(r(27),e),i(r(38),e),i(r(49),e),i(r(50),e),i(r(71),e),i(r(39),e),i(r(51),e),i(r(72),e),i(r(110),e),i(r(73),e)},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.MathTmp=void 0;var n=r(2),i=r(0),o=r(16),s=r(18),a=r(17),u=r(33),p=r(35),h=r(36),c=r(25),l=r(20),f=r(26),y=r(44),d=function(){function t(){}return Object.defineProperty(t,"Vector2",{get:function(){return t._Vector2.length<=0&&(t._Vector2=_(10,n.Vector2.Build)),t._Vector2},enumerable:!1,configurable:!0}),Object.defineProperty(t,"Vector3",{get:function(){return t._Vector3.length<=0&&(t._Vector3=_(10,i.Vector3.Build)),t._Vector3},enumerable:!1,configurable:!0}),Object.defineProperty(t,"Vector4",{get:function(){return t._Vector4.length<=0&&(t._Vector4=_(10,o.Vector4.Build)),t._Vector4},enumerable:!1,configurable:!0}),Object.defineProperty(t,"Matrix3",{get:function(){return t._Matrix3.length<=0&&(t._Matrix3=_(6,s.Matrix3.Build)),t._Matrix3},enumerable:!1,configurable:!0}),Object.defineProperty(t,"Matrix4",{get:function(){return t._Matrix4.length<=0&&(t._Matrix4=_(6,a.Matrix4.Build)),t._Matrix4},enumerable:!1,configurable:!0}),Object.defineProperty(t,"Euler",{get:function(){return t._Euler.length<=0&&(t._Euler=_(6,u.Euler.Build)),t._Euler},enumerable:!1,configurable:!0}),Object.defineProperty(t,"Quaternion",{get:function(){return t._Quaternion.length<=0&&(t._Quaternion=_(6,p.Quaternion.Build)),t._Quaternion},enumerable:!1,configurable:!0}),Object.defineProperty(t,"Box2",{get:function(){return t._Box2.length<=0&&(t._Box2=_(6,h.Box2.Build)),t._Box2},enumerable:!1,configurable:!0}),Object.defineProperty(t,"Box3",{get:function(){return t._Box3.length<=0&&(t._Box3=_(6,c.Box3.Build)),t._Box3},enumerable:!1,configurable:!0}),Object.defineProperty(t,"Sphere",{get:function(){return t._Sphere.length<=0&&(t._Sphere=_(6,l.Sphere.Build)),t._Sphere},enumerable:!1,configurable:!0}),Object.defineProperty(t,"ColorRGB",{get:function(){return t._ColorRGB.length<=0&&(t._ColorRGB=_(6,f.ColorRGB.Build)),t._ColorRGB},enumerable:!1,configurable:!0}),Object.defineProperty(t,"ColorRGBA",{get:function(){return t._ColorRGBA.length<=0&&(t._ColorRGBA=_(6,y.ColorRGBA.Build)),t._ColorRGBA},enumerable:!1,configurable:!0}),t}();function _(t,e){for(var r=[],n=0;n<t;++n)r.push(e());return r}e.MathTmp=d},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.CSG=void 0;var n=r(119),i=r(7),o=r(9),s=r(29),a=r(30),u=r(122),p=r(125),h=r(40),c=r(14),l=r(76),f=r(78),y=r(8),d=r(75),_=r(31),m=r(32),g=r(0),v=r(60),x=r(22);function b(t,e){return t-e}function S(t,e,r){for(var n=0,i=t.length;i>n;){var o=Math.floor((n+i)/2);r(e,t[o])>0?n=o+1:i=o}t.splice(n,0,e)}var T=function(){function t(){this.polygons=[],this.properties=new n.CSGProperties,this.isCanonicalized=!0,this.isRetesselated=!0}return t.fromGeometry=function(e,r){var n,u,p,h,c,l=e.attributes.position,f=[];for(n=0;n<l.count/3;++n){var y=[];for(u=0;u<3;++u)p=3*n+u,h=new o.CSGVector3D(l.getX(p),l.getY(p),l.getZ(p)),y.push(new s.CSGVertex(h));(c=new a.CSGPolygon(y)).checkIfConvex(),f.push(c)}var d=t.fromPolygons(f);if(null!=r){var _=new i.CSGMatrix4x4(r.clone().elements);d=d.transform(_)}return d},t.fromMesh=function(e){var r,n;return e.updateMatrix(),r=new i.CSGMatrix4x4(e.matrix.clone().elements),e.geometry instanceof m.Geometry?n=e.geometry:(n=e.geometry,console.warn("mesh类型错误")),t.fromGeometry(n).transform(r)},t.toGeometry=function(t,e,r){if(void 0===r&&(r=new m.Geometry),null!=e){var n=new i.CSGMatrix4x4(e.clone().elements);t=t.transform(n)}var o=t.toPolygons(),s=[],a=[],u=[];o.forEach((function(t){var e=t.vertices.map((function(t){return function(t,e){var r=new g.Vector3(e.x,e.y,e.z);return t.push(r),t.length-1}(s,t.pos)}));e[0]==e[e.length-1]&&e.pop();for(var r=2;r<e.length;r++)a.push(s[e[0]].x,s[e[0]].y,s[e[0]].z,s[e[r-1]].x,s[e[r-1]].y,s[e[r-1]].z,s[e[r]].x,s[e[r]].y,s[e[r]].z),u.push(t.plane.normal.x,t.plane.normal.y,t.plane.normal.z,t.plane.normal.x,t.plane.normal.y,t.plane.normal.z,t.plane.normal.x,t.plane.normal.y,t.plane.normal.z)}),this);var p=new Float32Array(a),h=new x.BufferAttribute(p,3);r.setAttribute(v.BufferAttributeKind.PositionKind,h);new Float32Array(u);var c=new x.BufferAttribute(p,3);return r.setAttribute(v.BufferAttributeKind.NormalKind,c),r},t.fromPolygons=function(e){var r=new t;return r.polygons=e,r.isCanonicalized=!1,r.isRetesselated=!1,r},t.fromSlices=function(t){return a.CSGPolygon.createFromPoints([[0,0,0],[1,0,0],[1,1,0],[0,1,0]]).solidFromSlices(t)},t.fromObject=function(e){var r=e.polygons.map((function(t){return a.CSGPolygon.fromObject(t)})),n=t.fromPolygons(r);return n=n.canonicalized()},t.fromCompactBinary=function(e){if("CSG"!=e.class)throw new Error("Not a CSG");for(var r,n,i,u,p,h,c=[],l=e.planeData,d=l.length/4,_=0,m=0;m<d;m++)r=l[_++],n=l[_++],i=l[_++],u=l[_++],p=o.CSGVector3D.Create(r,n,i),h=new y.CSGPlane(p,u),c.push(h);var g,v,x=[],b=e.vertexData,S=b.length/3;_=0;for(var T=0;T<S;T++)r=b[_++],n=b[_++],i=b[_++],g=o.CSGVector3D.Create(r,n,i),v=new s.CSGVertex(g),x.push(v);var C,E,M,w,P=e.shared.map((function(t){return f.CSGPolygonShared.fromObject(t)})),A=[],O=e.numPolygons,R=e.numVerticesPerPolygon,B=e.polygonVertices,I=e.polygonPlaneIndexes,N=e.polygonSharedIndexes;_=0;for(var F=0;F<O;F++){C=R[F],E=[];for(var G=0;G<C;G++)E.push(x[B[_++]]);h=c[I[F]],M=P[N[F]],w=new a.CSGPolygon(E,M,h),A.push(w)}var D=t.fromPolygons(A);return D.isCanonicalized=!0,D.isRetesselated=!0,D},t.getTag=function(){return t.staticTag++},t.parseOption=function(t,e,r){var n=r;return t&&e in t&&(n=t[e]),n},t.parseOptionAs3DVector=function(e,r,n){var i=t.parseOption(e,r,n);return i=new o.CSGVector3D(i)},t.parseOptionAs3DVectorList=function(e,r,n){return t.parseOption(e,r,n).map((function(t){return new o.CSGVector3D(t)}))},t.parseOptionAs2DVector=function(e,r,n){var i=t.parseOption(e,r,n);return i=new c.CSGVector2D(i)},t.parseOptionAsFloat=function(e,r,n){var i=t.parseOption(e,r,n);if("string"==typeof i&&(i=Number(i)),isNaN(i)||"number"!=typeof i)throw new Error("Parameter "+r+" should be a number");return i},t.parseOptionAsInt=function(e,r,n){var i=t.parseOption(e,r,n);if(i=Number(Math.floor(i)),isNaN(i))throw new Error("Parameter "+r+" should be a number");return i},t.parseOptionAsBool=function(e,r,n){var i=t.parseOption(e,r,n);return"string"==typeof i&&("true"==i?i=!0:"false"==i&&(i=!1)),i=!!i},t.cube=function(e){var r,i;if("corner1"in(e=e||{})||"corner2"in e){if("center"in e||"radius"in e)throw new Error("cube: should either give a radius and center parameter, or a corner1 and corner2 parameter");var u=t.parseOptionAs3DVector(e,"corner1",[0,0,0]),p=t.parseOptionAs3DVector(e,"corner2",[1,1,1]);r=u.plus(p).times(.5),i=p.minus(u).times(.5)}else r=t.parseOptionAs3DVector(e,"center",[0,0,0]),i=t.parseOptionAs3DVector(e,"radius",[1,1,1]);i=i.abs();var h=t.fromPolygons([[[0,4,6,2],[-1,0,0]],[[1,3,7,5],[1,0,0]],[[0,1,5,4],[0,-1,0]],[[2,6,7,3],[0,1,0]],[[0,2,3,1],[0,0,-1]],[[4,5,7,6],[0,0,1]]].map((function(t){var e=t[0].map((function(t){var e=1&t?1:0,n=2&t?1:0,a=4&t?1:0,u=new o.CSGVector3D(r.x+i.x*(2*e-1),r.y+i.y*(2*n-1),r.z+i.z*(2*a-1));return new s.CSGVertex(u)}));return new a.CSGPolygon(e,null)})));return h.properties.cube=new n.CSGProperties,h.properties.cube.center=new o.CSGVector3D(r),h.properties.cube.facecenters=[new d.CSGConnector(new o.CSGVector3D([i.x,0,0]).plus(r),[1,0,0],[0,0,1]),new d.CSGConnector(new o.CSGVector3D([-i.x,0,0]).plus(r),[-1,0,0],[0,0,1]),new d.CSGConnector(new o.CSGVector3D([0,i.y,0]).plus(r),[0,1,0],[0,0,1]),new d.CSGConnector(new o.CSGVector3D([0,-i.y,0]).plus(r),[0,-1,0],[0,0,1]),new d.CSGConnector(new o.CSGVector3D([0,0,i.z]).plus(r),[0,0,1],[1,0,0]),new d.CSGConnector(new o.CSGVector3D([0,0,-i.z]).plus(r),[0,0,-1],[1,0,0])],h},t.sphere=function(e){e=e||{};var r,i,u,p=t.parseOptionAs3DVector(e,"center",[0,0,0]),h=t.parseOptionAsFloat(e,"radius",1),c=t.parseOptionAsInt(e,"resolution",t.defaultResolution3D);"axes"in e?(r=e.axes[0].unit().times(h),i=e.axes[1].unit().times(h),u=e.axes[2].unit().times(h)):(r=new o.CSGVector3D([1,0,0]).times(h),i=new o.CSGVector3D([0,-1,0]).times(h),u=new o.CSGVector3D([0,0,1]).times(h)),c<4&&(c=4);for(var l,f=Math.round(c/4),y=[],d=0;d<=c;d++){var _=2*Math.PI*d/c,m=r.times(Math.cos(_)).plus(i.times(Math.sin(_)));if(d>0)for(var g=[],v=void 0,x=void 0,b=0;b<=f;b++){var S=.5*Math.PI*b/f,T=Math.cos(S),C=Math.sin(S);b>0&&((g=[]).push(new s.CSGVertex(p.plus(l.times(v).minus(u.times(x))))),g.push(new s.CSGVertex(p.plus(m.times(v).minus(u.times(x))))),b<f&&g.push(new s.CSGVertex(p.plus(m.times(T).minus(u.times(C))))),g.push(new s.CSGVertex(p.plus(l.times(T).minus(u.times(C))))),y.push(new a.CSGPolygon(g)),(g=[]).push(new s.CSGVertex(p.plus(l.times(v).plus(u.times(x))))),g.push(new s.CSGVertex(p.plus(m.times(v).plus(u.times(x))))),b<f&&g.push(new s.CSGVertex(p.plus(m.times(T).plus(u.times(C))))),g.push(new s.CSGVertex(p.plus(l.times(T).plus(u.times(C))))),g.reverse(),y.push(new a.CSGPolygon(g))),v=T,x=C}l=m}var E=t.fromPolygons(y);return E.properties.sphere=new n.CSGProperties,E.properties.sphere.center=new o.CSGVector3D(p),E.properties.sphere.facepoint=p.plus(r),E},t.cylinder=function(e){var r=t.parseOptionAs3DVector(e,"start",[0,-1,0]),i=t.parseOptionAs3DVector(e,"end",[0,1,0]),o=t.parseOptionAsFloat(e,"radius",1),u=t.parseOptionAsFloat(e,"radiusEnd",o),p=t.parseOptionAsFloat(e,"radiusStart",o),h=t.parseOptionAsFloat(e,"sectorAngle",360);if(h=h>360?h%360:h,u<0||p<0)throw new Error("Radius should be non-negative");if(0==u&&0==p)throw new Error("Either radiusStart or radiusEnd should be positive");var c=t.parseOptionAsInt(e,"resolution",t.defaultResolution2D),l=i.minus(r),f=l.unit(),y=f.randomNonParallelVector().unit(),_=y.cross(f).unit(),m=new s.CSGVertex(r),g=new s.CSGVertex(i),v=[];function x(t,e,n){var i=e*Math.PI*h/180,o=y.times(Math.cos(i)).plus(_.times(Math.sin(i))),a=r.plus(l.times(t)).plus(o.times(n));return new s.CSGVertex(a)}if(h>0){for(var b=0;b<c;b++){var S=b/c,T=(b+1)/c;u==p?(v.push(new a.CSGPolygon([m,x(0,S,u),x(0,T,u)])),v.push(new a.CSGPolygon([x(0,T,u),x(0,S,u),x(1,S,u),x(1,T,u)])),v.push(new a.CSGPolygon([g,x(1,T,u),x(1,S,u)]))):(p>0&&(v.push(new a.CSGPolygon([m,x(0,S,p),x(0,T,p)])),v.push(new a.CSGPolygon([x(0,S,p),x(1,S,u),x(0,T,p)]))),u>0&&(v.push(new a.CSGPolygon([g,x(1,T,u),x(1,S,u)])),v.push(new a.CSGPolygon([x(1,S,u),x(1,T,u),x(0,T,p)]))))}h<360&&(v.push(new a.CSGPolygon([m,g,x(0,0,p)])),v.push(new a.CSGPolygon([x(0,0,p),g,x(1,0,u)])),v.push(new a.CSGPolygon([m,x(0,1,p),g])),v.push(new a.CSGPolygon([x(0,1,p),x(1,1,u),g])))}var C=t.fromPolygons(v);C.properties.cylinder=new n.CSGProperties,C.properties.cylinder.start=new d.CSGConnector(r,f.negated(),y),C.properties.cylinder.end=new d.CSGConnector(i,f,y);var E=r.plus(l.times(.5)),M=y.rotate(r,f,-h/2).times((p+u)/2),w=M.cross(f);return C.properties.cylinder.facepointH=new d.CSGConnector(E.plus(M),M,f),C.properties.cylinder.facepointH90=new d.CSGConnector(E.plus(w),w,f),C},t.roundedCylinder=function(e){var r,i=t.parseOptionAs3DVector(e,"start",[0,-1,0]),u=t.parseOptionAs3DVector(e,"end",[0,1,0]),p=t.parseOptionAsFloat(e,"radius",1),h=u.minus(i);r=Math.abs(h.x)>Math.abs(h.y)?new o.CSGVector3D(0,1,0):new o.CSGVector3D(1,0,0);var c=t.parseOptionAs3DVector(e,"normal",r),l=t.parseOptionAsInt(e,"resolution",t.defaultResolution3D);l<4&&(l=4);var f=[],y=Math.floor(.25*l);if(h.length()<1e-10)return t.sphere({center:i,radius:p,resolution:l});for(var _,m=h.unit().times(p),g=m.cross(c).unit().times(p),v=g.cross(m).unit().times(p),x=0;x<=l;x++){var b=2*Math.PI*x/l,S=g.times(Math.cos(b)).plus(v.times(Math.sin(b)));if(x>0){var T=[];T.push(new s.CSGVertex(i.plus(S))),T.push(new s.CSGVertex(i.plus(_))),T.push(new s.CSGVertex(u.plus(_))),T.push(new s.CSGVertex(u.plus(S))),f.push(new a.CSGPolygon(T));for(var C=void 0,E=void 0,M=0;M<=y;M++){var w=.5*Math.PI*M/y,P=Math.cos(w),A=Math.sin(w);M>0&&((T=[]).push(new s.CSGVertex(i.plus(_.times(C).minus(m.times(E))))),T.push(new s.CSGVertex(i.plus(S.times(C).minus(m.times(E))))),M<y&&T.push(new s.CSGVertex(i.plus(S.times(P).minus(m.times(A))))),T.push(new s.CSGVertex(i.plus(_.times(P).minus(m.times(A))))),f.push(new a.CSGPolygon(T)),(T=[]).push(new s.CSGVertex(u.plus(_.times(C).plus(m.times(E))))),T.push(new s.CSGVertex(u.plus(S.times(C).plus(m.times(E))))),M<y&&T.push(new s.CSGVertex(u.plus(S.times(P).plus(m.times(A))))),T.push(new s.CSGVertex(u.plus(_.times(P).plus(m.times(A))))),T.reverse(),f.push(new a.CSGPolygon(T))),C=P,E=A}}_=S}var O=t.fromPolygons(f),R=m.unit(),B=g.unit();return O.properties.roundedCylinder=new n.CSGProperties,O.properties.roundedCylinder.start=new d.CSGConnector(i,R.negated(),B),O.properties.roundedCylinder.end=new d.CSGConnector(u,R,B),O.properties.roundedCylinder.facepoint=i.plus(g),O},t.roundedCube=function(e){var r,i;if("corner1"in(e=e||{})||"corner2"in e){if("center"in e||"radius"in e)throw new Error("roundedCube: should either give a radius and center parameter, or a corner1 and corner2 parameter");var a=t.parseOptionAs3DVector(e,"corner1",[0,0,0]),u=t.parseOptionAs3DVector(e,"corner2",[1,1,1]);r=a.plus(u).times(.5),i=u.minus(a).times(.5)}else r=t.parseOptionAs3DVector(e,"center",[0,0,0]),i=t.parseOptionAs3DVector(e,"radius",[1,1,1]);i=i.abs();var p=t.parseOptionAsInt(e,"resolution",t.defaultResolution3D);p<4&&(p=4),p%2==1&&p<8&&(p=8);var h=t.parseOptionAs3DVector(e,"roundradius",[.2,.2,.2]);h=t.Vector3D.Create(Math.max(h.x,.01),Math.max(h.y,.01),Math.max(h.z,.01));var c=i.minus(h);if(c.x<0||c.y<0||c.z<0)throw"roundradius <= radius!";var l=t.sphere({radius:1,resolution:p});return l=l.scale(h),c.x>1e-5&&(l=l.stretchAtPlane([1,0,0],[0,0,0],2*c.x)),c.y>1e-5&&(l=l.stretchAtPlane([0,1,0],[0,0,0],2*c.y)),c.z>1e-5&&(l=l.stretchAtPlane([0,0,1],[0,0,0],2*c.z)),(l=(l=l.translate([-c.x+r.x,-c.y+r.y,-c.z+r.z])).reTesselated()).properties.roundedCube=new n.CSGProperties,l.properties.roundedCube.center=new s.CSGVertex(r),l.properties.roundedCube.facecenters=[new d.CSGConnector(new o.CSGVector3D([i.x,0,0]).plus(r),[1,0,0],[0,0,1]),new d.CSGConnector(new o.CSGVector3D([-i.x,0,0]).plus(r),[-1,0,0],[0,0,1]),new d.CSGConnector(new o.CSGVector3D([0,i.y,0]).plus(r),[0,1,0],[0,0,1]),new d.CSGConnector(new o.CSGVector3D([0,-i.y,0]).plus(r),[0,-1,0],[0,0,1]),new d.CSGConnector(new o.CSGVector3D([0,0,i.z]).plus(r),[0,0,1],[1,0,0]),new d.CSGConnector(new o.CSGVector3D([0,0,-i.z]).plus(r),[0,0,-1],[1,0,0])],l},t.solve2Linear=function(t,e,r,n,i,o){var s=1/(t*n-e*r),a=i*n-e*o,u=-i*r+t*o;return[a*=s,u*=s]},t.polyhedron=function(e){if("points"in(e=e||{})!="faces"in e)throw new Error("polyhedron needs 'points' and 'faces' arrays");var r=t.parseOptionAs3DVectorList(e,"points",[[1,1,0],[1,-1,0],[-1,-1,0],[-1,1,0],[0,0,1]]).map((function(t){return new s.CSGVertex(t)})),n=t.parseOption(e,"faces",[[0,1,4],[1,2,4],[2,3,4],[3,0,4],[1,0,3],[2,1,3]]);n.forEach((function(t){t.reverse()}));var i=n.map((function(t){return new a.CSGPolygon(t.map((function(t){return r[t]})))}));return t.fromPolygons(i).reTesselated()},t.IsFloat=function(t){return!isNaN(t)||t==1/0||t==-1/0},t.interpolateBetween2DPointsForY=function(t,e,r){var n,i=r-t.y,o=e.y-t.y;return o<0&&(i=-i,o=-o),n=i<=0?0:i>=o?1:o<1e-10?.5:i/o,t.x+n*(e.x-t.x)},t.reTesselateCoplanarPolygons=function(e,r){var n=1e-5,i=e.length;if(i>0){for(var o=e[0].plane,u=e[0].shared,p=new h.CSGOrthoNormalBasis(o),f=[],y=[],d={},_={},m={},g=0;g<i;g++){var v=e[g],x=[],T=v.vertices.length,C=-1;if(T>0){for(var E=-Infinity,M=1/0,w=0;w<T;w++){var P=p.to2D(v.vertices[w].pos),A=Math.floor(999999.9999999999*P.y),O=void 0;A in m?O=m[A]:A+1 in m?O=m[A+1]:A-1 in m?O=m[A-1]:(O=P.y,m[A]=P.y),P=c.CSGVector2D.Create(P.x,O),x.push(P);var R=P.y;(0==w||R<E)&&(E=R,C=w),(0==w||R>M)&&(M=R,w),R in _||(_[R]={}),_[R][g]=!0}E>=M?(x=[],T=0,C=-1):(E in d||(d[E]=[]),d[E].push(g))}x.reverse(),C=T-C-1,f.push(x),y.push(C)}var B=[];for(var I in _)B.push(I);B.sort(b);for(var N=[],F=[],G=function(e){for(var i=[],h=B[e],m=Number(h),g=_[h],v=0;v<N.length;++v){if(g[A=(U=N[v]).polygonindex]){for(var x=(z=f[A]).length,b=U.leftvertexindex,T=U.rightvertexindex;;){if((G=b+1)>=x&&(G=0),z[G].y!=m)break;b=G}if((D=T-1)<0&&(D=x-1),z[D].y==m&&(T=D),b!=U.leftvertexindex&&b==T)N.splice(v,1),--v;else{U.leftvertexindex=b,U.rightvertexindex=T,U.topleft=z[b],U.topright=z[T],(G=b+1)>=x&&(G=0),U.bottomleft=z[G];var C=T-1;C<0&&(C=x-1),U.bottomright=z[C]}}}var E=void 0;if(e>=B.length-1)N=[],E=null;else{var M=.5*(m+(E=Number(B[e+1]))),w=d[h];for(var P in w){for(var A=w[P],O=(x=(z=f[A]).length,y[A]),R=O;;){if(($=R+1)>=x&&($=0),z[$].y!=m)break;if($==O)break;R=$}for(var I=O;;){if(($=I-1)<0&&($=x-1),z[$].y!=m)break;if($==R)break;I=$}var G,D;(G=R+1)>=x&&(G=0),(D=I-1)<0&&(D=x-1);var V={polygonindex:A,leftvertexindex:R,rightvertexindex:I,topleft:z[R],topright:z[I],bottomleft:z[G],bottomright:z[D]};S(N,V,(function(e,r){var n=t.interpolateBetween2DPointsForY(e.topleft,e.bottomleft,M),i=t.interpolateBetween2DPointsForY(r.topleft,r.bottomleft,M);return n>i?1:n<i?-1:0}))}}for(var L in N){A=(U=N[L]).polygonindex,x=(z=f[A]).length;var U,z,j=t.interpolateBetween2DPointsForY(U.topleft,U.bottomleft,m),q=c.CSGVector2D.Create(j,m);j=t.interpolateBetween2DPointsForY(U.topright,U.bottomright,m);var X=c.CSGVector2D.Create(j,m);j=t.interpolateBetween2DPointsForY(U.topleft,U.bottomleft,E);var W=c.CSGVector2D.Create(j,E);j=t.interpolateBetween2DPointsForY(U.topright,U.bottomright,E);var k=c.CSGVector2D.Create(j,E),Y={topleft:q,topright:X,bottomleft:W,bottomright:k,leftline:l.CSGLine2D.fromPoints(q,W),rightline:l.CSGLine2D.fromPoints(k,X)};if(i.length>0){var H=i[i.length-1],Z=Y.topleft.distanceTo(H.topright),K=Y.bottomleft.distanceTo(H.bottomright);Z<n&&K<n&&(Y.topleft=H.topleft,Y.leftline=H.leftline,Y.bottomleft=H.bottomleft,i.splice(i.length-1,1))}i.push(Y)}if(e>0){for(var Q={},J={},$=0;$<i.length;$++)for(var tt=i[$],et=0;et<F.length;et++)if(!J[et]){var rt=F[et];if(rt.bottomleft.distanceTo(tt.topleft)<n&&rt.bottomright.distanceTo(tt.topright)<n){J[et]=!0;Z=tt.leftline.direction().x-rt.leftline.direction().x,K=tt.rightline.direction().x-rt.rightline.direction().x;var nt=Math.abs(Z)<n,it=Math.abs(K)<n;(nt||Z>=0)&&(it||K>=0)&&(tt.outpolygon=rt.outpolygon,tt.leftlinecontinues=nt,tt.rightlinecontinues=it,Q[et]=!0);break}}var ot=function(t){if(!Q[t]){var e=F[t];e.outpolygon.rightpoints.push(e.bottomright),e.bottomright.distanceTo(e.bottomleft)>n&&e.outpolygon.leftpoints.push(e.bottomleft),e.outpolygon.leftpoints.reverse();var i=e.outpolygon.rightpoints.concat(e.outpolygon.leftpoints),h=[];i.map((function(t){var e=p.to3D(t),r=new s.CSGVertex(e);h.push(r)}));var c=new a.CSGPolygon(h,u,o);r.push(c)}};for(et=0;et<F.length;et++)ot(et)}for($=0;$<i.length;$++){(tt=i[$]).outpolygon?(tt.leftlinecontinues||tt.outpolygon.leftpoints.push(tt.topleft),tt.rightlinecontinues||tt.outpolygon.rightpoints.push(tt.topright)):(tt.outpolygon={leftpoints:[],rightpoints:[]},tt.outpolygon.leftpoints.push(tt.topleft),tt.topleft.distanceTo(tt.topright)>n&&tt.outpolygon.rightpoints.push(tt.topright))}F=i},D=0;D<B.length;D++)G(D)}},t.prototype.toPolygons=function(){return this.polygons},t.prototype.union=function(t){var e;t instanceof Array?(e=t.slice(0)).push(this):e=[this,t];for(var r=1,n=1;n<e.length;n+=2)e.push(e[n-1].unionSub(e[n])),r=n;return e[r-1].reTesselated().canonicalized()},t.prototype.unionSub=function(e,r,n){if(this.mayOverlap(e)){var i=new u.CSGTree(this.polygons),o=new u.CSGTree(e.polygons);i.clipTo(o,!1),o.clipTo(i),o.invert(),o.clipTo(i),o.invert();var s=i.allPolygons().concat(o.allPolygons()),a=t.fromPolygons(s);return a.properties=this.properties._merge(e.properties),r&&(a=a.reTesselated()),n&&(a=a.canonicalized()),a}return this.unionForNonIntersecting(e)},t.prototype.unionForNonIntersecting=function(e){var r=this.polygons.concat(e.polygons),n=t.fromPolygons(r);return n.properties=this.properties._merge(e.properties),n.isCanonicalized=this.isCanonicalized&&e.isCanonicalized,n.isRetesselated=this.isRetesselated&&e.isRetesselated,n},t.prototype.subtract=function(t){var e;e=t instanceof Array?t:[t];for(var r=this,n=0;n<e.length;n++){var i=n==e.length-1;r=r.subtractSub(e[n],i,i)}return r},t.prototype.subtractSub=function(e,r,n){var i=new u.CSGTree(this.polygons),o=new u.CSGTree(e.polygons);i.invert(),i.clipTo(o),o.clipTo(i,!0),i.addPolygons(o.allPolygons()),i.invert();var s=t.fromPolygons(i.allPolygons());return s.properties=this.properties._merge(e.properties),r&&(s=s.reTesselated()),n&&(s=s.canonicalized()),s},t.prototype.intersect=function(t){var e;e=t instanceof Array?t:[t];for(var r=this,n=0;n<e.length;n++){var i=n==e.length-1;r=r.intersectSub(e[n],i,i)}return r},t.prototype.intersectSub=function(e,r,n){var i=new u.CSGTree(this.polygons),o=new u.CSGTree(e.polygons);i.invert(),o.clipTo(i),o.invert(),i.clipTo(o),o.clipTo(i),i.addPolygons(o.allPolygons()),i.invert();var s=t.fromPolygons(i.allPolygons());return s.properties=this.properties._merge(e.properties),r&&(s=s.reTesselated()),n&&(s=s.canonicalized()),s},t.prototype.invert=function(){var e=this.polygons.map((function(t){return t.flipped()}));return t.fromPolygons(e)},t.prototype.transform1=function(e){var r=this.polygons.map((function(t){return t.transform(e)})),n=t.fromPolygons(r);return n.properties=this.properties._transform(e),n.isRetesselated=this.isRetesselated,n},t.prototype.transform=function(e){var r=e.isMirroring(),n={},i={},o=this.polygons.map((function(t){var o,s=t.plane,u=s.getTag();u in i?o=i[u]:(o=s.transform(e),i[u]=o);var p=t.vertices.map((function(t){var r,i=t.getTag();return i in n?r=n[i]:(r=t.transform(e),n[i]=r),r}));return r&&p.reverse(),new a.CSGPolygon(p,t.shared,o)})),s=t.fromPolygons(o);return s.properties=this.properties._transform(e),s.isRetesselated=this.isRetesselated,s.isCanonicalized=this.isCanonicalized,s},t.prototype.toString=function(){var t="CSG solid:\n";return this.polygons.map((function(e){t+=e.toString()})),t},t.prototype.expand=function(t,e){var r=this.expandedShell(t,e,!0);return(r=r.reTesselated()).properties=this.properties,r},t.prototype.contract=function(t,e){var r=this.expandedShell(t,e,!1),n=this.subtract(r);return(n=n.reTesselated()).properties=this.properties,n},t.prototype.stretchAtPlane=function(e,r,n){var i=t.Plane.fromNormalAndPoint(e,r),o=new h.CSGOrthoNormalBasis(i),s=this.sectionCut(o).extrudeInOrthonormalBasis(o,n),a=this.cutByPlane(i),u=this.cutByPlane(i.flipped());return a.union([s,u.translate(i.normal.times(n))])},t.prototype.expandedShell=function(e,r,n){var i,o=this.reTesselated();i=n?o:new t,o.polygons.map((function(t){var r=t.plane.normal.unit().times(2*e),n=t.translate(r.times(-.5)).extrude(r);i=i.unionSub(n,!1,!1)}));var u={};for(var p in o.polygons.map((function(t){for(var e=t.vertices.length,r=t.vertices[e-1],n=r.getTag(),i=0;i<e;i++){var o=t.vertices[i],s=o.getTag(),a=void 0,p=void 0;(a=s<n?s+"-"+n:n+"-"+s)in u?p=u[a]:(p={v1:r,v2:o,planenormals:[]},u[a]=p),p.planenormals.push(t.plane.normal),n=s,r=o}})),u){for(var h=u[p],c=h.v1.pos,l=h.v2.pos,f=l.minus(c).unit(),y=h.planenormals[0].unit(),d=y.cross(f),_=[],m=0;m<r;m++)_.push(m*Math.PI*2/r);m=0;for(var g=h.planenormals.length;m<g;m++){var v=h.planenormals[m],x=d.dot(v),S=y.dot(v);(A=Math.atan2(x,S))<0&&(A+=2*Math.PI),_.push(A),(A=Math.atan2(-x,-S))<0&&(A+=2*Math.PI),_.push(A)}var T=(_=_.sort(b)).length,C=void 0,E=void 0,M=[],w=[],P=[];for(m=-1;m<T;m++){var A=_[m<0?m+T:m],O=(x=Math.sin(A),S=Math.cos(A),y.times(S*e).plus(d.times(x*e))),R=c.plus(O),B=l.plus(O),I=!1;if(m>=0&&R.distanceTo(C)<1e-5&&(I=!0),!I){if(m>=0){M.push(new s.CSGVertex(R)),w.push(new s.CSGVertex(B));var N=[new s.CSGVertex(E),new s.CSGVertex(B),new s.CSGVertex(R),new s.CSGVertex(C)],F=new a.CSGPolygon(N);P.push(F)}C=R,E=B}}w.reverse(),P.push(new a.CSGPolygon(M)),P.push(new a.CSGPolygon(w));var G=t.fromPolygons(P);i=i.unionSub(G,!1,!1)}var D={};for(var V in o.polygons.map((function(t){t.vertices.map((function(e){var r,n=e.getTag();n in D?r=D[n]:(r={pos:e.pos,normals:[]},D[n]=r),r.normals.push(t.plane.normal)}))})),D){var L=D[V],U=L.normals[0].unit(),z=null,j=0;for(m=1;m<L.normals.length;m++){var q=L.normals[m].unit(),X=U.cross(q).length();X>.05&&X>j&&(j=X,z=q)}z||(z=U.randomNonParallelVector());var W=U.cross(z).unit(),k=W.cross(U),Y=t.sphere({center:L.pos,radius:e,resolution:r,axes:[U,W,k]});i=i.unionSub(Y,!1,!1)}return i},t.prototype.canonicalized=function(){if(this.isCanonicalized)return this;var t=(new p.CSGFuzzyCSGFactory).getCSG(this);return t.isCanonicalized=!0,t.isRetesselated=this.isRetesselated,t.properties=this.properties,t},t.prototype.reTesselated=function(){if(this.isRetesselated)return this;var e={},r=this.isCanonicalized,n=new p.CSGFuzzyCSGFactory;this.polygons.map((function(t){var i=t.plane,o=t.shared;r||(i=n.getPlane(i),o=n.getPolygonShared(o));var s=i.getTag()+"/"+o.getTag();s in e?e[s].push(t):e[s]=[t]}));var i=[];for(var o in e){var s=e[o];if(s.length<2)i=i.concat(s);else{var a=[];t.reTesselateCoplanarPolygons(s,a),i=i.concat(a)}}var u=t.fromPolygons(i);return u.isRetesselated=!0,u.properties=this.properties,u},t.prototype.getBounds=function(){if(!this.cachedBoundingBox){for(var t=new o.CSGVector3D(0,0,0),e=new o.CSGVector3D(0,0,0),r=this.polygons,n=r.length,i=0;i<n;i++){var s=r[i].boundingBox();0==i?(t=s[0],e=s[1]):(t=t.min(s[0]),e=e.max(s[1]))}this.cachedBoundingBox=[t,e]}return this.cachedBoundingBox},t.prototype.mayOverlap=function(t){if(0==this.polygons.length||0==t.polygons.length)return!1;var e=this.getBounds(),r=t.getBounds();return!(e[1].x<r[0].x)&&(!(e[0].x>r[1].x)&&(!(e[1].y<r[0].y)&&(!(e[0].y>r[1].y)&&(!(e[1].z<r[0].z)&&!(e[0].z>r[1].z)))))},t.prototype.cutByPlane=function(e){if(0==this.polygons.length)return new t;var r=e.normal.times(e.w),n=0;this.polygons.map((function(t){t.vertices.map((function(t){var e=t.pos.distanceToSquared(r);e>n&&(n=e)}))})),n=Math.sqrt(n),n*=1.01;var i=[],o=new h.CSGOrthoNormalBasis(e);i.push(new s.CSGVertex(o.to3D(new c.CSGVector2D(n,-n)))),i.push(new s.CSGVertex(o.to3D(new c.CSGVector2D(-n,-n)))),i.push(new s.CSGVertex(o.to3D(new c.CSGVector2D(-n,n)))),i.push(new s.CSGVertex(o.to3D(new c.CSGVector2D(n,n))));var u=new a.CSGPolygon(i,null,e.flipped()).extrude(e.normal.times(-n)),p=this.intersect(u);return p.properties=this.properties,p},t.prototype.connectTo=function(t,e,r,n){var i=t.getTransformationTo(e,r,n);return this.transform(i)},t.prototype.setShared=function(e){var r=this.polygons.map((function(t){return new a.CSGPolygon(t.vertices,e,t.plane)})),n=t.fromPolygons(r);return n.properties=this.properties,n.isRetesselated=this.isRetesselated,n.isCanonicalized=this.isCanonicalized,n},t.prototype.setColor=function(t){var e=f.CSGPolygonShared.fromColor.apply(this,arguments);return this.setShared(e)},t.prototype.toCompactBinary=function(){var t=this.canonicalized(),e=t.polygons.length,r=0,n=0,i={},o=[],s=0,a={},u=[],p=[],h={},c=0;t.polygons.map((function(t){t.vertices.map((function(t){++r;var e=t.getTag();e in i||(i[e]=n++,o.push(t))}));var e=t.plane.getTag();e in a||(a[e]=s++,u.push(t.plane));var l=t.shared.getTag();l in h||(h[l]=c++,p.push(t.shared))}));for(var l=new Uint32Array(e),f=new Uint32Array(e),y=new Uint32Array(r),d=new Uint32Array(e),_=new Float64Array(3*n),m=new Float64Array(4*s),g=0,v=0;v<e;++v){var x=t.polygons[v];l[v]=x.vertices.length,x.vertices.map((function(t){var e=t.getTag(),r=i[e];y[g++]=r}));var b=x.plane.getTag(),S=a[b];d[v]=S;var T=x.shared.getTag(),C=h[T];f[v]=C}var E=0;o.map((function(t){var e=t.pos;_[E++]=e._x,_[E++]=e._y,_[E++]=e._z}));var M=0;return u.map((function(t){var e=t.normal;m[M++]=e._x,m[M++]=e._y,m[M++]=e._z,m[M++]=t.w})),{class:"CSG",numPolygons:e,numVerticesPerPolygon:l,polygonPlaneIndexes:d,polygonSharedIndexes:f,polygonVertices:y,vertexData:_,planeData:m,shared:p}},t.prototype.toPointCloud=function(e){var r=this.reTesselated(),n=new t,i={};for(var o in r.polygons.map((function(t){t.vertices.map((function(t){i[t.getTag()]=t.pos}))})),i){var s=i[o],a=t.cube({center:s,radius:e});n=n.unionSub(a,!1,!1)}return n=n.reTesselated()},t.prototype.getTransformationAndInverseTransformationToFlatLying=function(){if(0==this.polygons.length)return new i.CSGMatrix4x4;var e=this.canonicalized(),r={};e.polygons.map((function(t){r[t.plane.getTag()]=t.plane}));var n=new o.CSGVector3D(1,0,0),s=new o.CSGVector3D(0,1,0),a=new o.CSGVector3D(0,0,1),u=new d.CSGConnector([0,0,0],[0,0,-1],n),p=new d.CSGConnector([0,0,0],[0,0,-1],s),h=!0,c=0,l=0,f=void 0,y=void 0;for(var _ in r){var m,g=r[_],v=g.normal.times(g.w),x=void 0,b=void 0;if(g.normal.cross(n).length()>g.normal.cross(s).length())x=(m=new d.CSGConnector(v,g.normal,n)).getTransformationTo(u,!1,0),b=u.getTransformationTo(m,!1,0);else x=(m=new d.CSGConnector(v,g.normal,s)).getTransformationTo(p,!1,0),b=p.getTransformationTo(m,!1,0);var S=e.transform(x),T=-g.normal.dot(a),C=S.getBounds(),E=C[1].z-C[0].z,M=h;if(M||(E<c||E==c&&T>l)&&(M=!0),M){var w=new o.CSGVector3D([-.5*(C[1].x+C[0].x),-.5*(C[1].y+C[0].y),-C[0].z]);c=E,l=T,f=x=x.multiply(t.Matrix4x4.translation(w)),y=b=i.CSGMatrix4x4.translation(w.negated()).multiply(b)}h=!1}return[f,y]},t.prototype.getTransformationToFlatLying=function(){return this.getTransformationAndInverseTransformationToFlatLying()[0]},t.prototype.lieFlat=function(){var t=this.getTransformationToFlatLying();return this.transform(t)},t.prototype.projectToOrthoNormalBasis=function(t){var e=[];return this.polygons.filter((function(e){return e.plane.normal.minus(t.plane.normal).lengthSquared()<1e-5*1e-5})).map((function(r){var n=r.projectToOrthoNormalBasis(t);n.sides.length>0&&e.push(n)})),(new _.CAG).union(e)},t.prototype.sectionCut=function(t){var e=t.plane,r=t.plane.flipped();e=new y.CSGPlane(e.normal,e.w),r=new y.CSGPlane(r.normal,r.w+5e-5);var n=this.cutByPlane(e);return(n=n.cutByPlane(r)).projectToOrthoNormalBasis(t)},t.prototype.fixTJunctions=function(){function e(t,e,n){var o=t.getTag(),s=e.getTag();if(o==s)throw new Error("Assertion failed");var a=o+"/"+s;if(s+"/"+o in i)return r(e,t,null),null;var u={vertex0:t,vertex1:e,polygonindex:n};return a in i?i[a].push(u):i[a]=[u],o in g?g[o].push(a):g[o]=[a],s in v?v[s].push(a):v[s]=[a],a}function r(t,e,r){var n=t.getTag(),o=e.getTag(),s=n+"/"+o;if(!(s in i))throw new Error("Assertion failed");for(var a=-1,u=i[s],p=0;p<u.length;p++){var h=u[p];if(h.vertex0==t&&(h.vertex1==e&&(null==r||h.polygonindex==r))){a=p;break}}if(a<0)throw new Error("Assertion failed");if(u.splice(a,1),0==u.length&&delete i[s],(a=g[n].indexOf(s))<0)throw new Error("Assertion failed");if(g[n].splice(a,1),0==g[n].length&&delete g[n],(a=v[o].indexOf(s))<0)throw new Error("Assertion failed");v[o].splice(a,1),0==v[o].length&&delete v[o]}for(var n=this.canonicalized(),i={},o=0;o<n.polygons.length;o++){var s=(k=n.polygons[o]).vertices.length;if(s>=3)for(var u=k.vertices[0],p=u.getTag(),h=0;h<s;h++){var c=h+1;c==s&&(c=0);var l=k.vertices[c],f=l.getTag(),y=p+"/"+f,d=f+"/"+p;if(d in i){var _=i[d];_.splice(-1,1),0==_.length&&delete i[d]}else{var m={vertex0:u,vertex1:l,polygonindex:o};y in i?i[y].push(m):i[y]=[m]}u=l,p=f}}var g={},v={},x={},b=!0,S=function(t){b=!1,x[t]=!0,i[t].map((function(e){var r=e.vertex0.getTag(),n=e.vertex1.getTag();r in g?g[r].push(t):g[r]=[t],n in v?v[n].push(t):v[n]=[t]}))};for(var y in i)S(y);if(!b){for(var T=n.polygons.slice(0);;){var C=!0;for(var y in i)C=!1,x[y]=!0;if(C)break;for(var E=!1;;){var M=null,w=null;for(var y in x){M=y,w=y;break}if(null==M)break;var P=!0;if(M in i){var A=i[M];if(0==A.length)throw new Error("Assertion failed");m=A[0];for(var O=0;O<2;O++){var R=0==O?m.vertex0:m.vertex1,B=0==O?m.vertex1:m.vertex0,I=R.getTag(),N=B.getTag(),F=[];0==O?I in v&&(F=v[I]):I in g&&(F=g[I]);for(var G=0;G<F.length;G++){var D=F[G],V=i[D][0],L=0==O?V.vertex0:V.vertex1,U=0==O?V.vertex1:V.vertex0,z=L.getTag();if(U.getTag()!=I)throw new Error("Assertion failed");if(z==N){r(R,B,null),r(B,R,null),P=!1,O=2,E=!0;break}var j=R.pos,q=B.pos,X=L.pos.minus(j),W=q.minus(j).dot(X)/X.dot(X);if(W>0&&W<1&&j.plus(X.times(W)).distanceToSquared(q)<1e-10){for(var k=T[o=V.polygonindex],Y=V.vertex1.getTag(),H=-1,Z=0;Z<k.vertices.length;Z++)if(k.vertices[Z].getTag()==Y){H=Z;break}if(H<0)throw new Error("Assertion failed");var K=k.vertices.slice(0);K.splice(H,0,B);var Q=new a.CSGPolygon(K,k.shared);T[o]=Q,r(V.vertex0,V.vertex1,o);var J=e(V.vertex0,B,o),$=e(B,V.vertex1,o);null!=J&&(x[J]=!0),null!=$&&(x[$]=!0),P=!1,O=2,E=!0;break}}}}P&&delete x[w]}if(!E)break}var tt=t.fromPolygons(T);tt.properties=n.properties,tt.isCanonicalized=!0,tt.isRetesselated=!0,n=tt}var et=!0;for(var y in i){et=!1;break}return et||console.log("!sidemapisempty1"),n},t.prototype.toTriangles=function(){var t=[];return this.polygons.forEach((function(e){for(var r=e.vertices[0],n=e.vertices.length-3;n>=0;n--)t.push(new a.CSGPolygon([r,e.vertices[n+1],e.vertices[n+2]],e.shared,e.plane))})),t},t.prototype.getFeatures=function(t){t instanceof Array||(t=[t]);var e=this.toTriangles().map((function(e){return e.getTetraFeatures(t)})).reduce((function(t,e){return e.map((function(e,r){return e+(0==t?0:t[r])}))}),0);return 1==e.length?e[0]:e},t.prototype.mirrored=function(t){return this.transform(i.CSGMatrix4x4.mirroring(t))},t.prototype.mirroredX=function(){var t=new y.CSGPlane(o.CSGVector3D.Create(1,0,0),0);return this.mirrored(t)},t.prototype.mirroredY=function(){var t=new y.CSGPlane(o.CSGVector3D.Create(0,1,0),0);return this.mirrored(t)},t.prototype.mirroredZ=function(){var t=new y.CSGPlane(o.CSGVector3D.Create(0,0,1),0);return this.mirrored(t)},t.prototype.translate=function(t){return this.transform(i.CSGMatrix4x4.translation(t))},t.prototype.scale=function(t){return this.transform(i.CSGMatrix4x4.scaling(t))},t.prototype.rotateX=function(t){return this.transform(i.CSGMatrix4x4.rotationX(t))},t.prototype.rotateY=function(t){return this.transform(i.CSGMatrix4x4.rotationY(t))},t.prototype.rotateZ=function(t){return this.transform(i.CSGMatrix4x4.rotationZ(t))},t.prototype.rotate=function(t,e,r){return this.transform(i.CSGMatrix4x4.rotation(t,e,r))},t.prototype.rotateEulerAngles=function(t,e,r,n){n=n||[0,0,0];var s=i.CSGMatrix4x4.rotationZ(t),a=i.CSGMatrix4x4.rotationX(e),u=i.CSGMatrix4x4.rotationZ(r),p=i.CSGMatrix4x4.translation(new o.CSGVector3D(n));return this.transform(u.multiply(a).multiply(s).multiply(p))},t.prototype.center=function(t){var e=["x","y","z"];(t=Array.prototype.map.call(arguments,(function(t){return t.toLowerCase()}))).length||(t=e.slice());var r=this.getBounds();return this.translate(e.map((function(e){return t.indexOf(e)>-1?-(r[0][e]+r[1][e])/2:0})))},t.Vector3D=o.CSGVector3D,t.Plane=y.CSGPlane,t.Matrix4x4=i.CSGMatrix4x4,t.staticTag=1,t.defaultResolution2D=32,t.defaultResolution3D=12,t}();e.CSG=T},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.CSGMatrix4x4=void 0;var n=r(14),i=r(9),o=r(8),s=r(40),a=function(){function t(t){if(arguments.length>=1){var e=t;this.elements=e}else this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}return t.unity=function(){return new t},t.rotationX=function(e){var r=e*Math.PI*(1/180),n=Math.cos(r),i=Math.sin(r);return new t([1,0,0,0,0,n,i,0,0,-i,n,0,0,0,0,1])},t.rotationY=function(e){var r=e*Math.PI*(1/180),n=Math.cos(r),i=Math.sin(r);return new t([n,0,-i,0,0,1,0,0,i,0,n,0,0,0,0,1])},t.rotationZ=function(e){var r=e*Math.PI*(1/180),n=Math.cos(r),i=Math.sin(r);return new t([n,i,0,0,-i,n,0,0,0,0,1,0,0,0,0,1])},t.rotation=function(e,r,n){e=new i.CSGVector3D(e),r=new i.CSGVector3D(r);var a=o.CSGPlane.fromNormalAndPoint(r,e),u=new s.CSGOrthoNormalBasis(a),p=t.translation(e.negated());return p=(p=(p=(p=p.multiply(u.getProjectionMatrix())).multiply(t.rotationZ(n))).multiply(u.getInverseProjectionMatrix())).multiply(t.translation(e))},t.translation=function(e){var r=new i.CSGVector3D(e);return new t([1,0,0,0,0,1,0,0,0,0,1,0,r.x,r.y,r.z,1])},t.mirroring=function(e){var r=e.normal.x,n=e.normal.y,i=e.normal.z,o=e.w;return new t([1-2*r*r,-2*n*r,-2*i*r,0,-2*r*n,1-2*n*n,-2*i*n,0,-2*r*i,-2*n*i,1-2*i*i,0,2*r*o,2*n*o,2*i*o,1])},t.scaling=function(e){var r=new i.CSGVector3D(e);return new t([r.x,0,0,0,0,r.y,0,0,0,0,r.z,0,0,0,0,1])},t.prototype.plus=function(e){for(var r=[],n=0;n<16;n++)r[n]=this.elements[n]+e.elements[n];return new t(r)},t.prototype.minus=function(e){for(var r=[],n=0;n<16;n++)r[n]=this.elements[n]-e.elements[n];return new t(r)},t.prototype.multiply=function(e){var r=this.elements[0],n=this.elements[1],i=this.elements[2],o=this.elements[3],s=this.elements[4],a=this.elements[5],u=this.elements[6],p=this.elements[7],h=this.elements[8],c=this.elements[9],l=this.elements[10],f=this.elements[11],y=this.elements[12],d=this.elements[13],_=this.elements[14],m=this.elements[15],g=e.elements[0],v=e.elements[1],x=e.elements[2],b=e.elements[3],S=e.elements[4],T=e.elements[5],C=e.elements[6],E=e.elements[7],M=e.elements[8],w=e.elements[9],P=e.elements[10],A=e.elements[11],O=e.elements[12],R=e.elements[13],B=e.elements[14],I=e.elements[15],N=[];return N[0]=r*g+n*S+i*M+o*O,N[1]=r*v+n*T+i*w+o*R,N[2]=r*x+n*C+i*P+o*B,N[3]=r*b+n*E+i*A+o*I,N[4]=s*g+a*S+u*M+p*O,N[5]=s*v+a*T+u*w+p*R,N[6]=s*x+a*C+u*P+p*B,N[7]=s*b+a*E+u*A+p*I,N[8]=h*g+c*S+l*M+f*O,N[9]=h*v+c*T+l*w+f*R,N[10]=h*x+c*C+l*P+f*B,N[11]=h*b+c*E+l*A+f*I,N[12]=y*g+d*S+_*M+m*O,N[13]=y*v+d*T+_*w+m*R,N[14]=y*x+d*C+_*P+m*B,N[15]=y*b+d*E+_*A+m*I,new t(N)},t.prototype.clone=function(){return new t(this.elements.map((function(t){return t})))},t.prototype.rightMultiply1x3Vector=function(t){var e=t._x,r=t._y,n=t._z,o=e*this.elements[0]+r*this.elements[1]+n*this.elements[2]+1*this.elements[3],s=e*this.elements[4]+r*this.elements[5]+n*this.elements[6]+1*this.elements[7],a=e*this.elements[8]+r*this.elements[9]+n*this.elements[10]+1*this.elements[11],u=e*this.elements[12]+r*this.elements[13]+n*this.elements[14]+1*this.elements[15];if(1!=u){var p=1/u;o*=p,s*=p,a*=p}return new i.CSGVector3D(o,s,a)},t.prototype.leftMultiply1x3Vector=function(t){var e=t._x,r=t._y,n=t._z,o=e*this.elements[0]+r*this.elements[4]+n*this.elements[8]+1*this.elements[12],s=e*this.elements[1]+r*this.elements[5]+n*this.elements[9]+1*this.elements[13],a=e*this.elements[2]+r*this.elements[6]+n*this.elements[10]+1*this.elements[14],u=e*this.elements[3]+r*this.elements[7]+n*this.elements[11]+1*this.elements[15];if(1!=u){var p=1/u;o*=p,s*=p,a*=p}return new i.CSGVector3D(o,s,a)},t.prototype.rightMultiply1x2Vector=function(t){var e=t.x,r=t.y,i=e*this.elements[0]+r*this.elements[1]+0*this.elements[2]+1*this.elements[3],o=e*this.elements[4]+r*this.elements[5]+0*this.elements[6]+1*this.elements[7],s=(this.elements[8],this.elements[9],this.elements[10],this.elements[11],e*this.elements[12]+r*this.elements[13]+0*this.elements[14]+1*this.elements[15]);if(1!=s){var a=1/s;i*=a,o*=a,a}return new n.CSGVector2D(i,o)},t.prototype.leftMultiply1x2Vector=function(t){var e=t.x,r=t.y,i=e*this.elements[0]+r*this.elements[4]+0*this.elements[8]+1*this.elements[12],o=e*this.elements[1]+r*this.elements[5]+0*this.elements[9]+1*this.elements[13],s=(this.elements[2],this.elements[6],this.elements[10],this.elements[14],e*this.elements[3]+r*this.elements[7]+0*this.elements[11]+1*this.elements[15]);if(1!=s){var a=1/s;i*=a,o*=a,a}return new n.CSGVector2D(i,o)},t.prototype.isMirroring=function(){var t=new i.CSGVector3D(this.elements[0],this.elements[4],this.elements[8]),e=new i.CSGVector3D(this.elements[1],this.elements[5],this.elements[9]),r=new i.CSGVector3D(this.elements[2],this.elements[6],this.elements[10]);return t.cross(e).dot(r)<0},t}();e.CSGMatrix4x4=a},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.CSGPlane=void 0;var n=r(9),i=r(29),o=r(30),s=r(57),a=r(6),u=r(7),p=function(){function t(t,e){this.normal=t,this.w=e}return t.fromObject=function(e){return new t(new n.CSGVector3D(e.normal),parseFloat(e.w))},t.fromVector3Ds=function(e,r,n){var i=r.minus(e).cross(n.minus(e)).unit();return new t(i,i.dot(e))},t.anyPlaneFromVector3Ds=function(e,r,n){var i=r.minus(e),o=n.minus(e);i.length()<1e-5&&(i=o.randomNonParallelVector()),o.length()<1e-5&&(o=i.randomNonParallelVector());var s=i.cross(o);return s.length()<1e-5&&(o=i.randomNonParallelVector(),s=i.cross(o)),new t(s=s.unit(),s.dot(e))},t.fromPoints=function(e,r,i){return e=new n.CSGVector3D(e),r=new n.CSGVector3D(r),i=new n.CSGVector3D(i),t.fromVector3Ds(e,r,i)},t.fromNormalAndPoint=function(e,r){return e=new n.CSGVector3D(e),r=new n.CSGVector3D(r),new t(e=e.unit(),r.dot(e))},t.prototype.flipped=function(){return new t(this.normal.negated(),-this.w)},t.prototype.getTag=function(){var t=this.tag;return t||(t=a.CSG.getTag(),this.tag=t),t},t.prototype.equals=function(t){return this.normal.equals(t.normal)&&this.w==t.w},t.prototype.transform=function(e){var r=e.isMirroring(),n=this.normal.randomNonParallelVector(),i=this.normal.cross(n),o=this.normal.cross(i),s=this.normal.times(this.w),a=s.plus(i),u=s.plus(o);s=s.multiply4x4(e),a=a.multiply4x4(e),u=u.multiply4x4(e);var p=t.fromVector3Ds(s,a,u);return r&&(p=p.flipped()),p},t.prototype.splitPolygon=function(e){var r={type:null,front:null,back:null},n=this.normal,s=e.vertices,a=s.length;if(e.plane.equals(this))r.type=0;else{for(var u=t.EPSILON,p=this.w,h=!1,c=!1,l=[],f=-u,y=0;y<a;y++){var d=(P=n.dot(s[y].pos)-p)<0;l.push(d),P>u&&(h=!0),P<f&&(c=!0)}if(h||c)if(c)if(h){r.type=4;for(var _=[],m=[],g=(d=l[0],0);g<a;g++){var v=s[g],x=g+1;x>=a&&(x=0);var b=l[x];if(d==b)d?m.push(v):_.push(v);else{var S=v.pos,T=s[x].pos,C=this.splitLineBetweenPoints(S,T),E=new i.CSGVertex(C);d?(m.push(v),m.push(E),_.push(E)):(_.push(v),_.push(E),m.push(E))}d=b}var M=t.EPSILON*t.EPSILON;if(m.length>=3){var w=m[m.length-1];for(g=0;g<m.length;g++){(v=m[g]).pos.distanceToSquared(w.pos)<M&&(m.splice(g,1),g--),w=v}}if(_.length>=3)for(w=_[_.length-1],g=0;g<_.length;g++){(v=_[g]).pos.distanceToSquared(w.pos)<M&&(_.splice(g,1),g--),w=v}_.length>=3&&(r.front=new o.CSGPolygon(_,e.shared,e.plane)),m.length>=3&&(r.back=new o.CSGPolygon(m,e.shared,e.plane))}else r.type=3;else r.type=2;else{var P=n.dot(e.plane.normal);r.type=P>=0?0:1}}return r},t.prototype.splitLineBetweenPoints=function(t,e){var r=e.minus(t),n=(this.w-this.normal.dot(t))/this.normal.dot(r);return isNaN(n)&&(n=0),n>1&&(n=1),n<0&&(n=0),t.plus(r.times(n))},t.prototype.intersectWithLine=function(t){return t.intersectWithPlane(this)},t.prototype.intersectWithPlane=function(t){return s.CSGLine3D.fromPlanes(this,t)},t.prototype.signedDistanceToPoint=function(t){return this.normal.dot(t)-this.w},t.prototype.toString=function(){return"[normal: "+this.normal.toString()+", w: "+this.w+"]"},t.prototype.mirrorPoint=function(t){var e=this.signedDistanceToPoint(t);return t.minus(this.normal.times(2*e))},t.prototype.mirrored=function(t){return this.transform(u.CSGMatrix4x4.mirroring(t))},t.prototype.mirroredX=function(){var e=new t(n.CSGVector3D.Create(1,0,0),0);return this.mirrored(e)},t.prototype.mirroredY=function(){var e=new t(n.CSGVector3D.Create(0,1,0),0);return this.mirrored(e)},t.prototype.mirroredZ=function(){var e=new t(n.CSGVector3D.Create(0,0,1),0);return this.mirrored(e)},t.prototype.translate=function(t){return this.transform(u.CSGMatrix4x4.translation(t))},t.prototype.scale=function(t){return this.transform(u.CSGMatrix4x4.scaling(t))},t.prototype.rotateX=function(t){return this.transform(u.CSGMatrix4x4.rotationX(t))},t.prototype.rotateY=function(t){return this.transform(u.CSGMatrix4x4.rotationY(t))},t.prototype.rotateZ=function(t){return this.transform(u.CSGMatrix4x4.rotationZ(t))},t.prototype.rotate=function(t,e,r){return this.transform(u.CSGMatrix4x4.rotation(t,e,r))},t.prototype.rotateEulerAngles=function(t,e,r,i){i=i||[0,0,0];var o=u.CSGMatrix4x4.rotationZ(t),s=u.CSGMatrix4x4.rotationX(e),a=u.CSGMatrix4x4.rotationZ(r),p=u.CSGMatrix4x4.translation(new n.CSGVector3D(i));return this.transform(a.multiply(s).multiply(o).multiply(p))},t.EPSILON=1e-5,t}();e.CSGPlane=p},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.CSGVector3D=void 0;var n=r(14),i=r(6),o=r(7),s=r(8),a=function(){function t(e,r,o){var s,a,u;if(void 0===e&&(e=null),void 0===r&&(r=null),void 0===o&&(o=null),3==arguments.length&&null!=r&&null!=o)s=e.toString(),a=r.toString(),u=o.toString(),this._x=parseFloat(s),this._y=parseFloat(a),this._z=parseFloat(u);else if(2==arguments.length&&null!=r)s=e.toString(),a=r.toString(),this._x=parseFloat(s),this._y=parseFloat(a),this._z=0;else{var p=!0;if(1==arguments.length)if("object"==typeof e)e instanceof t?(this._x=e._x,this._y=e._y,this._z=e._z):e instanceof n.CSGVector2D?(this._x=e._x,this._y=e._y,this._z=0):e instanceof Array?e.length<2||e.length>3?p=!1:(this._x=parseFloat(e[0]),this._y=parseFloat(e[1]),3==e.length?this._z=parseFloat(e[2]):this._z=0):"x"in e&&"y"in e?(this._x=parseFloat(e.x),this._y=parseFloat(e.y),this._z="z"in e?parseFloat(e.z):0):p=!1;else{var h=parseFloat(e);this._x=h,this._y=h,this._z=h}else p=!1;if(p&&(i.CSG.IsFloat(this._x)&&i.CSG.IsFloat(this._y)&&i.CSG.IsFloat(this._z)||(p=!1)),!p)throw new Error("wrong arguments")}}return Object.defineProperty(t.prototype,"x",{get:function(){return this._x},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"y",{get:function(){return this._y},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"z",{get:function(){return this._z},enumerable:!1,configurable:!0}),t.Create=function(e,r,n){var i=Object.create(t.prototype);return i._x=e,i._y=r,i._z=n,i},t.prototype.clone=function(){return t.Create(this._x,this._y,this._z)},t.prototype.negated=function(){return t.Create(-this._x,-this._y,-this._z)},t.prototype.abs=function(){return t.Create(Math.abs(this._x),Math.abs(this._y),Math.abs(this._z))},t.prototype.plus=function(e){return t.Create(this._x+e._x,this._y+e._y,this._z+e._z)},t.prototype.minus=function(e){return t.Create(this._x-e._x,this._y-e._y,this._z-e._z)},t.prototype.times=function(e){return t.Create(this._x*e,this._y*e,this._z*e)},t.prototype.dividedBy=function(e){return t.Create(this._x/e,this._y/e,this._z/e)},t.prototype.dot=function(t){return this._x*t._x+this._y*t._y+this._z*t._z},t.prototype.lerp=function(t,e){return this.plus(t.minus(this).times(e))},t.prototype.lengthSquared=function(){return this.dot(this)},t.prototype.length=function(){return Math.sqrt(this.lengthSquared())},t.prototype.unit=function(){return this.dividedBy(this.length())},t.prototype.cross=function(e){return t.Create(this._y*e._z-this._z*e._y,this._z*e._x-this._x*e._z,this._x*e._y-this._y*e._x)},t.prototype.distanceTo=function(t){return this.minus(t).length()},t.prototype.distanceToSquared=function(t){return this.minus(t).lengthSquared()},t.prototype.equals=function(t){return this._x==t._x&&this._y==t._y&&this._z==t._z},t.prototype.multiply4x4=function(t){return t.leftMultiply1x3Vector(this)},t.prototype.transform=function(t){return t.leftMultiply1x3Vector(this)},t.prototype.toString=function(){return"("+this._x.toFixed(2)+", "+this._y.toFixed(2)+", "+this._z.toFixed(2)+")"},t.prototype.randomNonParallelVector=function(){var e=this.abs();return e._x<=e._y&&e._x<=e._z?t.Create(1,0,0):e._y<=e._x&&e._y<=e._z?t.Create(0,1,0):t.Create(0,0,1)},t.prototype.min=function(e){return t.Create(Math.min(this._x,e._x),Math.min(this._y,e._y),Math.min(this._z,e._z))},t.prototype.max=function(e){return t.Create(Math.max(this._x,e._x),Math.max(this._y,e._y),Math.max(this._z,e._z))},t.prototype.mirrored=function(t){return this.transform(o.CSGMatrix4x4.mirroring(t))},t.prototype.mirroredX=function(){var e=new s.CSGPlane(t.Create(1,0,0),0);return this.mirrored(e)},t.prototype.mirroredY=function(){var e=new s.CSGPlane(t.Create(0,1,0),0);return this.mirrored(e)},t.prototype.mirroredZ=function(){var e=new s.CSGPlane(t.Create(0,0,1),0);return this.mirrored(e)},t.prototype.translate=function(t){return this.transform(o.CSGMatrix4x4.translation(t))},t.prototype.scale=function(t){return this.transform(o.CSGMatrix4x4.scaling(t))},t.prototype.rotateX=function(t){return this.transform(o.CSGMatrix4x4.rotationX(t))},t.prototype.rotateY=function(t){return this.transform(o.CSGMatrix4x4.rotationY(t))},t.prototype.rotateZ=function(t){return this.transform(o.CSGMatrix4x4.rotationZ(t))},t.prototype.rotate=function(t,e,r){return this.transform(o.CSGMatrix4x4.rotation(t,e,r))},t.prototype.rotateEulerAngles=function(e,r,n,i){i=i||[0,0,0];var s=o.CSGMatrix4x4.rotationZ(e),a=o.CSGMatrix4x4.rotationX(r),u=o.CSGMatrix4x4.rotationZ(n),p=o.CSGMatrix4x4.translation(new t(i));return this.transform(u.multiply(a).multiply(s).multiply(p))},t}();e.CSGVector3D=a},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Curve=void 0;var n=r(2),i=r(0),o=r(17),s=r(1),a=function(){function t(){this.needsUpdate=!1,this.type="Curve",this.arcLengthDivisions=200}return t.prototype.isEmpty=function(){return!0},t.prototype.getPoint=function(t,e){return void 0===e&&(e=null),null},t.prototype.getPointAt=function(t,e){void 0===e&&(e=null);var r=this.getUtoTmapping(t);return this.getPoint(r,e)},t.prototype.getPoints=function(t){void 0===t&&(t=5);for(var e=[],r=0;r<=t;r++)e.push(this.getPoint(r/t));return e},t.prototype.getSpacedPoints=function(t){void 0===t&&(t=5);for(var e=[],r=0;r<=t;r++)e.push(this.getPointAt(r/t));return e},t.prototype.getLength=function(){var t=this.getLengths();return t[t.length-1]},t.prototype.getLengths=function(t){if(void 0===t&&(t=this.arcLengthDivisions),this.cacheArcLengths&&this.cacheArcLengths.length==t+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var e,r=[],n=this.getPoint(0);r.push(0);for(var i=1;i<=t;i++)(e=this.getPoint(i/t)).distanceTo(n),r.push(0),n=e;return this.cacheArcLengths=r,r},t.prototype.updateArcLengths=function(){return this.needsUpdate=!0,this.getLengths()},t.prototype.getUtoTmapping=function(t,e){void 0===e&&(e=0);var r,n=this.getLengths(),i=0,o=n.length;r=e||t*n[o-1];for(var s,a=0,u=o-1;a<=u;)if((s=n[i=Math.floor(a+(u-a)/2)]-r)<0)a=i+1;else{if(!(s>0)){u=i;break}u=i-1}if(n[i=u]==r)return i/(o-1);var p=n[i];return(i+(r-p)/(n[i+1]-p))/(o-1)},t.prototype.getTangent=function(t,e){void 0===e&&(e=null);var r=t-1e-4,o=t+1e-4;r<0&&(r=0),o>1&&(o=1);var s,a=this.getPoint(r),u=this.getPoint(o);return(s=e||(a instanceof n.Vector2?new n.Vector2:new i.Vector3))&&s.copy(u).sub(a).normalize(),s},t.prototype.getTangentAt=function(t,e){void 0===e&&(e=null);var r=this.getUtoTmapping(t);return this.getTangent(r,e)},t.prototype.computeFrenetFrames=function(t,e){var r,n,a,u=new i.Vector3,p=[],h=[],c=[],l=new i.Vector3,f=new o.Matrix4;for(r=0;r<=t;r++)n=r/t,p[r]=this.getTangentAt(n),p[r].normalize();h[0]=new i.Vector3,c[0]=new i.Vector3;var y=Number.MAX_VALUE,d=Math.abs(p[0].x),_=Math.abs(p[0].y),m=Math.abs(p[0].z);for(d<=y&&(y=d,u.set(1,0,0)),_<=y&&(y=_,u.set(0,1,0)),m<=y&&u.set(0,0,1),l.crossVectors(p[0],u).normalize(),h[0].crossVectors(p[0],l),c[0].crossVectors(p[0],h[0]),r=1;r<=t;r++)h[r]=h[r-1].clone(),c[r]=c[r-1].clone(),l.crossVectors(p[r-1],p[r]),l.length()>Number.EPSILON&&(l.normalize(),a=Math.acos(s.MathUtils.clamp(p[r-1].dot(p[r]),-1,1)),h[r].applyMatrix4(f.makeRotationAxis(l,a))),c[r].crossVectors(p[r],h[r]);if(e)for(a=Math.acos(s.MathUtils.clamp(h[0].dot(h[t]),-1,1)),a/=t,p[0].dot(l.crossVectors(h[0],h[t]))>0&&(a=-a),r=1;r<=t;r++)h[r].applyMatrix4(f.makeRotationAxis(p[r],a*r)),c[r].crossVectors(p[r],h[r]);return{tangents:p,normals:h,binormals:c}},t.prototype.clone=function(){return(new t).copy(this)},t.prototype.copy=function(t){return this.arcLengthDivisions=t.arcLengthDivisions,this},t.prototype.toJSON=function(){var t={};return t.type=this.type,t.arcLengthDivisions=this.arcLengthDivisions,t},t.prototype.fromJSON=function(t){return this.arcLengthDivisions=t.arcLengthDivisions,this},t.prototype.toDataBuffer=function(t){return t.writeString(this.type),t.writeFloat32(this.arcLengthDivisions),this},t.prototype.fromDataBuffer=function(t){return this.arcLengthDivisions=t.readFloat32(),this},t}();e.Curve=a},function(t,e,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(t,e,r,n){void 0===n&&(n=r),Object.defineProperty(t,n,{enumerable:!0,get:function(){return e[r]}})}:function(t,e,r,n){void 0===n&&(n=r),t[n]=e[r]}),i=this&&this.__exportStar||function(t,e){for(var r in t)"default"===r||e.hasOwnProperty(r)||n(e,t,r)};Object.defineProperty(e,"__esModule",{value:!0}),i(r(12),e),i(r(126),e),i(r(127),e),i(r(128),e),i(r(13),e),i(r(131),e),i(r(23),e),i(r(143),e),i(r(144),e),i(r(79),e),i(r(58),e),i(r(145),e),i(r(146),e),i(r(147),e),i(r(148),e)},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Constants=void 0;var n=function(){function t(){}return t.CullFaceNone=0,t.CullFaceBack=1,t.CullFaceFront=2,t.CullFaceFrontBack=3,t.FrontFaceDirectionCW=0,t.FrontFaceDirectionCCW=1,t.BasicShadowMap=0,t.PCFShadowMap=1,t.PCFSoftShadowMap=2,t.VSMShadowMap=3,t.FrontSide=0,t.BackSide=1,t.DoubleSide=2,t.FlatShading=1,t.SmoothShading=2,t.NoBlending=0,t.AddBlending=1,t.CombineBlending=2,t.SubtractBlending=3,t.MultiplyBlending=4,t.MaximizedBlending=5,t.OneOneBlending=6,t.PremultipliedBlending=7,t.PremultipliedPorterDuffBlending=8,t.InterpolateBlending=9,t.ScreenModeBlending=10,t.OneOneOneOneBlending=11,t.AlphaToColorBlending=12,t.ReverseOneMinusBlending=13,t.SrcDstOneMinusSrcAlphaBlending=14,t.OneOneOneZeroBlending=15,t.ExclusionBlending=16,t.AddEquation=100,t.SubtractEquation=101,t.ReverseSubtractEquation=102,t.MinEquation=103,t.MaxEquation=104,t.ZeroFactor=200,t.OneFactor=201,t.SrcColorFactor=202,t.OneMinusSrcColorFactor=203,t.SrcAlphaFactor=204,t.OneMinusSrcAlphaFactor=205,t.DstAlphaFactor=206,t.OneMinusDstAlphaFactor=207,t.DstColorFactor=208,t.OneMinusDstColorFactor=209,t.SrcAlphaSaturateFactor=210,t.ConstantColorFactor=211,t.ConstantAlphaFactor=212,t.NeverDepth=0,t.AlwaysDepth=1,t.LessDepth=2,t.LessEqualDepth=3,t.EqualDepth=4,t.GreaterEqualDepth=5,t.GreaterDepth=6,t.NotEqualDepth=7,t.MultiplyOperation=0,t.MixOperation=1,t.AddOperation=2,t.NoToneMapping=0,t.LinearToneMapping=1,t.ReinhardToneMapping=2,t.CineonToneMapping=3,t.ACESFilmicToneMapping=4,t.CustomToneMapping=5,t.UVMapping=300,t.CubeReflectionMapping=301,t.CubeRefractionMapping=302,t.EquirectangularReflectionMapping=303,t.EquirectangularRefractionMapping=304,t.CubeUVReflectionMapping=306,t.CubeUVRefractionMapping=307,t.RepeatWrapping=1e3,t.ClampToEdgeWrapping=1001,t.MirroredRepeatWrapping=1002,t.NearestNearestFilter=1,t.LinearLinearFilter=2,t.LinearLinearMipLinearFilter=3,t.NearestNearestMipNearestFilter=4,t.NearestLinearMipNearestFilter=5,t.NearestLinearMipLinearFilter=6,t.NearestLinearFilter=7,t.NearestNearestMipLinearFilter=8,t.LinearNearestMipNearestFilter=9,t.LinearNearestMipLinearFilter=10,t.LinearLinearMipNearestFilter=11,t.LinearNearestFilter=12,t.UnsignedByteType=1009,t.ByteType=1010,t.ShortType=1011,t.UnsignedShortType=1012,t.IntType=1013,t.UnsignedIntType=1014,t.FloatType=1015,t.HalfFloatType=1016,t.UnsignedShort4444Type=1017,t.UnsignedShort5551Type=1018,t.UnsignedShort565Type=1019,t.UnsignedInt248Type=1020,t.DepthFormat=1021,t.DepthStencilFormat=1022,t.StencilFormat=1023,t.AlphaFormat=1024,t.RGBFormat=1025,t.RGBAFormat=1026,t.LuminanceFormat=1027,t.LuminanceAlphaFormat=1028,t.RGBEFormat=1029,t.RedFormat=1030,t.RedIntegerFormat=1031,t.RGFormat=1032,t.RGIntegerFormat=1033,t.RGBIntegerFormat=1034,t.RGBAIntegerFormat=1035,t.DoubleType=1036,t.RGBA4Format=1037,t.RGB5A1Format=1038,t.RGB565Format=1039,t.RGB_S3TC_DXT1_Format=33776,t.RGBA_S3TC_DXT1_Format=33777,t.RGBA_S3TC_DXT3_Format=33778,t.RGBA_S3TC_DXT5_Format=33779,t.RGB_PVRTC_4BPPV1_Format=35840,t.RGB_PVRTC_2BPPV1_Format=35841,t.RGBA_PVRTC_4BPPV1_Format=35842,t.RGBA_PVRTC_2BPPV1_Format=35843,t.RGB_ETC1_Format=36196,t.RGB_ETC2_Format=37492,t.RGBA_ETC2_EAC_Format=37496,t.RGBA_ASTC_4x4_Format=37808,t.RGBA_ASTC_5x4_Format=37809,t.RGBA_ASTC_5x5_Format=37810,t.RGBA_ASTC_6x5_Format=37811,t.RGBA_ASTC_6x6_Format=37812,t.RGBA_ASTC_8x5_Format=37813,t.RGBA_ASTC_8x6_Format=37814,t.RGBA_ASTC_8x8_Format=37815,t.RGBA_ASTC_10x5_Format=37816,t.RGBA_ASTC_10x6_Format=37817,t.RGBA_ASTC_10x8_Format=37818,t.RGBA_ASTC_10x10_Format=37819,t.RGBA_ASTC_12x10_Format=37820,t.RGBA_ASTC_12x12_Format=37821,t.RGBA_BPTC_Format=36492,t.SRGB8_ALPHA8_ASTC_4x4_Format=37840,t.SRGB8_ALPHA8_ASTC_5x4_Format=37841,t.SRGB8_ALPHA8_ASTC_5x5_Format=37842,t.SRGB8_ALPHA8_ASTC_6x5_Format=37843,t.SRGB8_ALPHA8_ASTC_6x6_Format=37844,t.SRGB8_ALPHA8_ASTC_8x5_Format=37845,t.SRGB8_ALPHA8_ASTC_8x6_Format=37846,t.SRGB8_ALPHA8_ASTC_8x8_Format=37847,t.SRGB8_ALPHA8_ASTC_10x5_Format=37848,t.SRGB8_ALPHA8_ASTC_10x6_Format=37849,t.SRGB8_ALPHA8_ASTC_10x8_Format=37850,t.SRGB8_ALPHA8_ASTC_10x10_Format=37851,t.SRGB8_ALPHA8_ASTC_12x10_Format=37852,t.SRGB8_ALPHA8_ASTC_12x12_Format=37853,t.TrianglesDrawMode=0,t.TriangleStripDrawMode=1,t.TriangleFanDrawMode=2,t.LinearEncoding=3e3,t.sRGBEncoding=3001,t.GammaEncoding=3007,t.RGBEEncoding=3002,t.LogLuvEncoding=3003,t.RGBM7Encoding=3004,t.RGBM16Encoding=3005,t.RGBDEncoding=3006,t.BasicDepthPacking=3200,t.RGBADepthPacking=3201,t.TangentSpaceNormalMap=0,t.ObjectSpaceNormalMap=1,t.ZeroStencilOp=0,t.KeepStencilOp=7680,t.ReplaceStencilOp=7681,t.IncrementStencilOp=7682,t.DecrementStencilOp=7683,t.IncrementWrapStencilOp=34055,t.DecrementWrapStencilOp=34056,t.InvertStencilOp=5386,t.NeverStencilFunc=512,t.LessStencilFunc=513,t.EqualStencilFunc=514,t.LessEqualStencilFunc=515,t.GreaterStencilFunc=516,t.NotEqualStencilFunc=517,t.GreaterEqualStencilFunc=518,t.AlwaysStencilFunc=519,t.StaticDrawUsage=35044,t.DynamicDrawUsage=35048,t.StreamDrawUsage=35040,t.StaticReadUsage=35045,t.DynamicReadUsage=35049,t.StreamReadUsage=35041,t.StaticCopyUsage=35046,t.DynamicCopyUsage=35050,t.StreamCopyUsage=35042,t.ArrayBufferTarget=0,t.ElementBufferTarget=1,t.UniformBufferTarget=2,t.TransformFeedbackTarget=3,t.CopyReadTarget=4,t.CopyWriteTarget=5,t.ReadBuffer=6,t.PixelPackBuffer=7,t.PixelUnPackBuffer=8,t.NoFog=0,t.LinerFog=1,t.Exp2Fog=2,t}();e.Constants=n},function(t,e,r){"use strict";var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(e,"__esModule",{value:!0}),e.WebGLEngine=void 0;var o=r(129),s=r(12),a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._currentFramebuffer=null,e._viewportCached={x:0,y:0,width:0,height:0},e}return i(e,t),e.prototype.getError=function(){return this._gl.getError()},e.prototype._InitGL=function(){try{this._gl=this._renderingCanvas.getContext("webgl2",this._creationOptions)||this._renderingCanvas.getContext("experimental-webgl2",this._creationOptions),this._gl&&(this._webGLVersion=2,this._gl.deleteQuery||(this._webGLVersion=1))}catch(t){}if(!this._gl)try{this._gl=this._renderingCanvas.getContext("webgl",this._creationOptions)||this._renderingCanvas.getContext("experimental-webgl",this._creationOptions),this._webGLVersion=1}catch(t){throw new Error("不支持WebGL")}if(!this._gl)throw new Error("不支持WebGL");this._gl.pixelStorei(this._gl.UNPACK_COLORSPACE_CONVERSION_WEBGL,this._gl.NONE)},e.prototype._initGLContext=function(){this._caps={maxTexturesImageUnits:this._gl.getParameter(this._gl.MAX_TEXTURE_IMAGE_UNITS),maxCombinedTexturesImageUnits:this._gl.getParameter(this._gl.MAX_COMBINED_TEXTURE_IMAGE_UNITS),maxVertexTextureImageUnits:this._gl.getParameter(this._gl.MAX_VERTEX_TEXTURE_IMAGE_UNITS),maxTextureSize:this._gl.getParameter(this._gl.MAX_TEXTURE_SIZE),maxSamples:this._webGLVersion>1?this._gl.getParameter(this._gl.MAX_SAMPLES):1,maxCubemapTextureSize:this._gl.getParameter(this._gl.MAX_CUBE_MAP_TEXTURE_SIZE),maxRenderTextureSize:this._gl.getParameter(this._gl.MAX_RENDERBUFFER_SIZE),maxVertexAttribs:this._gl.getParameter(this._gl.MAX_VERTEX_ATTRIBS),maxVaryingVectors:this._gl.getParameter(this._gl.MAX_VARYING_VECTORS),maxFragmentUniformVectors:this._gl.getParameter(this._gl.MAX_FRAGMENT_UNIFORM_VECTORS),maxVertexUniformVectors:this._gl.getParameter(this._gl.MAX_VERTEX_UNIFORM_VECTORS),parallelShaderCompile:this._gl.getExtension("KHR_parallel_shader_compile"),standardDerivatives:this._webGLVersion>1||null!=this._gl.getExtension("OES_standard_derivatives"),maxAnisotropy:1,astc:this._gl.getExtension("WEBGL_compressed_texture_astc")||this._gl.getExtension("WEBKIT_WEBGL_compressed_texture_astc"),s3tc:this._gl.getExtension("WEBGL_compressed_texture_s3tc")||this._gl.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc"),pvrtc:this._gl.getExtension("WEBGL_compressed_texture_pvrtc")||this._gl.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),etc1:this._gl.getExtension("WEBGL_compressed_texture_etc1")||this._gl.getExtension("WEBKIT_WEBGL_compressed_texture_etc1"),etc2:this._gl.getExtension("WEBGL_compressed_texture_etc")||this._gl.getExtension("WEBKIT_WEBGL_compressed_texture_etc")||this._gl.getExtension("WEBGL_compressed_texture_es3_0"),textureAnisotropicFilterExtension:this._gl.getExtension("EXT_texture_filter_anisotropic")||this._gl.getExtension("WEBKIT_EXT_texture_filter_anisotropic")||this._gl.getExtension("MOZ_EXT_texture_filter_anisotropic"),uintIndices:this._webGLVersion>1||null!=this._gl.getExtension("OES_element_index_uint"),fragmentDepthSupported:this._webGLVersion>1||null!=this._gl.getExtension("EXT_frag_depth"),highPrecisionShaderSupported:!1,timerQuery:this._gl.getExtension("EXT_disjoint_timer_query_webgl2")||this._gl.getExtension("EXT_disjoint_timer_query"),canUseTimestampForTimerQuery:!1,drawBuffersExtension:!1,maxMSAASamples:1,colorBufferFloat:this._webGLVersion>1&&this._gl.getExtension("EXT_color_buffer_float"),textureFloat:!!(this._webGLVersion>1||this._gl.getExtension("OES_texture_float")),textureHalfFloat:!!(this._webGLVersion>1||this._gl.getExtension("OES_texture_half_float")),textureHalfFloatRender:!1,textureFloatLinearFiltering:!1,textureFloatRender:!1,textureHalfFloatLinearFiltering:!1,vertexArrayObject:!1,instancedArrays:!1,textureLOD:!!(this._webGLVersion>1||this._gl.getExtension("EXT_shader_texture_lod")),blendMinMax:!1,multiview:this._gl.getExtension("OVR_multiview2"),oculusMultiview:this._gl.getExtension("OCULUS_multiview"),depthTextureExtension:!1},this._glVersion=this._gl.getParameter(this._gl.VERSION);var t=this._gl.getExtension("WEBGL_debug_renderer_info");if(null!=t&&(this._glRenderer=this._gl.getParameter(t.UNMASKED_RENDERER_WEBGL),this._glVendor=this._gl.getParameter(t.UNMASKED_VENDOR_WEBGL)),this._glVendor||(this._glVendor="Unknown vendor"),this._glRenderer||(this._glRenderer="Unknown renderer"),this._gpuVendor=this._identifyGPUVendor(this._glVendor,this._glRenderer),36193!=this._gl.HALF_FLOAT_OES&&(this._gl.HALF_FLOAT_OES=36193),34842!=this._gl.RGBA16F&&(this._gl.RGBA16F=34842),34836!=this._gl.RGBA32F&&(this._gl.RGBA32F=34836),35056!=this._gl.DEPTH24_STENCIL8&&(this._gl.DEPTH24_STENCIL8=35056),this._caps.timerQuery&&(1==this._webGLVersion&&(this._gl.getQuery=this._caps.timerQuery.getQueryEXT.bind(this._caps.timerQuery)),this._caps.canUseTimestampForTimerQuery=this._gl.getQuery(this._caps.timerQuery.TIMESTAMP_EXT,this._caps.timerQuery.QUERY_COUNTER_BITS_EXT)>0),this._caps.maxAnisotropy=this._caps.textureAnisotropicFilterExtension?this._gl.getParameter(this._caps.textureAnisotropicFilterExtension.MAX_TEXTURE_MAX_ANISOTROPY_EXT):0,this._caps.textureFloatLinearFiltering=!(!this._caps.textureFloat||!this._gl.getExtension("OES_texture_float_linear")),this._caps.textureFloatRender=!(!this._caps.textureFloat||!this._canRenderToFloatFramebuffer()),this._caps.textureHalfFloatLinearFiltering=!!(this._webGLVersion>1||this._caps.textureHalfFloat&&this._gl.getExtension("OES_texture_half_float_linear")),this._webGLVersion>1&&5131!=this._gl.HALF_FLOAT_OES&&(this._gl.HALF_FLOAT_OES=5131),this._caps.textureHalfFloatRender=this._caps.textureHalfFloat&&this._canRenderToHalfFloatFramebuffer(),this._webGLVersion>1)this._caps.drawBuffersExtension=!0,this._caps.maxMSAASamples=this._gl.getParameter(this._gl.MAX_SAMPLES);else{var e=this._gl.getExtension("WEBGL_draw_buffers");if(null!=e){this._caps.drawBuffersExtension=!0,this._gl.drawBuffers=e.drawBuffersWEBGL.bind(e),this._gl.DRAW_FRAMEBUFFER=this._gl.FRAMEBUFFER;for(var r=0;r<16;r++)this._gl["COLOR_ATTACHMENT"+r+"_WEBGL"]=e["COLOR_ATTACHMENT"+r+"_WEBGL"]}}if(this._webGLVersion>1)this._caps.depthTextureExtension=!0;else{var n=this._gl.getExtension("WEBGL_depth_texture");null!=n&&(this._caps.depthTextureExtension=!0,this._gl.UNSIGNED_INT_24_8=n.UNSIGNED_INT_24_8_WEBGL)}if(this._webGLVersion>1)this._caps.vertexArrayObject=!0;else{var i=this._gl.getExtension("OES_vertex_array_object");null!=i&&(this._caps.vertexArrayObject=!0,this._gl.createVertexArray=i.createVertexArrayOES.bind(i),this._gl.bindVertexArray=i.bindVertexArrayOES.bind(i),this._gl.deleteVertexArray=i.deleteVertexArrayOES.bind(i))}if(this._webGLVersion>1)this._caps.instancedArrays=!0;else{var o=this._gl.getExtension("ANGLE_instanced_arrays");null!=o?(this._caps.instancedArrays=!0,this._gl.drawArraysInstanced=o.drawArraysInstancedANGLE.bind(o),this._gl.drawElementsInstanced=o.drawElementsInstancedANGLE.bind(o),this._gl.vertexAttribDivisor=o.vertexAttribDivisorANGLE.bind(o)):this._caps.instancedArrays=!1}if(this._gl.getShaderPrecisionFormat){var s=this._gl.getShaderPrecisionFormat(this._gl.VERTEX_SHADER,this._gl.HIGH_FLOAT),a=this._gl.getShaderPrecisionFormat(this._gl.FRAGMENT_SHADER,this._gl.HIGH_FLOAT);s&&a&&(this._caps.highPrecisionShaderSupported=0!=s.precision&&0!=a.precision)}if(this._webGLVersion>1)this._caps.blendMinMax=!0;else{var u=this._gl.getExtension("EXT_blend_minmax");null!=u&&(this._caps.blendMinMax=!0,this._gl.MAX=u.MAX_EXT,this._gl.MIN=u.MIN_EXT)}this._initColorState(),this._initDepthState(),this._initStencilState(),this._initBlendingState(),this._initCullState(),this._initTextureState(),this._initDataBufferState()},e.prototype.setScissorTest=function(t){return t?this._gl.enable(this._gl.SCISSOR_TEST):this._gl.disable(this._gl.SCISSOR_TEST),this},e.prototype.setDithering=function(t){return t?this._gl.enable(this._gl.DITHER):this._gl.disable(this._gl.DITHER),this},e.prototype.setRasterizer=function(t){return t?this._gl.disable(this._gl.RASTERIZER_DISCARD):this._gl.enable(this._gl.RASTERIZER_DISCARD),this},e.prototype._viewport=function(t,e,r,n){t==this._viewportCached.x&&e==this._viewportCached.y&&r==this._viewportCached.width&&n==this._viewportCached.height||(this._viewportCached.x=t,this._viewportCached.y=e,this._viewportCached.width=r,this._viewportCached.height=n,this._gl.viewport(t,e,r,n))},e.prototype.clear=function(t,e,r){void 0===t&&(t=!0),void 0===e&&(e=!0),void 0===r&&(r=!0);var n=this.gl,i=0;return t&&(i|=n.COLOR_BUFFER_BIT),e&&(i|=n.DEPTH_BUFFER_BIT),r&&(i|=n.STENCIL_BUFFER_BIT),n.clear(i),this},e.prototype._canRenderToFloatFramebuffer=function(){return this._webGLVersion>1?this._caps.colorBufferFloat:this._canRenderToFramebuffer(s.Constants.FloatType)},e.prototype._canRenderToHalfFloatFramebuffer=function(){return this._webGLVersion>1?this._caps.colorBufferFloat:this._canRenderToFramebuffer(s.Constants.HalfFloatType)},e.prototype._canRenderToFramebuffer=function(t){for(var e=this._gl;e.getError()!=e.NO_ERROR;);var r=!0,n=e.createTexture();e.bindTexture(e.TEXTURE_2D,n),e.texImage2D(e.TEXTURE_2D,0,this._getRGBABufferInternalSizedFormat(t),1,1,0,e.RGBA,this._getWebGLTextureType(t),null),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.NEAREST);var i=e.createFramebuffer();e.bindFramebuffer(e.FRAMEBUFFER,i),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,n,0);var o=e.checkFramebufferStatus(e.FRAMEBUFFER);if((r=(r=r&&o==e.FRAMEBUFFER_COMPLETE)&&e.getError()==e.NO_ERROR)&&(e.clear(e.COLOR_BUFFER_BIT),r=r&&e.getError()==e.NO_ERROR),r){e.bindFramebuffer(e.FRAMEBUFFER,null);var s=e.RGBA,a=e.UNSIGNED_BYTE,u=new Uint8Array(4);e.readPixels(0,0,1,1,s,a,u),r=r&&e.getError()==e.NO_ERROR}for(e.deleteTexture(n),e.deleteFramebuffer(i),e.bindFramebuffer(e.FRAMEBUFFER,null);!r&&e.getError()!=e.NO_ERROR;);return r},e.prototype._getWebGLTextureType=function(t){if(1==this._webGLVersion){switch(t){case s.Constants.FloatType:return this._gl.FLOAT;case s.Constants.HalfFloatType:return this._gl.HALF_FLOAT_OES;case s.Constants.UnsignedByteType:return this._gl.UNSIGNED_BYTE;case s.Constants.UnsignedShort4444Type:return this._gl.UNSIGNED_SHORT_4_4_4_4;case s.Constants.UnsignedShort5551Type:return this._gl.UNSIGNED_SHORT_5_5_5_1;case s.Constants.UnsignedShort565Type:return this._gl.UNSIGNED_SHORT_5_6_5;case s.Constants.UnsignedInt248Type:return this._gl.UNSIGNED_INT_24_8}return this._gl.UNSIGNED_BYTE}switch(t){case s.Constants.ByteType:return this._gl.BYTE;case s.Constants.UnsignedByteType:return this._gl.UNSIGNED_BYTE;case s.Constants.ShortType:return this._gl.SHORT;case s.Constants.UnsignedShortType:return this._gl.UNSIGNED_SHORT;case s.Constants.IntType:return this._gl.INT;case s.Constants.UnsignedIntType:return this._gl.UNSIGNED_INT;case s.Constants.FloatType:return this._gl.FLOAT;case s.Constants.HalfFloatType:return this._gl.HALF_FLOAT;case s.Constants.UnsignedShort4444Type:return this._gl.UNSIGNED_SHORT_4_4_4_4;case s.Constants.UnsignedShort5551Type:return this._gl.UNSIGNED_SHORT_5_5_5_1;case s.Constants.UnsignedShort565Type:return this._gl.UNSIGNED_SHORT_5_6_5;case s.Constants.UnsignedInt248Type:return this._gl.UNSIGNED_INT_24_8}return this._gl.UNSIGNED_BYTE},e.prototype._getInternalFormat=function(t){var e=this._gl.RGBA;switch(t){case s.Constants.AlphaFormat:e=this._gl.ALPHA;break;case s.Constants.LuminanceFormat:e=this._gl.LUMINANCE;break;case s.Constants.LuminanceAlphaFormat:e=this._gl.LUMINANCE_ALPHA;break;case s.Constants.RedFormat:e=this._gl.RED;break;case s.Constants.RGFormat:e=this._gl.RG;break;case s.Constants.RGBFormat:e=this._gl.RGB;break;case s.Constants.RGBAFormat:e=this._gl.RGBA;break;case s.Constants.RGBA4Format:e=this._gl.RGBA4;break;case s.Constants.RGB5A1Format:e=this._gl.RGB5_A1;break;case s.Constants.RGB565Format:e=this._gl.RGB565}if(this._webGLVersion>1)switch(t){case s.Constants.RedIntegerFormat:e=this._gl.RED_INTEGER;break;case s.Constants.RGIntegerFormat:e=this._gl.RG_INTEGER;break;case s.Constants.RGBIntegerFormat:e=this._gl.RGB_INTEGER;break;case s.Constants.RGBAIntegerFormat:e=this._gl.RGBA_INTEGER}return e},e.prototype._getRGBABufferInternalSizedFormat=function(t,e){if(1==this._webGLVersion){if(null!=e)switch(e){case s.Constants.AlphaFormat:return this._gl.ALPHA;case s.Constants.LuminanceFormat:return this._gl.LUMINANCE;case s.Constants.LuminanceAlphaFormat:return this._gl.LUMINANCE_ALPHA;case s.Constants.RGBFormat:return this._gl.RGB}return this._gl.RGBA}switch(t){case s.Constants.ByteType:switch(e){case s.Constants.RedFormat:return this._gl.R8_SNORM;case s.Constants.RGFormat:return this._gl.RG8_SNORM;case s.Constants.RGBFormat:return this._gl.RGB8_SNORM;case s.Constants.RedIntegerFormat:return this._gl.R8I;case s.Constants.RGIntegerFormat:return this._gl.RG8I;case s.Constants.RGBIntegerFormat:return this._gl.RGB8I;case s.Constants.RGBAIntegerFormat:return this._gl.RGBA8I;default:return this._gl.RGBA8_SNORM}case s.Constants.UnsignedByteType:switch(e){case s.Constants.RedFormat:return this._gl.R8;case s.Constants.RGFormat:return this._gl.RG8;case s.Constants.RGBFormat:return this._gl.RGB8;case s.Constants.RGBAFormat:return this._gl.RGBA8;case s.Constants.RedIntegerFormat:return this._gl.R8UI;case s.Constants.RGIntegerFormat:return this._gl.RG8UI;case s.Constants.RGBIntegerFormat:return this._gl.RGB8UI;case s.Constants.RGBAIntegerFormat:return this._gl.RGBA8UI;case s.Constants.AlphaFormat:return this._gl.ALPHA;case s.Constants.LuminanceFormat:return this._gl.LUMINANCE;case s.Constants.LuminanceAlphaFormat:return this._gl.LUMINANCE_ALPHA;default:return this._gl.RGBA8}case s.Constants.ShortType:switch(e){case s.Constants.RedIntegerFormat:return this._gl.R16I;case s.Constants.RGIntegerFormat:return this._gl.RG16I;case s.Constants.RGBIntegerFormat:return this._gl.RGB16I;case s.Constants.RGBAIntegerFormat:default:return this._gl.RGBA16I}case s.Constants.UnsignedShortType:switch(e){case s.Constants.RedIntegerFormat:return this._gl.R16UI;case s.Constants.RGIntegerFormat:return this._gl.RG16UI;case s.Constants.RGBIntegerFormat:return this._gl.RGB16UI;case s.Constants.RGBAIntegerFormat:default:return this._gl.RGBA16UI}case s.Constants.IntType:switch(e){case s.Constants.RedIntegerFormat:return this._gl.R32I;case s.Constants.RGIntegerFormat:return this._gl.RG32I;case s.Constants.RGBIntegerFormat:return this._gl.RGB32I;case s.Constants.RGBAIntegerFormat:default:return this._gl.RGBA32I}case s.Constants.UnsignedIntType:switch(e){case s.Constants.RedIntegerFormat:return this._gl.R32UI;case s.Constants.RGIntegerFormat:return this._gl.RG32UI;case s.Constants.RGBIntegerFormat:return this._gl.RGB32UI;case s.Constants.RGBAIntegerFormat:default:return this._gl.RGBA32UI}case s.Constants.FloatType:switch(e){case s.Constants.RedFormat:return this._gl.R32F;case s.Constants.RGFormat:return this._gl.RG32F;case s.Constants.RGBFormat:return this._gl.RGB32F;case s.Constants.RGBAFormat:default:return this._gl.RGBA32F}case s.Constants.HalfFloatType:switch(e){case s.Constants.RedFormat:return this._gl.R16F;case s.Constants.RGFormat:return this._gl.RG16F;case s.Constants.RGBFormat:return this._gl.RGB16F;case s.Constants.RGBAFormat:default:return this._gl.RGBA16F}case s.Constants.UnsignedShort565Type:return this._gl.RGB565;case s.Constants.UnsignedShort4444Type:return this._gl.RGBA4;case s.Constants.UnsignedShort5551Type:return this._gl.RGB5_A1}return this._gl.RGBA8},e.prototype._getRGBAMultiSampleBufferFormat=function(t){return t==s.Constants.FloatType?this._gl.RGBA32F:t==s.Constants.HalfFloatType?this._gl.RGBA16F:this._gl.RGBA8},e.prototype._getDepthBufferInternalFormat=function(t,e){var r;switch(t){case s.Constants.DepthStencilFormat:r=this._gl.DEPTH_STENCIL;break;case s.Constants.DepthFormat:r=this._gl.DEPTH_COMPONENT;break;case s.Constants.StencilFormat:r=this._gl.STENCIL_INDEX8}if(this._webGLVersion>1)switch(t){case s.Constants.DepthStencilFormat:r=e&&e!=s.Constants.FloatType?e==s.Constants.UnsignedInt248Type?this._gl.DEPTH24_STENCIL8:this._gl.DEPTH_STENCIL:this._gl.DEPTH32F_STENCIL8;break;case s.Constants.DepthFormat:e&&e!=s.Constants.FloatType?e==s.Constants.UnsignedIntType?r=this._gl.DEPTH_COMPONENT24:e==s.Constants.UnsignedShortType&&(r=this._gl.DEPTH_COMPONENT16):r=this._gl.DEPTH_COMPONENT32F;break;case s.Constants.StencilFormat:r=this._gl.STENCIL_INDEX8}return r},e.prototype.deletePipelineContext=function(t){return t.program&&(this._gl.deleteProgram(t.program),t.program=null),this},e._ConcatenateShader=function(t,e,r){return void 0===r&&(r=""),r+(e?e+"\n":"")+t},e.prototype._compileShader=function(t,r,n,i){return this._compileRawShader(e._ConcatenateShader(t,n,i),r)},e.prototype._compileRawShader=function(t,e){var r=this._gl,n=r.createShader("vertex"==e?r.VERTEX_SHADER:r.FRAGMENT_SHADER);if(!n)throw new Error("Something went wrong while compile the shader.");return r.shaderSource(n,t),r.compileShader(n),n},e.prototype._getShaderSource=function(t){return this._gl.getShaderSource(t)},e.prototype.createShaderProgram=function(t,e,r,n,i){void 0===i&&(i=null);var o=this._webGLVersion>1?"#version 300 es\n#define WEBGL2 \n":"",s=this._compileShader(e,"vertex",n,o),a=this._compileShader(r,"fragment",n,o);return this._createShaderProgram(t,s,a,i)},e.prototype._createShaderProgram=function(t,e,r,n){void 0===n&&(n=null);var i=this._gl.createProgram();if(t.program=i,!i)throw new Error("Unable to create program");return this._gl.attachShader(i,e),this._gl.attachShader(i,r),this._gl.linkProgram(i),t.vertexShader=e,t.fragmentShader=r,t.isParallelCompiled||this._finalizePipelineContext(t),i},e.prototype._preparePipelineContext=function(t,e,r,n,i){return t.program=this.createShaderProgram(t,e,r,n,i),this},e.prototype._isRenderingStateCompiled=function(t){return!!this._gl.getProgramParameter(t.program,this._caps.parallelShaderCompile.COMPLETION_STATUS_KHR)&&(this._finalizePipelineContext(t),!0)},e.prototype._executeWhenRenderingStateIsCompiled=function(t,e){if(t.isParallelCompiled){var r=t.onCompiled;t.onCompiled=r?function(){r(),e()}:e}else e()},e.prototype._finalizePipelineContext=function(t){var e=t.vertexShader,r=t.fragmentShader,n=t.program;if(!this._gl.getProgramParameter(n,this._gl.LINK_STATUS)){var i,o;if(!this._gl.getShaderParameter(e,this._gl.COMPILE_STATUS))if(i=this._gl.getShaderInfoLog(e))throw t.vertexCompilationError=i,new Error("VERTEX SHADER "+i);if(!this._gl.getShaderParameter(r,this._gl.COMPILE_STATUS))if(i=this._gl.getShaderInfoLog(r))throw t.fragmentCompilationError=i,new Error("FRAGMENT SHADER "+i);if(o=this._gl.getProgramInfoLog(n))throw t.programLinkError=o,new Error(o)}if(this.validateShaderPrograms&&(this._gl.validateProgram(n),!this._gl.getProgramParameter(n,this._gl.VALIDATE_STATUS)&&(o=this._gl.getProgramInfoLog(n))))throw t.programValidationError=o,new Error(o);this._gl.deleteShader(e),this._gl.deleteShader(r),t.vertexShader=void 0,t.fragmentShader=void 0,t.onCompiled&&(t.onCompiled(),t.onCompiled=void 0)},e.prototype.getUniforms=function(t,e){for(var r=new Array,n=0;n<e.length;n++)r.push(this._gl.getUniformLocation(t.program,e[n]));return r},e.prototype.getAttributes=function(t,e){for(var r=[],n=0;n<e.length;n++)try{r.push(this._gl.getAttribLocation(t.program,e[n]))}catch(t){r.push(-1)}return r},e.prototype.setInt=function(t,e){return t?(this._gl.uniform1i(t,e),this):this},e.prototype.setIntArray=function(t,e){return t?(this._gl.uniform1iv(t,e),this):this},e.prototype.setIntArray2=function(t,e){return t&&e.length%2==0?(this._gl.uniform2iv(t,e),this):this},e.prototype.setIntArray3=function(t,e){return t&&e.length%3==0?(this._gl.uniform3iv(t,e),this):this},e.prototype.setIntArray4=function(t,e){return t&&e.length%4==0?(this._gl.uniform4iv(t,e),this):this},e.prototype.setArray=function(t,e){return t?(this._gl.uniform1fv(t,e),this):this},e.prototype.setArray2=function(t,e){return t&&e.length%2==0?(this._gl.uniform2fv(t,e),this):this},e.prototype.setArray3=function(t,e){return t&&e.length%3==0?(this._gl.uniform3fv(t,e),this):this},e.prototype.setArray4=function(t,e){return t&&e.length%4==0?(this._gl.uniform4fv(t,e),this):this},e.prototype.setMatrices=function(t,e){return t?(this._gl.uniformMatrix4fv(t,!1,e),this):this},e.prototype.setMatrix3x3=function(t,e){return t?(this._gl.uniformMatrix3fv(t,!1,e),this):this},e.prototype.setMatrix2x2=function(t,e){return t?(this._gl.uniformMatrix2fv(t,!1,e),this):this},e.prototype.setFloat=function(t,e){return t?(this._gl.uniform1f(t,e),this):this},e.prototype.setFloat2=function(t,e,r){return t?(this._gl.uniform2f(t,e,r),this):this},e.prototype.setFloat3=function(t,e,r,n){return t?(this._gl.uniform3f(t,e,r,n),this):this},e.prototype.setFloat4=function(t,e,r,n,i){return t?(this._gl.uniform4f(t,e,r,n,i),this):this},e}(o.BaseEngine);e.WebGLEngine=a},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.CSGVector2D=void 0;var n=r(6),i=r(7),o=r(8),s=r(9),a=function(){function t(e,r){if(void 0===e&&(e=null),void 0===r&&(r=null),null!=e&&null!=r){var i=e.toString(),o=r.toString();this._x=parseFloat(i),this._y=parseFloat(o)}else{var s=!0;if(null!=e)if("object"==typeof e)if(e instanceof t)this._x=e._x,this._y=e._y;else if(e instanceof Array){i=e[0].toString(),o=e[1].toString();this._x=parseFloat(i),this._y=parseFloat(o)}else if("x"in e&&"y"in e){i=e.x.toString(),o=e.y.toString();this._x=parseFloat(i),this._y=parseFloat(o)}else s=!1;else{var a=parseFloat(e);this._x=a,this._y=a}else s=!1;if(s&&(n.CSG.IsFloat(this._x)&&n.CSG.IsFloat(this._y)||(s=!1)),!s)throw new Error("wrong arguments")}}return Object.defineProperty(t.prototype,"x",{get:function(){return this._x},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"y",{get:function(){return this._y},enumerable:!1,configurable:!0}),t.fromAngle=function(e){return t.fromAngleRadians(e)},t.fromAngleDegrees=function(e){var r=Math.PI*e/180;return t.fromAngleRadians(r)},t.fromAngleRadians=function(e){return t.Create(Math.cos(e),Math.sin(e))},t.Create=function(e,r){var n=Object.create(t.prototype);return n._x=e,n._y=r,n},t.prototype.toVector3D=function(t){return new s.CSGVector3D(this._x,this._y,t)},t.prototype.equals=function(t){return this._x==t._x&&this._y==t._y},t.prototype.clone=function(){return t.Create(this._x,this._y)},t.prototype.negated=function(){return t.Create(-this._x,-this._y)},t.prototype.plus=function(e){return t.Create(this._x+e._x,this._y+e._y)},t.prototype.minus=function(e){return t.Create(this._x-e._x,this._y-e._y)},t.prototype.times=function(e){return t.Create(this._x*e,this._y*e)},t.prototype.dividedBy=function(e){return t.Create(this._x/e,this._y/e)},t.prototype.dot=function(t){return this._x*t._x+this._y*t._y},t.prototype.lerp=function(t,e){return this.plus(t.minus(this).times(e))},t.prototype.length=function(){return Math.sqrt(this.dot(this))},t.prototype.distanceTo=function(t){return this.minus(t).length()},t.prototype.distanceToSquared=function(t){return this.minus(t).lengthSquared()},t.prototype.lengthSquared=function(){return this.dot(this)},t.prototype.unit=function(){return this.dividedBy(this.length())},t.prototype.cross=function(t){return this._x*t._y-this._y*t._x},t.prototype.normal=function(){return t.Create(this._y,-this._x)},t.prototype.multiply4x4=function(t){return t.leftMultiply1x2Vector(this)},t.prototype.transform=function(t){return t.leftMultiply1x2Vector(this)},t.prototype.angle=function(){return this.angleRadians()},t.prototype.angleDegrees=function(){return 180*this.angleRadians()/Math.PI},t.prototype.angleRadians=function(){return Math.atan2(this._y,this._x)},t.prototype.min=function(e){return t.Create(Math.min(this._x,e._x),Math.min(this._y,e._y))},t.prototype.max=function(e){return t.Create(Math.max(this._x,e._x),Math.max(this._y,e._y))},t.prototype.toString=function(){return"("+this._x.toFixed(2)+", "+this._y.toFixed(2)+")"},t.prototype.abs=function(){return t.Create(Math.abs(this._x),Math.abs(this._y))},t.prototype.mirrored=function(t){return this.transform(i.CSGMatrix4x4.mirroring(t))},t.prototype.mirroredX=function(){var t=new o.CSGPlane(s.CSGVector3D.Create(1,0,0),0);return this.mirrored(t)},t.prototype.mirroredY=function(){var t=new o.CSGPlane(s.CSGVector3D.Create(0,1,0),0);return this.mirrored(t)},t.prototype.mirroredZ=function(){var t=new o.CSGPlane(s.CSGVector3D.Create(0,0,1),0);return this.mirrored(t)},t.prototype.translate=function(t){return this.transform(i.CSGMatrix4x4.translation(t))},t.prototype.scale=function(t){return this.transform(i.CSGMatrix4x4.scaling(t))},t.prototype.rotateX=function(t){return this.transform(i.CSGMatrix4x4.rotationX(t))},t.prototype.rotateY=function(t){return this.transform(i.CSGMatrix4x4.rotationY(t))},t.prototype.rotateZ=function(t){return this.transform(i.CSGMatrix4x4.rotationZ(t))},t.prototype.rotate=function(t,e,r){return this.transform(i.CSGMatrix4x4.rotation(t,e,r))},t.prototype.rotateEulerAngles=function(t,e,r,n){var o=n||[0,0,0],a=i.CSGMatrix4x4.rotationZ(t),u=i.CSGMatrix4x4.rotationX(e),p=i.CSGMatrix4x4.rotationZ(r),h=i.CSGMatrix4x4.translation(new s.CSGVector3D(o));return this.transform(p.multiply(u).multiply(a).multiply(h))},t}();e.CSGVector2D=a},function(t,e,r){"use strict";var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(e,"__esModule",{value:!0}),e.Light=void 0;var o=r(24),s=r(54),a=r(4),u=function(t){function e(e,r,n){void 0===r&&(r=null),void 0===n&&(n="");var i=t.call(this,e,r,n)||this;return i._maskLayers=new s.VisibleLayers,i._color=new a.ColorRGB(1,1,1),i._castShadow=!1,i._intensity=1,i._maskLayers.enableAll(),i.scene.addLight(i),i}return i(e,t),Object.defineProperty(e.prototype,"maskLayers",{get:function(){return this._maskLayers},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"color",{get:function(){return this._color},set:function(t){this._color.copy(t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"intensity",{get:function(){return this._intensity},set:function(t){this._intensity=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"castShadow",{get:function(){return this._castShadow},set:function(t){this._castShadow=t},enumerable:!1,configurable:!0}),e.prototype.canAffectMesh=function(t){return this._maskLayers.test(t.lightLayers)},e}(o.TransformObject);e.Light=u},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Vector4=void 0;var n=r(17),i=r(1),o=function(){function t(t,e,r,n){void 0===t&&(t=0),void 0===e&&(e=0),void 0===r&&(r=0),void 0===n&&(n=0),this._p=[],this._p[0]=t,this._p[1]=e,this._p[2]=r,this._p[3]=n,this._notify=!0,this._onNotify=null}return Object.defineProperty(t.prototype,"_x",{get:function(){return this._p[0]},set:function(t){this._p[0]=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_y",{get:function(){return this._p[1]},set:function(t){this._p[1]=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_z",{get:function(){return this._p[2]},set:function(t){this._p[2]=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_w",{get:function(){return this._p[3]},set:function(t){this._p[3]=t},enumerable:!1,configurable:!0}),t.Build=function(){return new t},Object.defineProperty(t,"ZERO",{get:function(){return t._zeroReadOnly},enumerable:!1,configurable:!0}),Object.defineProperty(t,"ONE",{get:function(){return t._oneReadOnly},enumerable:!1,configurable:!0}),Object.defineProperty(t,"INV_ONE",{get:function(){return t._oneInvReadOnly},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"p",{get:function(){return this._p},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"x",{get:function(){return this._x},set:function(t){this._x!=t&&(this._x=t,this.triggerNotify())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"y",{get:function(){return this._y},set:function(t){this._y!=t&&(this._y=t,this.triggerNotify())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"z",{get:function(){return this._z},set:function(t){this._z!=t&&(this._z=t,this.triggerNotify())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"w",{get:function(){return this._w},set:function(t){this._w!=t&&(this._w=t,this.triggerNotify())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"notify",{get:function(){return this._notify},set:function(t){this._notify=t},enumerable:!1,configurable:!0}),t.prototype.setNotifyFunc=function(t){return this._onNotify=t,this},t.prototype.triggerNotify=function(){this._notify&&this._onNotify&&this._onNotify()},t.prototype.set=function(t,e,r,n){return this._x=t,this._y=e,this._z=r,this._w=n,this.triggerNotify(),this},t.prototype.setScalar=function(t){return this._x=t,this._y=t,this._z=t,this._w=t,this.triggerNotify(),this},t.prototype.setX=function(t){return this._x=t,this.triggerNotify(),this},t.prototype.setY=function(t){return this._y=t,this.triggerNotify(),this},t.prototype.setZ=function(t){return this._z=t,this.triggerNotify(),this},t.prototype.setW=function(t){return this._w=t,this.triggerNotify(),this},t.prototype.setComponent=function(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;case 3:this.w=e;break;default:throw new Error("index is out of range: "+t)}return this},t.prototype.getComponent=function(t){switch(t){case 0:return this._x;case 1:return this._y;case 2:return this._z;case 3:return this._w;default:throw new Error("index is out of range: "+t)}},t.prototype.clone=function(){return new t(this._x,this._y,this._z,this._w)},t.prototype.copy=function(t){return this._x=t.x,this._y=t.y,this._z=t.z,this._w=t.w,this.triggerNotify(),this},t.prototype.add=function(t){return this._x+=t.x,this._y+=t.y,this._z+=t.z,this._w+=t.w,this.triggerNotify(),this},t.prototype.addScalar=function(t){return this._x+=t,this._y+=t,this._z+=t,this._w+=t,this.triggerNotify(),this},t.prototype.addVectors=function(t,e){return this._x=t.x+e.x,this._y=t.y+e.y,this._z=t.z+e.z,this._w=t.w+e.w,this.triggerNotify(),this},t.prototype.addScaledVector=function(t,e){return this._x+=t.x*e,this._y+=t.y*e,this._z+=t.z*e,this._w+=t.w*e,this.triggerNotify(),this},t.prototype.sub=function(t){return this._x-=t.x,this._y-=t.y,this._z-=t.z,this._w-=t.w,this.triggerNotify(),this},t.prototype.subScalar=function(t){return this._x-=t,this._y-=t,this._z-=t,this._w-=t,this.triggerNotify(),this},t.prototype.subVectors=function(t,e){return this._x=t.x-e.x,this._y=t.y-e.y,this._z=t.z-e.z,this._w=t.w-e.w,this.triggerNotify(),this},t.prototype.multiplyScalar=function(t){return this._x*=t,this._y*=t,this._z*=t,this._w*=t,this.triggerNotify(),this},t.prototype.applyMatrix4=function(t){var e=this._x,r=this._y,n=this._z,i=this._w,o=t.elements;return this._x=o[0]*e+o[4]*r+o[8]*n+o[12]*i,this._y=o[1]*e+o[5]*r+o[9]*n+o[13]*i,this._z=o[2]*e+o[6]*r+o[10]*n+o[14]*i,this._w=o[3]*e+o[7]*r+o[11]*n+o[15]*i,this.triggerNotify(),this},t.prototype.divideScalar=function(t){return this.multiplyScalar(1/t)},t.prototype.setAxisAngleFromQuaternion=function(t){this._w=2*Math.acos(t.w);var e=Math.sqrt(1-t.w*t.w);return e<1e-4?(this._x=1,this._y=0,this._z=0):(this._x=t.x/e,this._y=t.y/e,this._z=t.z/e),this.triggerNotify(),this},t.prototype.setAxisAngleFromRotationMatrix=function(t){var e,r,i,o,s=t instanceof n.Matrix4,a=t.elements,u=a[0],p=s?a[4]:a[3],h=s?a[8]:a[6],c=a[1],l=s?a[5]:a[4],f=s?a[9]:a[7],y=a[2],d=s?a[6]:a[5],_=s?a[10]:a[8];if(Math.abs(p-c)<.01&&Math.abs(h-y)<.01&&Math.abs(f-d)<.01){if(Math.abs(p+c)<.1&&Math.abs(h+y)<.1&&Math.abs(f+d)<.1&&Math.abs(u+l+_-3)<.1)return this.set(1,0,0,0),this;e=Math.PI;var m=(u+1)/2,g=(l+1)/2,v=(_+1)/2,x=(p+c)/4,b=(h+y)/4,S=(f+d)/4;return m>g&&m>v?m<.01?(r=0,i=.707106781,o=.707106781):(i=x/(r=Math.sqrt(m)),o=b/r):g>v?g<.01?(r=.707106781,i=0,o=.707106781):(r=x/(i=Math.sqrt(g)),o=S/i):v<.01?(r=.707106781,i=.707106781,o=0):(r=b/(o=Math.sqrt(v)),i=S/o),this.set(r,i,o,e),this}var T=Math.sqrt((d-f)*(d-f)+(h-y)*(h-y)+(c-p)*(c-p));return Math.abs(T)<.001&&(T=1),this._x=(d-f)/T,this._y=(h-y)/T,this._z=(c-p)/T,this._w=Math.acos((u+l+_-1)/2),this.triggerNotify(),this},t.prototype.min=function(t){return this._x=Math.min(this._x,t.x),this._y=Math.min(this._y,t.y),this._z=Math.min(this._z,t.z),this._w=Math.min(this._w,t.w),this.triggerNotify(),this},t.prototype.max=function(t){return this._x=Math.max(this._x,t.x),this._y=Math.max(this._y,t.y),this._z=Math.max(this._z,t.z),this._w=Math.max(this._w,t.w),this.triggerNotify(),this},t.prototype.clamp=function(t,e){return this._x=Math.max(t.x,Math.min(e.x,this._x)),this._y=Math.max(t.y,Math.min(e.y,this._y)),this._z=Math.max(t.z,Math.min(e.z,this._z)),this._w=Math.max(t.w,Math.min(e.w,this._w)),this.triggerNotify(),this},t.prototype.clampScalar=function(t,e){return this._x=Math.max(t,Math.min(e,this._x)),this._y=Math.max(t,Math.min(e,this._y)),this._z=Math.max(t,Math.min(e,this._z)),this._w=Math.max(t,Math.min(e,this._w)),this.triggerNotify(),this},t.prototype.clampLength=function(t,e){var r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(t,Math.min(e,r)))},t.prototype.floor=function(){return this._x=Math.floor(this._x),this._y=Math.floor(this._y),this._z=Math.floor(this._z),this._w=Math.floor(this._w),this.triggerNotify(),this},t.prototype.ceil=function(){return this._x=Math.ceil(this._x),this._y=Math.ceil(this._y),this._z=Math.ceil(this._z),this._w=Math.ceil(this._w),this.triggerNotify(),this},t.prototype.round=function(){return this._x=Math.round(this._x),this._y=Math.round(this._y),this._z=Math.round(this._z),this._w=Math.round(this._w),this.triggerNotify(),this},t.prototype.roundToZero=function(){return this._x=this._x<0?Math.ceil(this._x):Math.floor(this._x),this._y=this._y<0?Math.ceil(this._y):Math.floor(this._y),this._z=this._z<0?Math.ceil(this._z):Math.floor(this._z),this._w=this._w<0?Math.ceil(this._w):Math.floor(this._w),this.triggerNotify(),this},t.prototype.negate=function(){return this._x=-this._x,this._y=-this._y,this._z=-this._z,this._w=-this._w,this.triggerNotify(),this},t.prototype.dot=function(t){return this._x*t.x+this._y*t.y+this._z*t.z+this._w*t.w},t.prototype.lengthSq=function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},t.prototype.length=function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},t.prototype.manhattanLength=function(){return Math.abs(this._x)+Math.abs(this._y)+Math.abs(this._z)+Math.abs(this._w)},t.prototype.manhattanDistanceTo=function(t){return Math.abs(this._x-t.x)+Math.abs(this._y-t.y)+Math.abs(this._z-t.z)+Math.abs(this._w-t.w)},t.prototype.normalize=function(){return this.divideScalar(this.length()||1)},t.prototype.setLength=function(t){return this.normalize().multiplyScalar(t)},t.prototype.lerp=function(t,e){return this._x+=(t.x-this._x)*e,this._y+=(t.y-this._y)*e,this._z+=(t.z-this._z)*e,this._w+=(t.w-this._w)*e,this.triggerNotify(),this},t.prototype.lerpVectors=function(t,e,r){return this._x=t.x+(e.x-t.x)*r,this._y=t.y+(e.y-t.y)*r,this._z=t.z+(e.z-t.z)*r,this._w=t.w+(e.w-t.w)*r,this.triggerNotify(),this},t.prototype.random=function(){return this._x=Math.random(),this._y=Math.random(),this._z=Math.random(),this._w=Math.random(),this.triggerNotify(),this},t.prototype.equals=function(t){return t.x==this._x&&t.y==this._y&&t.z==this._z&&t.w==this._w},t.prototype.equalsEpsilon=function(t,e,r){return void 0===r&&(r=null),i.MathUtils.equalsEpsilon(this._x,t.x,e,r)&&i.MathUtils.equalsEpsilon(this._y,t.y,e,r)&&i.MathUtils.equalsEpsilon(this._z,t.z,e,r)&&i.MathUtils.equalsEpsilon(this._w,t.w,e,r)},t.prototype.fromArray=function(t,e){return void 0===e&&(e=0),this._x=t[e],this._y=t[e+1],this._z=t[e+2],this._w=t[e+3],this.triggerNotify(),this},t.prototype.toArray=function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._w,t},t.prototype.fromDataBuffer=function(t){return this._x=t.readFloat32(),this._y=t.readFloat32(),this._z=t.readFloat32(),this._w=t.readFloat32(),this.triggerNotify(),this},t.prototype.toDataBuffer=function(t){return t.writeFloat32(this._x),t.writeFloat32(this._y),t.writeFloat32(this._z),t.writeFloat32(this._w),this},t.prototype.fromBufferAttribute=function(t,e){return this._x=t.getX(e),this._y=t.getY(e),this._z=t.getZ(e),this._w=t.getW(e),this},t._zeroReadOnly=new t(0,0,0,0),t._oneReadOnly=new t(1,1,1,1),t._oneInvReadOnly=new t(-1,-1,-1,-1),t}();e.Vector4=o},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Matrix4=void 0;var n=r(0),i=r(16),o=r(18),s=r(33),a=r(34),u=r(1),p=r(5),h=function(){function t(t){void 0===t&&(t=[]),this._notify=!0,this._onNotify=null,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],t.length>0&&this.fromArray(t)}return t.Build=function(){return new t},t.getElementIndex=function(t,e){return 4*t+e},Object.defineProperty(t,"IDENTITY",{get:function(){return t._identityReadOnly},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"notify",{get:function(){return this._notify},set:function(t){this._notify=t},enumerable:!1,configurable:!0}),t.prototype.setNotifyFunc=function(t){return this._onNotify=t,this},t.prototype.triggerNotify=function(){this._notify&&this._onNotify&&this._onNotify()},t.prototype.set=function(t,e,r,n,i,o,s,a,u,p,h,c,l,f,y,d){var _=this.elements;return _[0]=t,_[4]=e,_[8]=r,_[12]=n,_[1]=i,_[5]=o,_[9]=s,_[13]=a,_[2]=u,_[6]=p,_[10]=h,_[14]=c,_[3]=l,_[7]=f,_[11]=y,_[15]=d,this.triggerNotify(),this},t.prototype.isIdentity=function(){return this.equals(t.IDENTITY)},t.prototype.identity=function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},t.prototype.clone=function(){return(new t).copy(this)},t.prototype.copy=function(t){var e=this.elements,r=t.elements;return e[0]=r[0],e[1]=r[1],e[2]=r[2],e[3]=r[3],e[4]=r[4],e[5]=r[5],e[6]=r[6],e[7]=r[7],e[8]=r[8],e[9]=r[9],e[10]=r[10],e[11]=r[11],e[12]=r[12],e[13]=r[13],e[14]=r[14],e[15]=r[15],this.triggerNotify(),this},t.prototype.copyPosition=function(t){var e=this.elements,r=t.elements;return e[12]=r[12],e[13]=r[13],e[14]=r[14],this.triggerNotify(),this},t.prototype.getX=function(t){return void 0===t&&(t=new n.Vector3),t.set(this.elements[0],this.elements[1],this.elements[2])},t.prototype.getY=function(t){return void 0===t&&(t=new n.Vector3),t.set(this.elements[4],this.elements[5],this.elements[6])},t.prototype.getZ=function(t){return void 0===t&&(t=new n.Vector3),t.set(this.elements[8],this.elements[9],this.elements[10])},t.prototype.getElement=function(e,r){var n=t.getElementIndex(e,r);return this.elements[n]},t.prototype.setElement=function(e,r,n){var i=t.getElementIndex(e,r);return this.elements[i]=n,this.triggerNotify(),this},t.prototype.getColumn=function(t,e){void 0===e&&(e=new i.Vector4);var r=4*t,n=this.elements[r],o=this.elements[r+1],s=this.elements[r+2],a=this.elements[r+3];return e.x=n,e.y=o,e.z=s,e.w=a,e},t.prototype.setColumn=function(t,e){var r=4*t;return this.elements[r]=e.x,this.elements[r+1]=e.y,this.elements[r+2]=e.z,this.elements[r+3]=e.w,this.triggerNotify(),this},t.prototype.getRow=function(t,e){void 0===e&&(e=new i.Vector4);var r=this.elements[t],n=this.elements[t+4],o=this.elements[t+8],s=this.elements[t+12];return e.x=r,e.y=n,e.z=o,e.w=s,e},t.prototype.setRow=function(t,e){return this.elements[t]=e.x,this.elements[t+4]=e.y,this.elements[t+8]=e.z,this.elements[t+12]=e.w,this.triggerNotify(),this},t.prototype.getScale=function(t){return void 0===t&&(t=new n.Vector3),this.getX(p.MathTmp.Vector3[0]),this.getY(p.MathTmp.Vector3[1]),this.getZ(p.MathTmp.Vector3[2]),t.set(p.MathTmp.Vector3[0].length(),p.MathTmp.Vector3[1].length(),p.MathTmp.Vector3[2].length()),t},t.prototype.getTranslation=function(t){return void 0===t&&(t=new n.Vector3),t.x=this.elements[12],t.y=this.elements[13],t.z=this.elements[14],t},t.prototype.getRotationMatrix3=function(t){return void 0===t&&(t=new o.Matrix3),t.elements[0]=this.elements[0],t.elements[1]=this.elements[1],t.elements[2]=this.elements[2],t.elements[3]=this.elements[4],t.elements[4]=this.elements[5],t.elements[5]=this.elements[6],t.elements[6]=this.elements[8],t.elements[7]=this.elements[9],t.elements[8]=this.elements[10],t},t.prototype.getRotationMatrix4=function(e){void 0===e&&(e=new t);var r=1/p.MathTmp.Vector3[0].setFromMatrixColumn(this,0).length(),n=1/p.MathTmp.Vector3[1].setFromMatrixColumn(this,1).length(),i=1/p.MathTmp.Vector3[2].setFromMatrixColumn(this,2).length();return e.elements[0]=this.elements[0]*r,e.elements[1]=this.elements[1]*r,e.elements[2]=this.elements[2]*r,e.elements[3]=0,e.elements[4]=this.elements[4]*n,e.elements[5]=this.elements[5]*n,e.elements[6]=this.elements[6]*n,e.elements[7]=0,e.elements[8]=this.elements[8]*i,e.elements[9]=this.elements[9]*i,e.elements[10]=this.elements[10]*i,e.elements[11]=0,e.elements[12]=0,e.elements[13]=0,e.elements[14]=0,e.elements[15]=1,e},t.prototype.setFromEulerAngles=function(t,e,r){var n,i,o,s,a,u,p;return n=Math.sin(-t),i=Math.cos(-t),o=Math.sin(-e),s=Math.cos(-e),a=Math.sin(-r),u=Math.cos(-r),(p=this.elements)[0]=s*u,p[1]=-s*a,p[2]=o,p[3]=0,p[4]=i*a+u*n*o,p[5]=i*u-n*o*a,p[6]=-s*n,p[7]=0,p[8]=n*a-i*u*o,p[9]=u*n+i*o*a,p[10]=i*s,p[11]=0,p[12]=0,p[13]=0,p[14]=0,p[15]=1,this.triggerNotify(),this},t.prototype.getEulerAngles=function(t){var e,r,n,i,o,a,u,h;return void 0===t&&(t=new s.Euler),this.getScale(p.MathTmp.Vector3[0]),i=p.MathTmp.Vector3[0].x,o=p.MathTmp.Vector3[0].y,a=p.MathTmp.Vector3[0].z,u=this.elements,(r=Math.asin(-u[2]/i))<(h=.5*Math.PI)?r>-h?(e=Math.atan2(u[6]/o,u[10]/a),n=Math.atan2(u[1]/i,u[0]/i)):(n=0,e=-Math.atan2(u[4]/o,u[5]/o)):(n=0,e=Math.atan2(u[4]/o,u[5]/o)),t.set(e,r,n)},t.prototype.transformPoint=function(t,e){var r,i,o;void 0===e&&(e=new n.Vector3);var s=this.elements,a=t;return r=a.x*s[0]+a.y*s[4]+a.z*s[8]+s[12],i=a.x*s[1]+a.y*s[5]+a.z*s[9]+s[13],o=a.x*s[2]+a.y*s[6]+a.z*s[10]+s[14],e.set(r,i,o)},t.prototype.transformVector3=function(t,e){var r,i,o;void 0===e&&(e=new n.Vector3);var s=this.elements,a=t;return r=a.x*s[0]+a.y*s[4]+a.z*s[8],i=a.x*s[1]+a.y*s[5]+a.z*s[9],o=a.x*s[2]+a.y*s[6]+a.z*s[10],e.set(r,i,o)},t.prototype.transformVector4=function(t,e){var r,n,o,s;void 0===e&&(e=new i.Vector4);var a=this.elements,u=t;return r=u.x*a[0]+u.y*a[4]+u.z*a[8]+u.w*a[12],n=u.x*a[1]+u.y*a[5]+u.z*a[9]+u.w*a[13],o=u.x*a[2]+u.y*a[6]+u.z*a[10]+u.w*a[14],s=u.x*a[3]+u.y*a[7]+u.z*a[11]+u.w*a[15],e.set(r,n,o,s)},t.prototype.extractBasis=function(t,e,r){return void 0===t&&(t=new n.Vector3),void 0===e&&(e=new n.Vector3),void 0===r&&(r=new n.Vector3),t.setFromMatrixColumn(this,0),e.setFromMatrixColumn(this,1),r.setFromMatrixColumn(this,2),this},t.prototype.makeBasis=function(t,e,r){return this.set(t.x,e.x,r.x,0,t.y,e.y,r.y,0,t.z,e.z,r.z,0,0,0,0,1),this},t.prototype.makeRotationFromEuler=function(t){var e=this.elements,r=t.x,n=t.y,i=t.z,o=Math.cos(r),s=Math.sin(r),u=Math.cos(n),p=Math.sin(n),h=Math.cos(i),c=Math.sin(i);if(t.order==a.EulerOrder.XYZ){var l=o*h,f=o*c,y=s*h,d=s*c;e[0]=u*h,e[4]=-u*c,e[8]=p,e[1]=f+y*p,e[5]=l-d*p,e[9]=-s*u,e[2]=d-l*p,e[6]=y+f*p,e[10]=o*u}else if(t.order==a.EulerOrder.YXZ){var _=u*h,m=u*c,g=p*h,v=p*c;e[0]=_+v*s,e[4]=g*s-m,e[8]=o*p,e[1]=o*c,e[5]=o*h,e[9]=-s,e[2]=m*s-g,e[6]=v+_*s,e[10]=o*u}else if(t.order==a.EulerOrder.ZXY){_=u*h,m=u*c,g=p*h,v=p*c;e[0]=_-v*s,e[4]=-o*c,e[8]=g+m*s,e[1]=m+g*s,e[5]=o*h,e[9]=v-_*s,e[2]=-o*p,e[6]=s,e[10]=o*u}else if(t.order==a.EulerOrder.ZYX){l=o*h,f=o*c,y=s*h,d=s*c;e[0]=u*h,e[4]=y*p-f,e[8]=l*p+d,e[1]=u*c,e[5]=d*p+l,e[9]=f*p-y,e[2]=-p,e[6]=s*u,e[10]=o*u}else if(t.order==a.EulerOrder.YZX){var x=o*u,b=o*p,S=s*u,T=s*p;e[0]=u*h,e[4]=T-x*c,e[8]=S*c+b,e[1]=c,e[5]=o*h,e[9]=-s*h,e[2]=-p*h,e[6]=b*c+S,e[10]=x-T*c}else if(t.order==a.EulerOrder.XZY){x=o*u,b=o*p,S=s*u,T=s*p;e[0]=u*h,e[4]=-c,e[8]=p*h,e[1]=x*c+T,e[5]=o*h,e[9]=b*c-S,e[2]=S*c-b,e[6]=s*h,e[10]=T*c+x}return e[3]=0,e[7]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this.triggerNotify(),this},t.prototype.makeRotationFromQuaternion=function(t){return this.compose(n.Vector3.ZERO,t,n.Vector3.ONE)},t.prototype.lookAt=function(t,e,r){var n=this.elements;return p.MathTmp.Vector3[2].subVectors(t,e),0==p.MathTmp.Vector3[2].lengthSq()&&(p.MathTmp.Vector3[2].z=1),p.MathTmp.Vector3[2].normalize(),p.MathTmp.Vector3[0].crossVectors(r,p.MathTmp.Vector3[2]),0==p.MathTmp.Vector3[0].lengthSq()&&(1==Math.abs(r.z)?p.MathTmp.Vector3[2].x+=1e-4:p.MathTmp.Vector3[2].z+=1e-4,p.MathTmp.Vector3[2].normalize(),p.MathTmp.Vector3[0].crossVectors(r,p.MathTmp.Vector3[2])),p.MathTmp.Vector3[0].normalize(),p.MathTmp.Vector3[1].crossVectors(p.MathTmp.Vector3[2],p.MathTmp.Vector3[0]),n[0]=p.MathTmp.Vector3[0].x,n[4]=p.MathTmp.Vector3[1].x,n[8]=p.MathTmp.Vector3[2].x,n[1]=p.MathTmp.Vector3[0].y,n[5]=p.MathTmp.Vector3[1].y,n[9]=p.MathTmp.Vector3[2].y,n[2]=p.MathTmp.Vector3[0].z,n[6]=p.MathTmp.Vector3[1].z,n[10]=p.MathTmp.Vector3[2].z,this.triggerNotify(),this},t.prototype.inverse=function(){var t,e,r,n,i,o,s,a,u,p,h,c,l,f,y,d,_,m,g,v,x,b,S,T,C,E,M,w,P,A,O;return t=(O=this.elements)[0],e=O[1],r=O[2],n=O[3],i=O[4],o=O[5],s=O[6],a=O[7],u=O[8],p=O[9],h=O[10],c=O[11],l=O[12],f=O[13],y=O[14],0==(P=(_=t*o-e*i)*(w=h*(d=O[15])-c*y)-(m=t*s-r*i)*(M=p*d-c*f)+(g=t*a-n*i)*(E=p*y-h*f)+(v=e*s-r*o)*(C=u*d-c*l)-(x=e*a-n*o)*(T=u*y-h*l)+(b=r*a-n*s)*(S=u*f-p*l))?this.identity():(A=1/P,O[0]=(o*w-s*M+a*E)*A,O[1]=(-e*w+r*M-n*E)*A,O[2]=(f*b-y*x+d*v)*A,O[3]=(-p*b+h*x-c*v)*A,O[4]=(-i*w+s*C-a*T)*A,O[5]=(t*w-r*C+n*T)*A,O[6]=(-l*b+y*g-d*m)*A,O[7]=(u*b-h*g+c*m)*A,O[8]=(i*M-o*C+a*S)*A,O[9]=(-t*M+e*C-n*S)*A,O[10]=(l*x-f*g+d*_)*A,O[11]=(-u*x+p*g-c*_)*A,O[12]=(-i*E+o*T-s*S)*A,O[13]=(t*E-e*T+r*S)*A,O[14]=(-l*v+f*m-y*_)*A,O[15]=(u*v-p*m+h*_)*A,this.triggerNotify(),this)},t.prototype.multiply=function(t){return this.multiplyMatrices(this,t)},t.prototype.premultiply=function(t){return this.multiplyMatrices(t,this)},t.prototype.multiplyMatrices=function(t,e){var r=t.elements,n=e.elements,i=this.elements,o=r[0],s=r[4],a=r[8],u=r[12],p=r[1],h=r[5],c=r[9],l=r[13],f=r[2],y=r[6],d=r[10],_=r[14],m=r[3],g=r[7],v=r[11],x=r[15],b=n[0],S=n[4],T=n[8],C=n[12],E=n[1],M=n[5],w=n[9],P=n[13],A=n[2],O=n[6],R=n[10],B=n[14],I=n[3],N=n[7],F=n[11],G=n[15];return i[0]=o*b+s*E+a*A+u*I,i[4]=o*S+s*M+a*O+u*N,i[8]=o*T+s*w+a*R+u*F,i[12]=o*C+s*P+a*B+u*G,i[1]=p*b+h*E+c*A+l*I,i[5]=p*S+h*M+c*O+l*N,i[9]=p*T+h*w+c*R+l*F,i[13]=p*C+h*P+c*B+l*G,i[2]=f*b+y*E+d*A+_*I,i[6]=f*S+y*M+d*O+_*N,i[10]=f*T+y*w+d*R+_*F,i[14]=f*C+y*P+d*B+_*G,i[3]=m*b+g*E+v*A+x*I,i[7]=m*S+g*M+v*O+x*N,i[11]=m*T+g*w+v*R+x*F,i[15]=m*C+g*P+v*B+x*G,this.triggerNotify(),this},t.prototype.multiplyMatrix3=function(t){var e=this.elements[0],r=this.elements[1],n=this.elements[2],i=this.elements[4],o=this.elements[5],s=this.elements[6],a=this.elements[8],u=this.elements[9],p=this.elements[10],h=t.elements[0],c=t.elements[1],l=t.elements[2],f=t.elements[3],y=t.elements[4],d=t.elements[5],_=t.elements[6],m=t.elements[7],g=t.elements[8],v=e*h+i*c+a*l,x=r*h+o*c+u*l,b=n*h+s*c+p*l,S=e*f+i*y+a*d,T=r*f+o*y+u*d,C=n*f+s*y+p*d,E=e*_+i*m+a*g,M=r*_+o*m+u*g,w=n*_+s*m+p*g;return this.elements[0]=v,this.elements[1]=x,this.elements[2]=b,this.elements[3]=0,this.elements[4]=S,this.elements[5]=T,this.elements[6]=C,this.elements[7]=0,this.elements[8]=E,this.elements[9]=M,this.elements[10]=w,this.elements[11]=0,this.elements[12]=this.elements[12],this.elements[13]=this.elements[13],this.elements[14]=this.elements[14],this.elements[15]=this.elements[15],this.triggerNotify(),this},t.prototype.multiplyScalar=function(t){var e=this.elements;return e[0]*=t,e[4]*=t,e[8]*=t,e[12]*=t,e[1]*=t,e[5]*=t,e[9]*=t,e[13]*=t,e[2]*=t,e[6]*=t,e[10]*=t,e[14]*=t,e[3]*=t,e[7]*=t,e[11]*=t,e[15]*=t,this.triggerNotify(),this},t.prototype.multiplyScalarVector=function(t){var e=this.elements;return e[0]*=t.x,e[1]*=t.x,e[2]*=t.x,e[3]=0,e[4]*=t.y,e[5]*=t.y,e[6]*=t.y,e[7]=0,e[8]*=t.z,e[9]*=t.z,e[10]*=t.z,e[15]=1,this.triggerNotify(),this},t.prototype.determinant=function(){var t=this.elements,e=t[0],r=t[4],n=t[8],i=t[12],o=t[1],s=t[5],a=t[9],u=t[13],p=t[2],h=t[6],c=t[10],l=t[14];return t[3]*(+i*a*h-n*u*h-i*s*c+r*u*c+n*s*l-r*a*l)+t[7]*(+e*a*l-e*u*c+i*o*c-n*o*l+n*u*p-i*a*p)+t[11]*(+e*u*h-e*s*l-i*o*h+r*o*l+i*s*p-r*u*p)+t[15]*(-n*s*p-e*a*h+e*s*c+n*o*h-r*o*c+r*a*p)},t.prototype.transpose=function(){var t,e=this.elements;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this.triggerNotify(),this},t.prototype.setPositionXYZ=function(t,e,r){var n=this.elements;return n[12]=t,n[13]=e,n[14]=r,this.triggerNotify(),this},t.prototype.setPositionVector=function(t){return this.setPositionXYZ(t.x,t.y,t.z)},t.prototype.setScaleXYZ=function(t,e,r){var n=this.elements;return n[0]=t,n[5]=e,n[10]=r,this.triggerNotify(),this},t.prototype.setScaleVector=function(t){return this.setScaleXYZ(t.x,t.y,t.z)},t.prototype.getInverse=function(t){var e=this.elements,r=t.elements,n=r[0],i=r[1],o=r[2],s=r[3],a=r[4],u=r[5],p=r[6],h=r[7],c=r[8],l=r[9],f=r[10],y=r[11],d=r[12],_=r[13],m=r[14],g=r[15],v=l*m*h-_*f*h+_*p*y-u*m*y-l*p*g+u*f*g,x=d*f*h-c*m*h-d*p*y+a*m*y+c*p*g-a*f*g,b=c*_*h-d*l*h+d*u*y-a*_*y-c*u*g+a*l*g,S=d*l*p-c*_*p-d*u*f+a*_*f+c*u*m-a*l*m,T=n*v+i*x+o*b+s*S;if(0==T)return this.identity();var C=1/T;return e[0]=v*C,e[1]=(_*f*s-l*m*s-_*o*y+i*m*y+l*o*g-i*f*g)*C,e[2]=(u*m*s-_*p*s+_*o*h-i*m*h-u*o*g+i*p*g)*C,e[3]=(l*p*s-u*f*s-l*o*h+i*f*h+u*o*y-i*p*y)*C,e[4]=x*C,e[5]=(c*m*s-d*f*s+d*o*y-n*m*y-c*o*g+n*f*g)*C,e[6]=(d*p*s-a*m*s-d*o*h+n*m*h+a*o*g-n*p*g)*C,e[7]=(a*f*s-c*p*s+c*o*h-n*f*h-a*o*y+n*p*y)*C,e[8]=b*C,e[9]=(d*l*s-c*_*s-d*i*y+n*_*y+c*i*g-n*l*g)*C,e[10]=(a*_*s-d*u*s+d*i*h-n*_*h-a*i*g+n*u*g)*C,e[11]=(c*u*s-a*l*s-c*i*h+n*l*h+a*i*y-n*u*y)*C,e[12]=S*C,e[13]=(c*_*o-d*l*o+d*i*f-n*_*f-c*i*m+n*l*m)*C,e[14]=(d*u*o-a*_*o-d*i*p+n*_*p+a*i*m-n*u*m)*C,e[15]=(a*l*o-c*u*o+c*i*p-n*l*p-a*i*f+n*u*f)*C,this.triggerNotify(),this},t.prototype.translateXYZ=function(t,e,r){var n=this.elements,i=t,o=e,s=r;return n[12]+=i,n[13]+=o,n[14]+=s,this.triggerNotify(),this},t.prototype.translateVector=function(t){return this.translateXYZ(t.x,t.y,t.z)},t.prototype.scaleXYZ=function(t,e,r){var n=this.elements,i=t,o=e,s=r;return n[0]*=i,n[4]*=o,n[8]*=s,n[1]*=i,n[5]*=o,n[9]*=s,n[2]*=i,n[6]*=o,n[10]*=s,n[3]*=i,n[7]*=o,n[11]*=s,this.triggerNotify(),this},t.prototype.scaleVector=function(t){return this.scaleXYZ(t.x,t.y,t.z)},t.prototype.getMaxScaleOnAxis=function(){var t=this.elements,e=t[0]*t[0]+t[1]*t[1]+t[2]*t[2],r=t[4]*t[4]+t[5]*t[5]+t[6]*t[6],n=t[8]*t[8]+t[9]*t[9]+t[10]*t[10];return Math.sqrt(Math.max(e,r,n))},t.prototype.makeTranslationXYZ=function(t,e,r){return this.set(1,0,0,t,0,1,0,e,0,0,1,r,0,0,0,1),this},t.prototype.makeTranslationVector=function(t){return this.makeTranslationXYZ(t.x,t.y,t.z)},t.prototype.makeRotationX=function(t){var e=Math.cos(t),r=Math.sin(t);return this.set(1,0,0,0,0,e,-r,0,0,r,e,0,0,0,0,1),this},t.prototype.makeRotationY=function(t){var e=Math.cos(t),r=Math.sin(t);return this.set(e,0,r,0,0,1,0,0,-r,0,e,0,0,0,0,1),this},t.prototype.makeRotationZ=function(t){var e=Math.cos(t),r=Math.sin(t);return this.set(e,-r,0,0,r,e,0,0,0,0,1,0,0,0,0,1),this},t.prototype.makeRotationAxis=function(t,e){var r=Math.cos(e),n=Math.sin(e),i=1-r,o=t.x,s=t.y,a=t.z,u=i*o,p=i*s;return this.set(u*o+r,u*s-n*a,u*a+n*s,0,u*s+n*a,p*s+r,p*a-n*o,0,u*a-n*s,p*a+n*o,i*a*a+r,0,0,0,0,1),this},t.prototype.makeScaleXYZ=function(t,e,r){return this.set(t,0,0,0,0,e,0,0,0,0,r,0,0,0,0,1),this},t.prototype.makeScaleVector=function(t){return this.makeScaleXYZ(t.x,t.y,t.z)},t.prototype.makeShearXYZ=function(t,e,r){return this.set(1,e,r,0,t,1,r,0,t,e,1,0,0,0,0,1),this},t.prototype.makeShearVector=function(t){return this.makeShearXYZ(t.x,t.y,t.z)},t.prototype.makeMatrix3=function(t){return this.elements[0]=t.elements[0],this.elements[1]=t.elements[1],this.elements[2]=t.elements[2],this.elements[4]=t.elements[3],this.elements[5]=t.elements[4],this.elements[6]=t.elements[5],this.elements[8]=t.elements[6],this.elements[9]=t.elements[7],this.elements[10]=t.elements[8],this.triggerNotify(),this},t.prototype.compose=function(t,e,r){var n=this.elements,i=e.x,o=e.y,s=e.z,a=e.w,u=i+i,p=o+o,h=s+s,c=i*u,l=i*p,f=i*h,y=o*p,d=o*h,_=s*h,m=a*u,g=a*p,v=a*h,x=r.x,b=r.y,S=r.z;return n[0]=(1-(y+_))*x,n[1]=(l+v)*x,n[2]=(f-g)*x,n[3]=0,n[4]=(l-v)*b,n[5]=(1-(c+_))*b,n[6]=(d+m)*b,n[7]=0,n[8]=(f+g)*S,n[9]=(d-m)*S,n[10]=(1-(c+y))*S,n[11]=0,n[12]=t.x,n[13]=t.y,n[14]=t.z,n[15]=1,this.triggerNotify(),this},t.prototype.decompose=function(t,e,r){var n=this.elements,i=p.MathTmp.Vector3[0].set(n[0],n[1],n[2]).length(),o=p.MathTmp.Vector3[0].set(n[4],n[5],n[6]).length(),s=p.MathTmp.Vector3[0].set(n[8],n[9],n[10]).length();this.determinant()<0&&(i=-i),t&&(t.x=n[12],t.y=n[13],t.z=n[14]),p.MathTmp.Matrix4[0].copy(this);var a=1/i,u=1/o,h=1/s;return p.MathTmp.Matrix4[0].elements[0]*=a,p.MathTmp.Matrix4[0].elements[1]*=a,p.MathTmp.Matrix4[0].elements[2]*=a,p.MathTmp.Matrix4[0].elements[4]*=u,p.MathTmp.Matrix4[0].elements[5]*=u,p.MathTmp.Matrix4[0].elements[6]*=u,p.MathTmp.Matrix4[0].elements[8]*=h,p.MathTmp.Matrix4[0].elements[9]*=h,p.MathTmp.Matrix4[0].elements[10]*=h,e&&e.setFromRotationMatrix(p.MathTmp.Matrix4[0]),r&&(r.x=i,r.y=o,r.z=s),this},t.prototype.makePerspective=function(t,e,r,n,i,o){var s=this.elements,a=2*i/(e-t),u=2*i/(r-n),p=(e+t)/(e-t),h=(r+n)/(r-n),c=-(o+i)/(o-i),l=-2*o*i/(o-i);return s[0]=a,s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[5]=u,s[6]=0,s[7]=0,s[8]=p,s[9]=h,s[10]=c,s[11]=-1,s[12]=0,s[13]=0,s[14]=l,s[15]=0,this.triggerNotify(),this},t.prototype.makeInfinitePerspective=function(t,e,r,n,i){var o=this.elements,s=2*i/(e-t),a=2*i/(r-n),u=(e+t)/(e-t),p=(r+n)/(r-n),h=-2*i;return o[0]=s,o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=a,o[6]=0,o[7]=0,o[8]=u,o[9]=p,o[10]=-1,o[11]=-1,o[12]=0,o[13]=0,o[14]=h,o[15]=0,this.triggerNotify(),this},t.prototype.makeOrthographic=function(t,e,r,n,i,o){var s=this.elements,a=1/(e-t),u=1/(r-n),p=1/(o-i),h=(e+t)*a,c=(r+n)*u,l=(o+i)*p;return s[0]=2*a,s[4]=0,s[8]=0,s[12]=-h,s[1]=0,s[5]=2*u,s[9]=0,s[13]=-c,s[2]=0,s[6]=0,s[10]=-2*p,s[14]=-l,s[3]=0,s[7]=0,s[11]=0,s[15]=1,this.triggerNotify(),this},t.prototype.makeViewportTransformation=function(t,e,r,n,i,o){void 0===i&&(i=1),void 0===o&&(o=1);var s=.5*r,a=.5*n,u=.5*(o-i),p=s,h=a,c=u,l=t+s,f=e+a,y=i+u,d=this.elements;return d[0]=p,d[1]=0,d[2]=0,d[3]=0,d[4]=0,d[5]=h,d[6]=0,d[7]=0,d[8]=0,d[9]=0,d[10]=c,d[11]=0,d[12]=l,d[13]=f,d[14]=y,d[15]=1,this.triggerNotify(),this},t.prototype.makeView=function(t,e,r,n){var i=this.elements;return i[0]=n.x,i[1]=r.x,i[2]=-e.x,i[3]=0,i[4]=n.y,i[5]=r.y,i[6]=-e.y,i[7]=0,i[8]=n.z,i[9]=r.z,i[10]=-e.z,i[11]=0,i[12]=-n.dot(t),i[13]=-r.dot(t),i[14]=e.dot(t),i[15]=1,this.triggerNotify(),this},t.prototype.applyToBufferAttribute=function(t){for(var e=0,r=t.count;e<r;e++)p.MathTmp.Vector3[0].x=t.getX(e),p.MathTmp.Vector3[0].y=t.getY(e),p.MathTmp.Vector3[0].z=t.getZ(e),p.MathTmp.Vector3[0].applyMatrix4(this),t.setXYZ(e,p.MathTmp.Vector3[0].x,p.MathTmp.Vector3[0].y,p.MathTmp.Vector3[0].z);return t},t.prototype.equals=function(t){for(var e=this.elements,r=t.elements,n=0;n<16;n++)if(e[n]!=r[n])return!1;return!0},t.prototype.equalsEpsilon=function(t,e,r){void 0===r&&(r=null);for(var n=this.elements,i=t.elements,o=0;o<16;o++)if(!u.MathUtils.equalsEpsilon(n[o],i[o],e,r))return!1;return!0},t.prototype.fromArray=function(t,e){void 0===e&&(e=0);for(var r=0;r<16;r++)this.elements[r]=t[r+e];return this.triggerNotify(),this},t.prototype.toArray=function(t,e){void 0===t&&(t=[]),void 0===e&&(e=0);var r=this.elements;return t[e]=r[0],t[e+1]=r[1],t[e+2]=r[2],t[e+3]=r[3],t[e+4]=r[4],t[e+5]=r[5],t[e+6]=r[6],t[e+7]=r[7],t[e+8]=r[8],t[e+9]=r[9],t[e+10]=r[10],t[e+11]=r[11],t[e+12]=r[12],t[e+13]=r[13],t[e+14]=r[14],t[e+15]=r[15],t},t.prototype.fromDataBuffer=function(t){for(var e=0;e<16;e++)this.elements[e]=t.readFloat32();return this.triggerNotify(),this},t.prototype.toDataBuffer=function(t){for(var e=0;e<16;e++)t.writeFloat32(this.elements[e]);return this},t._identityReadOnly=new t,t}();e.Matrix4=h},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Matrix3=void 0;var n=r(0),i=r(1),o=r(5),s=function(){function t(t){void 0===t&&(t=[]),this._notify=!0,this._onNotify=null,this.elements=[1,0,0,0,1,0,0,0,1],t.length>0&&this.fromArray(t)}return t.Build=function(){return new t},t.getElementIndex=function(t,e){return 3*t+e},Object.defineProperty(t,"IDENTITY",{get:function(){return t._identityReadOnly},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"notify",{get:function(){return this._notify},set:function(t){this._notify=t},enumerable:!1,configurable:!0}),t.prototype.setNotifyFunc=function(t){return this._onNotify=t,this},t.prototype.triggerNotify=function(){this._notify&&this._onNotify&&this._onNotify()},t.prototype.set=function(t,e,r,n,i,o,s,a,u){var p=this.elements;return p[0]=t,p[1]=n,p[2]=s,p[3]=e,p[4]=i,p[5]=a,p[6]=r,p[7]=o,p[8]=u,this.triggerNotify(),this},t.prototype.isIdentity=function(){return this.equals(t.IDENTITY)},t.prototype.identity=function(){return this.set(1,0,0,0,1,0,0,0,1),this},t.prototype.clone=function(){return(new t).copy(this)},t.prototype.copy=function(t){var e=this.elements,r=t.elements;return e[0]=r[0],e[1]=r[1],e[2]=r[2],e[3]=r[3],e[4]=r[4],e[5]=r[5],e[6]=r[6],e[7]=r[7],e[8]=r[8],this.triggerNotify(),this},t.prototype.setFromRotationX=function(t){var e=Math.cos(t),r=Math.sin(t),n=this.elements;return n[0]=1,n[1]=0,n[2]=0,n[3]=0,n[4]=e,n[5]=r,n[6]=0,n[7]=-r,n[8]=e,this.triggerNotify(),this},t.prototype.setFromRotationY=function(t){var e=Math.cos(t),r=Math.sin(t),n=this.elements;return n[0]=e,n[1]=r,n[2]=0,n[3]=-r,n[4]=e,n[5]=0,n[6]=0,n[7]=0,n[8]=1,this.triggerNotify(),this},t.prototype.setFromRotationZ=function(t){var e=Math.cos(t),r=Math.sin(t),n=this.elements;return n[0]=e,n[1]=0,n[2]=-r,n[3]=0,n[4]=1,n[5]=0,n[6]=r,n[7]=0,n[8]=e,this.triggerNotify(),this},t.prototype.setFromMatrix4=function(t){var e=t.elements;return this.set(e[0],e[4],e[8],e[1],e[5],e[9],e[2],e[6],e[10]),this},t.prototype.extractBasis=function(t,e,r){void 0===t&&(t=new n.Vector3),void 0===e&&(e=new n.Vector3),void 0===r&&(r=new n.Vector3);var i=this.elements;return t.fromArray(i,0),e.fromArray(i,3),r.fromArray(i,6),this},t.prototype.makeBasis=function(t,e,r){return this.set(t.x,e.x,r.x,t.y,e.y,r.y,t.z,e.z,r.z),this},t.prototype.getX=function(t){return void 0===t&&(t=new n.Vector3),t.set(this.elements[0],this.elements[1],this.elements[2])},t.prototype.getY=function(t){return void 0===t&&(t=new n.Vector3),t.set(this.elements[3],this.elements[4],this.elements[5])},t.prototype.getZ=function(t){return void 0===t&&(t=new n.Vector3),t.set(this.elements[6],this.elements[7],this.elements[8])},t.prototype.getElement=function(e,r){var n=t.getElementIndex(e,r);return this.elements[n]},t.prototype.setElement=function(e,r,n){var i=t.getElementIndex(e,r);return this.elements[i]=n,this.triggerNotify(),this},t.prototype.getColumn=function(t,e){void 0===e&&(e=new n.Vector3);var r=3*t,i=this.elements[r],o=this.elements[r+1],s=this.elements[r+2];return e.x=i,e.y=o,e.z=s,e},t.prototype.setColumn=function(t,e){var r=3*t;return this.elements[r]=e.x,this.elements[r+1]=e.y,this.elements[r+2]=e.z,this.triggerNotify(),this},t.prototype.getRow=function(t,e){void 0===e&&(e=new n.Vector3);var r=this.elements[t],i=this.elements[t+3],o=this.elements[t+6];return e.x=r,e.y=i,e.z=o,e},t.prototype.setRow=function(t,e){return this.elements[t]=e.x,this.elements[t+3]=e.y,this.elements[t+6]=e.z,this.triggerNotify(),this},t.prototype.makeScale=function(t,e,r){return this.set(t,0,0,0,e,0,0,0,r),this},t.prototype.multiply=function(t){return this.multiplyMatrices(this,t)},t.prototype.premultiply=function(t){return this.multiplyMatrices(t,this)},t.prototype.multiplyMatrices=function(t,e){var r=t.elements,n=e.elements,i=this.elements,o=r[0],s=r[3],a=r[6],u=r[1],p=r[4],h=r[7],c=r[2],l=r[5],f=r[8],y=n[0],d=n[3],_=n[6],m=n[1],g=n[4],v=n[7],x=n[2],b=n[5],S=n[8];return i[0]=o*y+s*m+a*x,i[3]=o*d+s*g+a*b,i[6]=o*_+s*v+a*S,i[1]=u*y+p*m+h*x,i[4]=u*d+p*g+h*b,i[7]=u*_+p*v+h*S,i[2]=c*y+l*m+f*x,i[5]=c*d+l*g+f*b,i[8]=c*_+l*v+f*S,this.triggerNotify(),this},t.prototype.multiplyScalar=function(t){var e=this.elements;return e[0]*=t,e[3]*=t,e[6]*=t,e[1]*=t,e[4]*=t,e[7]*=t,e[2]*=t,e[5]*=t,e[8]*=t,this.triggerNotify(),this},t.prototype.multiplyScalarVector=function(t){var e=this.elements;return e[0]*=t.x,e[1]*=t.x,e[2]*=t.x,e[3]*=t.y,e[4]*=t.y,e[5]*=t.y,e[6]*=t.z,e[7]*=t.z,e[8]*=t.z,this.triggerNotify(),this},t.prototype.determinant=function(){var t=this.elements,e=t[0],r=t[1],n=t[2],i=t[3],o=t[4],s=t[5],a=t[6],u=t[7],p=t[8];return e*o*p-e*s*u-r*i*p+r*s*a+n*i*u-n*o*a},t.prototype.inverse=function(){return this.getInverse(this)},t.prototype.getInverse=function(t){var e=t.elements,r=this.elements,n=e[0],i=e[1],o=e[2],s=e[3],a=e[4],u=e[5],p=e[6],h=e[7],c=e[8],l=c*a-u*h,f=u*p-c*s,y=h*s-a*p,d=n*l+i*f+o*y;if(0==d)return this.identity();var _=1/d;return r[0]=l*_,r[1]=(o*h-c*i)*_,r[2]=(u*i-o*a)*_,r[3]=f*_,r[4]=(c*n-o*p)*_,r[5]=(o*s-u*n)*_,r[6]=y*_,r[7]=(i*p-h*n)*_,r[8]=(a*n-i*s)*_,this.triggerNotify(),this},t.prototype.transpose=function(){var t,e=this.elements;return t=e[1],e[1]=e[3],e[3]=t,t=e[2],e[2]=e[6],e[6]=t,t=e[5],e[5]=e[7],e[7]=t,this.triggerNotify(),this},t.prototype.getNormalMatrix=function(t){return this.setFromMatrix4(t).getInverse(this).transpose()},t.prototype.setUvTransform=function(t,e,r,n,i,o,s){var a=Math.cos(i),u=Math.sin(i);return this.set(r*a,r*u,-r*(a*o+u*s)+o+t,-n*u,n*a,-n*(-u*o+a*s)+s+e,0,0,1)},t.prototype.scale=function(t,e){var r=this.elements,n=t,i=e;return r[0]*=n,r[3]*=n,r[6]*=n,r[1]*=i,r[4]*=i,r[7]*=i,this.triggerNotify(),this},t.prototype.rotate=function(t){var e=Math.cos(t),r=Math.sin(t),n=this.elements,i=n[0],o=n[3],s=n[6],a=n[1],u=n[4],p=n[7];return n[0]=e*i+r*a,n[3]=e*o+r*u,n[6]=e*s+r*p,n[1]=-r*i+e*a,n[4]=-r*o+e*u,n[7]=-r*s+e*p,this.triggerNotify(),this},t.prototype.translate=function(t,e){var r=this.elements,n=t,i=e;return r[0]+=n*r[2],r[3]+=n*r[5],r[6]+=n*r[8],r[1]+=i*r[2],r[4]+=i*r[5],r[7]+=i*r[8],this.triggerNotify(),this},t.prototype.makeRotationFromQuaternion=function(t){var e=this.elements,r=t.x,n=t.y,i=t.z,o=t.w,s=r+r,a=n+n,u=i+i,p=r*s,h=r*a,c=r*u,l=n*a,f=n*u,y=i*u,d=o*s,_=o*a,m=o*u;return e[0]=1-(l+y),e[1]=h+m,e[2]=c-_,e[3]=h-m,e[4]=1-(p+y),e[5]=f+d,e[6]=c+_,e[7]=f-d,e[8]=1-(p+l),this.triggerNotify(),this},t.prototype.applyToBufferAttribute=function(t){for(var e=0,r=t.count;e<r;e++)o.MathTmp.Vector3[0].x=t.getX(e),o.MathTmp.Vector3[0].y=t.getY(e),o.MathTmp.Vector3[0].z=t.getZ(e),o.MathTmp.Vector3[0].applyMatrix3(this),t.setXYZ(e,o.MathTmp.Vector3[0].x,o.MathTmp.Vector3[0].y,o.MathTmp.Vector3[0].z);return t},t.prototype.equals=function(t){for(var e=this.elements,r=t.elements,n=0;n<9;n++)if(e[n]!=r[n])return!1;return!0},t.prototype.equalsEpsilon=function(t,e,r){void 0===r&&(r=null);for(var n=this.elements,o=t.elements,s=0;s<9;s++)if(!i.MathUtils.equalsEpsilon(n[s],o[s],e,r))return!1;return!0},t.prototype.fromArray=function(t,e){void 0===e&&(e=0);for(var r=0;r<9;r++)this.elements[r]=t[r+e];return this.triggerNotify(),this},t.prototype.toArray=function(t,e){void 0===t&&(t=[]),void 0===e&&(e=0);var r=this.elements;return t[e]=r[0],t[e+1]=r[1],t[e+2]=r[2],t[e+3]=r[3],t[e+4]=r[4],t[e+5]=r[5],t[e+6]=r[6],t[e+7]=r[7],t[e+8]=r[8],t},t.prototype.fromDataBuffer=function(t){for(var e=0;e<9;e++)this.elements[e]=t.readFloat32();return this.triggerNotify(),this},t.prototype.toDataBuffer=function(t){for(var e=0;e<9;e++)t.writeFloat32(this.elements[e]);return this},t._identityReadOnly=new t,t}();e.Matrix3=s},function(t,e,r){"use strict";var n;Object.defineProperty(e,"__esModule",{value:!0}),e.Intervals=e.IntervalsType=void 0,function(t){t[t.isEmpty=0]="isEmpty",t[t.isPoint=1]="isPoint",t[t.isFinite=2]="isFinite",t[t.isPositiveInfinite=3]="isPositiveInfinite",t[t.isNegativeInfinite=4]="isNegativeInfinite",t[t.isDynamicQuery=5]="isDynamicQuery"}(n=e.IntervalsType||(e.IntervalsType={}));var i=function(){function t(){}return t.staticQuery=function(t,e){var r={intersect:!1,numIntersections:0,overlap:[0,0],type:n.isEmpty};return t[1]<e[0]||t[0]>e[1]?(r.numIntersections=0,r.overlap[0]=0,r.overlap[1]=0,r.type=n.isEmpty):t[1]>e[0]?t[0]<e[1]?(r.overlap[0]=t[0]<e[0]?e[0]:t[0],r.overlap[1]=t[1]>e[1]?e[1]:t[1],r.overlap[0]<r.overlap[1]?(r.numIntersections=2,r.type=n.isFinite):(r.numIntersections=1,r.type=n.isPoint)):(r.numIntersections=1,r.overlap[0]=t[0],r.overlap[1]=r.overlap[0],r.type=n.isPoint):(r.numIntersections=1,r.overlap[0]=t[1],r.overlap[1]=r.overlap[0],r.type=n.isPoint),r.intersect=r.numIntersections>0,r},t}();e.Intervals=i},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Sphere=void 0;var n=r(65),i=r(0),o=r(25),s=r(5),a=function(){function t(t,e){void 0===t&&(t=null),void 0===e&&(e=null),this.center=new i.Vector3,this.radius=0,t&&this.center.copy(t),e&&(this.radius=e)}return t.Build=function(){return new t},t.prototype.set=function(t,e){return this.center.copy(t),this.radius=e,this},t.prototype.setFromPoints=function(t,e){void 0===e&&(e=null);var r=this.center;e?r.copy(e):s.MathTmp.Box3[0].setFromPoints(t).getCenter(r);for(var n=0,i=0,o=t.length;i<o;i++)n=Math.max(n,r.distanceToSquared(t[i]));return this.radius=Math.sqrt(n),this},t.prototype.clone=function(){return(new t).copy(this)},t.prototype.copy=function(t){return this.center.copy(t.center),this.radius=t.radius,this},t.prototype.empty=function(){return this.radius<=0},t.prototype.makeEmpty=function(){return this.center.set(0,0,0),this.radius=0,this},t.prototype.containsPoint=function(t){return t.distanceToSquared(this.center)<=this.radius*this.radius},t.prototype.containsSphere=function(t){return this.containsPoint(t.center)&&this.radius>=t.radius},t.prototype.containsBox=function(e){var r=new t;return e.getBoundingSphere(r),this.containsSphere(r)},t.prototype.distanceToPoint=function(t){return t.distanceTo(this.center)-this.radius},t.prototype.intersectsSphere=function(t){var e=this.radius+t.radius;return t.center.distanceToSquared(this.center)<=e*e},t.prototype.intersectSphere=function(e){var r=e,o=s.MathTmp.Vector3[0].subVectors(r.center,this.center),a=o.dot(o),u=this.radius,p=r.radius,h=u+p,c=h*h;if(a>c)return{intersect:!1,type:n.SphereSphereIntersectType.NONE};if(a==c)return{intersect:!0,type:n.SphereSphereIntersectType.POINT,point:(new i.Vector3).copy(this.center).add(o.normalize().multiplyScalar(u))};var l=u-p,f=l*l;if(a<f)return{intersect:!0,type:l<=0?n.SphereSphereIntersectType.SPHERE:n.SphereSphereIntersectType.SPHERE1_IN_SPHERE0,point:(new i.Vector3).addVectors(this.center,r.center).multiplyScalar(.5)};if(a==f){var y={intersect:!0,type:0,point:new i.Vector3};return l<=0?(y.type=n.SphereSphereIntersectType.SPHERE0_IN_SPHERE1_POINT,y.point.copy(r.center).add(o.normalize().multiplyScalar(p))):(y.type=n.SphereSphereIntersectType.SPHERE1_IN_SPHERE0_POINT,y.point.copy(this.center).add(o.normalize().multiplyScalar(u))),y}var d=.5*(1+l*h/a),_={intersect:!0,type:n.SphereSphereIntersectType.SPHERE,circle:new t};return _.circle.center.copy(this.center).add(s.MathTmp.Vector3[0].copy(o).multiplyScalar(d)),_.circle.radius=Math.sqrt(Math.max(u*u-d*d*a,0)),_},t.prototype.intersecsTriangle=function(t){return t.distanceToPoint(this.center,s.MathTmp.Vector3[0])<this.radius},t.prototype.intersectTriangle=function(t){var e=new i.Vector3;return{intersect:t.distanceToPoint(this.center,e)<this.radius,point:e}},t.prototype.clampPoint=function(t,e){void 0===e&&(e=new i.Vector3);var r=this.center.distanceToSquared(t);return e.copy(t),r>this.radius*this.radius&&(e.sub(this.center).normalize(),e.multiplyScalar(this.radius).add(this.center)),e},t.prototype.getBoundingBox=function(t){return void 0===t&&(t=new o.Box3),t.set(this.center,this.center),t.expandByScalar(this.radius),t},t.prototype.applyMatrix4=function(t){return this.center.applyMatrix4(t),this.radius=this.radius*t.getMaxScaleOnAxis(),this},t.prototype.translate=function(t){return this.center.add(t),this},t.prototype.equals=function(t){return t.center.equals(this.center)&&t.radius==this.radius},t.prototype.toArray=function(t,e){return void 0===e&&(e=0),this.center.toArray(t,e),t[e+3]=this.radius,t},t.prototype.fromArray=function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),this.center.fromArray(t,e),this.radius=t[e+3],this},t}();e.Sphere=a},function(t,e,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(t,e,r,n){void 0===n&&(n=r),Object.defineProperty(t,n,{enumerable:!0,get:function(){return e[r]}})}:function(t,e,r,n){void 0===n&&(n=r),t[n]=e[r]}),i=this&&this.__exportStar||function(t,e){for(var r in t)"default"===r||e.hasOwnProperty(r)||n(e,t,r)};Object.defineProperty(e,"__esModule",{value:!0}),i(r(113),e),i(r(114),e)},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.BufferAttribute=void 0;var n=r(11),i=r(80),o=r(2),s=new(r(0).Vector3),a=new o.Vector2,u=function(){function t(t,e,r){void 0===r&&(r=!1),this.name="",this.type=0,this.array=t,this.itemSize=e,this.count=null!=t?t.length/e:0,this.normalized=r,this.type=i.DataTypeFormat.dataTypeFromTypedArray(t),this.target=n.Constants.ArrayBufferTarget,this.usage=n.Constants.StaticDrawUsage,this.updateRange={offset:0,count:-1},this._version=0,this._reference=0,this._glBuffer=null}return Object.defineProperty(t.prototype,"glBuffer",{get:function(){return this._glBuffer},set:function(t){this._glBuffer!=t&&(this._glBuffer&&this._glBuffer.dispose(),this._glBuffer=t,this._glBuffer&&this._glBuffer.addReference())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"version",{get:function(){return this._version},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"reference",{get:function(){return this._reference},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"needsUpdate",{set:function(t){t&&this._version++},enumerable:!1,configurable:!0}),t.prototype.dispose=function(){this._reference--,0==this._reference&&this._glBuffer&&(this._glBuffer.dispose(),this._glBuffer=null)},t.prototype.addReference=function(){this._reference++},t.prototype.setArray=function(t){return this.array=t,this.count=this.array.length/this.itemSize,this},t.prototype.setUsage=function(t){return this.usage=t,this},t.prototype.clone=function(){return new t(this.array,this.itemSize,this.normalized).copy(this)},t.prototype.copy=function(t){var e=i.DataTypeFormat.typedArrayFromDataType(t.type);return this.name=t.name,this.itemSize=t.itemSize,this.count=t.count,this.normalized=t.normalized,this.usage=t.usage,e&&(this.array=new e(t.array),this.type=t.type),this},t.prototype.copyAt=function(t,e,r){t*=this.itemSize,r*=e.itemSize;for(var n=0,i=this.itemSize;n<i;n++)this.array[t+n]=e.array[r+n];return this},t.prototype.copyArray=function(t){return this.array.set(t),this.count=this.array.length/this.itemSize,this},t.prototype.copyColorRGBsArray=function(t){for(var e=this.array,r=0,n=0,i=t.length;n<i;n++){var o=t[n];e[r++]=o.r,e[r++]=o.g,e[r++]=o.b}return this},t.prototype.copyColorRGBAsArray=function(t){for(var e=this.array,r=0,n=0,i=t.length;n<i;n++){var o=t[n];e[r++]=o.r,e[r++]=o.g,e[r++]=o.b,e[r++]=o.a}return this},t.prototype.copyVector2sArray=function(t){for(var e=this.array,r=0,n=0,i=t.length;n<i;n++){var o=t[n];e[r++]=o.x,e[r++]=o.y}return this},t.prototype.copyVector3sArray=function(t){for(var e=this.array,r=0,n=0,i=t.length;n<i;n++){var o=t[n];e[r++]=o.x,e[r++]=o.y,e[r++]=o.z}return this},t.prototype.copyVector4sArray=function(t){for(var e=this.array,r=0,n=0,i=t.length;n<i;n++){var o=t[n];e[r++]=o.x,e[r++]=o.y,e[r++]=o.z,e[r++]=o.w}return this},t.prototype.applyMatrix3=function(t){if(2==this.itemSize)for(var e=0,r=this.count;e<r;e++)a.fromBufferAttribute(this,e),a.applyMatrix3(t),this.setXY(e,a.x,a.y);else if(3==this.itemSize)for(e=0,r=this.count;e<r;e++)s.fromBufferAttribute(this,e),s.applyMatrix3(t),this.setXYZ(e,s.x,s.y,s.z);return this},t.prototype.applyMatrix4=function(t){if(3==this.itemSize)for(var e=0,r=this.count;e<r;e++)s.fromBufferAttribute(this,e),s.applyMatrix4(t),this.setXYZ(e,s.x,s.y,s.z);return this},t.prototype.applyNormalMatrix=function(t){if(3==this.itemSize)for(var e=0,r=this.count;e<r;e++)s.fromBufferAttribute(this,e),s.applyNormalMatrix(t),this.setXYZ(e,s.x,s.y,s.z);return this},t.prototype.transformDirection=function(t){if(3==this.itemSize)for(var e=0,r=this.count;e<r;e++)s.fromBufferAttribute(this,e),t.transformVector3(s,s),this.setXYZ(e,s.x,s.y,s.z);return this},t.prototype.transformPoint=function(t){if(3==this.itemSize)for(var e=0,r=this.count;e<r;e++)s.fromBufferAttribute(this,e),t.transformPoint(s,s),this.setXYZ(e,s.x,s.y,s.z);return this},t.prototype.get=function(t){return this.array[t]},t.prototype.set=function(t,e){return void 0===e&&(e=0),this.array.set(t,e),this},t.prototype.getX=function(t){return this.array[t*this.itemSize]},t.prototype.setX=function(t,e){return this.array[t*this.itemSize]=e,this},t.prototype.getY=function(t){return this.array[t*this.itemSize+1]},t.prototype.setY=function(t,e){return this.array[t*this.itemSize+1]=e,this},t.prototype.getZ=function(t){return this.array[t*this.itemSize+2]},t.prototype.setZ=function(t,e){return this.array[t*this.itemSize+2]=e,this},t.prototype.getW=function(t){return this.array[t*this.itemSize+3]},t.prototype.setW=function(t,e){return this.array[t*this.itemSize+3]=e,this},t.prototype.setXY=function(t,e,r){return t*=this.itemSize,this.array[t+0]=e,this.array[t+1]=r,this},t.prototype.setXYZ=function(t,e,r,n){return t*=this.itemSize,this.array[t+0]=e,this.array[t+1]=r,this.array[t+2]=n,this},t.prototype.setXYZW=function(t,e,r,n,i){return t*=this.itemSize,this.array[t+0]=e,this.array[t+1]=r,this.array[t+2]=n,this.array[t+3]=i,this},t.prototype.toJSON=function(){return{itemSize:this.itemSize,type:this.type,array:Array.prototype.slice.call(this.array),normalized:this.normalized}},t.prototype.serializeBinary=function(t){switch(t.writeUint8(1),t.writeUint8(this.itemSize),t.writeBoolean(this.normalized),t.writeUint32(this.type),t.writeString(this.name),t.writeUint32(this.array.length),this.type){case n.Constants.ByteType:for(var e=0;e<this.array.length;++e)t.writeInt8(this.array[e]);break;case n.Constants.UnsignedByteType:for(e=0;e<this.array.length;++e)t.writeUint8(this.array[e]);break;case n.Constants.ShortType:for(e=0;e<this.array.length;++e)t.writeInt16(this.array[e]);break;case n.Constants.UnsignedShortType:for(e=0;e<this.array.length;++e)t.writeUint16(this.array[e]);break;case n.Constants.IntType:for(e=0;e<this.array.length;++e)t.writeInt32(this.array[e]);break;case n.Constants.UnsignedIntType:for(e=0;e<this.array.length;++e)t.writeUint32(this.array[e]);break;case n.Constants.FloatType:for(e=0;e<this.array.length;++e)t.writeFloat32(this.array[e]);break;case n.Constants.DoubleType:for(e=0;e<this.array.length;++e)t.writeFloat64(this.array[e])}},t.prototype.deserializeBinary=function(t){t.readUint8();this.itemSize=t.readUint8(),this.normalized=t.readBoolean(),this.type=t.readUint32(),this.name=t.readString();var e=t.readUint32();switch(this.count=e/this.itemSize,this.type){case n.Constants.ByteType:this.array=new Int8Array(e);for(var r=0;r<e;++r)this.array[r]=t.readInt8();break;case n.Constants.UnsignedByteType:this.array=new Uint8Array(e);for(r=0;r<e;++r)this.array[r]=t.readUint8();break;case n.Constants.ShortType:this.array=new Int8Array(e);for(r=0;r<e;++r)this.array[r]=t.readInt16();break;case n.Constants.UnsignedShortType:this.array=new Int16Array(e);for(r=0;r<e;++r)this.array[r]=t.readUint16();break;case n.Constants.IntType:this.array=new Int32Array(e);for(r=0;r<e;++r)this.array[r]=t.readInt32();break;case n.Constants.UnsignedIntType:this.array=new Uint32Array(e);for(r=0;r<e;++r)this.array[r]=t.readUint32();break;case n.Constants.FloatType:this.array=new Float32Array(e);for(r=0;r<e;++r)this.array[r]=t.readFloat32();break;case n.Constants.DoubleType:this.array=new Float64Array(e);for(r=0;r<e;++r)this.array[r]=t.readFloat64()}},t}();e.BufferAttribute=u},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Texture=void 0;var n=r(4),i=r(12),o=function(){function t(){this.uuid=n.MathUtils.generateUUID(),this.name="",this.format=i.Constants.RGBAFormat,this.type=i.Constants.UnsignedByteType,this.encoding=i.Constants.LinearEncoding,this.mapping=i.Constants.UVMapping,this.unpackAlignment=4,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this._wrapU=i.Constants.ClampToEdgeWrapping,this._wrapV=i.Constants.ClampToEdgeWrapping,this._wrapR=i.Constants.ClampToEdgeWrapping,this._filter=i.Constants.LinearLinearMipLinearFilter,this._anisotropy=1,this._flipY=!0,this._offset=new n.Vector2(0,0),this._repeat=new n.Vector2(1,1),this._center=new n.Vector2(0,0),this._rotation=0,this._matrix=new n.Matrix3,this._needsUpdateMatrix=!1,this._version=0,this._reference=0,this._glTexture=null}return Object.defineProperty(t.prototype,"isReady",{get:function(){return!0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"wrapU",{get:function(){return this._wrapU},set:function(t){this._wrapU!=t&&(this._wrapU=t,this.needsUpdate=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"wrapV",{get:function(){return this._wrapV},set:function(t){this._wrapV!=t&&(this._wrapV=t,this.needsUpdate=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"wrapR",{get:function(){return this._wrapR},set:function(t){this._wrapR!=t&&(this._wrapR=t,this.needsUpdate=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"filter",{get:function(){return this._filter},set:function(t){this._filter!=t&&(this._filter=t,this.needsUpdate=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"flipY",{get:function(){return this._flipY},set:function(t){this._flipY!=t&&(this._flipY=t,this.needsUpdate=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"anisotropy",{get:function(){return this._anisotropy},set:function(t){this._anisotropy!=t&&(this._anisotropy=t,this.needsUpdate=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"offset",{get:function(){return this._offset},set:function(t){this._offset.equals(t)||(this._offset=t,this._needsUpdateMatrix=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"repeat",{get:function(){return this._repeat},set:function(t){this._repeat.equals(t)||(this._repeat=t,this._needsUpdateMatrix=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"center",{get:function(){return this._center},set:function(t){this._center.equals(t)||(this._center=t,this._needsUpdateMatrix=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"rotation",{get:function(){return this._rotation},set:function(t){this._rotation!=t&&(this._rotation=t,this._needsUpdateMatrix=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"matrix",{get:function(){return this._needsUpdateMatrix&&this.updateMatrix(),this._matrix},set:function(t){this._matrix.copy(t)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"version",{get:function(){return this._version},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"glTexture",{get:function(){return this._glTexture},set:function(t){this._glTexture!=t&&(this._glTexture&&this._glTexture.addReference(),this._glTexture=t,this._glTexture&&this._glTexture.dispose())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"needsUpdate",{set:function(t){t&&this._version++},enumerable:!1,configurable:!0}),t.prototype.updateMatrix=function(){this._needsUpdateMatrix=!1,this._matrix.setUvTransform(this._offset.x,this._offset.y,this._repeat.x,this._repeat.y,this._rotation,this._center.x,this._center.y)},t.prototype.addReference=function(){this._reference++},t.prototype.releaseGLTexture=function(){this._glTexture&&(this._glTexture.dispose(),this._glTexture=null)},t.prototype.clone=function(){return(new t).copy(this)},t.prototype.copy=function(t){return this.name=t.name,this.format=t.format,this.type=t.type,this.mapping=t.mapping,this.generateMipmaps=t.generateMipmaps,this.premultiplyAlpha=t.premultiplyAlpha,this.unpackAlignment=t.unpackAlignment,this.encoding=t.encoding,this._offset.copy(t.offset),this._repeat.copy(t.repeat),this._center.copy(t.center),this._rotation=t.rotation,this._matrix.copy(t.matrix),this._flipY=t.flipY,this._wrapU=t.wrapU,this._wrapV=t.wrapV,this._wrapR=t.wrapR,this._filter=t.filter,this._anisotropy=t.anisotropy,this},t.prototype.dispose=function(){this._reference--,0==this._reference&&this.releaseGLTexture()},t}();e.Texture=o},function(t,e,r){"use strict";var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(e,"__esModule",{value:!0}),e.TransformObject=void 0;var o=r(1),s=r(4),a=r(5),u=function(t){function e(e,r,n,i){void 0===r&&(r=null),void 0===n&&(n=""),void 0===i&&(i=!0);var o=t.call(this,e,r,n)||this;return o._position=new s.Vector3,o._rotation=new s.Euler,o._quaternion=new s.Quaternion,o._scale=new s.Vector3(1,1,1),o._matrix=new s.Matrix4,o._matrixWorld=new s.Matrix4,o._pivotMatrix=new s.Matrix4,o._matrixWorldInverse=new s.Matrix4,o._pivotMatrixInverse=new s.Matrix4,o._normalMatrix=new s.Matrix3,o._modelViewMatrix=new s.Matrix4,o._modelViewProjectionMatrix=new s.Matrix4,o._transModelViewMatrix=new s.Matrix4,o._transModelViewMatrixInverse=new s.Matrix4,o._modelViewRelativeMatrix=new s.Matrix4,o._modelViewProjectionRelativeMatrix=new s.Matrix4,o._lastPosition=new s.Vector3,o._lastRotation=new s.Euler,o._lastQuaternion=new s.Quaternion,o._lastScale=new s.Vector3(1,1,1),o._lastMatrix=new s.Matrix4,o._lastMatrixWorld=new s.Matrix4,o._lastPivotMatrix=new s.Matrix4,o._tempPosition=new s.Vector3,o._tempRotation=new s.Euler,o._tempQuaternion=new s.Quaternion,o._tempScale=new s.Vector3(1,1,1),o._tempMatrix=new s.Matrix4,o._tempMatrixWorld=new s.Matrix4,o._tempPivotMatrix=new s.Matrix4,o._usePivotMatrix=!1,o._matrixNeedsUpdate=!0,o._matrixWorldNeedsUpdate=!0,o._position.setNotifyFunc(o._onPositionChange.bind(o)),o._rotation.setNotifyFunc(o._onRotationChange.bind(o)),o._quaternion.setNotifyFunc(o._onQuaternionChange.bind(o)),o._scale.setNotifyFunc(o._onScaleChange.bind(o)),o._matrix.setNotifyFunc(o._onMatrixChange.bind(o)),o._matrixWorld.setNotifyFunc(o._onMatrixWorldChange.bind(o)),o._pivotMatrix.setNotifyFunc(o._onPivotMatrixChange.bind(o)),i&&o.scene.addTransform(o),o}return i(e,t),Object.defineProperty(e.prototype,"position",{get:function(){return this._position},set:function(t){this._position.copy(t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"scale",{get:function(){return this._scale},set:function(t){this._scale.copy(t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"quaternion",{get:function(){return this._quaternion},set:function(t){this._quaternion.copy(t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"rotation",{get:function(){return this._rotation},set:function(t){this._rotation.copy(t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"visibleLayers",{get:function(){return this._visibleLayers},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"matrix",{get:function(){return this._matrix},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"matrixWorld",{get:function(){return this._matrixWorld},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"matrixWorldInverse",{get:function(){return this._matrixWorldInverse},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"usePivotMatrix",{get:function(){return this._usePivotMatrix},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"pivotMatrix",{get:function(){return this._pivotMatrix},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"pivotMatrixInverse",{get:function(){return this._pivotMatrixInverse},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"normalMatrix",{get:function(){return this._normalMatrix},set:function(t){this._normalMatrix.copy(t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"modelViewMatrix",{get:function(){return this._modelViewMatrix},set:function(t){this._modelViewMatrix.copy(t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"modelViewProjectionMatrix",{get:function(){return this._modelViewProjectionMatrix},set:function(t){this._modelViewProjectionMatrix.copy(t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"transModelViewMatrix",{get:function(){return this._transModelViewMatrix},set:function(t){this._transModelViewMatrix.copy(t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"transModelViewMatrixInverse",{get:function(){return this._transModelViewMatrixInverse},set:function(t){this._transModelViewMatrixInverse.copy(t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"modelViewRelativeMatrix",{get:function(){return this._modelViewRelativeMatrix},set:function(t){this._modelViewRelativeMatrix.copy(t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"modelViewProjectionRelativeMatrix",{get:function(){return this._modelViewProjectionRelativeMatrix},set:function(t){this._modelViewProjectionRelativeMatrix.copy(t)},enumerable:!1,configurable:!0}),e.prototype._onRotationChange=function(){this._quaternion.notify=!1,this._quaternion.setFromEuler(this._rotation),this._quaternion.notify=!0,this._rotation.equals(this._lastRotation)||(this._tempRotation.copy(this._lastRotation),this._lastRotation.copy(this._rotation),this._matrixNeedsUpdate=!0,this.onRotationChanged(this._tempRotation,this._lastRotation))},e.prototype._onQuaternionChange=function(){this._rotation.notify=!1,this._rotation.setFromQuaternion(this._quaternion,null),this._rotation.notify=!0,this._quaternion.equals(this._lastQuaternion)||(this._tempQuaternion.copy(this._lastQuaternion),this._lastQuaternion.copy(this._quaternion),this._matrixNeedsUpdate=!0,this.onQuaternionChanged(this._tempQuaternion,this._lastQuaternion))},e.prototype._onPositionChange=function(){this._position.equals(this._lastPosition)||(this._tempPosition.copy(this._lastPosition),this._lastPosition.copy(this._position),this._matrixNeedsUpdate=!0,this.onPositionChanged(this._tempPosition,this._lastPosition))},e.prototype._onScaleChange=function(){this._scale.equals(this._lastScale)||(this._tempScale.copy(this._lastScale),this._lastScale.copy(this._scale),this._matrixNeedsUpdate=!0,this.onScaleChanged(this._tempScale,this._lastScale))},e.prototype._onMatrixChange=function(){this._matrix.equals(this._lastMatrix)||(this._tempMatrix.copy(this._lastMatrix),this._lastMatrix.copy(this._matrix),this.onMatrixChanged(this._tempMatrix,this._lastMatrix))},e.prototype._onMatrixWorldChange=function(){this._matrixWorld.equals(this._lastMatrixWorld)||(this._tempMatrixWorld.copy(this._lastMatrixWorld),this._lastMatrixWorld.copy(this._matrixWorld),this.onMatrixWorldChanged(this._tempMatrixWorld,this._lastMatrixWorld))},e.prototype._onPivotMatrixChange=function(){this._pivotMatrix.equals(this._lastPivotMatrix)||(this._tempPivotMatrix.copy(this._lastPivotMatrix),this._lastPivotMatrix.copy(this._pivotMatrix),this._pivotMatrixInverse.getInverse(this._pivotMatrix),this._usePivotMatrix=!this._pivotMatrix.isIdentity(),this._matrixNeedsUpdate=!0)},e.prototype.onRotationChanged=function(t,e){},e.prototype.onQuaternionChanged=function(t,e){},e.prototype.onPositionChanged=function(t,e){},e.prototype.onScaleChanged=function(t,e){},e.prototype.onMatrixChanged=function(t,e){},e.prototype.onMatrixWorldChanged=function(t,e){},e.prototype.applyMatrix=function(t){return this.matrix.premultiply(t),this.matrix.decompose(this._position,this._quaternion,this._scale),this},e.prototype.applyQuaternion=function(t){return this._quaternion.premultiply(t),this},e.prototype.setRotationFromAxisAngle=function(t,e){return this._quaternion.setFromAxisAngle(t,e),this},e.prototype.setRotationFromEuler=function(t){return this._quaternion.setFromEuler(t),this},e.prototype.setRotationFromMatrix=function(t){return this._quaternion.setFromRotationMatrix(t),this},e.prototype.setRotationFromQuaternion=function(t){return this._quaternion.copy(t),this},e.prototype.rotateOnAxis=function(t,e){return this._tempQuaternion.setFromAxisAngle(t,e),this._quaternion.multiply(this._tempQuaternion),this},e.prototype.rotateOnWorldAxis=function(t,e){return this._tempQuaternion.setFromAxisAngle(t,e),this._quaternion.premultiply(this._tempQuaternion),this},e.prototype.rotateX=function(t){return this.rotateOnAxis(s.Vector3.UNIT_X,t)},e.prototype.rotateY=function(t){return this.rotateOnAxis(s.Vector3.UNIT_Y,t)},e.prototype.rotateZ=function(t){return this.rotateOnAxis(s.Vector3.UNIT_Z,t)},e.prototype.translateOnAxis=function(t,e){return this._tempPosition.copy(t).applyQuaternion(this._quaternion),this.position.add(this._tempPosition.multiplyScalar(e)),this},e.prototype.translateX=function(t){return this.translateOnAxis(s.Vector3.UNIT_X,t)},e.prototype.translateY=function(t){return this.translateOnAxis(s.Vector3.UNIT_Y,t)},e.prototype.translateZ=function(t){return this.translateOnAxis(s.Vector3.UNIT_Z,t)},e.prototype.setPosition=function(t){return this._position.copy(t),this},e.prototype.setScale=function(t){return this._scale.copy(t),this},e.prototype.setWorldPosition=function(t){return this._parent?this._parent.matrixWorldInverse.transformPoint(t,this._position):this._position.copy(t),this},e.prototype.setWorldRotation=function(t){return this._parent?(this._tempQuaternion.copy(this._parent.quaternion).inverse(),this._quaternion.notify=!1,this._quaternion.copy(this._tempQuaternion),this._quaternion.notify=!0,this._quaternion.multiply(t)):this._quaternion.copy(t),this},e.prototype.localToWorld=function(t,e){return void 0===e&&(e=new s.Vector3),e.copy(t),e.applyMatrix4(this.matrixWorld)},e.prototype.worldToLocal=function(t,e){return void 0===e&&(e=new s.Vector3),e.copy(t),e.applyMatrix4(this.matrixWorld)},e.prototype.lookAt=function(t){return this._tempPosition.setFromMatrixPosition(this.matrixWorld),this._tempMatrix.lookAt(t,this._tempPosition,s.Vector3.UNIT_Y),this._parent?(this._quaternion.notify=!1,this._quaternion.setFromRotationMatrix(this._tempMatrix),this._parent.matrixWorld.getRotationMatrix4(this._tempMatrix),this._tempQuaternion.setFromRotationMatrix(this._tempMatrix),this._quaternion.notify=!0,this._quaternion.premultiply(this._tempQuaternion.inverse())):this._quaternion.setFromRotationMatrix(this._tempMatrix),this},e.prototype.getPivotPosition=function(t){return void 0===t&&(t=new s.Vector3),t.x=-this._pivotMatrix.elements[12],t.y=-this._pivotMatrix.elements[13],t.z=-this._pivotMatrix.elements[14],t},e.prototype.getWorldPivotPosition=function(t){return void 0===t&&(t=new s.Vector3),(t=this.getPivotPosition(t)).setFromMatrixPosition(this.matrixWorld)},e.prototype.getWorldPosition=function(t){return void 0===t&&(t=new s.Vector3),t.setFromMatrixPosition(this.matrixWorld)},e.prototype.getWorldQuaternion=function(t){return void 0===t&&(t=new s.Quaternion),this.matrixWorld.decompose(null,t,null),t},e.prototype.getWorldRotaion=function(t){return void 0===t&&(t=new s.Euler),this.matrixWorld.decompose(null,this._tempQuaternion,null),t.setFromQuaternion(this._tempQuaternion,this._rotation.order),t},e.prototype.getWorldScale=function(t){return void 0===t&&(t=new s.Vector3),this.matrixWorld.decompose(null,null,t),t},e.prototype.getWorldDirection=function(t){void 0===t&&(t=new s.Vector3);var e=this.matrixWorld.elements;return t.set(e[8],e[9],e[10]).normalize()},e.prototype.getLocalUp=function(t){return void 0===t&&(t=new s.Vector3),t.set(0,1,0),t.applyQuaternion(this.quaternion).normalize()},e.prototype.getLocalDown=function(t){return void 0===t&&(t=new s.Vector3),t.set(0,-1,0),t.applyQuaternion(this.quaternion).normalize()},e.prototype.getLocalForward=function(t){return void 0===t&&(t=new s.Vector3),t.set(0,0,1),t.applyQuaternion(this.quaternion).normalize()},e.prototype.getLocalBackward=function(t){return void 0===t&&(t=new s.Vector3),t.set(0,0,-1),t.applyQuaternion(this.quaternion).normalize()},e.prototype.getLocalLeft=function(t){return void 0===t&&(t=new s.Vector3),t.set(-1,0,0),t.applyQuaternion(this.quaternion).normalize()},e.prototype.getLocalRight=function(t){return void 0===t&&(t=new s.Vector3),t.set(1,0,0),t.applyQuaternion(this.quaternion).normalize()},e.prototype.getWorldUp=function(t){return void 0===t&&(t=new s.Vector3),t.set(0,1,0),this.matrixWorld.transformVector3(t,t).normalize()},e.prototype.getWorldDown=function(t){return void 0===t&&(t=new s.Vector3),t.set(0,-1,0),this.matrixWorld.transformVector3(t,t).normalize()},e.prototype.getWorldForward=function(t){return void 0===t&&(t=new s.Vector3),t.set(0,0,1),this.matrixWorld.transformVector3(t,t).normalize()},e.prototype.getWorldBackward=function(t){return void 0===t&&(t=new s.Vector3),t.set(0,0,-1),this.matrixWorld.transformVector3(t,t).normalize()},e.prototype.getWorldLeft=function(t){return void 0===t&&(t=new s.Vector3),t.set(-1,0,0),this.matrixWorld.transformVector3(t,t).normalize()},e.prototype.getWorldRight=function(t){return void 0===t&&(t=new s.Vector3),t.set(1,0,0),this.matrixWorld.transformVector3(t,t).normalize()},e.prototype.getHeading=function(){return o.MathUtils.TWO_PI-o.MathUtils.zeroToTwoPi(this.rotation.y)},e.prototype.getPitch=function(){return o.MathUtils.clamp(this.rotation.x,-1,1)},e.prototype.getRoll=function(){return o.MathUtils.zeroToTwoPi(this.rotation.z+o.MathUtils.TWO_PI)},e.prototype.updateMatrix=function(t){if(void 0===t&&(t=!1),this._matrixNeedsUpdate||t){if(this._matrix.notify=!1,this._tempMatrix.copy(this._matrix),this._usePivotMatrix){var e=a.MathTmp.Matrix4[0].makeScaleXYZ(this.scale.x,this.scale.y,this.scale.z),r=a.MathTmp.Matrix4[1].makeRotationFromQuaternion(this.quaternion);this._matrix.multiplyMatrices(e,this._pivotMatrix),this._matrix.premultiply(r),this._matrix.premultiply(this.pivotMatrixInverse),this._matrix.translateVector(this.position)}else this._matrix.compose(this.position,this.quaternion,this.scale);this._matrix.notify=!0,this._matrixNeedsUpdate=!1,this._matrixWorldNeedsUpdate=!0,this.onMatrixChanged(this._tempMatrix,this._matrix)}return this},e.prototype.updateMatrixWorld=function(t){void 0===t&&(t=!1),this.updateMatrix(),(this._matrixWorldNeedsUpdate||t)&&(this._matrixWorld.notify=!1,this._tempMatrixWorld.copy(this._matrixWorld),this._parent?this._matrixWorld.multiplyMatrices(this._parent.matrixWorld,this._matrix):this._matrixWorld.copy(this._matrix),this._matrixWorld.notify=!0,this._matrixWorldInverse.getInverse(this._matrixWorld),this._matrixWorldNeedsUpdate=!1,t=!0,this.onMatrixWorldChanged(this._tempMatrixWorld,this._matrixWorld));for(var e=this.children,r=0,n=e.length;r<n;r++)e[r].updateMatrixWorld(t);return this},e.prototype.updateWorldMatrix=function(t,e,r){if(void 0===t&&(t=!1),void 0===e&&(e=!1),void 0===r&&(r=!1),t&&null!=this._parent&&this._parent.updateWorldMatrix(!0,!1,r),this.updateMatrix(),(this._matrixWorldNeedsUpdate||r)&&(this._matrixWorld.notify=!1,this._tempMatrixWorld.copy(this._matrixWorld),this._parent?this._matrixWorld.multiplyMatrices(this._parent.matrixWorld,this._matrix):this._matrixWorld.copy(this._matrix),this._matrixWorld.notify=!0,this._matrixWorldInverse.getInverse(this._matrixWorld),this._matrixWorldNeedsUpdate=!1,r=!0,this.onMatrixWorldChanged(this._tempMatrixWorld,this._matrixWorld)),e)for(var n=this.children,i=0,o=n.length;i<o;i++)n[i].updateWorldMatrix(!1,!0,r);return this},e.prototype.clone=function(){return new e(this._scene,this._parent).copy(this)},e.prototype.copy=function(t){return this},e}(r(74).AbstractObject);e.TransformObject=u},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Box3=void 0;var n=r(0),i=r(20),o=r(19),s=r(43),a=r(5),u=new Array(3),p=new Array(3),h=function(){function t(t,e){void 0===t&&(t=null),void 0===e&&(e=null),this.min=new n.Vector3(1/0,1/0,1/0),this.max=new n.Vector3(-1/0,-1/0,-1/0),t&&this.min.copy(t),e&&this.min.copy(e)}return t.Build=function(){return new t},t.prototype.clone=function(){return new t(this.min,this.max)},t.prototype.copy=function(t){return this.min.copy(t.min),this.max.copy(t.max),this},t.prototype.set=function(t,e){return this.min.copy(t),this.max.copy(e),this},t.prototype.setFromArray=function(t){for(var e=1/0,r=1/0,n=1/0,i=-1/0,o=-1/0,s=-1/0,a=0,u=t.length;a<u;a+=3){var p=t[a],h=t[a+1],c=t[a+2];p<e&&(e=p),h<r&&(r=h),c<n&&(n=c),p>i&&(i=p),h>o&&(o=h),c>s&&(s=c)}return this.min.set(e,r,n),this.max.set(i,o,s),this},t.prototype.setFromBufferAttribute=function(t){for(var e=1/0,r=1/0,n=1/0,i=-1/0,o=-1/0,s=-1/0,a=0,u=t.count;a<u;a++){var p=t.getX(a),h=t.getY(a),c=t.getZ(a);p<e&&(e=p),h<r&&(r=h),c<n&&(n=c),p>i&&(i=p),h>o&&(o=h),c>s&&(s=c)}return this.min.set(e,r,n),this.max.set(i,o,s),this},t.prototype.setFromPoints=function(t){this.makeEmpty();for(var e=0,r=t.length;e<r;e++)this.expandByPoint(t[e]);return this},t.prototype.setFromCenterAndSize=function(t,e){var r=a.MathTmp.Vector3[0].copy(e).multiplyScalar(.5);return this.min.copy(t).sub(r),this.max.copy(t).add(r),this},t.prototype.setFromObject=function(t){return this.makeEmpty(),this.expandByObject(t)},t.prototype.makeEmpty=function(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this},t.prototype.isEmpty=function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},t.prototype.getCenter=function(t){return void 0===t&&(t=new n.Vector3),this.isEmpty()?t.set(0,0,0):t.addVectors(this.min,this.max).multiplyScalar(.5)},t.prototype.getSize=function(t){return void 0===t&&(t=new n.Vector3),this.isEmpty()?t.set(0,0,0):t.subVectors(this.max,this.min)},t.prototype.getExtent=function(t){return void 0===t&&(t=new n.Vector3),this.isEmpty()?t.set(0,0,0):t.subVectors(this.max,this.min).multiplyScalar(.5)},t.prototype.expandByPoint=function(t){return this.min.min(t),this.max.max(t),this},t.prototype.expandByVector=function(t){return this.min.sub(t),this.max.add(t),this},t.prototype.expandByScalar=function(t){return this.min.addScalar(-t),this.max.addScalar(t),this},t.prototype.expandByObject=function(t){return this},t.prototype.getBoundingSphere=function(t){return void 0===t&&(t=new i.Sphere),this.getCenter(t.center),t.radius=.5*this.getSize(a.MathTmp.Vector3[0]).length(),t},t.prototype.containsPoint=function(t){return!(t.x<this.min.x||t.x>this.max.x||t.y<this.min.y||t.y>this.max.y||t.z<this.min.z||t.z>this.max.z)},t.prototype.containsBox=function(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y&&this.min.z<=t.min.z&&t.max.z<=this.max.z},t.prototype.containsSphere=function(t){void 0===t&&(t=new i.Sphere);var e=new i.Sphere;return this.getBoundingSphere(e),e.containsSphere(t)},t.prototype.getParameter=function(t,e){return void 0===e&&(e=new n.Vector3),e.set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y),(t.z-this.min.z)/(this.max.z-this.min.z))},t.prototype.clampPoint=function(t,e){return void 0===e&&(e=new n.Vector3),e.copy(t).clamp(this.min,this.max)},t.prototype.intersect=function(t){return this.min.max(t.min),this.max.min(t.max),this.isEmpty()&&this.makeEmpty(),this},t.prototype.union=function(t){return this.min.min(t.min),this.max.max(t.max),this},t.prototype.applyMatrix4=function(t){return this.isEmpty()||(a.MathTmp.Vector3[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(t),a.MathTmp.Vector3[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(t),a.MathTmp.Vector3[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(t),a.MathTmp.Vector3[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(t),a.MathTmp.Vector3[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(t),a.MathTmp.Vector3[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(t),a.MathTmp.Vector3[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(t),a.MathTmp.Vector3[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(t),this.setFromPoints(a.MathTmp.Vector3)),this},t.prototype.translate=function(t){return this.min.add(t),this.max.add(t),this},t.prototype.scale=function(t){return this.min.multiplyScalar(t),this.max.multiplyScalar(t),this},t.prototype.multiply=function(t){return this.min.multiply(t),this.max.multiply(t),this},t.prototype.translates=function(t,e){return this.min.add(t),this.max.add(e),this},t.prototype.scales=function(t,e){return this.min.multiplyScalar(t),this.max.multiplyScalar(e),this},t.prototype.multiplies=function(t,e){return this.min.multiply(t),this.max.multiply(e),this},t.prototype.distanceSqToPoint=function(t,e){void 0===e&&(e=null);for(var r=this.getCenter(a.MathTmp.Vector3[0]),n=this.getExtent(a.MathTmp.Vector3[1]),i=a.MathTmp.Vector3[2].subVectors(t,r),o=0,s=0;s<3;++s){if(i.p[s]<-n.p[s])o+=(u=i.p[s]+n.p[s])*u,i.p[s]=-n.p[s];else if(i.p[s]>n.p[s]){var u;o+=(u=i.p[s]-n.p[s])*u,i.p[s]=n.p[s]}}return e&&e.addVectors(i,r),o},t.prototype.distanceToPoint=function(t,e){return void 0===e&&(e=null),Math.sqrt(this.distanceSqToPoint(t,e))},t.prototype.distanceSqToBox=function(t,e,r){void 0===e&&(e=null),void 0===r&&(r=null),a.MathTmp.Box3[0].makeEmpty(),a.MathTmp.Box3[1].makeEmpty();for(var n=0,i=0;i<3;++i){if(this.min.p[i]>=t.max.p[i])n+=(s=this.min.p[i]-t.min.p[i])*s,e&&(a.MathTmp.Box3[0].min.p[i]=this.min.p[i],a.MathTmp.Box3[0].max.p[i]=this.min.p[i]),r&&(a.MathTmp.Box3[1].min.p[i]=t.max.p[i],a.MathTmp.Box3[1].max.p[i]=t.max.p[i]);else if(t.min.p[i]>=this.max.p[i]){var s;n+=(s=t.min.p[i]-this.max.p[i])*s,e&&(a.MathTmp.Box3[0].min.p[i]=this.max.p[i],a.MathTmp.Box3[0].max.p[i]=this.max.p[i]),r&&(a.MathTmp.Box3[1].min.p[i]=t.min.p[i],a.MathTmp.Box3[1].max.p[i]=t.min.p[i])}else if(e||r){var u=[this.min.p[i],this.max.p[i]],p=[t.min.p[i],t.max.p[i]],h=o.Intervals.staticQuery(u,p);e&&(a.MathTmp.Box3[0].min.p[i]=h.overlap[0],a.MathTmp.Box3[0].max.p[i]=h.overlap[1]),r&&(a.MathTmp.Box3[1].min.p[i]=h.overlap[0],a.MathTmp.Box3[1].max.p[i]=h.overlap[1])}}return e&&a.MathTmp.Box3[0].getCenter(e),r&&a.MathTmp.Box3[1].getCenter(r),n},t.prototype.distanceToBox=function(t,e,r){return void 0===e&&(e=null),void 0===r&&(r=null),Math.sqrt(this.distanceSqToBox(t,e,r))},t.prototype.distanceSqToOBB=function(t,e,r,n){void 0===e&&(e=null),void 0===r&&(r=null),void 0===n&&(n=null);for(var i=t,o=a.MathTmp.Vector3[0].subVectors(this.max,this.min),u=a.MathTmp.Vector3[1].subVectors(i.center,this.min),p=0;p<3;++p)u.sub(a.MathTmp.Vector3[2].copy(i.axis[p]).multiplyScalar(i.extent.p[p]));var h=a.MathTmp.Vector3[2];for(p=0;p<3;++p)h.p[p]=i.axis[p].dot(u);var c=a.MathTmp.Vector3[3].copy(i.extent).multiplyScalar(2),l=[-u.x,-u.y,-u.z,h.x,h.y,h.z,o.x,o.y,o.z,c.x,c.y,c.z],f=-1,y=i.axis[0],d=i.axis[1],_=i.axis[2],m=[[1,0,0,-y.x,-d.x,-d.z,1,0,0,0,0,0],[0,1,0,-y.y,-d.y,-d.y,0,1,0,0,0,0],[0,0,1,-y.z,-d.z,-d.z,0,0,1,0,0,0],[-y.x,-y.y,-y.z,1,0,0,0,0,0,1,0,0],[-d.x,-d.y,-d.z,0,1,0,0,0,0,0,1,0],[-_.x,-_.y,-_.z,0,0,1,0,0,0,0,0,1],[f,0,0,0,0,0,0,0,0,0,0,0],[0,f,0,0,0,0,0,0,0,0,0,0],[0,0,f,0,0,0,0,0,0,0,0,0],[0,0,0,f,0,0,0,0,0,0,0,0],[0,0,0,0,f,0,0,0,0,0,0,0],[0,0,0,0,0,f,0,0,0,0,0,0]],g=new Array(12),v=new Array(12),x=new s.LCPSolver(12);if(x.solve(l,m,g,v)){n&&(n.queryIsSuccessful=!0,n.numLCPIterations=x.getNumIterations());for(p=0;p<3;++p){var b=v[p]+this.min.p[p];n&&(n.box0Parameter[p]=b),a.MathTmp.Vector3[0].p[p]=b}a.MathTmp.Vector3[1].copy(i.center);p=0;for(var S=3;p<3;++p,++S){b=v[S]-i.extent.p[p];n&&(n.box1Parameter[p]=b),a.MathTmp.Vector3[1].add(a.MathTmp.Vector3[2].copy(i.axis[p]).multiplyScalar(b))}e&&e.copy(a.MathTmp.Vector3[0]),r&&r.copy(a.MathTmp.Vector3[1]);var T=a.MathTmp.Vector3[2].subVectors(a.MathTmp.Vector3[1],a.MathTmp.Vector3[0]);return T.dot(T)}return n&&(n.queryIsSuccessful=!1,n.numLCPIterations=0),NaN},t.prototype.distanceToOBB=function(t,e,r,n){return void 0===e&&(e=null),void 0===r&&(r=null),void 0===n&&(n=null),Math.sqrt(this.distanceSqToOBB(t,e,r,n))},t.prototype.intersectsBox=function(t){return!(t.max.x<this.min.x||t.min.x>this.max.x||t.max.y<this.min.y||t.min.y>this.max.y||t.max.z<this.min.z||t.min.z>this.max.z)},t.prototype.intersectBox=function(e){for(var r=e,n={intersect:!1,box:new t},i=0;i<3;i++)if(this.max.p[i]<r.min.p[i]||this.min.p[i]>r.max.p[i])return n.intersect=!1,n;for(i=0;i<3;i++)this.max.p[i]<=r.max.p[i]?n.box.max.p[i]=this.max.p[i]:n.box.max.p[i]=r.max.p[i],this.min.p[i]<=r.min.p[i]?n.box.min.p[i]=r.min.p[i]:n.box.min.p[i]=this.min.p[i];return n.intersect=!0,n},t.prototype.intersectsSphere=function(t){return this.clampPoint(t.center,a.MathTmp.Vector3[0]),a.MathTmp.Vector3[0].distanceToSquared(t.center)<=t.radius*t.radius},t.prototype.intersectsOBB=function(t){for(var e,r,n=t,i=this.getCenter(a.MathTmp.Vector3[0]),o=this.getExtent(a.MathTmp.Vector3[1]).toArray(u),s=n.center,h=n.axis,c=n.extent.toArray(p),l=!1,f=a.MathTmp.Vector3[2].subVectors(s,i),y=[[],[],[]],d=[[],[],[]],_=0;_<3;++_)y[0][_]=h[_].x,d[0][_]=Math.abs(h[_].x),d[0][_]>=1&&(l=!0);if(r=Math.abs(f.x),e=c[0]*d[0][0]+c[1]*d[0][1]+c[2]*d[0][2],r>o[0]+e)return!1;for(_=0;_<3;++_)y[1][_]=h[_].y,d[1][_]=Math.abs(h[_].y),d[1][_]>=1&&(l=!0);if(r=Math.abs(f.y),e=c[0]*d[1][0]+c[1]*d[1][1]+c[2]*d[1][2],r>o[1]+e)return!1;for(_=0;_<3;++_)y[2][_]=h[_].z,d[2][_]=Math.abs(h[_].z),d[2][_]>=1&&(l=!0);return r=Math.abs(f.z),e=c[0]*d[2][0]+c[1]*d[2][1]+c[2]*d[2][2],!(r>o[2]+e)&&(!((r=Math.abs(f.dot(h[0])))>o[0]*d[0][0]+o[1]*d[1][0]+o[2]*d[2][0]+c[0])&&(!((r=Math.abs(f.dot(h[1])))>o[0]*d[0][1]+o[1]*d[1][1]+o[2]*d[2][1]+c[1])&&(!((r=Math.abs(f.dot(h[2])))>o[0]*d[0][2]+o[1]*d[1][2]+o[2]*d[2][2]+c[2])&&(!!l||!((r=Math.abs(f.z*y[1][0]-f.y*y[2][0]))>o[1]*d[2][0]+o[2]*d[1][0]+(e=c[1]*d[0][2]+c[2]*d[0][1]))&&(!((r=Math.abs(f.z*y[1][1]-f.y*y[2][1]))>o[1]*d[2][1]+o[2]*d[1][1]+(e=c[0]*d[0][2]+c[2]*d[0][0]))&&(!((r=Math.abs(f.z*y[1][2]-f.y*y[2][2]))>o[1]*d[2][2]+o[2]*d[1][2]+(e=c[0]*d[0][1]+c[1]*d[0][0]))&&(!((r=Math.abs(f.x*y[2][0]-f.z*y[0][0]))>o[0]*d[2][0]+o[2]*d[0][0]+(e=c[1]*d[1][2]+c[2]*d[1][1]))&&(!((r=Math.abs(f.x*y[2][1]-f.z*y[0][1]))>o[0]*d[2][1]+o[2]*d[0][1]+(e=c[0]*d[1][2]+c[2]*d[1][0]))&&(!((r=Math.abs(f.x*y[2][2]-f.z*y[0][2]))>o[0]*d[2][2]+o[2]*d[0][2]+(e=c[0]*d[1][1]+c[1]*d[1][0]))&&(!((r=Math.abs(f.y*y[0][0]-f.x*y[1][0]))>o[0]*d[1][0]+o[1]*d[0][0]+(e=c[1]*d[2][2]+c[2]*d[2][1]))&&(!((r=Math.abs(f.y*y[0][1]-f.x*y[1][1]))>o[0]*d[1][1]+o[1]*d[0][1]+(e=c[0]*d[2][2]+c[2]*d[2][0]))&&!((r=Math.abs(f.y*y[0][2]-f.x*y[1][2]))>o[0]*d[1][2]+o[1]*d[0][2]+(e=c[0]*d[2][1]+c[1]*d[2][0])))))))))))))},t.prototype.equals=function(t){return t.min.equals(this.min)&&t.max.equals(this.max)},t.prototype.toArray=function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),this.min.toArray(t,e),this.max.toArray(t,e+3),t},t.prototype.fromArray=function(t,e){return void 0===e&&(e=0),this.min.fromArray(t,e),this.max.fromArray(t,e+3),this},t}();e.Box3=h},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ColorRGB=void 0;var n=r(1),i={h:0,s:0,l:0},o={h:0,s:0,l:0};function s(t,e,r){return r<0&&(r+=1),r>1&&(r-=1),r<1/6?t+6*(e-t)*r:r<.5?e:r<2/3?t+6*(e-t)*(2/3-r):t}function a(t){return t<.04045?.0773993808*t:Math.pow(.9478672986*t+.0521327014,2.4)}function u(t){return t<.0031308?12.92*t:1.055*Math.pow(t,.41666)-.055}var p=function(){function t(t,e,r){void 0===t&&(t=null),void 0===e&&(e=null),void 0===r&&(r=null),this.r=1,this.g=1,this.b=1,null==e&&null==r?this.set(t):"number"==typeof t&&null!=e&&null!=r&&this.setRGB(t,e,r)}return t.Build=function(){return new t},t.prototype.set=function(e){return e&&e instanceof t?this.copy(e):"number"==typeof e?this.setHex(e):"string"==typeof e&&this.setStyle(e),this},t.prototype.setScalar=function(t){return this.r=t,this.g=t,this.b=t,this},t.prototype.setHex=function(t){return t=Math.floor(t),this.r=(t>>16&255)/255,this.g=(t>>8&255)/255,this.b=(255&t)/255,this},t.prototype.setRGB=function(t,e,r){return this.r=t,this.g=e,this.b=r,this},t.prototype.setHSL=function(t,e,r){if(t=n.MathUtils.mod(t,1),e=n.MathUtils.clamp(e,0,1),r=n.MathUtils.clamp(r,0,1),0==e)this.r=this.g=this.b=r;else{var i=r<=.5?r*(1+e):r+e-r*e,o=2*r-i;this.r=s(o,i,t+1/3),this.g=s(o,i,t),this.b=s(o,i,t-1/3)}return this},t.prototype.setStyle=function(t){var e;if(e=/^((?:rgb|hsl)a?)\(\s*([^\)]*)\)/.exec(t)){var r=void 0,n=e[1],i=e[2];switch(n){case"rgb":case"rgba":if(r=/^(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(i))return this.r=Math.min(255,parseInt(r[1],10))/255,this.g=Math.min(255,parseInt(r[2],10))/255,this.b=Math.min(255,parseInt(r[3],10))/255,this;if(r=/^(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(i))return this.r=Math.min(100,parseInt(r[1],10))/100,this.g=Math.min(100,parseInt(r[2],10))/100,this.b=Math.min(100,parseInt(r[3],10))/100,this;break;case"hsl":case"hsla":if(r=/^([0-9]*\.?[0-9]+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(i)){var o=parseFloat(r[1])/360,s=parseInt(r[2],10)/100,a=parseInt(r[3],10)/100;return this.setHSL(o,s,a)}}}else if(e=/^\#([A-Fa-f0-9]+)$/.exec(t)){var u=e[1],p=u.length;if(3==p)return this.r=parseInt(u.charAt(0)+u.charAt(0),16)/255,this.g=parseInt(u.charAt(1)+u.charAt(1),16)/255,this.b=parseInt(u.charAt(2)+u.charAt(2),16)/255,this;if(6==p)return this.r=parseInt(u.charAt(0)+u.charAt(1),16)/255,this.g=parseInt(u.charAt(2)+u.charAt(3),16)/255,this.b=parseInt(u.charAt(4)+u.charAt(5),16)/255,this}return t&&t.length>0?this.setColorName(t):this},t.prototype.setColorName=function(t){var e=_colorKeywords[t];return e&&this.setHex(e),this},t.prototype.setComponent=function(t,e){switch(t){case 0:this.r=e;break;case 1:this.g=e;break;case 2:this.b=e;break;default:throw new Error("index is out of range: "+t)}return this},t.prototype.getComponent=function(t){switch(t){case 0:return this.r;case 1:return this.g;case 2:return this.b;default:throw new Error("index is out of range: "+t)}},t.prototype.maximumComponent=function(){return Math.max(Math.max(this.r,this.g),this.b)},t.prototype.minimumComponent=function(){return Math.min(Math.min(this.r,this.g),this.b)},t.prototype.clone=function(){return new t(this.r,this.g,this.b)},t.prototype.copy=function(t){return this.r=t.r,this.g=t.g,this.b=t.b,this},t.prototype.copyGammaToLinear=function(t,e){return void 0===e&&(e=2),this.r=Math.pow(t.r,e),this.g=Math.pow(t.g,e),this.b=Math.pow(t.b,e),this},t.prototype.copyLinearToGamma=function(t,e){void 0===e&&(e=2);var r=e>0?1/e:1;return this.r=Math.pow(t.r,r),this.g=Math.pow(t.g,r),this.b=Math.pow(t.b,r),this},t.prototype.convertGammaToLinear=function(t){return this.copyGammaToLinear(this,t),this},t.prototype.convertLinearToGamma=function(t){return this.copyLinearToGamma(this,t),this},t.prototype.copySRGBToLinear=function(t){return this.r=a(t.r),this.g=a(t.g),this.b=a(t.b),this},t.prototype.copyLinearToSRGB=function(t){return this.r=u(t.r),this.g=u(t.g),this.b=u(t.b),this},t.prototype.convertSRGBToLinear=function(){return this.copySRGBToLinear(this),this},t.prototype.convertLinearToSRGB=function(){return this.copyLinearToSRGB(this),this},t.prototype.getHex=function(){return 255*this.r<<16^255*this.g<<8^255*this.b<<0},t.prototype.getHexString=function(){return("000000"+this.getHex().toString(16)).slice(-6)},t.prototype.getHSL=function(t){void 0===t&&(t={h:0,s:0,l:0});var e,r=this.r,n=this.g,i=this.b,o=Math.max(r,n,i),s=Math.min(r,n,i),a=0,u=(s+o)/2;if(s==o)a=0,e=0;else{var p=o-s;switch(e=u<=.5?p/(o+s):p/(2-o-s),o){case r:a=(n-i)/p+(n<i?6:0);break;case n:a=(i-r)/p+2;break;case i:a=(r-n)/p+4}a/=6}return t.h=a,t.s=e,t.l=u,t},t.prototype.getStyle=function(){return"rgb("+(255*this.r|0)+","+(255*this.g|0)+","+(255*this.b|0)+")"},t.prototype.offsetHSL=function(t,e,r){return this.getHSL(i),i.h+=t,i.s+=e,i.l+=r,this.setHSL(i.h,i.s,i.l),this},t.prototype.add=function(t){return this.r+=t.r,this.g+=t.g,this.b+=t.b,this},t.prototype.addColors=function(t,e){return this.r=t.r+e.r,this.g=t.g+e.g,this.b=t.b+e.b,this},t.prototype.addScalar=function(t){return this.r+=t,this.g+=t,this.b+=t,this},t.prototype.sub=function(t){return this.r=Math.max(0,this.r-t.r),this.g=Math.max(0,this.g-t.g),this.b=Math.max(0,this.b-t.b),this},t.prototype.multiply=function(t){return this.r*=t.r,this.g*=t.g,this.b*=t.b,this},t.prototype.multiplyScalar=function(t){return this.r*=t,this.g*=t,this.b*=t,this},t.prototype.lerp=function(t,e){return this.r+=(t.r-this.r)*e,this.g+=(t.g-this.g)*e,this.b+=(t.b-this.b)*e,this},t.prototype.lerpHSL=function(t,e){this.getHSL(i),t.getHSL(o);var r=n.MathUtils.lerp(i.h,o.h,e),s=n.MathUtils.lerp(i.s,o.s,e),a=n.MathUtils.lerp(i.l,o.l,e);return this.setHSL(r,s,a),this},t.prototype.equals=function(t){return t.r==this.r&&t.g==this.g&&t.b==this.b},t.prototype.equalsEpsilon=function(t,e,r){return void 0===r&&(r=null),n.MathUtils.equalsEpsilon(this.r,t.r,e,r)&&n.MathUtils.equalsEpsilon(this.g,t.g,e,r)&&n.MathUtils.equalsEpsilon(this.b,t.b,e,r)},t.prototype.fromBufferAttribute=function(t,e){return this.r=t.getX(e),this.g=t.getY(e),this.b=t.getZ(e),t.normalized&&(this.r/=255,this.g/=255,this.b/=255),this},t.prototype.toArray=function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this.r,t[e+1]=this.g,t[e+2]=this.b,t},t.prototype.fromArray=function(t,e){return void 0===e&&(e=0),this.r=t[e],this.g=t[e+1],this.b=t[e+2],this},t.prototype.fromDataBuffer=function(t){return this.r=t.readFloat32(),this.g=t.readFloat32(),this.b=t.readFloat32(),this},t.prototype.toDataBuffer=function(t){return t.writeFloat32(this.r),t.writeFloat32(this.g),t.writeFloat32(this.b),this},t.prototype.toJSON=function(){return this.getHex()},t.ALICEBLUE=new t("#F0F8FF"),t.ANTIQUEWHITE=new t("#FAEBD7"),t.AQUA=new t("#00FFFF"),t.AQUAMARINE=new t("#7FFFD4"),t.AZURE=new t("#F0FFFF"),t.BEIGE=new t("#F5F5DC"),t.BISQUE=new t("#FFE4C4"),t.BLACK=new t("#000000"),t.BLANCHEDALMOND=new t("#FFEBCD"),t.BLUE=new t("#0000FF"),t.BLUEVIOLET=new t("#8A2BE2"),t.BROWN=new t("#A52A2A"),t.BURLYWOOD=new t("#DEB887"),t.CADETBLUE=new t("#5F9EA0"),t.CHARTREUSE=new t("#7FFF00"),t.CHOCOLATE=new t("#D2691E"),t.CORAL=new t("#FF7F50"),t.CORNFLOWERBLUE=new t("#6495ED"),t.CORNSILK=new t("#FFF8DC"),t.CRIMSON=new t("#DC143C"),t.CYAN=new t("#00FFFF"),t.DARKBLUE=new t("#00008B"),t.DARKCYAN=new t("#008B8B"),t.DARKGOLDENROD=new t("#B8860B"),t.DARKGRAY=new t("#A9A9A9"),t.DARKGREEN=new t("#006400"),t.DARKGREY=t.DARKGREEN,t.DARKKHAKI=new t("#BDB76B"),t.DARKMAGENTA=new t("#8B008B"),t.DARKOLIVEGREEN=new t("#556B2F"),t.DARKORANGE=new t("#FF8C00"),t.DARKORCHID=new t("#9932CC"),t.DARKRED=new t("#8B0000"),t.DARKSALMON=new t("#E9967A"),t.DARKSEAGREEN=new t("#8FBC8F"),t.DARKSLATEBLUE=new t("#483D8B"),t.DARKSLATEGRAY=new t("#2F4F4F"),t.DARKSLATEGREY=t.DARKSLATEGRAY,t.DARKTURQUOISE=new t("#00CED1"),t.DARKVIOLET=new t("#9400D3"),t.DEEPPINK=new t("#FF1493"),t.DEEPSKYBLUE=new t("#00BFFF"),t.DIMGRAY=new t("#696969"),t.DIMGREY=t.DIMGRAY,t.DODGERBLUE=new t("#1E90FF"),t.FIREBRICK=new t("#B22222"),t.FLORALWHITE=new t("#FFFAF0"),t.FORESTGREEN=new t("#228B22"),t.FUCHSIA=new t("#FF00FF"),t.GAINSBORO=new t("#DCDCDC"),t.GHOSTWHITE=new t("#F8F8FF"),t.GOLD=new t("#FFD700"),t.GOLDENROD=new t("#DAA520"),t.GRAY=new t("#808080"),t.GREEN=new t("#008000"),t.GREENYELLOW=new t("#ADFF2F"),t.GREY=t.GRAY,t.HONEYDEW=new t("#F0FFF0"),t.HOTPINK=new t("#FF69B4"),t.INDIANRED=new t("#CD5C5C"),t.INDIGO=new t("#4B0082"),t.IVORY=new t("#FFFFF0"),t.KHAKI=new t("#F0E68C"),t.LAVENDER=new t("#E6E6FA"),t.LAVENDAR_BLUSH=new t("#FFF0F5"),t.LAWNGREEN=new t("#7CFC00"),t.LEMONCHIFFON=new t("#FFFACD"),t.LIGHTBLUE=new t("#ADD8E6"),t.LIGHTCORAL=new t("#F08080"),t.LIGHTCYAN=new t("#E0FFFF"),t.LIGHTGOLDENRODYELLOW=new t("#FAFAD2"),t.LIGHTGRAY=new t("#D3D3D3"),t.LIGHTGREEN=new t("#90EE90"),t.LIGHTGREY=t.LIGHTGRAY,t.LIGHTPINK=new t("#FFB6C1"),t.LIGHTSEAGREEN=new t("#20B2AA"),t.LIGHTSKYBLUE=new t("#87CEFA"),t.LIGHTSLATEGRAY=new t("#778899"),t.LIGHTSLATEGREY=t.LIGHTSLATEGRAY,t.LIGHTSTEELBLUE=new t("#B0C4DE"),t.LIGHTYELLOW=new t("#FFFFE0"),t.LIME=new t("#00FF00"),t.LIMEGREEN=new t("#32CD32"),t.LINEN=new t("#FAF0E6"),t.MAGENTA=new t("#FF00FF"),t.MAROON=new t("#800000"),t.MEDIUMAQUAMARINE=new t("#66CDAA"),t.MEDIUMBLUE=new t("#0000CD"),t.MEDIUMORCHID=new t("#BA55D3"),t.MEDIUMPURPLE=new t("#9370DB"),t.MEDIUMSEAGREEN=new t("#3CB371"),t.MEDIUMSLATEBLUE=new t("#7B68EE"),t.MEDIUMSPRINGGREEN=new t("#00FA9A"),t.MEDIUMTURQUOISE=new t("#48D1CC"),t.MEDIUMVIOLETRED=new t("#C71585"),t.MIDNIGHTBLUE=new t("#191970"),t.MINTCREAM=new t("#F5FFFA"),t.MISTYROSE=new t("#FFE4E1"),t.MOCCASIN=new t("#FFE4B5"),t.NAVAJOWHITE=new t("#FFDEAD"),t.NAVY=new t("#000080"),t.OLDLACE=new t("#FDF5E6"),t.OLIVE=new t("#808000"),t.OLIVEDRAB=new t("#6B8E23"),t.ORANGE=new t("#FFA500"),t.ORANGERED=new t("#FF4500"),t.ORCHID=new t("#DA70D6"),t.PALEGOLDENROD=new t("#EEE8AA"),t.PALEGREEN=new t("#98FB98"),t.PALETURQUOISE=new t("#AFEEEE"),t.PALEVIOLETRED=new t("#DB7093"),t.PAPAYAWHIP=new t("#FFEFD5"),t.PEACHPUFF=new t("#FFDAB9"),t.PERU=new t("#CD853F"),t.PINK=new t("#FFC0CB"),t.PLUM=new t("#DDA0DD"),t.POWDERBLUE=new t("#B0E0E6"),t.PURPLE=new t("#800080"),t.RED=new t("#FF0000"),t.ROSYBROWN=new t("#BC8F8F"),t.ROYALBLUE=new t("#4169E1"),t.SADDLEBROWN=new t("#8B4513"),t.SALMON=new t("#FA8072"),t.SANDYBROWN=new t("#F4A460"),t.SEAGREEN=new t("#2E8B57"),t.SEASHELL=new t("#FFF5EE"),t.SIENNA=new t("#A0522D"),t.SILVER=new t("#C0C0C0"),t.SKYBLUE=new t("#87CEEB"),t.SLATEBLUE=new t("#6A5ACD"),t.SLATEGRAY=new t("#708090"),t.SLATEGREY=t.SLATEGRAY,t.SNOW=new t("#FFFAFA"),t.SPRINGGREEN=new t("#00FF7F"),t.STEELBLUE=new t("#4682B4"),t.TAN=new t("#D2B48C"),t.TEAL=new t("#008080"),t.THISTLE=new t("#D8BFD8"),t.TOMATO=new t("#FF6347"),t.TURQUOISE=new t("#40E0D0"),t.VIOLET=new t("#EE82EE"),t.WHEAT=new t("#F5DEB3"),t.WHITE=new t("#FFFFFF"),t.WHITESMOKE=new t("#F5F5F5"),t.YELLOW=new t("#FFFF00"),t.YELLOWGREEN=new t("#9ACD32"),t}();e.ColorRGB=p},function(t,e,r){"use strict";var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(e,"__esModule",{value:!0}),e.EllipseCurve=void 0;var o=r(10),s=r(2),a=function(t){function e(e,r,n,i,o,a,u,p){void 0===e&&(e=0),void 0===r&&(r=0),void 0===n&&(n=1),void 0===i&&(i=1),void 0===o&&(o=0),void 0===a&&(a=2*Math.PI),void 0===u&&(u=!1),void 0===p&&(p=0);var h=t.call(this)||this;return h.type="EllipseCurve",h.center=new s.Vector2(e||0,r||0),h.xRadius=n,h.yRadius=i,h.aStartAngle=o,h.aEndAngle=a,h.aClockwise=u,h.aRotation=p,h}return i(e,t),Object.defineProperty(e.prototype,"aX",{get:function(){return this.center.x},set:function(t){this.center.x=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"aY",{get:function(){return this.center.y},set:function(t){this.center.y=t},enumerable:!1,configurable:!0}),e.prototype.getPoint=function(t,e){void 0===e&&(e=null);for(var r=e||new s.Vector2,n=2*Math.PI,i=this.aEndAngle-this.aStartAngle,o=Math.abs(i)<Number.EPSILON;i<0;)i+=n;for(;i>n;)i-=n;i<Number.EPSILON&&(i=o?0:n),1!=this.aClockwise||o||(i==n?i=-n:i-=n);var a=this.aStartAngle+t*i,u=this.aX+this.xRadius*Math.cos(a),p=this.aY+this.yRadius*Math.sin(a);if(0!=this.aRotation){var h=Math.cos(this.aRotation),c=Math.sin(this.aRotation),l=u-this.aX,f=p-this.aY;u=l*h-f*c+this.aX,p=l*c+f*h+this.aY}return r.set(u,p)},e.prototype.clone=function(){return(new e).copy(this)},e.prototype.copy=function(e){return t.prototype.copy.call(this,e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this},e.prototype.toJSON=function(){var e=t.prototype.toJSON.call(this);return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e},e.prototype.fromJSON=function(e){return t.prototype.fromJSON.call(this,e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this},e.prototype.toDataBuffer=function(e){return t.prototype.toDataBuffer.call(this,e),e.writeVector2(this.center),e.writeFloat32(this.xRadius),e.writeFloat32(this.yRadius),e.writeFloat32(this.aStartAngle),e.writeFloat32(this.aEndAngle),e.writeFloat32(this.aRotation),e.writeBoolean(this.aClockwise),this},e.prototype.fromDataBuffer=function(e){return t.prototype.fromDataBuffer.call(this,e),this.center=e.readVector2(this.center),this.xRadius=e.readFloat32(),this.yRadius=e.readFloat32(),this.aStartAngle=e.readFloat32(),this.aEndAngle=e.readFloat32(),this.aRotation=e.readFloat32(),this.aClockwise=e.readBoolean(),this},e}(o.Curve);e.EllipseCurve=a},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.BezierCurveFunc=void 0,function(t){function e(t,e){var r=1-t;return r*r*e}function r(t,e){return 2*(1-t)*t*e}function n(t,e){return t*t*e}function i(t,e){var r=1-t;return r*r*r*e}function o(t,e){var r=1-t;return 3*r*r*t*e}function s(t,e){return 3*(1-t)*t*t*e}function a(t,e){return t*t*t*e}t.CatmullRom=function(t,e,r,n,i){var o=.5*(n-e),s=.5*(i-r),a=t*t;return(2*r-2*n+o+s)*(t*a)+(-3*r+3*n-2*o-s)*a+o*t+r},t.QuadraticBezierP0=e,t.QuadraticBezierP1=r,t.QuadraticBezierP2=n,t.QuadraticBezier=function(t,i,o,s){return e(t,i)+r(t,o)+n(t,s)},t.CubicBezierP0=i,t.CubicBezierP1=o,t.CubicBezierP2=s,t.CubicBezierP3=a,t.CubicBezier=function(t,e,r,n,u){return i(t,e)+o(t,r)+s(t,n)+a(t,u)}}(e.BezierCurveFunc||(e.BezierCurveFunc={}))},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.CSGVertex=void 0;var n=r(9),i=r(6),o=r(7),s=r(8),a=function(){function t(t){this.pos=t}return t.fromObject=function(e){return new t(new n.CSGVector3D(e.pos))},t.prototype.flipped=function(){return this},t.prototype.getTag=function(){var t=this.tag;return t||(t=i.CSG.getTag(),this.tag=t),t},t.prototype.interpolate=function(e,r){return new t(this.pos.lerp(e.pos,r))},t.prototype.transform=function(e){return new t(this.pos.multiply4x4(e))},t.prototype.toString=function(){return this.pos.toString()},t.prototype.mirrored=function(t){return this.transform(o.CSGMatrix4x4.mirroring(t))},t.prototype.mirroredX=function(){var t=new s.CSGPlane(n.CSGVector3D.Create(1,0,0),0);return this.mirrored(t)},t.prototype.mirroredY=function(){var t=new s.CSGPlane(n.CSGVector3D.Create(0,1,0),0);return this.mirrored(t)},t.prototype.mirroredZ=function(){var t=new s.CSGPlane(n.CSGVector3D.Create(0,0,1),0);return this.mirrored(t)},t.prototype.translate=function(t){return this.transform(o.CSGMatrix4x4.translation(t))},t.prototype.scale=function(t){return this.transform(o.CSGMatrix4x4.scaling(t))},t.prototype.rotateX=function(t){return this.transform(o.CSGMatrix4x4.rotationX(t))},t.prototype.rotateY=function(t){return this.transform(o.CSGMatrix4x4.rotationY(t))},t.prototype.rotateZ=function(t){return this.transform(o.CSGMatrix4x4.rotationZ(t))},t.prototype.rotate=function(t,e,r){return this.transform(o.CSGMatrix4x4.rotation(t,e,r))},t.prototype.rotateEulerAngles=function(t,e,r,i){var s=i||[0,0,0],a=o.CSGMatrix4x4.rotationZ(t),u=o.CSGMatrix4x4.rotationX(e),p=o.CSGMatrix4x4.rotationZ(r),h=o.CSGMatrix4x4.translation(new n.CSGVector3D(s));return this.transform(p.multiply(u).multiply(a).multiply(h))},t}();e.CSGVertex=a},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.CSGPolygon=void 0;var n=r(31),i=r(9),o=r(29),s=r(8),a=r(7),u=r(78),p=r(6);function h(t,e){return t.index-e.index}var c=function(){function t(t,e,r){this.defaultShared=new u.CSGPolygonShared(null),this.vertices=t,e||(e=this.defaultShared),this.shared=e,this.plane=arguments.length>=3?r:s.CSGPlane.fromVector3Ds(t[0].pos,t[1].pos,t[2].pos),this.defaultShared=new u.CSGPolygonShared(null)}return t.fromObject=function(e){return new t(e.vertices.map((function(t){return o.CSGVertex.fromObject(t)})),u.CSGPolygonShared.fromObject(e.shared),s.CSGPlane.fromObject(e.plane))},t.verticesConvex=function(e,r){var n=e.length;if(n>2)for(var i=e[n-2].pos,o=e[n-1].pos,s=0;s<n;s++){var a=e[s].pos;if(!t.isConvexPoint(i,o,a,r))return!1;i=o,o=a}return!0},t.createFromPoints=function(e,r,n){arguments.length<3?new i.CSGVector3D(0,0,0):n.normal;var s=[];return e.map((function(t){var e=new i.CSGVector3D(t),r=new o.CSGVertex(e);s.push(r)})),arguments.length<3?new t(s,r):new t(s,r,n)},t.isConvexPoint=function(t,e,r,n){return e.minus(t).cross(r.minus(e)).dot(n)>=0},t.isStrictlyConvexPoint=function(t,e,r,n){return e.minus(t).cross(r.minus(e)).dot(n)>=1e-5},t.prototype.checkIfConvex=function(){if(!t.verticesConvex(this.vertices,this.plane.normal))throw t.verticesConvex(this.vertices,this.plane.normal),new Error("Not convex!")},t.prototype.setColor=function(t){var e=u.CSGPolygonShared.fromColor.apply(this,arguments);return this.shared=e,this},t.prototype.getSignedVolume=function(){for(var t=0,e=0;e<this.vertices.length-2;e++)t+=this.vertices[0].pos.dot(this.vertices[e+1].pos.cross(this.vertices[e+2].pos));return t/=6},t.prototype.getArea=function(){for(var t=0,e=0;e<this.vertices.length-2;e++)t+=this.vertices[e+1].pos.minus(this.vertices[0].pos).cross(this.vertices[e+2].pos.minus(this.vertices[e+1].pos)).length();return t/=2},t.prototype.getTetraFeatures=function(t){var e=[];return t.forEach((function(t){"volume"==t?e.push(this.getSignedVolume()):"area"==t&&e.push(this.getArea())}),this),e},t.prototype.extrude=function(e){var r=[],n=this;n.plane.normal.dot(e)>0&&(n=n.flipped()),r.push(n);for(var i=n.translate(e),o=this.vertices.length,s=0;s<o;s++){var a=[],u=s<o-1?s+1:0;a.push(n.vertices[s].pos),a.push(i.vertices[s].pos),a.push(i.vertices[u].pos),a.push(n.vertices[u].pos);var h=t.createFromPoints(a,this.shared);r.push(h)}return i=i.flipped(),r.push(i),p.CSG.fromPolygons(r)},t.prototype.boundingSphere=function(){if(!this.cachedBoundingSphere){var t=this.boundingBox(),e=t[0].plus(t[1]).times(.5),r=t[1].minus(e).length();this.cachedBoundingSphere=[e,r]}return this.cachedBoundingSphere},t.prototype.boundingBox=function(){if(!this.cachedBoundingBox){var t=void 0,e=void 0,r=this.vertices,n=r.length;e=t=0==n?new i.CSGVector3D(0,0,0):r[0].pos;for(var o=1;o<n;o++){var s=r[o].pos;t=t.min(s),e=e.max(s)}this.cachedBoundingBox=[t,e]}return this.cachedBoundingBox},t.prototype.flipped=function(){var e=this.vertices.map((function(t){return t.flipped()}));e.reverse();var r=this.plane.flipped();return new t(e,this.shared,r)},t.prototype.transform=function(e){var r=this.vertices.map((function(t){return t.transform(e)})),n=this.plane.transform(e);return e.isMirroring()&&r.reverse(),new t(r,this.shared,n)},t.prototype.toString=function(){var t="Polygon plane: "+this.plane.toString()+"\n";return this.vertices.map((function(e){t+="  "+e.toString()+"\n"})),t},t.prototype.projectToOrthoNormalBasis=function(t){var e=this.vertices.map((function(e){return t.to2D(e.pos)})),r=n.CAG.fromPointsNoCheck(e),i=r.area();return Math.abs(i)<1e-5?r=new n.CAG:i<0&&(r=r.flipped()),r},t.prototype.solidFromSlices=function(e){var r,n,i=[],o=null,s=null,a=null,u=2,h=!1,c=null;if(e&&(h=Boolean(e.loop),e.numslices&&(u=e.numslices),e.callback&&(n=e.callback)),!n){var l=t.createFromPoints([[0,0,0],[1,0,0],[1,1,0],[0,1,0]]);n=function(t,e){return 0==t||1==t?l.translate([0,0,t]):null}}for(var f=0,y=u-1;f<=y;f++)if(o=n.call(this,f/y,f)){if(!(o instanceof t))throw new Error("CSG.Polygon.solidFromSlices callback error: CSG.Polygon expected");o.checkIfConvex(),s?(null==c&&(c=s.plane.signedDistanceToPoint(o.vertices[0].pos)<0),this._addWalls(i,s,o,c)):r=o,s=o}if(a=o,h){r.vertices.length==a.vertices.length&&r.vertices.every((function(t,e){return t.pos.equals(a.vertices[e].pos)}))||this._addWalls(i,a,r,c)}else{var d=void 0;d=c?r:r.flipped(),i.unshift(d),i.push(c?a.flipped():a)}return p.CSG.fromPolygons(i)},t.prototype._addWalls=function(e,r,n,i){var o=r.vertices.slice(0),s=n.vertices.slice(0),a=n.shared||null;o[0].pos.equals(o[o.length-1].pos)||o.push(o[0]),s[0].pos.equals(s[s.length-1].pos)||s.push(s[0]),i&&(o=o.reverse(),s=s.reverse());for(var u,p=s.length-1,c=o.length-1,l=p-c,f=l>0,y=l<0,d=[],_=Math.abs(l);_>0;_--)d.push({len:1/0,index:-1});if(y)for(_=0;_<c;_++){u=o[_].pos.distanceToSquared(o[_+1].pos);for(var m=d.length-1;m>=0;m--)if(d[m].len>u){d[m].len=u,d[m].index=m;break}}else if(f)for(_=0;_<p;_++){u=s[_].pos.distanceToSquared(s[_+1].pos);for(m=d.length-1;m>=0;m--)if(d[m].len>u){d[m].len=u,d[m].index=m;break}}d.sort(h);for(var g,v=function(e,r,n,i){return new t([e,r,n],i)},x=o[0],b=s[0],S=0,T=0,C=p+c;S+T<C;){if(d.length){if(f&&T==d[0].index){g=s[++T],e.push(v(g,b,x,a)),b=g,d.shift();continue}if(y&&S==d[0].index){g=o[++S],e.push(v(b,x,g,a)),x=g,d.shift();continue}}(S<c?b.pos.distanceToSquared(o[S+1].pos):1/0)<=(T<p?x.pos.distanceToSquared(s[T+1].pos):1/0)?(g=o[++S],e.push(v(b,x,g,a)),x=g):T<p&&(g=s[++T],e.push(v(g,b,x,a)),b=g)}return e},t.prototype.mirrored=function(t){return this.transform(a.CSGMatrix4x4.mirroring(t))},t.prototype.mirroredX=function(){var t=new s.CSGPlane(i.CSGVector3D.Create(1,0,0),0);return this.mirrored(t)},t.prototype.mirroredY=function(){var t=new s.CSGPlane(i.CSGVector3D.Create(0,1,0),0);return this.mirrored(t)},t.prototype.mirroredZ=function(){var t=new s.CSGPlane(i.CSGVector3D.Create(0,0,1),0);return this.mirrored(t)},t.prototype.translate=function(t){return this.transform(a.CSGMatrix4x4.translation(t))},t.prototype.scale=function(t){return this.transform(a.CSGMatrix4x4.scaling(t))},t.prototype.rotateX=function(t){return this.transform(a.CSGMatrix4x4.rotationX(t))},t.prototype.rotateY=function(t){return this.transform(a.CSGMatrix4x4.rotationY(t))},t.prototype.rotateZ=function(t){return this.transform(a.CSGMatrix4x4.rotationZ(t))},t.prototype.rotate=function(t,e,r){return this.transform(a.CSGMatrix4x4.rotation(t,e,r))},t.prototype.rotateEulerAngles=function(t,e,r,n){n=n||[0,0,0];var o=a.CSGMatrix4x4.rotationZ(t),s=a.CSGMatrix4x4.rotationX(e),u=a.CSGMatrix4x4.rotationZ(r),p=a.CSGMatrix4x4.translation(new i.CSGVector3D(n));return this.transform(u.multiply(s).multiply(o).multiply(p))},t}();e.CSGPolygon=c},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.CAG=void 0;var n=r(14),i=r(55),o=r(56),s=r(6),a=r(75),u=r(9),p=r(30),h=r(40),c=r(29),l=r(7),f=r(8),y=r(120),d=r(121),_=function(){function t(){}return t.fromSides=function(e){var r=new t;return r.sides=e,r},t.fromPoints=function(e){var r=e.length;if(r<3)throw new Error("CAG shape needs at least 3 points");var s=[],a=new n.CSGVector2D(e[r-1]),u=new i.CAGVertex(a);e.map((function(t){var e=new n.CSGVector2D(t),r=new i.CAGVertex(e),a=new o.CAGSide(u,r);s.push(a),u=r}));var p=t.fromSides(s);if(p.isSelfIntersecting())throw new Error("Polygon is self intersecting!");var h=p.area();if(Math.abs(h)<1e-5)throw new Error("Degenerate polygon!");return h<0&&(p=p.flipped()),p=p.canonicalized()},t.fromPointsNoCheck=function(e){var r=[],s=new n.CSGVector2D(e[e.length-1]),a=new i.CAGVertex(s);return e.map((function(t){var e=new n.CSGVector2D(t),s=new i.CAGVertex(e),u=new o.CAGSide(a,s);r.push(u),a=s})),t.fromSides(r)},t.fromFakeCSG=function(e){var r=e.polygons.map((function(t){return o.CAGSide._fromFakePolygon(t)})).filter((function(t){return null!=t}));return t.fromSides(r)},t.linesIntersect=function(t,e,r,n){if(e.equals(r)||n.equals(t)){if(n.minus(r).unit().plus(e.minus(t).unit()).length()<1e-5)return!0}else{var i=e.minus(t),o=n.minus(r);if(Math.abs(i.cross(o))<1e-9)return!1;var a=s.CSG.solve2Linear(-i.x,o.x,-i.y,o.y,t.x-r.x,t.y-r.y);if(a[0]>1e-6&&a[0]<.999999&&a[1]>1e-5&&a[1]<.999999)return!0}return!1},t.circle=function(e){e=e||{};for(var r,a=s.CSG.parseOptionAs2DVector(e,"center",[0,0]),u=s.CSG.parseOptionAsFloat(e,"radius",1),p=s.CSG.parseOptionAsInt(e,"resolution",this.defaultResolution2D),h=[],c=0;c<=p;c++){var l=2*Math.PI*c/p,f=n.CSGVector2D.fromAngleRadians(l).times(u).plus(a),y=new i.CAGVertex(f);c>0&&h.push(new o.CAGSide(r,y)),r=y}return t.fromSides(h)},t.rectangle=function(e){var r,i;if("corner1"in(e=e||{})||"corner2"in e){if("center"in e||"radius"in e)throw new Error("rectangle: should either give a radius and center parameter, or a corner1 and corner2 parameter");var o=s.CSG.parseOptionAs2DVector(e,"corner1",[0,0]),a=s.CSG.parseOptionAs2DVector(e,"corner2",[1,1]);r=o.plus(a).times(.5),i=a.minus(o).times(.5)}else r=s.CSG.parseOptionAs2DVector(e,"center",[0,0]),i=s.CSG.parseOptionAs2DVector(e,"radius",[1,1]);i=i.abs();var u=new n.CSGVector2D(i.x,-i.y),p=[r.plus(i),r.plus(u),r.minus(i),r.minus(u)];return t.fromPoints(p)},t.roundedRectangle=function(e){var r,i;if("corner1"in(e=e||{})||"corner2"in e){if("center"in e||"radius"in e)throw new Error("roundedRectangle: should either give a radius and center parameter, or a corner1 and corner2 parameter");var o=s.CSG.parseOptionAs2DVector(e,"corner1",[0,0]),a=s.CSG.parseOptionAs2DVector(e,"corner2",[1,1]);r=o.plus(a).times(.5),i=a.minus(o).times(.5)}else r=s.CSG.parseOptionAs2DVector(e,"center",[0,0]),i=s.CSG.parseOptionAs2DVector(e,"radius",[1,1]);i=i.abs();var u=s.CSG.parseOptionAsFloat(e,"roundradius",.2),p=s.CSG.parseOptionAsInt(e,"resolution",this.defaultResolution2D),h=Math.min(i.x,i.y);h-=.1,u=Math.min(u,h),u=Math.max(0,u),i=new n.CSGVector2D(i.x-u,i.y-u);var c=t.rectangle({center:r,radius:i});return u>0&&(c=c.expand(u,p)),c},t.fromCompactBinary=function(t){if("CAG"!=t.class)throw new Error("Not a CAG");for(var e=[],r=t.vertexData,s=r.length/2,a=0,u=0;u<s;u++){var p=r[a++],h=r[a++],c=new n.CSGVector2D(p,h),l=new i.CAGVertex(c);e.push(l)}var f=[],y=t.sideVertexIndices.length/2;a=0;for(var d=0;d<y;d++){var _=t.sideVertexIndices[a++],m=t.sideVertexIndices[a++],g=new o.CAGSide(e[_],e[m]);f.push(g)}var v=this.fromSides(f);return v.isCanonicalized=!0,v},t.prototype.toString=function(){var t="CAG ("+this.sides.length+" sides):\n";return this.sides.map((function(e){t+="  "+e.toString()+"\n"})),t},t.prototype._toCSGWall=function(t,e){var r=this.sides.map((function(r){return r.toPolygon3D(t,e)}));return s.CSG.fromPolygons(r)},t.prototype._toVector3DPairs=function(t){var e=this.sides.map((function(t){var e=t.vertex0.pos,r=t.vertex1.pos;return[u.CSGVector3D.Create(e.x,e.y,0),u.CSGVector3D.Create(r.x,r.y,0)]}));return void 0!==t&&(e=e.map((function(e){return e.map((function(e){return e.transform(t)}))}))),e},t.prototype._toPlanePolygons=function(t){var e=t.flipped||!1,r=[0,0,0],i=[0,0,1],o=[0,1,0],h=new a.CSGConnector(r,i,o),l=t.translation||r,f=t.axisVector||i,y=t.normalVector||o,d=t.toConnector||new a.CSGConnector(l,f,y),_=h.getTransformationTo(d,!1,0),m=this.getBounds();m[0]=m[0].minus(new n.CSGVector2D(1,1)),m[1]=m[1].plus(new n.CSGVector2D(1,1));var g=this._toCSGWall(-1,1),v=s.CSG.fromPolygons([new p.CSGPolygon([new c.CSGVertex(new u.CSGVector3D(m[0].x,m[0].y,0)),new c.CSGVertex(new u.CSGVector3D(m[1].x,m[0].y,0)),new c.CSGVertex(new u.CSGVector3D(m[1].x,m[1].y,0)),new c.CSGVertex(new u.CSGVector3D(m[0].x,m[1].y,0))])]);return e&&(v=v.invert()),(v=v.intersectSub(g)).polygons.filter((function(t){return Math.abs(t.plane.normal.z)>.99})).map((function(t){return t.transform(_)}))},t.prototype._toWallPolygons=function(t){var e=new a.CSGConnector([0,0,0],[0,0,1],[0,1,0]),r=t.toConnector1,n=t.toConnector2;if(!(r instanceof a.CSGConnector&&n instanceof a.CSGConnector))throw"could not parse CSG.Connector arguments toConnector1 or toConnector2";if(t.cag&&t.cag.sides.length!=this.sides.length)throw"target cag needs same sides count as start cag";var i=t.cag||this,o=e.getTransformationTo(r,!1,0),s=e.getTransformationTo(n,!1,0),u=this._toVector3DPairs(o),h=i._toVector3DPairs(s),l=[];return u.forEach((function(t,e){l.push(new p.CSGPolygon([new c.CSGVertex(h[e][1]),new c.CSGVertex(h[e][0]),new c.CSGVertex(t[0])])),l.push(new p.CSGPolygon([new c.CSGVertex(h[e][1]),new c.CSGVertex(t[0]),new c.CSGVertex(t[1])]))})),l},t.prototype.union=function(e){var r;r=e instanceof Array?e:[e];var n=this._toCSGWall(-1,1);return n=n.union(r.map((function(t){return t._toCSGWall(-1,1).reTesselated()}))),t.fromFakeCSG(n).canonicalized()},t.prototype.subtract=function(e){var r;r=e instanceof Array?e:[e];var n=this._toCSGWall(-1,1);return r.map((function(t){n=n.subtractSub(t._toCSGWall(-1,1),!1,!1)})),n=(n=n.reTesselated()).canonicalized(),n=(n=t.fromFakeCSG(n)).canonicalized()},t.prototype.intersect=function(e){var r;r=e instanceof Array?e:[e];var n=this._toCSGWall(-1,1);return r.map((function(t){n=n.intersectSub(t._toCSGWall(-1,1),!1,!1)})),n=(n=n.reTesselated()).canonicalized(),n=(n=t.fromFakeCSG(n)).canonicalized()},t.prototype.transform=function(e){var r=e.isMirroring(),n=this.sides.map((function(t){return t.transform(e)})),i=t.fromSides(n);return r&&(i=i.flipped()),i},t.prototype.area=function(){var t=0;return this.sides.map((function(e){t+=e.vertex0.pos.cross(e.vertex1.pos)})),t*=.5},t.prototype.flipped=function(){var e=this.sides.map((function(t){return t.flipped()}));return e.reverse(),t.fromSides(e)},t.prototype.getBounds=function(){var t,e=t=0==this.sides.length?new n.CSGVector2D(0,0):this.sides[0].vertex0.pos;return this.sides.map((function(r){t=(t=t.min(r.vertex0.pos)).min(r.vertex1.pos),e=(e=e.max(r.vertex0.pos)).max(r.vertex1.pos)})),[t,e]},t.prototype.isSelfIntersecting=function(e){for(var r=this.sides.length,n=0;n<r;n++)for(var i=this.sides[n],o=n+1;o<r;o++){var s=this.sides[o];if(t.linesIntersect(i.vertex0.pos,i.vertex1.pos,s.vertex0.pos,s.vertex1.pos))return e&&(console.log(i),console.log(s)),!0}return!1},t.prototype.expandedShell=function(e,r){(r=r||8)<4&&(r=4);var i=[],o={},s=this.canonicalized();for(var a in s.sides.map((function(r){var n=r.vertex1.pos.minus(r.vertex0.pos),s=n.length();if(s>1e-5){var a=(n=n.times(1/s)).normal().times(e),u=[r.vertex1.pos.plus(a),r.vertex1.pos.minus(a),r.vertex0.pos.minus(a),r.vertex0.pos.plus(a)],p=t.fromPoints(u);i.push(p);for(var h=0;h<2;h++){var c=0==h?r.vertex0.pos:r.vertex1.pos,l=0==h?r.vertex1.pos:r.vertex0.pos,f=c.x+" "+c.y;f in o||(o[f]=[]),o[f].push({p1:c,p2:l})}}})),o){var u=o[a],p=void 0,h=void 0,c=u[0].p1;if(2==u.length){var l=u[0].p2,f=u[1].p2;if(p=l.minus(c).angleDegrees(),(h=f.minus(c).angleDegrees())<p&&(h+=360),h>=p+360&&(h-=360),h<p+180){var y=h;h=p+360,p=y}p+=90,h-=90}else p=0,h=360;var d=h>p+359.999;if(d&&(p=0,h=360),h>p+1e-5){var _=[];d||_.push(c);var m=Math.round(r*(h-p)/360);m<1&&(m=1);for(var g=0;g<=m;g++){var v=p+g/m*(h-p);g==m&&(v=h);var x=c.plus(n.CSGVector2D.fromAngleDegrees(v).times(e));(!d||g>0)&&_.push(x)}var b=t.fromPointsNoCheck(_);i.push(b)}}var S=new t;return S=S.union(i)},t.prototype.expand=function(t,e){return this.union(this.expandedShell(t,e))},t.prototype.contract=function(t,e){return this.subtract(this.expandedShell(t,e))},t.prototype.extrudeInOrthonormalBasis=function(t,e,r){if(!(t instanceof h.CSGOrthoNormalBasis))throw new Error("extrudeInPlane: the first parameter should be a CSG.OrthoNormalBasis");var n=this.extrude({offset:[0,0,e]});s.CSG.parseOptionAsBool(r,"symmetrical",!1)&&(n=n.translate([0,0,-e/2]));var i=t.getInverseProjectionMatrix();return n=n.transform(i)},t.prototype.extrudeInPlane=function(t,e,r,n){return this.extrudeInOrthonormalBasis(h.CSGOrthoNormalBasis.GetCartesian(t,e),r,n)},t.prototype.extrude=function(t){if(0==this.sides.length)return new s.CSG;var e=s.CSG.parseOptionAs3DVector(t,"offset",[0,0,1]),r=s.CSG.parseOptionAsFloat(t,"twistangle",0),n=s.CSG.parseOptionAsInt(t,"twiststeps",s.CSG.defaultResolution3D);if(0==e.z)throw"offset cannot be orthogonal to Z axis";(0==r||n<1)&&(n=1);var i=u.CSGVector3D.Create(0,1,0),o=[];o=(o=o.concat(this._toPlanePolygons({translation:[0,0,0],normalVector:i,flipped:!(e.z<0)}))).concat(this._toPlanePolygons({translation:e,normalVector:i.rotateZ(r),flipped:e.z<0}));for(var p=0;p<n;p++){var h=new a.CSGConnector(e.times(p/n),[0,0,e.z],i.rotateZ(p*r/n)),c=new a.CSGConnector(e.times((p+1)/n),[0,0,e.z],i.rotateZ((p+1)*r/n));o=o.concat(this._toWallPolygons({toConnector1:h,toConnector2:c}))}return s.CSG.fromPolygons(o)},t.prototype.rotateExtrude=function(t){var e=s.CSG.parseOptionAsFloat(t,"angle",360),r=s.CSG.parseOptionAsInt(t,"resolution",s.CSG.defaultResolution3D);e=e>360?e%360:e;var n=[0,0,0],i=u.CSGVector3D.Create(0,1,0),o=[0,0,1],p=[],h=new a.CSGConnector(n,i,o);if(e>0&&e<360){var c=new a.CSGConnector(n,i.rotateZ(-e),o);p=(p=p.concat(this._toPlanePolygons({toConnector:h,flipped:!0}))).concat(this._toPlanePolygons({toConnector:c}))}for(var l,f=h,y=e/r,d=y;d<=e+1e-5;d+=y)l=new a.CSGConnector(n,i.rotateZ(-d),o),p=p.concat(this._toWallPolygons({toConnector1:f,toConnector2:l})),f=l;return s.CSG.fromPolygons(p).reTesselated()},t.prototype.check=function(){var t=[];this.isSelfIntersecting(!0)&&t.push("Self intersects");var e={};for(var r in this.sides.map((function(t){function r(t){var r=t.x+" "+t.y;r in e||(e[r]=0),e[r]++}r(t.vertex0.pos),r(t.vertex1.pos)})),e){var n=e[r];1&n&&t.push("Uneven number of sides ("+n+") for point "+r)}var i=this.area();if(i<1e-5*1e-5&&t.push("Area is "+i),t.length>0){var o="";throw t.map((function(t){o+=t+"\n"})),new Error(o)}},t.prototype.canonicalized=function(){if(this.isCanonicalized)return this;var t=(new y.CAGFuzzyFactory).getCAG(this);return t.isCanonicalized=!0,t},t.prototype.toCompactBinary=function(){var t=this.canonicalized(),e=t.sides.length,r={},n=[],i=0,o=new Uint32Array(2*e),s=0;t.sides.map((function(t){[t.vertex0,t.vertex1].map((function(t){var e,a=t.getTag();a in r?e=r[a]:(e=i++,r[a]=e,n.push(t)),o[s++]=e}))}));var a=new Float64Array(2*i),u=0;return n.map((function(t){var e=t.pos;a[u++]=e._x,a[u++]=e._y})),{class:"CAG",sideVertexIndices:o,vertexData:a}},t.prototype.getOutlinePaths=function(){var t=this.canonicalized(),e={},r={};t.sides.map((function(t){var n=t.getTag();e[n]=t;var i=t.vertex0.getTag();i in r||(r[i]=[]),r[i].push(n)}));for(var n=[];;){var i=null;for(var o in r){var s=r[o];i=s[0],s.splice(0,1),0==s.length&&delete r[o];break}if(null==i)break;for(var a=[],u=e[i],p=u.vertex0.getTag();;){a.push(u.vertex0.pos);var h=u.vertex1.getTag();if(h==p)break;if(!(h in r))throw new Error("Area is not closed!");var c=r[h],l=-1;if(1==c.length)l=0;else for(var f=null,y=u.direction().angleDegrees(),_=0;_<c.length;_++){var m=c[_],g=e[m].direction().angleDegrees()-y;g<-180&&(g+=360),g>=180&&(g-=360),(l<0||g>f)&&(l=_,f=g)}var v=c[l];c.splice(l,1),0==c.length&&delete r[h],u=e[v]}var x=new d.CSGPath2D(a,!0);n.push(x)}return n},t.prototype.overCutInsideCorners=function(e){var r=this.canonicalized(),i={};r.sides.map((function(t){t.vertex0.getTag()in i||(i[t.vertex0.getTag()]={pos:t.vertex0.pos,from:[],to:[]}),i[t.vertex0.getTag()].to.push(t.vertex1.pos),t.vertex1.getTag()in i||(i[t.vertex1.getTag()]={pos:t.vertex1.pos,from:[],to:[]}),i[t.vertex1.getTag()].from.push(t.vertex0.pos)}));var o=[];for(var s in i){var a=i[s];if(1==a.from.length&&1==a.to.length){var u=a.from[0],p=a.pos,h=a.to[0],c=p.minus(u).unit(),l=h.minus(p).unit();if(c.cross(l)<.001){var f=l.angleRadians()-c.angleRadians()+Math.PI;f<0?f+=2*Math.PI:f>=2*Math.PI&&(f-=2*Math.PI);for(var y=l.minus(c).unit(),d=30/180*Math.PI,_=e/Math.cos(d/2),m=p.plus(y.times(_)),g=f+y.angleRadians(),v=2*(Math.PI-f),x=2*Math.ceil(v/d/2),b=[m],S=0;S<=x;S++){var T=g+S/x*v,C=n.CSGVector2D.fromAngleRadians(T).times(_).plus(m);b.push(C)}o.push(t.fromPoints(b))}}}return r.subtract(o)},t.prototype.mirrored=function(t){return this.transform(l.CSGMatrix4x4.mirroring(t))},t.prototype.mirroredX=function(){var t=new f.CSGPlane(u.CSGVector3D.Create(1,0,0),0);return this.mirrored(t)},t.prototype.mirroredY=function(){var t=new f.CSGPlane(u.CSGVector3D.Create(0,1,0),0);return this.mirrored(t)},t.prototype.mirroredZ=function(){var t=new f.CSGPlane(u.CSGVector3D.Create(0,0,1),0);return this.mirrored(t)},t.prototype.translate=function(t){return this.transform(l.CSGMatrix4x4.translation(t))},t.prototype.scale=function(t){return this.transform(l.CSGMatrix4x4.scaling(t))},t.prototype.rotateX=function(t){return this.transform(l.CSGMatrix4x4.rotationX(t))},t.prototype.rotateY=function(t){return this.transform(l.CSGMatrix4x4.rotationY(t))},t.prototype.rotateZ=function(t){return this.transform(l.CSGMatrix4x4.rotationZ(t))},t.prototype.rotate=function(t,e,r){return this.transform(l.CSGMatrix4x4.rotation(t,e,r))},t.prototype.rotateEulerAngles=function(t,e,r,n){n=n||[0,0,0];var i=l.CSGMatrix4x4.rotationZ(t),o=l.CSGMatrix4x4.rotationX(e),s=l.CSGMatrix4x4.rotationZ(r),a=l.CSGMatrix4x4.translation(new u.CSGVector3D(n));return this.transform(s.multiply(o).multiply(i).multiply(a))},t.prototype.center=function(t){var e=["x","y"];(t=Array.prototype.map.call(arguments,(function(t){return t.toLowerCase()}))).length||(t=e.slice());var r=this.getBounds();return this.translate(e.map((function(e){return t.indexOf(e)>-1?-(r[0][e]+r[1][e])/2:0})))},t}();e.CAG=_},function(t,e,r){"use strict";var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(e,"__esModule",{value:!0}),e.Geometry=void 0;var o=r(4),s=r(22),a=r(59),u=r(60),p=r(61),h=r(21),c=r(151),l=r(11),f=new o.Matrix4,y=new o.Vector3,d=new o.Vector3,_=new o.Box3,m=new o.Box3,g=0,v=function(t){function e(){var e=t.call(this)||this;return e.uuid=o.MathUtils.generateUUID(),e.id=g+=2,e.name="",e.indexAttrbute=null,e.attributes={},e.morphAttributes={},e.morphTargetsRelative=!1,e.boundingBox=null,e.boundingSphere=null,e.groups=[],e.drawRange={start:0,count:1/0},e.version=0,e.reference=0,e}return i(e,t),e.prototype.dispose=function(){if(this.reference--,0==this.reference){t.prototype.dispose.call(this),this.indexAttrbute&&(this.indexAttrbute.dispose(),this.indexAttrbute=null);var e=this.attributes;for(var r in e)e[r]&&(e[r].dispose(),delete e[r]);var n=this.morphAttributes;for(var r in n)if(n[r]){var i=n[r];for(var o in i)i[o].dispose(),delete i[o];delete n[r]}}},e.prototype.addReference=function(){this.reference++},e.prototype.getIndexAttrbute=function(){return this.indexAttrbute},e.prototype.setIndexAttrbute=function(t){return this.indexAttrbute!=t&&(this.indexAttrbute&&(this.indexAttrbute.dispose(),this.indexAttrbute=null),Array.isArray(t)?this.indexAttrbute=new(c.ArrayUtils.arrayMax(t)>65535?a.UInt32BufferAttribute:a.UInt16BufferAttribute)(t,1):this.indexAttrbute=t,this.indexAttrbute.target=l.Constants.ElementBufferTarget,this.indexAttrbute.addReference()),this},e.prototype.isEmptyAttribute=function(){return Object.keys(this.attributes).length<=0},e.prototype.haveAttribute=function(t){return null!=(t==u.BufferAttributeKind.IndicesKind?this.indexAttrbute:this.attributes[t])},e.prototype.getAttribute=function(t){return t==u.BufferAttributeKind.IndicesKind?this.indexAttrbute:this.attributes[t]},e.prototype.setAttribute=function(t,e){return e instanceof s.BufferAttribute&&t==u.BufferAttributeKind.IndicesKind?this.setIndexAttrbute(e):(this.attributes[t]!=e&&(this.attributes[t]&&this.attributes[t].dispose(),this.attributes[t]=e,this.attributes[t]&&this.attributes[t].addReference()),this)},e.prototype.removeAttribute=function(t){return this.attributes[t]&&(this.attributes[t].dispose(),delete this.attributes[t]),this},e.prototype.forceUpdateAttributes=function(){this.indexAttrbute&&(this.indexAttrbute.needsUpdate=!0);var t=this.attributes;for(var e in t)this.attributes[e]&&(this.attributes[e].needsUpdate=!0);return this},e.prototype.addGroup=function(t,e,r){return void 0===r&&(r=0),this.groups.push({start:t,count:e,materialIndex:r}),this},e.prototype.clearGroups=function(){return this.groups.length=0,this},e.prototype.sortGroupByMaterial=function(){return this.groups.sort((function(t,e){return t.materialIndex-e.materialIndex})),this},e.prototype.sortGroupByStart=function(){return this.groups.sort((function(t,e){return t.start-e.start})),this},e.prototype.setDrawRange=function(t,e){return this.drawRange.start=t,this.drawRange.count=e,this},e.prototype.applyMatrix=function(t){var e=this.attributes.position;e&&(e.applyMatrix4(t),e.needsUpdate=!0);var r=this.attributes.normal;r&&(r.transformDirection(t),r.needsUpdate=!0);var n=this.attributes.tangent;return n&&(n.transformDirection(t),n.needsUpdate=!0),this.boundingBox&&this.computeBoundingBox(),this.boundingSphere&&this.computeBoundingSphere(),this},e.prototype.applyQuaternion=function(t){var e=this.attributes.position;e&&(t.applyToBufferAttribute(e),e.needsUpdate=!0);var r=this.attributes.normal;r&&(t.applyToBufferAttribute(r),r.needsUpdate=!0);var n=this.attributes.tangent;return n&&(t.applyToBufferAttribute(n),r.needsUpdate=!0),this.boundingBox&&this.computeBoundingBox(),this.boundingSphere&&this.computeBoundingSphere(),this},e.prototype.rotateX=function(t){return f.makeRotationX(t),this.applyMatrix(f),this},e.prototype.rotateY=function(t){return f.makeRotationY(t),this.applyMatrix(f),this},e.prototype.rotateZ=function(t){return f.makeRotationZ(t),this.applyMatrix(f),this},e.prototype.translate=function(t){return f.makeTranslationVector(t),this.applyMatrix(f),this},e.prototype.scale=function(t){return f.makeScaleVector(t),this.applyMatrix(f),this},e.prototype.lookAt=function(t){return f.lookAt(o.Vector3.ZERO,t,o.Vector3.UNIT_Y),this.applyMatrix(f),this},e.prototype.moveToOrigin=function(){var t;return this.computeBoundingBox(),null===(t=this.boundingBox)||void 0===t||t.getCenter(y).negate(),this.translate(y),this},e.prototype.setFromPoints=function(t){for(var e=[],r=0,n=t.length;r<n;r++){var i=t[r];e.push(i.x,i.y,i instanceof o.Vector2?0:i.z)}return this.setAttribute(u.BufferAttributeKind.PositionKind,new a.Float32BufferAttribute(e,3)),this},e.prototype.computeBoundingBox=function(){null==this.boundingBox&&(this.boundingBox=new o.Box3);var t=this.attributes[u.BufferAttributeKind.PositionKind],e=this.morphAttributes[u.BufferAttributeKind.PositionKind];if(t){if(this.boundingBox.setFromBufferAttribute(t),e)for(var r=0,n=e.length;r<n;r++){var i=e[r];_.setFromBufferAttribute(i),this.morphTargetsRelative?(y.addVectors(this.boundingBox.min,_.min),this.boundingBox.expandByPoint(y),y.addVectors(this.boundingBox.max,_.max),this.boundingBox.expandByPoint(y)):(this.boundingBox.expandByPoint(_.min),this.boundingBox.expandByPoint(_.max))}}else this.boundingBox.makeEmpty();return(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.warn('computeBoundingBox: Computed min/max have NaN values. The "position" attribute is likely to have NaN values.'),this},e.prototype.computeBoundingSphere=function(){null==this.boundingSphere&&(this.boundingSphere=new o.Sphere);var t=this.attributes[u.BufferAttributeKind.PositionKind],e=this.morphAttributes[u.BufferAttributeKind.PositionKind];if(t){var r=this.boundingSphere.center;if(_.setFromBufferAttribute(t),e)for(var n=0,i=e.length;n<i;n++){var s=e[n];m.setFromBufferAttribute(s),this.morphTargetsRelative?(y.addVectors(_.min,m.min),_.expandByPoint(y),y.addVectors(_.max,m.max),_.expandByPoint(y)):(_.expandByPoint(m.min),_.expandByPoint(m.max))}_.getCenter(r);var a=0;for(n=0,i=t.count;n<i;n++)y.fromBufferAttribute(t,n),a=Math.max(a,r.distanceToSquared(y));if(e)for(n=0,i=e.length;n<i;n++){s=e[n];for(var p=this.morphTargetsRelative,h=0,c=s.count;h<c;h++)y.fromBufferAttribute(s,h),p&&(d.fromBufferAttribute(t,h),y.add(d)),a=Math.max(a,r.distanceToSquared(y))}this.boundingSphere.radius=Math.sqrt(a),isNaN(this.boundingSphere.radius)&&console.error('VISION.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}return this},e.prototype.computeVertexNormals=function(){var t=this.getAttribute(u.BufferAttributeKind.IndicesKind),e=this.getAttribute(u.BufferAttributeKind.PositionKind);if(e){var r=this.getAttribute(u.BufferAttributeKind.NormalKind);if(r)for(var n=0,i=r.count;n<i;n++)r.setXYZ(n,0,0,0);else r=new s.BufferAttribute(new Float32Array(3*e.count),3),this.setAttribute(u.BufferAttributeKind.NormalKind,r);var a=new o.Vector3,p=new o.Vector3,h=new o.Vector3,c=new o.Vector3,l=new o.Vector3,f=new o.Vector3,y=new o.Vector3,d=new o.Vector3;if(t)for(n=0,i=t.count;n<i;n+=3){var _=t.getX(n+0),m=t.getX(n+1),g=t.getX(n+2);a.fromBufferAttribute(e,_),p.fromBufferAttribute(e,m),h.fromBufferAttribute(e,g),y.subVectors(h,p),d.subVectors(a,p),y.cross(d),c.fromBufferAttribute(r,_),l.fromBufferAttribute(r,m),f.fromBufferAttribute(r,g),c.add(y),l.add(y),f.add(y),r.setXYZ(_,c.x,c.y,c.z),r.setXYZ(m,l.x,l.y,l.z),r.setXYZ(g,f.x,f.y,f.z)}else for(n=0,i=e.count;n<i;n+=3)a.fromBufferAttribute(e,n+0),p.fromBufferAttribute(e,n+1),h.fromBufferAttribute(e,n+2),y.subVectors(h,p),d.subVectors(a,p),y.cross(d),r.setXYZ(n+0,y.x,y.y,y.z),r.setXYZ(n+1,y.x,y.y,y.z),r.setXYZ(n+2,y.x,y.y,y.z);this.normalizeNormals()}return this},e.prototype.normalizeNormals=function(){for(var t=this.attributes.normal,e=0,r=t.count;e<r;e++)y.fromBufferAttribute(t,e),y.normalize(),t.setXYZ(e,y.x,y.y,y.z);return t.needsUpdate=!0,this},e.prototype.mergeAttributes=function(t,e){void 0===e&&(e=0);var r=this.attributes;for(var n in r)if(t.attributes[n])for(var i=r[n].array,o=t.attributes[n],s=o.array,a=o.itemSize*e,u=Math.min(s.length,i.length-a),p=0,h=a;p<u;p++,h++)i[h]=s[p];return this},e.prototype.toNonIndexed=function(){var t=function(t,e){for(var r=t.array,n=t.itemSize,i=t.normalized,o=p.DataTypeFormat.createTypedArrayFromDataType(t.type,e.length*n),a=0,u=0,h=0,c=e.length;h<c;h++){a=e[h]*n;for(var l=0;l<n;l++)o[u++]=r[a++]}return new s.BufferAttribute(o,n,i)};if(!this.haveAttribute(u.BufferAttributeKind.IndicesKind))return this;var r=new e,n=this.getAttribute(u.BufferAttributeKind.IndicesKind),i=this.attributes;for(var o in i){if((_=i[o])instanceof s.BufferAttribute){var a=t(_,n.array);r.setAttribute(o,a)}}var h=this.morphAttributes;for(var c in h){for(var l=[],f=h[c],y=0,d=f.length;y<d;y++){var _;if((_=f[y])instanceof s.BufferAttribute){a=t(_,n.array);l.push(a)}}r.morphAttributes[c]=l}r.morphTargetsRelative=this.morphTargetsRelative;for(var m=this.groups,g=(y=0,m.length);y<g;y++){var v=m[y];r.addGroup(v.start,v.count,v.materialIndex)}return r},e.prototype.clone=function(){return(new e).copy(this)},e.prototype.copy=function(t){this.name=t.name;var e=t.getIndexAttrbute();e&&this.setIndexAttrbute(e.clone());var r={cacheKey:new Map,arrayBuffers:{},interleavedBuffers:{}},n=t.attributes;for(var i in n){var o=n[i];this.setAttribute(i,o.clone(r))}var s=t.morphAttributes;for(var a in s){for(var u=[],p=s[a],h=0,c=p.length;h<c;h++)u.push(p[h].clone(r));this.morphAttributes[a]=u}this.morphTargetsRelative=t.morphTargetsRelative;var l=t.groups;for(h=0,c=l.length;h<c;h++){var f=l[h];this.addGroup(f.start,f.count,f.materialIndex)}var y=t.boundingBox;y&&(this.boundingBox=y.clone());var d=t.boundingSphere;return d&&(this.boundingSphere=d.clone()),this.drawRange.start=t.drawRange.start,this.drawRange.count=t.drawRange.count,this},e}(h.EventDispatcher);e.Geometry=v},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Euler=void 0;var n=r(63),i=r(1),o=r(5),s=function(){function t(t,e,r,i){void 0===t&&(t=0),void 0===e&&(e=0),void 0===r&&(r=0),void 0===i&&(i=n.EulerOrder.YXZ),this._x=t,this._y=e,this._z=r,this._order=i,this._notify=!0,this._onNotify=null}return t.Build=function(){return new t},Object.defineProperty(t.prototype,"x",{get:function(){return this._x},set:function(t){this._x!=t&&(this._x=t,this.triggerNotify())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"y",{get:function(){return this._y},set:function(t){this._y!=t&&(this._y=t,this.triggerNotify())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"z",{get:function(){return this._z},set:function(t){this._z!=t&&(this._z=t,this.triggerNotify())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"order",{get:function(){return this._order},set:function(t){this._order!=t&&(this._order=t,this.triggerNotify())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"notify",{get:function(){return this._notify},set:function(t){this._notify=t},enumerable:!1,configurable:!0}),t.prototype.setNotifyFunc=function(t){return this._onNotify=t,this},t.prototype.triggerNotify=function(){this._notify&&this._onNotify&&this._onNotify()},t.prototype.set=function(t,e,r,n){return void 0===n&&(n=null),this._x=t,this._y=e,this._z=r,this._order=n||this._order,this.triggerNotify(),this},t.prototype.setComponent=function(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;default:throw new Error("index is out of range: "+t)}return this},t.prototype.getComponent=function(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+t)}},t.prototype.clone=function(){return new t(this._x,this._y,this._z,this._order)},t.prototype.copy=function(t){return this._x=t._x,this._y=t._y,this._z=t._z,this._order=t._order,this.triggerNotify(),this},t.prototype.setFromRotationMatrix=function(t,e){var r=i.MathUtils.clamp,o=t.elements,s=o[0],a=o[4],u=o[8],p=o[1],h=o[5],c=o[9],l=o[2],f=o[6],y=o[10];switch(e=e||this._order){case n.EulerOrder.XYZ:this._y=Math.asin(r(u,-1,1)),Math.abs(u)<.9999999?(this._x=Math.atan2(-c,y),this._z=Math.atan2(-a,s)):(this._x=Math.atan2(f,h),this._z=0);break;case n.EulerOrder.YXZ:this._x=Math.asin(-r(c,-1,1)),Math.abs(c)<.9999999?(this._y=Math.atan2(u,y),this._z=Math.atan2(p,h)):(this._y=Math.atan2(-l,s),this._z=0);break;case n.EulerOrder.ZXY:this._x=Math.asin(r(f,-1,1)),Math.abs(f)<.9999999?(this._y=Math.atan2(-l,y),this._z=Math.atan2(-a,h)):(this._y=0,this._z=Math.atan2(p,s));break;case n.EulerOrder.ZYX:this._y=Math.asin(-r(l,-1,1)),Math.abs(l)<.9999999?(this._x=Math.atan2(f,y),this._z=Math.atan2(p,s)):(this._x=0,this._z=Math.atan2(-a,h));break;case n.EulerOrder.YZX:this._z=Math.asin(r(p,-1,1)),Math.abs(p)<.9999999?(this._x=Math.atan2(-c,h),this._y=Math.atan2(-l,s)):(this._x=0,this._y=Math.atan2(u,y));break;case n.EulerOrder.XZY:this._z=Math.asin(-r(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(f,h),this._y=Math.atan2(u,s)):(this._x=Math.atan2(-c,y),this._y=0)}return this._order=e,this.triggerNotify(),this},t.prototype.setFromQuaternion=function(t,e){return o.MathTmp.Matrix4[0].makeRotationFromQuaternion(t),this.setFromRotationMatrix(o.MathTmp.Matrix4[0],e)},t.prototype.setFromVector3=function(t,e){return this.set(t.x,t.y,t.z,e||this._order)},t.prototype.reorder=function(t){return o.MathTmp.Quaternion[0].setFromEuler(this),this.setFromQuaternion(o.MathTmp.Quaternion[0],t)},t.prototype.equals=function(t){return t._x==this._x&&t._y==this._y&&t._z==this._z&&t._order==this._order},t.prototype.equalsEpsilon=function(t,e,r){return void 0===r&&(r=null),i.MathUtils.equalsEpsilon(this._x,t.x,e,r)&&i.MathUtils.equalsEpsilon(this._y,t.y,e,r)&&i.MathUtils.equalsEpsilon(this._z,t.z,e,r)&&this._order==t._order},t.prototype.fromArray=function(t,e){return void 0===e&&(e=0),this._x=t[e],this._y=t[e+1],this._z=t[e+2],this._order=t[e+3],this.triggerNotify(),this},t.prototype.toArray=function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._order,t},t.prototype.fromDataBuffer=function(t){return this._x=t.readFloat32(),this._y=t.readFloat32(),this._z=t.readFloat32(),this._order=t.readInt8(),this.triggerNotify(),this},t.prototype.toDataBuffer=function(t){return t.writeFloat32(this._x),t.writeFloat32(this._y),t.writeFloat32(this._z),t.writeInt8(this._order),this},t}();e.Euler=s},function(t,e,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(t,e,r,n){void 0===n&&(n=r),Object.defineProperty(t,n,{enumerable:!0,get:function(){return e[r]}})}:function(t,e,r,n){void 0===n&&(n=r),t[n]=e[r]}),i=this&&this.__exportStar||function(t,e){for(var r in t)"default"===r||e.hasOwnProperty(r)||n(e,t,r)};Object.defineProperty(e,"__esModule",{value:!0}),i(r(63),e),i(r(64),e),i(r(65),e),i(r(42),e)},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Quaternion=void 0;var n=r(1),i=r(34),o=r(17),s=r(5),a=function(){function t(t,e,r,n){void 0===t&&(t=0),void 0===e&&(e=0),void 0===r&&(r=0),void 0===n&&(n=1),this._x=t,this._y=e,this._z=r,this._w=n,this._notify=!0,this._onNotify=null}return t.slerp=function(t,e,r,n){return r.copy(t).slerp(e,n)},t.slerpFlat=function(t,e,r,i,o,s,a){var u=r[i+0],p=r[i+1],h=r[i+2],c=r[i+3],l=o[s+0],f=o[s+1],y=o[s+2],d=o[s+3];if(c!=d||u!=l||p!=f||h!=y){var _=1-a,m=u*l+p*f+h*y+c*d,g=m>=0?1:-1,v=1-m*m;if(v>n.MathUtils.EPSILON14){var x=Math.sqrt(v),b=Math.atan2(x,m*g);_=Math.sin(_*b)/x,a=Math.sin(a*b)/x}var S=a*g;if(u=u*_+l*S,p=p*_+f*S,h=h*_+y*S,c=c*_+d*S,_==1-a){var T=1/Math.sqrt(u*u+p*p+h*h+c*c);u*=T,p*=T,h*=T,c*=T}}t[e]=u,t[e+1]=p,t[e+2]=h,t[e+3]=c},t.multiplyQuaternionsFlat=function(t,e,r,i,o,s,a){var u=r[i+0],p=r[i+1],h=r[i+2],c=r[i+3],l=o[s+0],f=o[s+1],y=o[s+2],d=o[s+3];if(c!=d||u!=l||p!=f||h!=y){var _=1-a,m=u*l+p*f+h*y+c*d,g=m>=0?1:-1,v=1-m*m;if(v>n.MathUtils.EPSILON14){var x=Math.sqrt(v),b=Math.atan2(x,m*g);_=Math.sin(_*b)/x,a=Math.sin(a*b)/x}var S=a*g;if(u=u*_+l*S,p=p*_+f*S,h=h*_+y*S,c=c*_+d*S,_==1-a){var T=1/Math.sqrt(u*u+p*p+h*h+c*c);u*=T,p*=T,h*=T,c*=T}}t[e]=u,t[e+1]=p,t[e+2]=h,t[e+3]=c},t.Build=function(){return new t},Object.defineProperty(t.prototype,"x",{get:function(){return this._x},set:function(t){this._x!=t&&(this._x=t,this.triggerNotify())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"y",{get:function(){return this._y},set:function(t){this._y!=t&&(this._y=t,this.triggerNotify())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"z",{get:function(){return this._z},set:function(t){this._z!=t&&(this._z=t,this.triggerNotify())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"w",{get:function(){return this._w},set:function(t){this._w!=t&&(this._w=t,this.triggerNotify())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"notify",{get:function(){return this._notify},set:function(t){this._notify=t},enumerable:!1,configurable:!0}),t.prototype.setNotifyFunc=function(t){return this._onNotify=t,this},t.prototype.triggerNotify=function(){this._notify&&this._onNotify&&this._onNotify()},t.prototype.set=function(t,e,r,n){return this._x=t,this._y=e,this._z=r,this._w=n,this.triggerNotify(),this},t.prototype.setComponent=function(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;case 3:this.w=e;break;default:throw new Error("index is out of range: "+t)}return this},t.prototype.getComponent=function(t){switch(t){case 0:return this._x;case 1:return this._y;case 2:return this._z;case 3:return this._w;default:throw new Error("index is out of range: "+t)}},t.prototype.clone=function(){return new t(this._x,this._y,this._z,this._w)},t.prototype.copy=function(t){return this._x=t.x,this._y=t.y,this._z=t.z,this._w=t.w,this.triggerNotify(),this},t.prototype.add=function(t){return this._x+=t.x,this._y+=t.y,this._z+=t.z,this._w+=t.w,this.triggerNotify(),this},t.prototype.addQuaternions=function(t,e){return this._x=t.x+e.x,this._y=t.y+e.y,this._z=t.z+e.z,this._w=t.w+e.w,this},t.prototype.setFromEuler=function(t){var e=t.x,r=t.y,n=t.z,o=t.order,s=Math.cos,a=Math.sin,u=s(e/2),p=s(r/2),h=s(n/2),c=a(e/2),l=a(r/2),f=a(n/2);switch(o){case i.EulerOrder.XYZ:this._x=c*p*h+u*l*f,this._y=u*l*h-c*p*f,this._z=u*p*f+c*l*h,this._w=u*p*h-c*l*f;break;case i.EulerOrder.YXZ:this._x=c*p*h+u*l*f,this._y=u*l*h-c*p*f,this._z=u*p*f-c*l*h,this._w=u*p*h+c*l*f;break;case i.EulerOrder.ZXY:this._x=c*p*h-u*l*f,this._y=u*l*h+c*p*f,this._z=u*p*f+c*l*h,this._w=u*p*h-c*l*f;break;case i.EulerOrder.ZYX:this._x=c*p*h-u*l*f,this._y=u*l*h+c*p*f,this._z=u*p*f-c*l*h,this._w=u*p*h+c*l*f;break;case i.EulerOrder.YZX:this._x=c*p*h+u*l*f,this._y=u*l*h+c*p*f,this._z=u*p*f-c*l*h,this._w=u*p*h-c*l*f;break;case i.EulerOrder.XZY:this._x=c*p*h-u*l*f,this._y=u*l*h-c*p*f,this._z=u*p*f+c*l*h,this._w=u*p*h+c*l*f}return this.triggerNotify(),this},t.prototype.setFromAxisAngle=function(t,e){var r=e/2,n=Math.sin(r);return this._x=t.x*n,this._y=t.y*n,this._z=t.z*n,this._w=Math.cos(r),this.triggerNotify(),this},t.prototype.setFromRotationMatrix=function(t){var e,r=t instanceof o.Matrix4,n=t.elements,i=n[0],s=r?n[4]:n[3],a=r?n[8]:n[6],u=n[1],p=r?n[5]:n[4],h=r?n[9]:n[7],c=n[2],l=r?n[6]:n[5],f=r?n[10]:n[8],y=i+p+f;return y>0?(e=.5/Math.sqrt(y+1),this._w=.25/e,this._x=(l-h)*e,this._y=(a-c)*e,this._z=(u-s)*e):i>p&&i>f?(e=2*Math.sqrt(1+i-p-f),this._w=(l-h)/e,this._x=.25*e,this._y=(s+u)/e,this._z=(a+c)/e):p>f?(e=2*Math.sqrt(1+p-i-f),this._w=(a-c)/e,this._x=(s+u)/e,this._y=.25*e,this._z=(h+l)/e):(e=2*Math.sqrt(1+f-i-p),this._w=(u-s)/e,this._x=(a+c)/e,this._y=(h+l)/e,this._z=.25*e),this.triggerNotify(),this},t.prototype.setFromUnitVectors=function(t,e){var r=t.dot(e)+1;return r<1e-6?(r=0,Math.abs(t.x)>Math.abs(t.z)?(this._x=-t.y,this._y=t.x,this._z=0,this._w=r):(this._x=0,this._y=-t.z,this._z=t.y,this._w=r)):(this._x=t.y*e.z-t.z*e.y,this._y=t.z*e.x-t.x*e.z,this._z=t.x*e.y-t.y*e.x,this._w=r),this.normalize()},t.prototype.angleTo=function(t){return 2*Math.acos(Math.abs(n.MathUtils.clamp(this.dot(t),-1,1)))},t.prototype.rotateTowards=function(t,e){var r=this.angleTo(t);if(0==r)return this;var n=Math.min(1,e/r);return this.slerp(t,n),this},t.prototype.inverse=function(){return this.conjugate()},t.prototype.conjugate=function(){return this._x*=-1,this._y*=-1,this._z*=-1,this.triggerNotify(),this},t.prototype.dot=function(t){return this._x*t._x+this._y*t._y+this._z*t._z+this._w*t._w},t.prototype.lengthSq=function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},t.prototype.length=function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},t.prototype.normalize=function(){var t=this.length();return 0==t?(this._x=0,this._y=0,this._z=0,this._w=1):(t=1/t,this._x=this._x*t,this._y=this._y*t,this._z=this._z*t,this._w=this._w*t),this.triggerNotify(),this},t.prototype.multiply=function(t){return this.multiplyQuaternions(this,t)},t.prototype.premultiply=function(t){return this.multiplyQuaternions(t,this)},t.prototype.multiplyQuaternions=function(t,e){var r=t._x,n=t._y,i=t._z,o=t._w,s=e._x,a=e._y,u=e._z,p=e._w;return this._x=r*p+o*s+n*u-i*a,this._y=n*p+o*a+i*s-r*u,this._z=i*p+o*u+r*a-n*s,this._w=o*p-r*s-n*a-i*u,this.triggerNotify(),this},t.prototype.slerp=function(t,e){if(0==e)return this;if(1==e)return this.copy(t);var r=this._x,i=this._y,o=this._z,s=this._w,a=s*t._w+r*t._x+i*t._y+o*t._z;if(a<0?(this._w=-t._w,this._x=-t._x,this._y=-t._y,this._z=-t._z,a=-a):this.copy(t),a>=1)return this._w=s,this._x=r,this._y=i,this._z=o,this;var u=1-a*a;if(u<=n.MathUtils.EPSILON14){var p=1-e;return this._w=p*s+e*this._w,this._x=p*r+e*this._x,this._y=p*i+e*this._y,this._z=p*o+e*this._z,this.normalize()}var h=Math.sqrt(u),c=Math.atan2(h,a),l=Math.sin((1-e)*c)/h,f=Math.sin(e*c)/h;return this._w=s*l+this._w*f,this._x=r*l+this._x*f,this._y=i*l+this._y*f,this._z=o*l+this._z*f,this.triggerNotify(),this},t.prototype.applyToBufferAttribute=function(t){for(var e=0,r=t.count;e<r;e++)s.MathTmp.Vector3[0].x=t.getX(e),s.MathTmp.Vector3[0].y=t.getY(e),s.MathTmp.Vector3[0].z=t.getZ(e),s.MathTmp.Vector3[0].applyQuaternion(this),t.setXYZ(e,s.MathTmp.Vector3[0].x,s.MathTmp.Vector3[0].y,s.MathTmp.Vector3[0].z);return t},t.prototype.equals=function(t){return t._x==this._x&&t._y==this._y&&t._z==this._z&&t._w==this._w},t.prototype.equalsEpsilon=function(t,e,r){return void 0===r&&(r=null),n.MathUtils.equalsEpsilon(this._x,t.x,e,r)&&n.MathUtils.equalsEpsilon(this._y,t.y,e,r)&&n.MathUtils.equalsEpsilon(this._z,t.z,e,r)&&n.MathUtils.equalsEpsilon(this._w,t.w,e,r)},t.prototype.fromArray=function(t,e){return void 0===e&&(e=0),this._x=t[e],this._y=t[e+1],this._z=t[e+2],this._w=t[e+3],this.triggerNotify(),this},t.prototype.toArray=function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._w,t},t.prototype.fromDataBuffer=function(t){return this._x=t.readFloat32(),this._y=t.readFloat32(),this._z=t.readFloat32(),this._w=t.readFloat32(),this.triggerNotify(),this},t.prototype.toDataBuffer=function(t){return t.writeFloat32(this._x),t.writeFloat32(this._y),t.writeFloat32(this._z),t.writeFloat32(this._w),this},t.prototype.fromBufferAttribute=function(t,e){return this._x=t.getX(e),this._y=t.getY(e),this._z=t.getZ(e),this._w=t.getW(e),this},t}();e.Quaternion=a},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Box2=void 0;var n=r(2),i=r(19),o=r(5),s=function(){function t(t,e){void 0===t&&(t=null),void 0===e&&(e=null),this.min=new n.Vector2(1/0,1/0),this.max=new n.Vector2(-1/0,-1/0),t&&this.min.copy(t),e&&this.min.copy(e)}return t.Build=function(){return new t},Object.defineProperty(t.prototype,"x",{get:function(){return this.min.x},set:function(t){var e=this.width;this.min.x=t,this.max.x=this.min.x+e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"y",{get:function(){return this.min.y},set:function(t){var e=this.height;this.min.y=t,this.max.y=this.min.y+e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"width",{get:function(){return this.max.x-this.min.x},set:function(t){this.max.x=this.min.x+t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this.max.y-this.min.y},set:function(t){this.max.y=this.min.y+t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"center",{get:function(){return this.getCenter()},set:function(t){var e=this.getExtent();this.min.x=t.x-e.x,this.min.y=t.y-e.y,this.max.x=t.x+e.x,this.max.y=t.y+e.y},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"position",{get:function(){return this.min},set:function(t){this.x=t.x,this.y=t.y},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){return this.getSize()},set:function(t){this.width=t.x,this.height=t.y},enumerable:!1,configurable:!0}),t.prototype.clone=function(){return new t(this.min,this.max)},t.prototype.copy=function(t){return this.min.copy(t.min),this.max.copy(t.max),this},t.prototype.set=function(t,e){return this.min.copy(t),this.max.copy(e),this},t.prototype.setFromArray=function(t){for(var e=1/0,r=1/0,n=-1/0,i=-1/0,o=0,s=t.length;o<s;o+=3){var a=t[o],u=t[o+1];a<e&&(e=a),u<r&&(r=u),a>n&&(n=a),u>i&&(i=u)}return this.min.set(e,r),this.max.set(n,i),this},t.prototype.setFromBufferAttribute=function(t){for(var e=1/0,r=1/0,n=-1/0,i=-1/0,o=0,s=t.count;o<s;o++){var a=t.getX(o),u=t.getY(o);a<e&&(e=a),u<r&&(r=u),a>n&&(n=a),u>i&&(i=u)}return this.min.set(e,r),this.max.set(n,i),this},t.prototype.setFromPoints=function(t){this.makeEmpty();for(var e=0,r=t.length;e<r;e++)this.expandByPoint(t[e]);return this},t.prototype.setFromCenterAndSize=function(t,e){var r=o.MathTmp.Vector2[0].copy(e).multiplyScalar(.5);return this.min.copy(t).sub(r),this.max.copy(t).add(r),this},t.prototype.makeEmpty=function(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this},t.prototype.isEmpty=function(){return this.max.x<this.min.x||this.max.y<this.min.y},t.prototype.getCenter=function(t){return void 0===t&&(t=new n.Vector2),this.isEmpty()?t.set(0,0):t.addVectors(this.min,this.max).multiplyScalar(.5)},t.prototype.getSize=function(t){return void 0===t&&(t=new n.Vector2),this.isEmpty()?t.set(0,0):t.subVectors(this.max,this.min)},t.prototype.getExtent=function(t){return void 0===t&&(t=new n.Vector2),this.isEmpty()?t.set(0,0):t.subVectors(this.max,this.min).multiplyScalar(.5)},t.prototype.expandByPoint=function(t){return this.min.min(t),this.max.max(t),this},t.prototype.expandByVector=function(t){return this.min.sub(t),this.max.add(t),this},t.prototype.expandByScalar=function(t){return this.min.addScalar(-t),this.max.addScalar(t),this},t.prototype.containsPoint=function(t){return!(t.x<this.min.x||t.x>this.max.x||t.y<this.min.y||t.y>this.max.y)},t.prototype.containsBox=function(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y},t.prototype.getParameter=function(t,e){return void 0===e&&(e=new n.Vector2),e.set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y))},t.prototype.clampPoint=function(t,e){return void 0===e&&(e=new n.Vector2),e.copy(t).clamp(this.min,this.max)},t.prototype.intersect=function(t){return this.min.max(t.min),this.max.min(t.max),this.isEmpty()&&this.makeEmpty(),this},t.prototype.union=function(t){return this.min.min(t.min),this.max.max(t.max),this},t.prototype.translate=function(t){return this.min.add(t),this.max.add(t),this},t.prototype.scale=function(t){return this.min.multiplyScalar(t),this.max.multiplyScalar(t),this},t.prototype.multiply=function(t){return this.min.multiply(t),this.max.multiply(t),this},t.prototype.translates=function(t,e){return this.min.add(t),this.max.add(e),this},t.prototype.scales=function(t,e){return this.min.multiplyScalar(t),this.max.multiplyScalar(e),this},t.prototype.multiplies=function(t,e){return this.min.multiply(t),this.max.multiply(e),this},t.prototype.distanceSqToPoint=function(t,e){void 0===e&&(e=null);for(var r=this.getCenter(o.MathTmp.Vector2[0]),n=this.getExtent(o.MathTmp.Vector2[1]),i=o.MathTmp.Vector2[2].subVectors(t,r),s=0,a=0;a<2;++a){if(i.p[a]<-n.p[a])s+=(u=i.p[a]+n.p[a])*u,i.p[a]=-n.p[a];else if(i.p[a]>n.p[a]){var u;s+=(u=i.p[a]-n.p[a])*u,i.p[a]=n.p[a]}}return e&&e.addVectors(i,r),s},t.prototype.distanceToPoint=function(t,e){return void 0===e&&(e=null),Math.sqrt(this.distanceSqToPoint(t,e))},t.prototype.distanceSqToBox=function(t,e,r){void 0===e&&(e=null),void 0===r&&(r=null),o.MathTmp.Box2[0].makeEmpty(),o.MathTmp.Box2[1].makeEmpty();for(var n=0,s=0;s<2;++s){if(this.min.p[s]>=t.max.p[s])n+=(a=this.min.p[s]-t.min.p[s])*a,e&&(o.MathTmp.Box2[0].min.p[s]=this.min.p[s],o.MathTmp.Box2[0].max.p[s]=this.min.p[s]),r&&(o.MathTmp.Box2[1].min.p[s]=t.max.p[s],o.MathTmp.Box2[1].max.p[s]=t.max.p[s]);else if(t.min.p[s]>=this.max.p[s]){var a;n+=(a=t.min.p[s]-this.max.p[s])*a,e&&(o.MathTmp.Box2[0].min.p[s]=this.max.p[s],o.MathTmp.Box2[0].max.p[s]=this.max.p[s]),r&&(o.MathTmp.Box2[1].min.p[s]=t.min.p[s],o.MathTmp.Box2[1].max.p[s]=t.min.p[s])}else if(e||r){var u=[this.min.p[s],this.max.p[s]],p=[t.min.p[s],t.max.p[s]],h=i.Intervals.staticQuery(u,p);e&&(o.MathTmp.Box2[0].min.p[s]=h.overlap[0],o.MathTmp.Box2[0].max.p[s]=h.overlap[1]),r&&(o.MathTmp.Box2[1].min.p[s]=h.overlap[0],o.MathTmp.Box2[1].max.p[s]=h.overlap[1])}}return e&&o.MathTmp.Box2[0].getCenter(e),r&&o.MathTmp.Box2[1].getCenter(r),n},t.prototype.distanceToBox=function(t,e,r){return void 0===e&&(e=null),void 0===r&&(r=null),Math.sqrt(this.distanceSqToBox(t,e,r))},t.prototype.intersectsBox=function(t){return!(t.max.x<this.min.x||t.min.x>this.max.x||t.max.y<this.min.y||t.min.y>this.max.y)},t.prototype.intersectBox=function(e){for(var r=e,n={intersect:!1,box:new t},i=0;i<2;i++)if(this.max.p[i]<r.min.p[i]||this.min.p[i]>r.max.p[i])return n.intersect=!1,n;for(i=0;i<2;i++)this.max.p[i]<=r.max.p[i]?n.box.max.p[i]=this.max.p[i]:n.box.max.p[i]=r.max.p[i],this.min.p[i]<=r.min.p[i]?n.box.min.p[i]=r.min.p[i]:n.box.min.p[i]=this.min.p[i];return n.intersect=!0,n},t.prototype.equals=function(t){return t.min.equals(this.min)&&t.max.equals(this.max)},t.prototype.toArray=function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),this.min.toArray(t,e),this.max.toArray(t,e+3),t},t.prototype.fromArray=function(t,e){return void 0===e&&(e=0),this.min.fromArray(t,e),this.max.fromArray(t,e+3),this},t}();e.Box2=s},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.DTBCase000=e.DTBCase00=e.DTBCase0=e.DTBCaseNoZeros=e.DTBFace=e.Line3=void 0;var n=r(0),i=r(46),o=new n.Vector3,s=new n.Vector3,a=new n.Vector3,u=new n.Vector3,p=new n.Vector3,h=new n.Vector3,c=new n.Vector3,l=function(){function t(t,e){void 0===t&&(t=null),void 0===e&&(e=null),this.origin=new n.Vector3,this.direction=new n.Vector3(0,0,-1),t&&this.origin.copy(t),e&&this.direction.copy(e)}return t.prototype.set=function(t,e){return this.origin.copy(t),this.direction.copy(e),this},t.prototype.clone=function(){return(new t).copy(this)},t.prototype.copy=function(t){return this.origin.copy(t.origin),this.direction.copy(t.direction),this},t.prototype.closestPointToPoint=function(t,e){void 0===e&&(e=new n.Vector3),e.subVectors(t,this.origin);var r=e.dot(this.direction);return e.copy(this.direction).multiplyScalar(r).add(this.origin)},t.prototype.distanceSqToPoint=function(t,e){void 0===e&&(e=null);var r=o.subVectors(t,this.origin),n=this.direction.dot(r);return s.copy(this.direction).multiplyScalar(n).add(this.origin),e&&e.copy(s),r.subVectors(t,s),r.dot(r)},t.prototype.distanceToPoint=function(t,e){return void 0===e&&(e=null),Math.sqrt(this.distanceSqToPoint(t,e))},t.prototype.distanceSqToRay=function(t,e,r,n){void 0===e&&(e=null),void 0===r&&(r=null),void 0===n&&(n=null);var i,u,p=o.subVectors(this.origin,t.origin),h=-this.direction.dot(t.direction),c=p.dot(this.direction);if(Math.abs(h)<1){var l=-p.dot(t.direction);if((u=h*c-l)>=0){var f=1-h*h;i=(h*l-c)/f,u/=f}else i=-c,u=0}else i=-c,u=0;return s.copy(this.direction).multiplyScalar(i).add(this.origin),a.copy(t.direction).multiplyScalar(u).add(t.origin),e&&e.copy(s),r&&r.copy(a),n&&(n.parameter=[i,u]),p.subVectors(s,a),p.dot(p)},t.prototype.distanceToRay=function(t,e,r,n){return void 0===e&&(e=null),void 0===r&&(r=null),void 0===n&&(n=null),Math.sqrt(this.distanceSqToRay(t,e,r,n))},t.prototype.distanceSqToSegment=function(t,e,r,n){void 0===e&&(e=null),void 0===r&&(r=null),void 0===n&&(n=null);var i,h,c=o,l=s,f=t.getCenteredForm(c,l),y=a.subVectors(this.origin,c),d=-this.direction.dot(l),_=y.dot(this.direction);if(Math.abs(d)<1){var m=1-d*d,g=f*m,v=-y.dot(l);(h=d*_-v)>=-g?h<=g?(i=(d*v-_)/m,h/=m):i=-(d*(h=f)+_):i=-(d*(h=-f)+_)}else h=0,i=-_;return u.copy(this.direction).multiplyScalar(i).add(this.origin),p.copy(l).multiplyScalar(h).add(c),e&&e.copy(u),r&&r.copy(p),n&&(n.parameter=[i,h]),y.subVectors(u,p),y.dot(y)},t.prototype.distanceToSegment=function(t,e,r,n){return void 0===e&&(e=null),void 0===r&&(r=null),void 0===n&&(n=null),Math.sqrt(this.distanceSqToSegment(t,e,r,n))},t.prototype.distanceSqToLine=function(t,e,r,n){void 0===e&&(e=null),void 0===r&&(r=null),void 0===n&&(n=null);var i,s,a=t,h=o.subVectors(this.origin,a.origin),c=-this.direction.dot(a.direction),l=h.dot(this.direction);if(Math.abs(c)<1){var f=1-c*c,y=-h.dot(a.direction);i=(c*y-l)/f,s=(c*l-y)/f}else i=-l,s=0;return u.copy(this.direction).multiplyScalar(i).add(this.origin),p.copy(a.direction).multiplyScalar(s).add(a.origin),e&&e.copy(u),r&&r.copy(p),n&&(n.parameter=[i,s]),h.subVectors(u,p),h.dot(h)},t.prototype.distanceToLine=function(t,e,r,n){return void 0===e&&(e=null),void 0===r&&(r=null),void 0===n&&(n=null),Math.sqrt(this.distanceSqToLine(t,e,r,n))},t.prototype.distanceSqToTriangle=function(e,r,l,f){void 0===r&&(r=null),void 0===l&&(l=null),void 0===f&&(f=null);var y=o.subVectors(e.b,e.a),d=s.subVectors(e.c,e.a),_=a.crossVectors(y,d).normalize().dot(this.direction),m=0,g=0;if(Math.abs(_)>0){var v=u.subVectors(this.origin,e.a),x=[];x[0]=p.copy(this.direction),n.Vector3.computeOrthogonalComplement(1,x);var b=x[1].dot(y),S=x[1].dot(d),T=x[1].dot(v),C=x[2].dot(y),E=x[2].dot(d),M=x[2].dot(v),w=1/(b*E-S*C),P=(E*T-S*M)*w,A=(b*M-C*T)*w,O=1-P-A;if(O>=0&&P>=0&&A>=0)return g=P*this.direction.dot(y)+A*this.direction.dot(d)-this.direction.dot(v),h.copy(this.direction).multiplyScalar(g).add(this.origin),c.copy(e.a).add(y.multiplyScalar(P)).add(d.multiplyScalar(A)),r&&r.copy(h),l&&l.copy(c),f&&(f.lineParameter=g,f.triangleParameter[0]=O,f.triangleParameter[1]=P,f.triangleParameter[2]=A),m}m=1/0;for(var R=new t(this.origin,this.direction),B=2,I=0;I<3;B=I++){var N=o.addVectors(e.p[B],e.p[I]).multiplyScalar(.5),F=s.subVectors(e.p[I],e.p[B]),G=.5*F.length();F.normalize();var D=new i.LineSegment3;D.setCenteredForm(N,F,G);var V={parameter:[0,0]},L=R.distanceSqToSegment(D,u,p,V);L<m&&(m=L,h.copy(u),c.copy(p),f&&(f.lineParameter=V.parameter[0],f.triangleParameter[B]=.5*(1-V.parameter[0]/G),f.triangleParameter[I]=1-f.triangleParameter[B],f.triangleParameter[3-B-I]=0))}return r&&r.copy(h),l&&l.copy(c),m},t.prototype.distanceToTriangle=function(t,e,r,n){return void 0===e&&(e=null),void 0===r&&(r=null),void 0===n&&(n=null),Math.sqrt(this.distanceSqToTriangle(t,e,r))},t.prototype.distanceSqToBox=function(t,e,r,n){void 0===e&&(e=null),void 0===r&&(r=null),void 0===n&&(n=null);var i=o,p=s;t.getCenter(i),t.getExtent(p);for(var h=a.subVectors(this.origin,i),c=u.copy(this.direction),l={sqrDistance:0,lineParameter:0},f=[],y=0;y<3;++y)c.p[y]<0?(h.p[y]=-h.p[y],c.p[y]=-c.p[y],f[y]=!0):f[y]=!1;c.x>0?c.y>0?c.z>0?d(h,c,p,l):_(0,1,2,h,c,p,l):c.z>0?_(0,2,1,h,c,p,l):m(0,1,2,h,c,p,l):c.y>0?c.z>0?_(1,2,0,h,c,p,l):m(1,0,2,h,c,p,l):c.z>0?m(2,0,1,h,c,p,l):g(h,p,l);for(y=0;y<3;++y)f[y]&&(h.p[y]=-h.p[y]);return e&&e.copy(this.direction).multiplyScalar(l.lineParameter).add(this.origin),r&&r.addVectors(i,h),n&&(n.lineParameter=l.lineParameter,n.sqrDistance=l.sqrDistance),l.sqrDistance},t.prototype.distanceToBox=function(t,e,r,n){return void 0===e&&(e=null),void 0===r&&(r=null),void 0===n&&(n=null),Math.sqrt(this.distanceSqToBox(t,e,r,n))},t.prototype.distanceSqToOBB=function(t,e,r,n){void 0===e&&(e=null),void 0===r&&(r=null),void 0===n&&(n=null);for(var i=o.subVectors(this.origin,t.center),h=s,c=a,l=0;l<3;++l)h.p[l]=i.dot(t.axis[l]),c.p[l]=this.direction.dot(t.axis[l]);var f=t.getExtent(u),y={sqrDistance:0,lineParameter:0},v=[];for(l=0;l<3;++l)c.p[l]<0?(h.p[l]=-h.p[l],c.p[l]=-c.p[l],v[l]=!0):v[l]=!1;c.x>0?c.y>0?c.z>0?d(h,c,f,y):_(0,1,2,h,c,f,y):c.z>0?_(0,2,1,h,c,f,y):m(0,1,2,h,c,f,y):c.y>0?c.z>0?_(1,2,0,h,c,f,y):m(1,0,2,h,c,f,y):c.z>0?m(2,0,1,h,c,f,y):g(h,f,y);for(l=0;l<3;++l)v[l]&&(h.p[l]=-h.p[l]);if(e&&e.copy(this.direction).multiplyScalar(y.lineParameter).add(this.origin),r){r.copy(t.center);for(l=0;l<3;++l)r.add(p.copy(t.axis[l]).multiplyScalar(h.p[l]))}return y.sqrDistance},t.prototype.distanceToOBB=function(t,e,r,n){return void 0===e&&(e=null),void 0===r&&(r=null),void 0===n&&(n=null),Math.sqrt(this.distanceSqToOBB(t,e,r,n))},t.prototype.intersectsTriangle=function(t){var e,r=o.subVectors(this.origin,t.p[0]),n=s.subVectors(t.p[1],t.p[0]),i=a.subVectors(t.p[2],t.p[0]),p=u.crossVectors(n,i),h=this.direction.dot(p);if(h>0)e=1;else{if(!(h<0))return!1;e=-1,h=-h}var c=e*this.direction.dotCross(r,i);if(c>=0){var l=e*this.direction.dotCross(n,r);if(l>=0&&c+l<=h)return!0}return!1},t.prototype.intersectTriangle=function(t){var e,r=o.subVectors(this.origin,t.p[0]),i=s.subVectors(t.p[1],t.p[0]),p=a.subVectors(t.p[2],t.p[0]),h=u.crossVectors(i,p),c=this.direction.dot(h);if(c>0)e=1;else{if(!(c<0))return{intersect:!1};e=-1,c=-c}var l=e*this.direction.dotCross(r,p);if(l>=0){var f=e*this.direction.dotCross(i,r);if(f>=0&&l+f<=c){var y=1/c,d={intersect:!0,parameter:-e*r.dot(h)*y,triangleBary:new Array,point:new n.Vector3};return d.triangleBary[1]=l*y,d.triangleBary[2]=f*y,d.triangleBary[0]=1-d.triangleBary[1]-d.triangleBary[2],d.point.copy(this.direction).multiplyScalar(d.parameter).add(this.origin),d}}return{intersect:!1}},t.prototype.intersectsSphere=function(t){var e=o.subVectors(this.origin,t.center),r=e.dot(e)-t.radius*t.radius,n=this.direction.dot(e);return n*n-r>=0},t.prototype.intersectSphere=function(e){var r={intersect:!1,numIntersections:0,parameter:new Array(2),point:new Array(2)};t.intersectSphere(this.origin,this.direction,e,r);for(var i=0;i<r.numIntersections;++i)r.point[i]=(new n.Vector3).copy(this.direction).multiplyScalar(r.parameter[i]).add(this.origin);return r},t.intersectSphere=function(t,e,r,n){var i=c.subVectors(t,r.center),o=i.dot(i)-r.radius*r.radius,s=e.dot(i),a=s*s-o;if(a>0){n.intersect=!0,n.numIntersections=2;var u=Math.sqrt(a);n.parameter[0]=-s-u,n.parameter[1]=-s+u}else a<0?(n.intersect=!1,n.numIntersections=0):(n.intersect=!0,n.numIntersections=1,n.parameter[0]=-s)},t.prototype.intersectsPlane=function(t){return 0!=this.direction.dot(t.normal)||0==t.distanceToPoint(this.origin)},t.prototype.intersectPlane=function(e){var r={intersect:!1,numIntersections:0,parameter:0,point:new n.Vector3};return t.intersectPlane(this.origin,this.direction,e,r),r.intersect&&r.point.copy(this.direction).multiplyScalar(r.parameter).add(this.origin),r},t.intersectPlane=function(t,e,r,n){var i=e.dot(r.normal),o=r.distanceToPoint(t),s=Math.abs(o);0!=i?(n.intersect=!0,n.numIntersections=1,n.parameter=-o/i):0==s?(n.intersect=!0,n.numIntersections=1/0,n.parameter=0):(n.intersect=!1,n.numIntersections=0)},t.prototype.intersectsBox=function(e){var r=e.getCenter(o),n=e.getExtent(s),i=a.subVectors(this.origin,r);return t.intersectsBox(i,this.direction,n)},t.intersectsBox=function(t,e,r){var n=c.crossVectors(e,t),i=[Math.abs(e.x),Math.abs(e.y),Math.abs(e.z)];return!(Math.abs(n.p[0])>r.p[1]*i[2]+r.p[2]*i[1])&&(!(Math.abs(n.p[1])>r.p[0]*i[2]+r.p[2]*i[0])&&!(Math.abs(n.p[2])>r.p[0]*i[1]+r.p[1]*i[0]))},t.prototype.intersectBox=function(e){var r=e.getCenter(o),i=e.getExtent(s),u=a.subVectors(this.origin,r),p={intersect:!1,numPoints:0,lineParameter:new Array(2),point:new Array(2)};t.intersectBox(u,this.direction,i,p);for(var h=0;h<p.numPoints;++h)p.point[h]=(new n.Vector3).copy(this.direction).multiplyScalar(p.lineParameter[h]).add(this.origin);return p},t.intersectBox=function(t,e,r,n){var i=function(t,e,r){return t>0?!(e>t*r[1])&&(e>t*r[0]&&(r[0]=e/t),!0):t<0?!(e>t*r[0])&&(e>t*r[1]&&(r[1]=e/t),!0):e<=0},o=[-1/0,1/0];i(+e.p[0],-t.p[0]-r.p[0],o)&&i(-e.p[0],+t.p[0]-r.p[0],o)&&i(+e.p[1],-t.p[1]-r.p[1],o)&&i(-e.p[1],+t.p[1]-r.p[1],o)&&i(+e.p[2],-t.p[2]-r.p[2],o)&&i(-e.p[2],+t.p[2]-r.p[2],o)?(n.intersect=!0,o[1]>o[0]?(n.numPoints=2,n.lineParameter[0]=o[0],n.lineParameter[1]=o[1]):(n.numPoints=1,n.lineParameter[0]=o[0],n.lineParameter[1]=o[0])):(n.intersect=!1,n.numPoints=0)},t.prototype.intersectsOBB=function(e){var r=o.subVectors(this.origin,e.center),n=s.set(r.dot(e.axis[0]),r.dot(e.axis[1]),r.dot(e.axis[2])),i=a.set(this.direction.dot(e.axis[0]),this.direction.dot(e.axis[1]),this.direction.dot(e.axis[2])),p=e.getExtent(u);return t.intersectsBox(n,i,p)},t.prototype.intersectOBB=function(e){var r=o.subVectors(this.origin,e.center),i=s.set(r.dot(e.axis[0]),r.dot(e.axis[1]),r.dot(e.axis[2])),p=a.set(this.direction.dot(e.axis[0]),this.direction.dot(e.axis[1]),this.direction.dot(e.axis[2])),h=e.getExtent(u),c={intersect:!1,numPoints:0,lineParameter:new Array(2),point:new Array(2)};t.intersectBox(i,p,h,c);for(var l=0;l<c.numPoints;++l)c.point[l]=(new n.Vector3).copy(this.direction).multiplyScalar(c.lineParameter[l]).add(this.origin);return c},t.prototype.applyMatrix4=function(t){return this.origin.applyMatrix4(t),t.transformVector3(this.direction,this.direction),this},t.prototype.equals=function(t){return t.origin.equals(this.origin)&&t.direction.equals(this.direction)},t}();e.Line3=l;var f=new Array(3);function y(t,e,r,n,i,o,s,a){var u,p,h,c,l,y,d=f;if(d[0]=0,d[1]=0,d[2]=0,d[e]=n.p[e]+s.p[e],d[r]=n.p[r]+s.p[r],i.p[t]*d[e]>=i.p[e]*o.p[t])i.p[t]*d[r]>=i.p[r]*o.p[t]?(n.p[t]=s.p[t],p=1/i.p[t],n.p[e]-=i.p[e]*o.p[t]*p,n.p[r]-=i.p[r]*o.p[t]*p,a.lineParameter=-o.p[t]*p):(h=(u=i.p[t]*i.p[t]+i.p[r]*i.p[r])*d[e]-i.p[e]*(i.p[t]*o.p[t]+i.p[r]*d[r]))<=2*u*s.p[e]?(l=h/u,u+=i.p[e]*i.p[e],h=d[e]-l,c=-(y=i.p[t]*o.p[t]+i.p[e]*h+i.p[r]*d[r])/u,a.sqrDistance+=o.p[t]*o.p[t]+h*h+d[r]*d[r]+y*c,a.lineParameter=c,n.p[t]=s.p[t],n.p[e]=l-s.p[e],n.p[r]=-s.p[r]):(u+=i.p[e]*i.p[e],c=-(y=i.p[t]*o.p[t]+i.p[e]*o.p[e]+i.p[r]*d[r])/u,a.sqrDistance+=o.p[t]*o.p[t]+o.p[e]*o.p[e]+d[r]*d[r]+y*c,a.lineParameter=c,n.p[t]=s.p[t],n.p[e]=s.p[e],n.p[r]=-s.p[r]);else if(i.p[t]*d[r]>=i.p[r]*o.p[t])(h=(u=i.p[t]*i.p[t]+i.p[e]*i.p[e])*d[r]-i.p[r]*(i.p[t]*o.p[t]+i.p[e]*d[e]))<=2*u*s.p[r]?(l=h/u,u+=i.p[r]*i.p[r],h=d[r]-l,c=-(y=i.p[t]*o.p[t]+i.p[e]*d[e]+i.p[r]*h)/u,a.sqrDistance+=o.p[t]*o.p[t]+d[e]*d[e]+h*h+y*c,a.lineParameter=c,n.p[t]=s.p[t],n.p[e]=-s.p[e],n.p[r]=l-s.p[r]):(u+=i.p[r]*i.p[r],c=-(y=i.p[t]*o.p[t]+i.p[e]*d[e]+i.p[r]*o.p[r])/u,a.sqrDistance+=o.p[t]*o.p[t]+d[e]*d[e]+o.p[r]*o.p[r]+y*c,a.lineParameter=c,n.p[t]=s.p[t],n.p[e]=-s.p[e],n.p[r]=s.p[r]);else{if((h=(u=i.p[t]*i.p[t]+i.p[r]*i.p[r])*d[e]-i.p[e]*(i.p[t]*o.p[t]+i.p[r]*d[r]))>=0)return void(h<=2*u*s.p[e]?(l=h/u,u+=i.p[e]*i.p[e],h=d[e]-l,c=-(y=i.p[t]*o.p[t]+i.p[e]*h+i.p[r]*d[r])/u,a.sqrDistance+=o.p[t]*o.p[t]+h*h+d[r]*d[r]+y*c,a.lineParameter=c,n.p[t]=s.p[t],n.p[e]=l-s.p[e],n.p[r]=-s.p[r]):(u+=i.p[e]*i.p[e],c=-(y=i.p[t]*o.p[t]+i.p[e]*o.p[e]+i.p[r]*d[r])/u,a.sqrDistance+=o.p[t]*o.p[t]+o.p[e]*o.p[e]+d[r]*d[r]+y*c,a.lineParameter=c,n.p[t]=s.p[t],n.p[e]=s.p[e],n.p[r]=-s.p[r]));if((h=(u=i.p[t]*i.p[t]+i.p[e]*i.p[e])*d[r]-i.p[r]*(i.p[t]*o.p[t]+i.p[e]*d[e]))>=0)return void(h<=2*u*s.p[r]?(l=h/u,u+=i.p[r]*i.p[r],h=d[r]-l,c=-(y=i.p[t]*o.p[t]+i.p[e]*d[e]+i.p[r]*h)/u,a.sqrDistance+=o.p[t]*o.p[t]+d[e]*d[e]+h*h+y*c,a.lineParameter=c,n.p[t]=s.p[t],n.p[e]=-s.p[e],n.p[r]=l-s.p[r]):(u+=i.p[r]*i.p[r],c=-(y=i.p[t]*o.p[t]+i.p[e]*d[e]+i.p[r]*o.p[r])/u,a.sqrDistance+=o.p[t]*o.p[t]+d[e]*d[e]+o.p[r]*o.p[r]+y*c,a.lineParameter=c,n.p[t]=s.p[t],n.p[e]=-s.p[e],n.p[r]=s.p[r]));u+=i.p[r]*i.p[r],c=-(y=i.p[t]*o.p[t]+i.p[e]*d[e]+i.p[r]*d[r])/u,a.sqrDistance+=o.p[t]*o.p[t]+d[e]*d[e]+d[r]*d[r]+y*c,a.lineParameter=c,n.p[t]=s.p[t],n.p[e]=-s.p[e],n.p[r]=-s.p[r]}}function d(t,e,r,n){var i=c.subVectors(t,r),o=e.p[0]*i.p[1];e.p[1]*i.p[0]>=o?e.p[2]*i.p[0]>=e.p[0]*i.p[2]?y(0,1,2,t,e,i,r,n):y(2,0,1,t,e,i,r,n):e.p[2]*i.p[1]>=e.p[1]*i.p[2]?y(1,2,0,t,e,i,r,n):y(2,0,1,t,e,i,r,n)}function _(t,e,r,n,i,o,s){var a,u,p,h=n.p[t]-o.p[t],c=n.p[e]-o.p[e],l=i.p[e]*h,f=i.p[t]*c;if(l>=f){n.p[t]=o.p[t];var y=n.p[e]+o.p[e];(a=l-i.p[t]*y)>=0?(u=1/(i.p[t]*i.p[t]+i.p[e]*i.p[e]),s.sqrDistance+=a*a*u,n.p[e]=-o.p[e],s.lineParameter=-(i.p[t]*h+i.p[e]*y)*u):(p=1/i.p[t],n.p[e]-=l*p,s.lineParameter=-h*p)}else{n.p[e]=o.p[e];var d=n.p[t]+o.p[t];(a=f-i.p[e]*d)>=0?(u=1/(i.p[t]*i.p[t]+i.p[e]*i.p[e]),s.sqrDistance+=a*a*u,n.p[t]=-o.p[t],s.lineParameter=-(i.p[t]*d+i.p[e]*c)*u):(p=1/i.p[e],n.p[t]-=f*p,s.lineParameter=-c*p)}n.p[r]<-o.p[r]?(a=n.p[r]+o.p[r],s.sqrDistance+=a*a,n.p[r]=-o.p[r]):n.p[r]>o.p[r]&&(a=n.p[r]-o.p[r],s.sqrDistance+=a*a,n.p[r]=o.p[r])}function m(t,e,r,n,i,o,s){var a;s.lineParameter=(o.p[t]-n.p[t])/i.p[t],n.p[t]=o.p[t],n.p[e]<-o.p[e]?(a=n.p[e]+o.p[e],s.sqrDistance+=a*a,n.p[e]=-o.p[e]):n.p[e]>o.p[e]&&(a=n.p[e]-o.p[e],s.sqrDistance+=a*a,n.p[e]=o.p[e]),n.p[r]<-o.p[r]?(a=n.p[r]+o.p[r],s.sqrDistance+=a*a,n.p[r]=-o.p[r]):n.p[r]>o.p[r]&&(a=n.p[r]-o.p[r],s.sqrDistance+=a*a,n.p[r]=o.p[r])}function g(t,e,r){var n;t.p[0]<-e.p[0]?(n=t.p[0]+e.p[0],r.sqrDistance+=n*n,t.p[0]=-e.p[0]):t.p[0]>e.p[0]&&(n=t.p[0]-e.p[0],r.sqrDistance+=n*n,t.p[0]=e.p[0]),t.p[1]<-e.p[1]?(n=t.p[1]+e.p[1],r.sqrDistance+=n*n,t.p[1]=-e.p[1]):t.p[1]>e.p[1]&&(n=t.p[1]-e.p[1],r.sqrDistance+=n*n,t.p[1]=e.p[1]),t.p[2]<-e.p[2]?(n=t.p[2]+e.p[2],r.sqrDistance+=n*n,t.p[2]=-e.p[2]):t.p[2]>e.p[2]&&(n=t.p[2]-e.p[2],r.sqrDistance+=n*n,t.p[2]=e.p[2])}e.DTBFace=y,e.DTBCaseNoZeros=d,e.DTBCase0=_,e.DTBCase00=m,e.DTBCase000=g},function(t,e,r){"use strict";var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(e,"__esModule",{value:!0}),e.LineCurve=void 0;var o=r(10),s=r(2),a=function(t){function e(e,r){void 0===e&&(e=null),void 0===r&&(r=null);var n=t.call(this)||this;return n.v1=new s.Vector2,n.v2=new s.Vector2,n.type="LineCurve",n.arcLengthDivisions=10,e&&n.v1.copy(e),r&&n.v2.copy(r),n}return i(e,t),e.prototype.getPoint=function(t,e){void 0===e&&(e=null);var r=null!=e?e:new s.Vector2;return 1==t?r.copy(this.v2):(r.copy(this.v2).sub(this.v1),r.multiplyScalar(t).add(this.v1)),r},e.prototype.getPointAt=function(t,e){return void 0===e&&(e=null),this.getPoint(t,e)},e.prototype.getTangent=function(t,e){void 0===e&&(e=null);var r=null!=e?e:new s.Vector2;return r.copy(this.v2).sub(this.v1).normalize(),r},e.prototype.clone=function(){return(new e).copy(this)},e.prototype.copy=function(e){return t.prototype.copy.call(this,e),this.v1.copy(e.v1),this.v2.copy(e.v2),this},e.prototype.toJSON=function(){var e=t.prototype.toJSON.call(this);return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e},e.prototype.fromJSON=function(e){return t.prototype.fromJSON.call(this,e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this},e.prototype.toDataBuffer=function(e){return t.prototype.toDataBuffer.call(this,e),this.v1.toDataBuffer(e),this.v2.toDataBuffer(e),this},e.prototype.fromDataBuffer=function(e){return t.prototype.fromDataBuffer.call(this,e),this.v1.fromDataBuffer(e),this.v2.fromDataBuffer(e),this},e}(o.Curve);e.LineCurve=a},function(t,e,r){"use strict";var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(e,"__esModule",{value:!0}),e.SplineCurve=void 0;var o=r(10),s=r(2),a=r(28),u=function(t){function e(e){void 0===e&&(e=null);var r=t.call(this)||this;return r.type="SplineCurve",r.points=null!=e?e:[],r}return i(e,t),e.prototype.getPoint=function(t,e){void 0===e&&(e=null);var r=e||new s.Vector2,n=this.points,i=(n.length-1)*t,o=Math.floor(i),u=i-o,p=n[0==o?o:o-1],h=n[o],c=n[o>n.length-2?n.length-1:o+1],l=n[o>n.length-3?n.length-1:o+2];return r.set(a.BezierCurveFunc.CatmullRom(u,p.x,h.x,c.x,l.x),a.BezierCurveFunc.CatmullRom(u,p.y,h.y,c.y,l.y)),r},e.prototype.clone=function(){return new e(this.points)},e.prototype.copy=function(e){t.prototype.copy.call(this,e),this.points=[];for(var r=0,n=e.points.length;r<n;r++){var i=e.points[r];this.points.push(i.clone())}return this},e.prototype.toJSON=function(){var e=t.prototype.toJSON.call(this);e.points=[];for(var r=0,n=this.points.length;r<n;r++){var i=this.points[r];e.points.push(i.toArray())}return e},e.prototype.fromJSON=function(e){t.prototype.fromJSON.call(this,e),this.points=[];for(var r=0,n=e.points.length;r<n;r++){var i=e.points[r];this.points.push((new s.Vector2).fromArray(i))}return this},e.prototype.toDataBuffer=function(e){return t.prototype.toDataBuffer.call(this,e),e.writeUint16(this.points.length),this.points.forEach((function(t){return t.toDataBuffer(e)})),this},e.prototype.fromDataBuffer=function(e){t.prototype.fromDataBuffer.call(this,e);for(var r=e.readUint16(),n=0;n<r;++n)this.points.push((new s.Vector2).fromDataBuffer(e));return this},e}(o.Curve);e.SplineCurve=u},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.CSGOrthoNormalBasis=void 0;var n=r(14),i=r(9),o=r(8),s=r(57),a=r(76),u=r(7),p=function(){function t(t,e){e=arguments.length<2?t.normal.randomNonParallelVector():new i.CSGVector3D(e),this.v=t.normal.cross(e).unit(),this.u=this.v.cross(t.normal),this.plane=t,this.planeorigin=t.normal.times(t.w)}return t.GetCartesian=function(e,r){var n,s,a=e+"/"+r;if("X/Y"==a)n=[0,0,1],s=[1,0,0];else if("Y/-X"==a)n=[0,0,1],s=[0,1,0];else if("-X/-Y"==a)n=[0,0,1],s=[-1,0,0];else if("-Y/X"==a)n=[0,0,1],s=[0,-1,0];else if("-X/Y"==a)n=[0,0,-1],s=[-1,0,0];else if("-Y/-X"==a)n=[0,0,-1],s=[0,-1,0];else if("X/-Y"==a)n=[0,0,-1],s=[1,0,0];else if("Y/X"==a)n=[0,0,-1],s=[0,1,0];else if("X/Z"==a)n=[0,-1,0],s=[1,0,0];else if("Z/-X"==a)n=[0,-1,0],s=[0,0,1];else if("-X/-Z"==a)n=[0,-1,0],s=[-1,0,0];else if("-Z/X"==a)n=[0,-1,0],s=[0,0,-1];else if("-X/Z"==a)n=[0,1,0],s=[-1,0,0];else if("-Z/-X"==a)n=[0,1,0],s=[0,0,-1];else if("X/-Z"==a)n=[0,1,0],s=[1,0,0];else if("Z/X"==a)n=[0,1,0],s=[0,0,1];else if("Y/Z"==a)n=[1,0,0],s=[0,1,0];else if("Z/-Y"==a)n=[1,0,0],s=[0,0,1];else if("-Y/-Z"==a)n=[1,0,0],s=[0,-1,0];else if("-Z/Y"==a)n=[1,0,0],s=[0,0,-1];else if("-Y/Z"==a)n=[-1,0,0],s=[0,-1,0];else if("-Z/-Y"==a)n=[-1,0,0],s=[0,0,-1];else if("Y/-Z"==a)n=[-1,0,0],s=[0,1,0];else{if("Z/Y"!=a)throw new Error("CSG.OrthoNormalBasis.GetCartesian: invalid combination of axis identifiers. Should pass two string arguments from [X,Y,Z,-X,-Y,-Z], being two different axes.");n=[-1,0,0],s=[0,0,1]}return new t(new o.CSGPlane(new i.CSGVector3D(n),0),new i.CSGVector3D(s))},t.Z0Plane=function(){return new t(new o.CSGPlane(new i.CSGVector3D([0,0,1]),0),new i.CSGVector3D([1,0,0]))},t.prototype.getProjectionMatrix=function(){return new u.CSGMatrix4x4([this.u.x,this.v.x,this.plane.normal.x,0,this.u.y,this.v.y,this.plane.normal.y,0,this.u.z,this.v.z,this.plane.normal.z,0,0,0,-this.plane.w,1])},t.prototype.getInverseProjectionMatrix=function(){var t=this.plane.normal.times(this.plane.w);return new u.CSGMatrix4x4([this.u.x,this.u.y,this.u.z,0,this.v.x,this.v.y,this.v.z,0,this.plane.normal.x,this.plane.normal.y,this.plane.normal.z,0,t.x,t.y,t.z,1])},t.prototype.to2D=function(t){return new n.CSGVector2D(t.dot(this.u),t.dot(this.v))},t.prototype.to3D=function(t){return this.planeorigin.plus(this.u.times(t.x)).plus(this.v.times(t.y))},t.prototype.line3Dto2D=function(t){var e=t.point,r=t.direction.plus(e),n=this.to2D(e),i=this.to2D(r);return a.CSGLine2D.fromPoints(n,i)},t.prototype.line2Dto3D=function(t){var e=t.origin(),r=t.direction().plus(e),n=this.to3D(e),i=this.to3D(r);return s.CSGLine3D.fromPoints(n,i)},t.prototype.transform=function(e){var r=this.plane.transform(e),n=this.u.transform(e),o=new i.CSGVector3D(0,0,0).transform(e);return new t(r,n.minus(o))},t.prototype.mirrored=function(t){return this.transform(u.CSGMatrix4x4.mirroring(t))},t.prototype.mirroredX=function(){var t=new o.CSGPlane(i.CSGVector3D.Create(1,0,0),0);return this.mirrored(t)},t.prototype.mirroredY=function(){var t=new o.CSGPlane(i.CSGVector3D.Create(0,1,0),0);return this.mirrored(t)},t.prototype.mirroredZ=function(){var t=new o.CSGPlane(i.CSGVector3D.Create(0,0,1),0);return this.mirrored(t)},t.prototype.translate=function(t){return this.transform(u.CSGMatrix4x4.translation(t))},t.prototype.scale=function(t){return this.transform(u.CSGMatrix4x4.scaling(t))},t.prototype.rotateX=function(t){return this.transform(u.CSGMatrix4x4.rotationX(t))},t.prototype.rotateY=function(t){return this.transform(u.CSGMatrix4x4.rotationY(t))},t.prototype.rotateZ=function(t){return this.transform(u.CSGMatrix4x4.rotationZ(t))},t.prototype.rotate=function(t,e,r){return this.transform(u.CSGMatrix4x4.rotation(t,e,r))},t.prototype.rotateEulerAngles=function(t,e,r,n){n=n||[0,0,0];var o=u.CSGMatrix4x4.rotationZ(t),s=u.CSGMatrix4x4.rotationX(e),a=u.CSGMatrix4x4.rotationZ(r),p=u.CSGMatrix4x4.translation(new i.CSGVector3D(n));return this.transform(a.multiply(s).multiply(o).multiply(p))},t}();e.CSGOrthoNormalBasis=p},function(t,e,r){"use strict";var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(e,"__esModule",{value:!0}),e.Camera=void 0;var o=r(24),s=r(4),a=r(115),u=function(t){function e(e,r,n,i){void 0===r&&(r=!0),void 0===n&&(n=null),void 0===i&&(i="");var o=t.call(this,e,n,i)||this;return o._viewport=new a.Viewport(0,0,1,1),o._frustum=new s.Frustum,o._projectionMatrix=new s.Matrix4,o._projectionMatrixInverse=new s.Matrix4,o._viewProjectionMatrix=new s.Matrix4,o._viewProjectionMatrixInverse=new s.Matrix4,o._needsUpdateCameraMatrix=!0,o._visibleLayers.enableAll(),o.scene.addCamera(o),r&&!o.scene.activeCamera&&(o.scene.activeCamera=o),o}return i(e,t),Object.defineProperty(e.prototype,"viewport",{get:function(){return this._viewport},set:function(t){this._viewport=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"frustum",{get:function(){return this._needsUpdateCameraMatrix&&this.updateProjectionMatrix(),this._frustum},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"projectionMatrix",{get:function(){return this._needsUpdateCameraMatrix&&this.updateProjectionMatrix(),this._projectionMatrix},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"projectionMatrixInverse",{get:function(){return this._needsUpdateCameraMatrix&&this.updateProjectionMatrix(),this._projectionMatrixInverse},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"viewProjectionMatrix",{get:function(){return this._needsUpdateCameraMatrix&&this.updateProjectionMatrix(),this._viewProjectionMatrix},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"viewProjectionMatrixInverse",{get:function(){return this._needsUpdateCameraMatrix&&this.updateProjectionMatrix(),this._viewProjectionMatrixInverse},enumerable:!1,configurable:!0}),e.prototype.onMatrixWorldChanged=function(e,r){t.prototype.onMatrixWorldChanged.call(this,e,r),this._needsUpdateCameraMatrix=!0},e}(o.TransformObject);e.Camera=u},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.PlanePolygonIntersectType=void 0,function(t){t[t.SPLIT=0]="SPLIT",t[t.POSITIVE_SIDE_VERTEX=1]="POSITIVE_SIDE_VERTEX",t[t.POSITIVE_SIDE_EDGE=2]="POSITIVE_SIDE_EDGE",t[t.POSITIVE_SIDE_STRICT=3]="POSITIVE_SIDE_STRICT",t[t.NEGATIVE_SIDE_VERTEX=4]="NEGATIVE_SIDE_VERTEX",t[t.NEGATIVE_SIDE_EDGE=5]="NEGATIVE_SIDE_EDGE",t[t.NEGATIVE_SIDE_STRICT=6]="NEGATIVE_SIDE_STRICT",t[t.CONTAINED=7]="CONTAINED",t[t.INVALID_POLYGON=8]="INVALID_POLYGON"}(e.PlanePolygonIntersectType||(e.PlanePolygonIntersectType={}))},function(t,e,r){"use strict";var n,i,o=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(e,"__esModule",{value:!0}),e.LCPSolver=e.LCPResultType=void 0,function(t){t[t.HAS_TRIVIAL_SOLUTION=0]="HAS_TRIVIAL_SOLUTION",t[t.HAS_NONTRIVIAL_SOLUTION=1]="HAS_NONTRIVIAL_SOLUTION",t[t.NO_SOLUTION=2]="NO_SOLUTION",t[t.FAILED_TO_CONVERGE=3]="FAILED_TO_CONVERGE",t[t.INVALID_INPUT=4]="INVALID_INPUT"}(i=e.LCPResultType||(e.LCPResultType={}));var s=function(t){function e(e){var r=t.call(this,e)||this;return e>0&&(r.mVarBasic=new Array(e+1),r.mVarNonbasic=new Array(e+1),r.mNumCols=2*(e+1),r.mAugmented=new Array(2*(e+1)*e),r.mQMin=new Array(e+1),r.mMinRatio=new Array(e+1),r.mRatio=new Array(e+1),r.mPoly=new Array(e)),r}return o(e,t),e.prototype.solve=function(e,r,n,o,s){return void 0===s&&(s=null),this.mDimension>e.length||this.mDimension*this.mDimension>r.length||this.mDimension>n.length||this.mDimension>o.length?(s&&(s.result=i.INVALID_INPUT),!1):t.prototype.solve.call(this,e,r,n,o,s)},e}(function(){function t(t,e,r){void 0===e&&(e=0),void 0===r&&(r=1),this.mDimension=0,this.mMaxIterations=0,this.mNumIterations=0,this.mNumCols=0,this.mZero=0,this.mOne=1,this.mZero=e,this.mOne=r,t>0?(this.mDimension=t,this.mMaxIterations=t*t):(this.mDimension=0,this.mMaxIterations=0)}return t.prototype.getNumIterations=function(){return this.mNumIterations},t.prototype.setMaxIterations=function(t){this.mMaxIterations=t>0?t:this.mDimension*this.mDimension},t.prototype.solve=function(t,e,r,n,o){for(var s=0;s<this.mDimension;++s)this.mPoly[s]=this.getAugmentedIndex(s,this.mDimension+1),this.makeZero(this.mPoly[s]),this.setAugmentedValueByIndex(this.mPoly[s],t[s]),this.setAugmentedValueByIndex(this.mPoly[s]+s+1,this.mOne);this.copyAugmented(this.mPoly[0],this.mQMin);var a=0;for(s=1;s<this.mDimension;++s)this.lessThanAugmented(this.mPoly[s],this.mQMin)&&(this.copyAugmented(this.mPoly[s],this.mQMin),a=s);if(!this.lessThanZero(this.mQMin)){for(s=0;s<this.mDimension;++s)r[s]=t[s],n[s]=this.mZero;return o&&(o.result=i.HAS_TRIVIAL_SOLUTION),!0}for(s=0;s<this.mDimension;++s){for(var u=0;u<this.mDimension;++u)this.setAugmentedValue(s,u,e[this.mDimension*s][u]);this.setAugmentedValue(s,this.mDimension,this.mOne)}for(var p=0;p<=this.mDimension;++p)this.mVarBasic[p].name="w",this.mVarBasic[p].index=p,this.mVarBasic[p].complementary=p,this.mVarBasic[p].tuple=r,this.mVarNonbasic[p].name="z",this.mVarNonbasic[p].index=p,this.mVarNonbasic[p].complementary=p,this.mVarNonbasic[p].tuple=n;var h=this.mDimension;for(s=0;s<this.mDimension;++s)if(s!=a)for(u=0;u<this.mNumCols;++u)if(u!=this.mDimension){var c=this.getAugmentedValue(s,u),l=this.getAugmentedValue(a,u);this.setAugmentedValue(s,u,c-l)}for(u=0;u<this.mNumCols;++u)u!=this.mDimension&&this.setAugmentedValue(a,u,-this.getAugmentedValue(a,u));this.mNumIterations=0;for(p=0;p<this.mMaxIterations;++p,++this.mNumIterations){var f=this.mVarBasic[a].complementary;this.mVarNonbasic[f].complementary=h;var y=this.mVarBasic[a];if(this.mVarBasic[a]=this.mVarNonbasic[h],this.mVarNonbasic[h]=y,this.mVarNonbasic[h].index==this.mDimension){for(s=0;s<this.mDimension;++s)this.mVarBasic[s].tuple[this.mVarBasic[s].index]=this.getAugmentedValueByIndex(s);for(u=0;u<=this.mDimension;++u){var d=this.mVarNonbasic[u].index;d<this.mDimension&&(this.mVarNonbasic[u].tuple[d]=this.mZero)}return o&&(o.result=i.HAS_NONTRIVIAL_SOLUTION),!0}h=f,a=-1;for(s=0;s<this.mDimension;++s)if(this.getAugmentedValue(s,h)<this.mZero){var _=-this.mOne/this.getAugmentedValue(s,h);this.multiplyAugmented(this.mPoly[s],_,this.mRatio),(-1==a||this.lessThan(this.mRatio,this.mMinRatio))&&(this.copy(this.mRatio,this.mMinRatio),a=s)}if(-1==a){for(s=0;s<this.mDimension;++s)r[s]=this.mZero,n[s]=this.mZero;return o&&(o.result=i.NO_SOLUTION),!1}var m=this.mOne/this.getAugmentedValue(a,h);for(s=0;s<this.mDimension;++s)if(s!=a&&this.getAugmentedValue(s,h)!=this.mZero){var g=this.getAugmentedValue(s,h)*m;for(u=0;u<this.mNumCols;++u)if(u!=h){c=this.getAugmentedValue(s,u),l=this.getAugmentedValue(a,u)*g;this.setAugmentedValue(s,u,c-l)}else this.setAugmentedValue(s,h,g)}for(u=0;u<this.mNumCols;++u)u!=h?this.setAugmentedValue(a,u,-this.getAugmentedValue(a,u)*m):this.setAugmentedValue(a,h,m)}return o&&(o.result=i.FAILED_TO_CONVERGE),!1},t.prototype.getAugmentedIndex=function(t,e){return e+this.mNumCols*t},t.prototype.getAugmentedValue=function(t,e){return this.mAugmented[e+this.mNumCols*t]},t.prototype.setAugmentedValue=function(t,e,r){this.mAugmented[e+this.mNumCols*t]=r},t.prototype.setAugmentedValueByIndex=function(t,e){this.mAugmented[t]=e},t.prototype.getAugmentedValueByIndex=function(t){return this.mAugmented[t]},t.prototype.makeZero=function(t){for(var e=0;e<=this.mDimension;++e)this.mAugmented[t+e]=this.mZero},t.prototype.copyAugmented=function(t,e){for(var r=0;r<=this.mDimension;++r)e[r]=this.mAugmented[t+r]},t.prototype.copy=function(t,e){for(var r=0;r<=this.mDimension;++r)e[r]=t[r]},t.prototype.lessThanAugmented=function(t,e){for(var r=0;r<=this.mDimension;++r){if(this.mAugmented[t+r]<e[r])return!0;if(this.mAugmented[t+r]>e[r])return!1}return!1},t.prototype.lessThan=function(t,e){for(var r=0;r<=this.mDimension;++r){if(t[r]<e[r])return!0;if(t[r]>e[r])return!1}return!1},t.prototype.lessThanZeroAugmented=function(t){for(var e=0;e<=this.mDimension;++e){if(this.mAugmented[t+e]<this.mZero)return!0;if(this.mAugmented[t+e]>this.mZero)return!1}return!1},t.prototype.lessThanZero=function(t){for(var e=0;e<=this.mDimension;++e){if(t[e]<this.mZero)return!0;if(t[e]>this.mZero)return!1}return!1},t.prototype.multiplyAugmented=function(t,e,r){for(var n=0;n<=this.mDimension;++n)r[n]=this.mAugmented[t+n]*e},t.prototype.multiply=function(t,e,r){for(var n=0;n<=this.mDimension;++n)r[n]=t[n]*e},t}());e.LCPSolver=s},function(t,e,r){"use strict";var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(e,"__esModule",{value:!0}),e.ColorRGBA=void 0;var o=r(26),s=r(1),a=function(t){function e(e,r,n,i){void 0===e&&(e=null),void 0===r&&(r=null),void 0===n&&(n=null),void 0===i&&(i=null);var o=t.call(this,e,r,n)||this;return o.a=1,i&&(o.a=i),o}return i(e,t),e.Build=function(){return new e},e.prototype.setComponent=function(t,e){switch(t){case 0:this.r=e;break;case 1:this.g=e;break;case 2:this.b=e;break;case 3:this.a=e;break;default:throw new Error("index is out of range: "+t)}return this},e.prototype.getComponent=function(t){switch(t){case 0:return this.r;case 1:return this.g;case 2:return this.b;case 3:return this.a;default:throw new Error("index is out of range: "+t)}},e.prototype.maximumComponent=function(){return Math.max(Math.max(Math.max(this.r,this.g),this.b),this.a)},e.prototype.minimumComponent=function(){return Math.min(Math.min(Math.min(this.r,this.g),this.b),this.a)},e.prototype.clone=function(){return new e(this.r,this.g,this.b,this.a)},e.prototype.copy=function(t){return this.r=t.r,this.g=t.g,this.b=t.b,t instanceof e&&(this.a=t.a),this},e.prototype.setRGBA=function(t,e,r,n){return this.r=t,this.g=e,this.b=r,this.a=n,this},e.prototype.setStyle=function(e){var r;if(r=/^((?:rgb|hsl)a?)\(\s*([^\)]*)\)/.exec(e)){var n=void 0,i=r[1],o=r[2];switch(i){case"rgba":if(n=/^(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(o))return this.r=Math.min(255,parseInt(n[1],10))/255,this.g=Math.min(255,parseInt(n[2],10))/255,this.b=Math.min(255,parseInt(n[3],10))/255,this.a=Math.min(1,parseFloat(n[4])),this;if(n=/^(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(o))return this.r=Math.min(100,parseInt(n[1],10))/100,this.g=Math.min(100,parseInt(n[2],10))/100,this.b=Math.min(100,parseInt(n[3],10))/100,this.a=Math.min(1,parseFloat(n[4])),this;break;case"hsla":if(n=/^([0-9]*\.?[0-9]+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(o)){var s=parseFloat(n[1])/360,a=parseInt(n[2],10)/100,u=parseInt(n[3],10)/100;return this.a=Math.min(1,parseFloat(n[4])),this.setHSL(s,a,u),this}}}return t.prototype.setStyle.call(this,e),this},e.prototype.getStyle=function(){return"rgba("+(255*this.r|0)+","+(255*this.g|0)+","+(255*this.b|0)+","+this.a+")"},e.prototype.lerp=function(t,e){return this.r+=(t.r-this.r)*e,this.g+=(t.g-this.g)*e,this.b+=(t.b-this.b)*e,this.a+=(t.a-this.a)*e,this},e.prototype.equals=function(r){return r instanceof e?r.r==this.r&&r.g==this.g&&r.b==this.b&&r.a==this.a:t.prototype.equals.call(this,r)},e.prototype.equalsEpsilon=function(r,n,i){return void 0===i&&(i=null),r instanceof e?s.MathUtils.equalsEpsilon(this.r,r.r,n,i)&&s.MathUtils.equalsEpsilon(this.g,r.g,n,i)&&s.MathUtils.equalsEpsilon(this.b,r.b,n,i)&&s.MathUtils.equalsEpsilon(this.a,r.a,n,i):t.prototype.equalsEpsilon.call(this,r,n,i)},e.prototype.fromBufferAttribute=function(t,e){return this.r=t.getX(e),this.g=t.getY(e),this.b=t.getZ(e),this.a=t.getW(e),t.normalized&&(this.r/=255,this.g/=255,this.b/=255,this.a/=255),this},e.prototype.toArray=function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this.r,t[e+1]=this.g,t[e+2]=this.b,t[e+3]=this.a,t},e.prototype.fromArray=function(t,e){return void 0===e&&(e=0),this.r=t[e],this.g=t[e+1],this.b=t[e+2],this.a=t[e+3],this},e.prototype.fromDataBuffer=function(t){return this.r=t.readFloat32(),this.g=t.readFloat32(),this.b=t.readFloat32(),this.a=t.readFloat32(),this},e.prototype.toDataBuffer=function(t){return t.writeFloat32(this.r),t.writeFloat32(this.g),t.writeFloat32(this.b),t.writeFloat32(this.a),this},e}(o.ColorRGB);e.ColorRGBA=a},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Plane=void 0;var n=r(0),i=r(42),o=r(20),s=r(18),a=r(37),u=new n.Vector3,p=new n.Vector3,h=new s.Matrix3,c=function(){function t(t,e){void 0===t&&(t=n.Vector3.UNIT_X),void 0===e&&(e=0),this.normal=new n.Vector3,this.constant=0,this.normal.copy(t),this.constant=e}return t.prototype.set=function(t,e){return this.normal.copy(t),this.constant=e,this},t.prototype.setFromXYZW=function(t,e,r,n){return this.normal.set(t,e,r),this.constant=n,this},t.prototype.setFromVector4=function(t){return this.setFromXYZW(t.x,t.y,t.z,t.w)},t.prototype.setFromNormalAndCoplanarPoint=function(t,e){return this.normal.copy(t),this.constant=e.dot(this.normal),this},t.prototype.setFromCoplanarPoints=function(t,e,r){var n=u.subVectors(r,e).cross(p.subVectors(t,e)).normalize();return this.setFromNormalAndCoplanarPoint(n,t),this},t.prototype.clone=function(){return(new t).copy(this)},t.prototype.copy=function(t){return this.normal.copy(t.normal),this.constant=t.constant,this},t.prototype.normalize=function(){var t=1/this.normal.length();return this.normal.multiplyScalar(t),this.constant*=t,this},t.prototype.negate=function(){return this.constant*=-1,this.normal.negate(),this},t.prototype.projectPoint=function(t,e){return void 0===e&&(e=new n.Vector3),e.copy(this.normal).multiplyScalar(-this.distanceToPoint(t)).add(t)},t.prototype.coplanarPoint=function(t){return void 0===t&&(t=new n.Vector3),t.copy(this.normal).multiplyScalar(this.constant)},t.prototype.applyMatrix4=function(t,e){void 0===e&&(e=null),e=e||h.getNormalMatrix(t);var r=this.coplanarPoint(u).applyMatrix4(t),n=this.normal.applyMatrix3(e).normalize();return this.constant=r.dot(n),this},t.prototype.translate=function(t){return this.constant+=t.dot(this.normal),this},t.prototype.distanceToPoint=function(t){return this.normal.dot(t)-this.constant},t.prototype.distanceToSphere=function(t){return this.distanceToPoint(t.center)-t.radius},t.prototype.intersectsPlane=function(t){var e,r=t,n=this.normal.dot(r.normal);return Math.abs(n)<1||(e=n>=0?this.constant-r.constant:this.constant+r.constant,0==Math.abs(e))},t.prototype.intersectPlane=function(e){var r=e,n={intersect:!1,isLine:!1,line:new a.Line3,plane:new t},i=this.normal.dot(r.normal);if(Math.abs(i)>=1){var o=void 0;return o=i>=0?this.constant-r.constant:this.constant+r.constant,0==Math.abs(o)?(n.intersect=!0,n.isLine=!1,n.plane=this,n):(n.intersect=!1,n)}var s=1/(1-i*i),h=(this.constant-i*r.constant)*s,c=(r.constant-i*this.constant)*s;return n.intersect=!0,n.isLine=!0,n.line.origin.addVectors(u.copy(this.normal).multiplyScalar(h),p.copy(r.normal).multiplyScalar(c)),n.line.direction.crossVectors(this.normal,r.normal).normalize(),n},t.prototype.intersectsPolygon=function(t){var e=t.length;if(e<3)return!1;for(var r=0,n=0,i=0,o=0;o<e;++o){var s=this.normal.dot(t[o])-this.constant;s>0?++r:s<0?++n:++i}return r>0?n>0||0!=i:!(n>0)||0!=i},t.prototype.intersectPolygon=function(t){var e={type:i.PlanePolygonIntersectType.INVALID_POLYGON,intersection:new Array,positivePolygon:new Array,negativePolygon:new Array},r=t.length;if(r<3)return e;for(var o=new Array(r),s=[],a=0,h=0,c=-1/0,l=1/0,f=1/0,y=1/0,d=0;d<r;++d)o[d]=this.normal.dot(t[d])-this.constant,o[d]>0?(++a,o[d]>c&&(c=o[d],f=d)):o[d]<0?(++h,o[d]<l&&(l=o[d],y=d)):s.push(d);if(a>0)if(h>0){e.type=i.PlanePolygonIntersectType.SPLIT;var _=c<-l;if(_){o.forEach((function(t,e){o[e]=-o[e]}));var m=f;f=y,y=m}if(function(t,e,r,i){var o=t.length,s=[];s.push(t[r]);for(var a=r,h=1/0,c=0;c<o&&e[h=(a+o-1)%o]>=0;++c)s.splice(0,0,t[h]),a=h;var l=r,f=1/0;for(c=0;c<o&&e[f=(l+1)%o]>=0;++c)s.push(t[f]),l=f;var y=f,d=[];for(c=0;c<o&&(d.push(t[y]),(y=(y+1)%o)!=a);++c);if(e[a]>0){var _=1-(g=-e[h]/(e[a]-e[h])),m=(new n.Vector3).addVectors(u.copy(t[h]).multiplyScalar(_),p.copy(t[a]).multiplyScalar(g));s.splice(0,0,m),d.push(m),i.intersection.push(m)}else d.push(t[a]),i.intersection.push(t[a]);if(e[l]>0){var g;_=1-(g=-e[f]/(e[l]-e[f])),m=(new n.Vector3).addVectors(u.copy(t[f]).multiplyScalar(_),p.copy(t[l]).multiplyScalar(g));s.push(m),d.splice(0,0,m),i.intersection.push(m)}else d.splice(0,0,t[l]),i.intersection.push(t[l]);i.positivePolygon=s,i.negativePolygon=d}(t,o,f,e),_){m=e.positivePolygon;e.positivePolygon=e.negativePolygon,e.negativePolygon=m}}else{0==(g=s.length)?e.type=i.PlanePolygonIntersectType.POSITIVE_SIDE_STRICT:1==g?(e.type=i.PlanePolygonIntersectType.POSITIVE_SIDE_VERTEX,e.intersection.push(t[s[0]])):(e.type=i.PlanePolygonIntersectType.POSITIVE_SIDE_EDGE,e.intersection.push(t[s[0]],t[s[1]])),e.positivePolygon=t}else if(h>0){var g;0==(g=s.length)?e.type=i.PlanePolygonIntersectType.NEGATIVE_SIDE_STRICT:1==g?(e.type=i.PlanePolygonIntersectType.NEGATIVE_SIDE_VERTEX,e.intersection.push(t[s[0]])):(e.type=i.PlanePolygonIntersectType.NEGATIVE_SIDE_EDGE,e.intersection.push(t[s[0]],t[s[1]])),e.negativePolygon=t}else e.type=i.PlanePolygonIntersectType.CONTAINED,e.intersection=t;return e},t.prototype.intersectsSphere=function(t){return Math.abs(this.distanceToPoint(t.center))<=t.radius},t.prototype.intersectSphere=function(t){var e=this.distanceToPoint(t.center),r=Math.abs(e);if(r<t.radius){var i=(t.radius+r)*(t.radius-r),s=new o.Sphere;return s.center.subVectors(t.center,u.copy(this.normal).multiplyScalar(e)),s.radius=Math.sqrt(i),{intersect:!0,isCircle:!0,circle:s}}return r==t.radius?{intersect:!0,isCircle:!1,point:(new n.Vector3).subVectors(t.center,u.copy(this.normal).multiplyScalar(e))}:{intersect:!1}},t.prototype.intersectsTriangle=function(t){for(var e=[],r=0,n=0,i=0,o=0;o<3;++o)e[o]=this.normal.dot(t.p[o])-this.constant,e[o]>0?++r:e[o]<0?++n:++i;return 0==i&&r>0&&n>0||i>0},t.prototype.intersectTriangle=function(t){for(var e={intersect:!1,numIntersections:0,isInterior:!1,points:new Array},r=[],i=0,o=0,s=0,a=0;a<3;++a)r[a]=this.normal.dot(t.p[a])-this.constant,r[a]>0?++i:r[a]<0?++o:++s;if(0==s&&i>0&&o>0){e.intersect=!0,e.numIntersections=2,e.isInterior=!0;for(var h=3-2*i,c=0;c<3;++c)if(h*r[c]>0){var l=(c+2)%3,f=r[d=(c+1)%3]/(r[d]-r[c]),y=r[l]/(r[l]-r[c]);e.points[0]=(new n.Vector3).copy(t.p[d]).add(u.subVectors(t.p[c],t.p[d]).multiplyScalar(f)),e.points[1]=(new n.Vector3).copy(t.p[l]).add(p.subVectors(t.p[c],t.p[l]).multiplyScalar(y));break}return e}if(1==s){e.intersect=!0;for(c=0;c<3;++c)if(0==r[c]){var d=(c+1)%3;l=(c+2)%3;if(e.points[0]=(new n.Vector3).copy(t.p[c]),2==i||2==o)e.numIntersections=1;else{e.numIntersections=2,e.isInterior=!0;var _=r[d]/(r[d]-r[l]);e.points[1]=(new n.Vector3).copy(t.p[d]).add(u.subVectors(t.p[l],t.p[d]).multiplyScalar(_))}break}return e}if(2==s){e.intersect=!0,e.numIntersections=2,e.isInterior=!1;for(c=0;c<3;++c)if(0!=r[c]){d=(c+1)%3,l=(c+2)%3;e.points[0]=(new n.Vector3).copy(t.p[d]),e.points[1]=(new n.Vector3).copy(t.p[l]);break}return e}return 3==s?(e.intersect=!0,e.numIntersections=3,e.points[0]=(new n.Vector3).copy(t.a),e.points[1]=(new n.Vector3).copy(t.b),e.points[2]=(new n.Vector3).copy(t.c)):(e.intersect=!1,e.numIntersections=0),e},t.prototype.intersectsOBB=function(t){var e=Math.abs(t.extent.x*this.normal.dot(t.axis[0]))+Math.abs(t.extent.y*this.normal.dot(t.axis[1]))+Math.abs(t.extent.z*this.normal.dot(t.axis[2])),r=this.distanceToPoint(t.center);return Math.abs(r)<=e},t.prototype.equals=function(t){return t.normal.equals(this.normal)&&t.constant==this.constant},t}();e.Plane=c},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.LineSegment3=void 0;var n,i,o,s,a,u,p,h,c,l,f,y,d,_=r(0),m=r(1),g=r(37),v=r(19),x=new _.Vector3,b=new _.Vector3,S=new _.Vector3,T=new _.Vector3,C=new _.Vector3,E=new _.Vector3,M=function(){function t(t,e){void 0===t&&(t=null),void 0===e&&(e=null),this._p=[new _.Vector3,new _.Vector3],t&&this._p[0].copy(t),e&&this._p[1].copy(e)}return Object.defineProperty(t.prototype,"p",{get:function(){return this._p},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"start",{get:function(){return this._p[0]},set:function(t){this._p[0].copy(t)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"end",{get:function(){return this._p[1]},set:function(t){this._p[1].copy(t)},enumerable:!1,configurable:!0}),t.prototype.set=function(t,e){return this.start.copy(t),this.end.copy(e),this},t.prototype.clone=function(){return(new t).copy(this)},t.prototype.copy=function(t){return this.start.copy(t.start),this.end.copy(t.end),this},t.prototype.getCenter=function(t){return void 0===t&&(t=new _.Vector3),t.addVectors(this.start,this.end).multiplyScalar(.5)},t.prototype.delta=function(t){return void 0===t&&(t=new _.Vector3),t.subVectors(this.end,this.start)},t.prototype.distanceSq=function(){return this.start.distanceToSquared(this.end)},t.prototype.distance=function(){return this.start.distanceTo(this.end)},t.prototype.at=function(t,e){return void 0===e&&(e=new _.Vector3),this.delta(e).multiplyScalar(t).add(this.start)},t.prototype.closestPointToPointParameter=function(t,e){void 0===e&&(e=!1),x.subVectors(t,this.start),b.subVectors(this.end,this.start);var r=b.dot(b),n=b.dot(x)/r;return e&&(n=m.MathUtils.clamp(n,0,1)),n},t.prototype.closestPointToPoint=function(t,e,r){void 0===e&&(e=!1),void 0===r&&(r=new _.Vector3);var n=this.closestPointToPointParameter(t,e);return this.delta(r).multiplyScalar(n).add(this.start)},t.prototype.setCenteredForm=function(t,e,r){return this._p[0].copy(e).multiplyScalar(r).subVectors(t,this._p[0]),this._p[1].copy(e).multiplyScalar(r).add(t),this},t.prototype.getCenteredForm=function(t,e){t.addVectors(this._p[0],this._p[1]).multiplyScalar(.5),e.subVectors(this._p[1],this._p[0]);var r=.5*e.length();return e.normalize(),r},t.prototype.distanceSqToPoint=function(t,e,r){void 0===e&&(e=null),void 0===r&&(r=null);var n,i=x.subVectors(this.p[1],this.p[0]),o=b.subVectors(t,this.p[1]),s=i.dot(o),a=0;if(s>=0)a=1,n=this.p[1];else if(o.subVectors(t,this.p[0]),(s=i.dot(o))<=0)a=0,n=this.p[0];else{var u=i.dot(i);u>0?(a=s/=u,n=S.copy(i).multiplyScalar(s).add(this.p[0])):(a=0,n=this.p[0])}return e&&e.copy(n),r&&(r.segmentParameter=a),o.subVectors(t,n),o.dot(o)},t.prototype.distanceToPoint=function(t,e,r){return void 0===e&&(e=null),void 0===r&&(r=null),Math.sqrt(this.distanceSqToPoint(t,e,r))},t.prototype.distanceSqToSegment=function(t,e,r,_){void 0===e&&(e=null),void 0===r&&(r=null),void 0===_&&(_=null);var m=this.start,g=this.end,v=t.start,E=t.end,M=x.subVectors(g,m),P=b.subVectors(E,v),A=S.subVectors(m,v);n=M.dot(M),i=M.dot(P),o=P.dot(P),s=M.dot(A),a=P.dot(A),h=(u=s)-i,c=(p=u+n)-i,y=(l=-a)+o,d=(f=l-i)+o;var O=[0,0];if(n>0&&o>0){var R=[0,0];R[0]=w(n,u,p),R[1]=w(n,h,c);for(var B=[0,0],I=0;I<2;++I)R[I]<=0?B[I]=-1:R[I]>=1?B[I]=1:B[I]=0;if(-1==B[0]&&-1==B[1])O[0]=0,O[1]=w(o,l,y);else if(1==B[0]&&1==B[1])O[0]=1,O[1]=w(o,f,d);else{var N=[0,0],F=[[0,0],[0,0]];!function(t,e,r,n){e[0]<0?(r[0]=0,n[0][0]=0,n[0][1]=u/i,(n[0][1]<0||n[0][1]>1)&&(n[0][1]=.5),0==e[1]?(r[1]=3,n[1][0]=t[1],n[1][1]=1):(r[1]=1,n[1][0]=1,n[1][1]=p/i,(n[1][1]<0||n[1][1]>1)&&(n[1][1]=.5))):0==e[0]?(r[0]=2,n[0][0]=t[0],n[0][1]=0,e[1]<0?(r[1]=0,n[1][0]=0,n[1][1]=u/i,(n[1][1]<0||n[1][1]>1)&&(n[1][1]=.5)):0==e[1]?(r[1]=3,n[1][0]=t[1],n[1][1]=1):(r[1]=1,n[1][0]=1,n[1][1]=p/i,(n[1][1]<0||n[1][1]>1)&&(n[1][1]=.5))):(r[0]=1,n[0][0]=1,n[0][1]=p/i,(n[0][1]<0||n[0][1]>1)&&(n[0][1]=.5),0==e[1]?(r[1]=3,n[1][0]=t[1],n[1][1]=1):(r[1]=0,n[1][0]=0,n[1][1]=u/i,(n[1][1]<0||n[1][1]>1)&&(n[1][1]=.5)))}(R,B,N,F),function(t,e,r){var n=e[1][1]-e[0][1],s=n*(-i*e[0][0]+o*e[0][1]-a);if(s>=0)0==t[0]?(r[0]=0,r[1]=w(o,l,y)):1==t[0]?(r[0]=1,r[1]=w(o,f,d)):(r[0]=e[0][0],r[1]=e[0][1]);else{var u=n*(-i*e[1][0]+o*e[1][1]-a);if(u<=0)0==t[1]?(r[0]=0,r[1]=w(o,l,y)):1==t[1]?(r[0]=1,r[1]=w(o,f,d)):(r[0]=e[1][0],r[1]=e[1][1]);else{var p=Math.min(Math.max(s/(s-u),0),1),h=1-p;r[0]=h*e[0][0]+p*e[1][0],r[1]=h*e[0][1]+p*e[1][1]}}}(N,F,O)}}else n>0?(O[0]=w(n,u,p),O[1]=0):o>0?(O[0]=0,O[1]=w(o,l,y)):(O[0]=0,O[1]=0);T.addVectors(x.copy(m).multiplyScalar(1-O[0]),b.copy(g).multiplyScalar(O[0])),C.addVectors(x.copy(v).multiplyScalar(1-O[1]),b.copy(E).multiplyScalar(O[1])),e&&e.copy(T),r&&r.copy(C),_&&(_.parameter=O);var G=S.subVectors(T,C);return G.dot(G)},t.prototype.distanceToSegment=function(t,e,r,n){return void 0===e&&(e=null),void 0===r&&(r=null),void 0===n&&(n=null),Math.sqrt(this.distanceSqToSegment(t,e,r,n))},t.prototype.distanceSqToTriangle=function(t,e,r,n){void 0===e&&(e=null),void 0===r&&(r=null),void 0===n&&(n=null);var i=x,o=b,s=this.getCenteredForm(i,o),a={lineParameter:0,triangleParameter:[]},u=new g.Line3(i,o).distanceSqToTriangle(t,e,r,a);if(a.lineParameter>=-s)if(a.lineParameter<=s)n&&(n.segmentParameter=a.lineParameter,n.triangleParameter=a.triangleParameter);else{var p=S.copy(o).multiplyScalar(s).add(i);u=t.distanceSqToPoint(p,r),n&&(n.segmentParameter=s),e&&e.copy(p)}else{p=S.copy(o).multiplyScalar(s).subVectors(i,S);u=t.distanceSqToPoint(p,r),n&&(n.segmentParameter=s),e&&e.copy(p)}return u},t.prototype.distanceToTriangle=function(t,e,r,n){return void 0===e&&(e=null),void 0===r&&(r=null),void 0===n&&(n=null),Math.sqrt(this.distanceSqToTriangle(t,e,r,n))},t.prototype.distanceSqToBox=function(t,e,r,n){void 0===e&&(e=null),void 0===r&&(r=null),void 0===n&&(n=null);var i=x,o=b,s=this.getCenteredForm(i,o),a={sqrDistance:0,lineParameter:0},u=new g.Line3(i,o).distanceSqToBox(t,e,r,a);if(a.lineParameter>=-s)if(a.lineParameter<=s)n&&(n.segmentParameter=a.lineParameter);else{var p=S.copy(o).multiplyScalar(s).add(i);u=t.distanceSqToPoint(p,r),n&&(n.segmentParameter=s),e&&e.copy(p)}else{p=S.copy(o).multiplyScalar(s).subVectors(i,S);u=t.distanceSqToPoint(p,r),n&&(n.segmentParameter=s),e&&e.copy(p)}return u},t.prototype.distanceToBox=function(t,e,r,n){return void 0===e&&(e=null),void 0===r&&(r=null),void 0===n&&(n=null),Math.sqrt(this.distanceSqToBox(t,e,r,n))},t.prototype.distanceSqToOBB=function(t,e,r,n){void 0===e&&(e=null),void 0===r&&(r=null),void 0===n&&(n=null);var i=x,o=b,s=this.getCenteredForm(i,o),a={sqrDistance:0,lineParameter:0},u=new g.Line3(i,o).distanceSqToOBB(t,e,r,a);if(a.lineParameter>=-s)if(a.lineParameter<=s)n&&(n.segmentParameter=a.lineParameter);else{var p=S.copy(o).multiplyScalar(s).add(i);u=t.distanceSqToPoint(p,r),n&&(n.segmentParameter=s),e&&e.copy(p)}else{p=S.copy(o).multiplyScalar(s).subVectors(i,S);u=t.distanceSqToPoint(p,r),n&&(n.segmentParameter=s),e&&e.copy(p)}return u},t.prototype.distanceToOBB=function(t,e,r,n){return void 0===e&&(e=null),void 0===r&&(r=null),void 0===n&&(n=null),Math.sqrt(this.distanceSqToOBB(t,e,r,n))},t.prototype.intersectsTriangle=function(t){var e,r=x,n=b,i=this.getCenteredForm(r,n),o=S.subVectors(r,t.p[0]),s=T.subVectors(t.p[1],t.p[0]),a=C.subVectors(t.p[2],t.p[0]),u=E.crossVectors(s,a),p=n.dot(u);if(p>0)e=1;else{if(!(p<0))return!1;e=-1,p=-p}var h=e*n.dotCross(o,a);if(h>=0){var c=e*n.dotCross(s,o);if(c>=0&&h+c<=p){var l=-e*o.dot(u),f=i*p;if(-f<=l&&l<=f)return!0}}return!1},t.prototype.intersectTriangle=function(t){var e,r=x,n=b,i=this.getCenteredForm(r,n),o=S.subVectors(r,t.p[0]),s=T.subVectors(t.p[1],t.p[0]),a=C.subVectors(t.p[2],t.p[0]),u=E.crossVectors(s,a),p=n.dot(u);if(p>0)e=1;else{if(!(p<0))return{intersect:!1};e=-1,p=-p}var h=e*n.dotCross(o,a);if(h>=0){var c=e*n.dotCross(s,o);if(c>=0&&h+c<=p){var l=-e*o.dot(u),f=i*p;if(-f<=l&&l<=f){var y=1/p,d={intersect:!0,parameter:l*y,triangleBary:new Array(3),point:new _.Vector3};return d.triangleBary[1]=h*y,d.triangleBary[2]=c*y,d.triangleBary[0]=1-d.triangleBary[1]-d.triangleBary[2],d.point.copy(n).multiplyScalar(d.parameter).add(r),d}}}return{intersect:!1}},t.prototype.intersectsSphere=function(t){var e=x,r=b,n=this.getCenteredForm(e,r),i=S.subVectors(e,t.center),o=i.dot(i)-t.radius*t.radius,s=r.dot(i);if(s*s-o<0)return!1;var a=n*n+o,u=2*s*n,p=a-u;return p*(a+u)<=0||p>0&&Math.abs(s)<n},t.prototype.intersectSphere=function(t){var e=x,r=b,n=this.getCenteredForm(e,r),i=new g.Line3(e,r).intersectSphere(t);if(i.intersect){var o=[-n,n],s=v.Intervals.staticQuery(i.parameter,o);s.intersect?(i.numIntersections=s.numIntersections,i.parameter=s.overlap):(i.intersect=!1,i.numIntersections=0)}i.point.length=0;for(var a=0;a<i.numIntersections;++a)i.point[a]=(new _.Vector3).copy(r).multiplyScalar(i.parameter[a]).add(e);return i},t.prototype.intersectsPlane=function(t){var e=t.distanceToPoint(this.p[0]);if(0==e)return!0;var r=t.distanceToPoint(this.p[1]);return 0==r||e*r<0},t.prototype.intersectPlane=function(t){var e=x,r=b,n=this.getCenteredForm(e,r),i=new g.Line3(e,r).intersectPlane(t);return i.intersect&&(Math.abs(i.parameter)>n?(i.intersect=!1,i.numIntersections=0):i.point.copy(r).multiplyScalar(i.parameter).add(e)),i},t.prototype.intersectsBox3=function(e){var r=e.getCenter(x),n=e.getCenter(b),i=new t(S.subVectors(this.p[0],r),T.subVectors(this.p[1],r)),o=C,s=E,a=i.getCenteredForm(o,s);return t.intersectsBox(o,s,a,n)},t.intersectsBox=function(t,e,r,n){for(var i=0;i<3;++i)if(Math.abs(t.p[i])>n.p[i]+r*Math.abs(e.p[i]))return!1;return g.Line3.intersectsBox(t,e,n)},t.prototype.intersectBox=function(e){var r=e.getCenter(x),n=e.getCenter(b),i=new t(S.subVectors(this.p[0],r),T.subVectors(this.p[1],r)),o=C,s=E,a=i.getCenteredForm(o,s),u={intersect:!1,numPoints:0,lineParameter:new Array(2),point:new Array(2)};t.intersectBox(o,s,a,n,u),o.add(r);for(var p=0;p<u.numPoints;++p)u.point[p]=(new _.Vector3).copy(s).multiplyScalar(u.lineParameter[p]).add(o);return u},t.intersectBox=function(t,e,r,n,i){if(g.Line3.intersectBox(t,e,n,i),i.intersect){var o=[i.lineParameter[0],i.lineParameter[1]],s=[-r,r],a=v.Intervals.staticQuery(o,s);if(a.numIntersections>0){i.numPoints=a.numIntersections;for(var u=0;u<i.numPoints;++u)i.lineParameter[u]=a.overlap[u]}else i.intersect=!1,i.numPoints=0}},t.prototype.intersectsOBB=function(e){var r=x,n=b,i=this.getCenteredForm(r,n),o=S.subVectors(r,e.center),s=T.set(o.dot(e.axis[0]),o.dot(e.axis[1]),o.dot(e.axis[2])),a=C.set(n.dot(e.axis[0]),n.dot(e.axis[1]),n.dot(e.axis[2]));return t.intersectsBox(s,a,i,e.extent)},t.prototype.intersectOBB=function(e){var r=x,n=b,i=this.getCenteredForm(r,n),o=S.subVectors(r,e.center),s=T.set(o.dot(e.axis[0]),o.dot(e.axis[1]),o.dot(e.axis[2])),a=C.set(n.dot(e.axis[0]),n.dot(e.axis[1]),n.dot(e.axis[2])),u={intersect:!1,numPoints:0,lineParameter:new Array(2),point:new Array(2)};t.intersectBox(s,a,i,e.extent,u);for(var p=0;p<u.numPoints;++p){var h=x.copy(a).multiplyScalar(u.lineParameter[p]).add(s);u.point[p].copy(e.center);for(var c=0;c<3;++c)u.point[p].add(b.copy(e.axis[c]).multiplyScalar(h.p[c]))}return u},t.prototype.applyMatrix4=function(t){return this.start.applyMatrix4(t),this.end.applyMatrix4(t),this},t.prototype.equals=function(t){return t.start.equals(this.start)&&t.end.equals(this.end)},t}();function w(t,e,r){var n;return e<0?r>0?(n=-e/t)>1&&(n=.5):n=1:n=0,n}e.LineSegment3=M},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Line2=void 0;var n=r(2),i=new n.Vector2,o=new n.Vector2,s=new n.Vector2,a=new n.Vector2,u=new n.Vector2,p=(new n.Vector2,new n.Vector2,function(){function t(t,e){void 0===t&&(t=null),void 0===e&&(e=null),this.origin=new n.Vector2,this.direction=new n.Vector2(-1,0),t&&this.origin.copy(t),e&&this.direction.copy(e)}return t.prototype.set=function(t,e){return this.origin.copy(t),this.direction.copy(e),this},t.prototype.clone=function(){return(new t).copy(this)},t.prototype.copy=function(t){return this.origin.copy(t.origin),this.direction.copy(t.direction),this},t.prototype.closestPointToPoint=function(t,e){void 0===e&&(e=new n.Vector2),e.subVectors(t,this.origin);var r=e.dot(this.direction);return e.copy(this.direction).multiplyScalar(r).add(this.origin)},t.prototype.distanceSqToPoint=function(t,e){void 0===e&&(e=null);var r=i.subVectors(t,this.origin),n=this.direction.dot(r);return o.copy(this.direction).multiplyScalar(n).add(this.origin),e&&e.copy(o),r.subVectors(t,o),r.dot(r)},t.prototype.distanceToPoint=function(t,e){return void 0===e&&(e=null),Math.sqrt(this.distanceSqToPoint(t,e))},t.prototype.distanceSqToRay=function(t,e,r,n){void 0===e&&(e=null),void 0===r&&(r=null),void 0===n&&(n=null);var a,u,p=i.subVectors(this.origin,t.origin),h=-this.direction.dot(t.direction),c=p.dot(this.direction);if(Math.abs(h)<1){var l=-p.dot(t.direction);if((u=h*c-l)>=0){var f=1-h*h;a=(h*l-c)/f,u/=f}else a=-c,u=0}else a=-c,u=0;return o.copy(this.direction).multiplyScalar(a).add(this.origin),s.copy(t.direction).multiplyScalar(u).add(t.origin),e&&e.copy(o),r&&r.copy(s),n&&(n.parameter=[a,u]),p.subVectors(o,s),p.dot(p)},t.prototype.distanceToRay=function(t,e,r,n){return void 0===e&&(e=null),void 0===r&&(r=null),void 0===n&&(n=null),Math.sqrt(this.distanceSqToRay(t,e,r,n))},t.prototype.distanceSqToSegment=function(t,e,r,n){void 0===e&&(e=null),void 0===r&&(r=null),void 0===n&&(n=null);var p,h,c=i,l=o,f=t.getCenteredForm(c,l),y=s.subVectors(this.origin,c),d=-this.direction.dot(l),_=y.dot(this.direction);if(Math.abs(d)<1){var m=1-d*d,g=f*m,v=-y.dot(l);(h=d*_-v)>=-g?h<=g?(p=(d*v-_)/m,h/=m):p=-(d*(h=f)+_):p=-(d*(h=-f)+_)}else h=0,p=-_;return a.copy(this.direction).multiplyScalar(p).add(this.origin),u.copy(l).multiplyScalar(h).add(c),e&&e.copy(a),r&&r.copy(u),n&&(n.parameter=[p,h]),y.subVectors(a,u),y.dot(y)},t.prototype.distanceToSegment=function(t,e,r,n){return void 0===e&&(e=null),void 0===r&&(r=null),void 0===n&&(n=null),Math.sqrt(this.distanceSqToSegment(t,e,r,n))},t.prototype.distanceSqToLine=function(t,e,r,n){void 0===e&&(e=null),void 0===r&&(r=null),void 0===n&&(n=null);var o,s,p=t,h=i.subVectors(this.origin,p.origin),c=-this.direction.dot(p.direction),l=h.dot(this.direction);if(Math.abs(c)<1){var f=1-c*c,y=-h.dot(p.direction);o=(c*y-l)/f,s=(c*l-y)/f}else o=-l,s=0;return a.copy(this.direction).multiplyScalar(o).add(this.origin),u.copy(p.direction).multiplyScalar(s).add(p.origin),e&&e.copy(a),r&&r.copy(u),n&&(n.parameter=[o,s]),h.subVectors(a,u),h.dot(h)},t.prototype.distanceToLine=function(t,e,r,n){return void 0===e&&(e=null),void 0===r&&(r=null),void 0===n&&(n=null),Math.sqrt(this.distanceSqToLine(t,e,r,n))},t.prototype.intersectsBox=function(e){var r=e.getCenter(i),n=e.getExtent(o),a=s.subVectors(this.origin,r);return t.intersectsBox(a,this.direction,n)},t.intersectsBox=function(t,e,r){return Math.abs(e.dotPerp(t))<=r.p[0]*Math.abs(e.p[1])+r.p[1]*Math.abs(e.p[0])},t.prototype.intersectBox=function(e){var r=e.getCenter(i),a=e.getExtent(o),u=s.subVectors(this.origin,r),p={intersect:!1,numIntersections:0,parameter:new Array(2),point:new Array(2)};t.intersectBox(u,this.direction,a,p);for(var h=0;h<p.numIntersections;++h)p.point[h]=(new n.Vector2).copy(this.direction).multiplyScalar(p.parameter[h]).add(this.origin);return p},t.intersectBox=function(t,e,r,n){var i=function(t,e,r){return t>0?!(e>t*r[1])&&(e>t*r[0]&&(r[0]=e/t),!0):t<0?!(e>t*r[0])&&(e>t*r[1]&&(r[1]=e/t),!0):e<=0},o=[-1/0,1/0];if(i(+e.p[0],-t.p[0]-r.p[0],o)&&i(-e.p[0],+t.p[0]-r.p[0],o)&&i(+e.p[1],-t.p[1]-r.p[1],o)&&i(-e.p[1],+t.p[1]-r.p[1],o))return n.intersect=!0,void(o[1]>o[0]?(n.numIntersections=2,n.parameter[0]=o[0],n.parameter[1]=o[1]):(n.numIntersections=1,n.parameter[0]=o[0],n.parameter[1]=o[0]));n.intersect=!1,n.numIntersections=0},t.prototype.intersectsLine=function(t){var e=t,r=i.subVectors(e.origin,this.origin);return 0!=this.direction.dotPerp(e.direction)||(r.normalize(),0==r.dotPerp(e.direction))},t.prototype.intersectLine=function(t){var e=t,r=i.subVectors(e.origin,this.origin),o=this.direction.dotPerp(e.direction),s={intersect:!1,numIntersections:0,line0Parameter:new Array(2),line1Parameter:new Array(2),point:new n.Vector2};if(0!=o){s.intersect=!0,s.numIntersections=1;var a=1/o,u=r.dotPerp(this.direction),p=r.dotPerp(e.direction)*a,h=u*a;s.line0Parameter[0]=p,s.line1Parameter[0]=h,s.point.copy(this.direction).multiplyScalar(p).add(this.origin)}else{r.normalize();var c=r.dotPerp(e.direction);if(0!=Math.abs(c))s.intersect=!1,s.numIntersections=0;else{s.intersect=!0,s.numIntersections=1/0;s.line0Parameter[0]=-1/0,s.line0Parameter[1]=1/0,s.line1Parameter[0]=-1/0,s.line1Parameter[1]=1/0}}return s},t.prototype.intersectsSegment=function(e){var r=i,n=o,s=e.getCenteredForm(r,n),a=this.intersectLine(new t(r,n));return 1==a.numIntersections?Math.abs(a.line1Parameter[0])<=s:a.intersect},t.prototype.intersectSegment=function(e){var r=i,s=o,a=e.getCenteredForm(r,s),u={intersect:!1,numIntersections:0,lineParameter:new Array(2),segmentParameter:new Array(2),point:new n.Vector2},p=this.intersectLine(new t(r,s));if(1==p.numIntersections)Math.abs(p.line1Parameter[0])<=a?(u.intersect=!0,u.numIntersections=1,u.lineParameter[0]=p.line0Parameter[0],u.segmentParameter[0]=p.line1Parameter[0],u.point=p.point):(u.intersect=!1,u.numIntersections=0);else if(p.numIntersections==1/0){u.intersect=!0,u.numIntersections=1/0;u.lineParameter[0]=-1/0,u.lineParameter[1]=1/0,u.segmentParameter[0]=-a,u.segmentParameter[1]=+a}else u.intersect=!1,u.numIntersections=0;return u},t.prototype.intersectsRay=function(e){var r=this.intersectLine(new t(e.origin,e.direction));return 1==r.numIntersections?r.line1Parameter[0]>=0:r.intersect},t.prototype.intersectRay=function(e){var r={intersect:!1,numIntersections:0,lineParameter:new Array(2),rayParameter:new Array(2),point:new n.Vector2},i=this.intersectLine(new t(e.origin,e.direction));if(1==i.numIntersections)i.line1Parameter[0]>=0?(r.intersect=!0,r.numIntersections=1,r.lineParameter[0]=i.line0Parameter[0],r.rayParameter[0]=i.line1Parameter[0],r.point=i.point):(r.intersect=!1,r.numIntersections=0);else if(i.numIntersections==1/0){r.intersect=!0,r.numIntersections=1/0;r.lineParameter[0]=-1/0,r.lineParameter[1]=1/0,r.rayParameter[0]=0,r.rayParameter[1]=1/0}else r.intersect=!1,r.numIntersections=0;return r},t.prototype.equals=function(t){return t.origin.equals(this.origin)&&t.direction.equals(this.direction)},t}());e.Line2=p},function(t,e,r){"use strict";var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(e,"__esModule",{value:!0}),e.CubicBezierCurve=void 0;var o=r(10),s=r(2),a=r(28),u=function(t){function e(e,r,n,i){void 0===e&&(e=null),void 0===r&&(r=null),void 0===n&&(n=null),void 0===i&&(i=null);var o=t.call(this)||this;return o.v0=new s.Vector2,o.v1=new s.Vector2,o.v2=new s.Vector2,o.v3=new s.Vector2,o.type="CubicBezierCurve",e&&o.v0.copy(e),r&&o.v1.copy(r),n&&o.v2.copy(n),i&&o.v3.copy(i),o}return i(e,t),e.prototype.getPoint=function(t,e){void 0===e&&(e=null);var r=null!=e?e:new s.Vector2,n=this.v0,i=this.v1,o=this.v2,u=this.v3;return r.set(a.BezierCurveFunc.CubicBezier(t,n.x,i.x,o.x,u.x),a.BezierCurveFunc.CubicBezier(t,n.y,i.y,o.y,u.y)),r},e.prototype.clone=function(){return(new e).copy(this)},e.prototype.copy=function(e){return t.prototype.copy.call(this,e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this},e.prototype.toJSON=function(){var e=t.prototype.toJSON.call(this);return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e},e.prototype.fromJSON=function(e){return t.prototype.fromJSON.call(this,e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this},e.prototype.toDataBuffer=function(e){return t.prototype.toDataBuffer.call(this,e),this.v0.toDataBuffer(e),this.v1.toDataBuffer(e),this.v2.toDataBuffer(e),this.v3.toDataBuffer(e),this},e.prototype.fromDataBuffer=function(e){return t.prototype.fromDataBuffer.call(this,e),this.v0.fromDataBuffer(e),this.v1.fromDataBuffer(e),this.v2.fromDataBuffer(e),this.v3.fromDataBuffer(e),this},e}(o.Curve);e.CubicBezierCurve=u},function(t,e,r){"use strict";var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(e,"__esModule",{value:!0}),e.LineCurve3=void 0;var o=r(10),s=r(0),a=function(t){function e(e,r){void 0===e&&(e=null),void 0===r&&(r=null);var n=t.call(this)||this;return n.v1=new s.Vector3,n.v2=new s.Vector3,n.type="LineCurve3",n.arcLengthDivisions=10,e&&n.v1.copy(e),r&&n.v2.copy(r),n}return i(e,t),e.prototype.getPoint=function(t,e){void 0===e&&(e=null);var r=null!=e?e:new s.Vector3;return 1==t?r.copy(this.v2):(r.copy(this.v2).sub(this.v1),r.multiplyScalar(t).add(this.v1)),r},e.prototype.getPointAt=function(t,e){return void 0===e&&(e=null),this.getPoint(t,e)},e.prototype.clone=function(){return(new e).copy(this)},e.prototype.copy=function(e){return t.prototype.copy.call(this,e),this.v1.copy(e.v1),this.v2.copy(e.v2),this},e.prototype.toJSON=function(){var e=t.prototype.toJSON.call(this);return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e},e.prototype.fromJSON=function(e){return t.prototype.fromJSON.call(this,e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this},e.prototype.toDataBuffer=function(e){return t.prototype.toDataBuffer.call(this,e),this.v1.toDataBuffer(e),this.v2.toDataBuffer(e),this},e.prototype.fromDataBuffer=function(e){return t.prototype.fromDataBuffer.call(this,e),this.v1.fromDataBuffer(e),this.v2.fromDataBuffer(e),this},e}(o.Curve);e.LineCurve3=a},function(t,e,r){"use strict";var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(e,"__esModule",{value:!0}),e.QuadraticBezierCurve=void 0;var o=r(10),s=r(2),a=r(28),u=function(t){function e(e,r,n){void 0===e&&(e=null),void 0===r&&(r=null),void 0===n&&(n=null);var i=t.call(this)||this;return i.v0=new s.Vector2,i.v1=new s.Vector2,i.v2=new s.Vector2,i.type="QuadraticBezierCurve",e&&i.v0.copy(e),r&&i.v1.copy(r),n&&i.v2.copy(n),i}return i(e,t),e.prototype.getPoint=function(t,e){void 0===e&&(e=null);var r=null!=e?e:new s.Vector2,n=this.v0,i=this.v1,o=this.v2;return r.set(a.BezierCurveFunc.QuadraticBezier(t,n.x,i.x,o.x),a.BezierCurveFunc.QuadraticBezier(t,n.y,i.y,o.y)),r},e.prototype.clone=function(){return(new e).copy(this)},e.prototype.copy=function(e){return t.prototype.copy.call(this,e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this},e.prototype.toJSON=function(){var e=t.prototype.toJSON.call(this);return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e},e.prototype.fromJSON=function(e){return t.prototype.fromJSON.call(this,e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this},e.prototype.toDataBuffer=function(e){return t.prototype.toDataBuffer.call(this,e),this.v0.toDataBuffer(e),this.v1.toDataBuffer(e),this.v2.toDataBuffer(e),this},e.prototype.fromDataBuffer=function(e){return t.prototype.fromDataBuffer.call(this,e),this.v0.fromDataBuffer(e),this.v1.fromDataBuffer(e),this.v2.fromDataBuffer(e),this},e}(o.Curve);e.QuadraticBezierCurve=u},function(t,e,r){"use strict";var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(e,"__esModule",{value:!0}),e.Path=void 0;var o=r(5),s=r(2),a=r(70),u=r(38),p=r(50),h=r(48),c=r(39),l=r(27),f=function(t){function e(e){void 0===e&&(e=null);var r=t.call(this)||this;return r.type="Path",r.currentPoint=new s.Vector2,e&&r.setFromPoints(e),r}return i(e,t),e.prototype.setFromPoints=function(t){this.moveTo(t[0].x,t[0].y);for(var e=1,r=t.length;e<r;e++)this.lineTo(t[e].x,t[e].y);return this},e.prototype.moveTo=function(t,e){return this.currentPoint.set(t,e),this},e.prototype.lineTo=function(t,e){var r=new u.LineCurve(this.currentPoint,o.MathTmp.Vector2[0].set(t,e));return this.curves.push(r),this.currentPoint.set(t,e),this},e.prototype.quadraticCurveTo=function(t,e,r,n){var i=new p.QuadraticBezierCurve(this.currentPoint,o.MathTmp.Vector2[0].set(t,e),o.MathTmp.Vector2[1].set(r,n));return this.curves.push(i),this.currentPoint.set(r,n),this},e.prototype.bezierCurveTo=function(t,e,r,n,i,o){var a=new h.CubicBezierCurve(this.currentPoint.clone(),new s.Vector2(t,e),new s.Vector2(r,n),new s.Vector2(i,o));return this.curves.push(a),this.currentPoint.set(i,o),this},e.prototype.splineThru=function(t){var e=[this.currentPoint.clone()].concat(t),r=new c.SplineCurve(e);return this.curves.push(r),this.currentPoint.copy(t[t.length-1]),this},e.prototype.arc=function(t,e,r,n,i,o){var s=this.currentPoint.x,a=this.currentPoint.y;return this.absarc(t+s,e+a,r,n,i,o),this},e.prototype.absarc=function(t,e,r,n,i,o){return this.absellipse(t,e,r,r,n,i,o),this},e.prototype.ellipse=function(t,e,r,n,i,o,s,a){void 0===a&&(a=0);var u=this.currentPoint.x,p=this.currentPoint.y;return this.absellipse(t+u,e+p,r,n,i,o,s,a),this},e.prototype.absellipse=function(t,e,r,n,i,o,s,a){void 0===a&&(a=0);var u=new l.EllipseCurve(t,e,r,n,i,o,s,a);if(this.curves.length>0){var p=u.getPoint(0);p.equals(this.currentPoint)||this.lineTo(p.x,p.y)}this.curves.push(u);var h=u.getPoint(1);return this.currentPoint.copy(h),this},e.prototype.copy=function(e){return t.prototype.copy.call(this,e),this.currentPoint.copy(e.currentPoint),this},e.prototype.clone=function(){return(new e).copy(this)},e.prototype.toJSON=function(){var e=t.prototype.toJSON.call(this);return e.currentPoint=this.currentPoint.toArray(),e},e.prototype.fromJSON=function(e){return t.prototype.fromJSON.call(this,e),this.currentPoint.fromArray(e.currentPoint),this},e.prototype.toDataBuffer=function(e){return t.prototype.toDataBuffer.call(this,e),this.currentPoint.toDataBuffer(e),this},e.prototype.fromDataBuffer=function(e){return t.prototype.fromDataBuffer.call(this,e),this.currentPoint.fromDataBuffer(e),this},e}(a.CurvePath);e.Path=f},function(t,e,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(t,e,r,n){void 0===n&&(n=r),Object.defineProperty(t,n,{enumerable:!0,get:function(){return e[r]}})}:function(t,e,r,n){void 0===n&&(n=r),t[n]=e[r]}),i=this&&this.__exportStar||function(t,e){for(var r in t)"default"===r||e.hasOwnProperty(r)||n(e,t,r)};Object.defineProperty(e,"__esModule",{value:!0}),i(r(111),e),i(r(112),e),i(r(53),e)},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.decode=e.encode=void 0;var n,i,o,s=String.fromCharCode;function a(t){for(var e,r,n=[],i=0,o=t.length;i<o;)(e="string"==typeof t?t.charCodeAt(i++):t[i++])>=55296&&e<=56319&&i<o?56320==(64512&(r="string"==typeof t?t.charCodeAt(i++):t[i++]))?n.push(((1023&e)<<10)+(1023&r)+65536):(n.push(e),i--):n.push(e);return n}function u(t){if(t>=55296&&t<=57343)throw Error("Lone surrogate U+"+t.toString(16).toUpperCase()+" is not a scalar value")}function p(t,e){return s(t>>e&63|128)}function h(t){if(0==(4294967168&t))return s(t);var e="";return 0==(4294965248&t)?e=s(t>>6&31|192):0==(4294901760&t)?(u(t),e=s(t>>12&15|224),e+=p(t,6)):0==(4292870144&t)&&(e=s(t>>18&7|240),e+=p(t,12),e+=p(t,6)),e+=s(63&t|128)}function c(){if(o>=i)throw Error("Invalid byte index");var t=255&n[o];if(o++,128==(192&t))return 63&t;throw Error("Invalid continuation byte")}function l(){var t,e;if(o>i)throw Error("Invalid byte index");if(o==i)return!1;if(t=255&n[o],o++,0==(128&t))return t;if(192==(224&t)){if((e=(31&t)<<6|c())>=128)return e;throw Error("Invalid continuation byte")}if(224==(240&t)){if((e=(15&t)<<12|c()<<6|c())>=2048)return u(e),e;throw Error("Invalid continuation byte")}if(240==(248&t)&&(e=(7&t)<<18|c()<<12|c()<<6|c())>=65536&&e<=1114111)return e;throw Error("Invalid UTF-8 detected")}var f=function(t){for(var e=a(t),r=e.length,n=-1,i="";++n<r;)i+=h(e[n]);return i};e.encode=f;var y=function(t){n=a(t),i=n.length,o=0;for(var e,r=[];0!=(e=l());)r.push(Number(e));return function(t){for(var e,r=t.length,n=-1,i="";++n<r;)(e=t[n])>65535&&(i+=s((e-=65536)>>>10&1023|55296),e=56320|1023&e),i+=s(e);return i}(r)};e.decode=y},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.VisibleLayers=void 0;var n=function(){function t(){this.mask=1}return t.prototype.set=function(t){this.mask=1<<t|0},t.prototype.enable=function(t){this.mask|=1<<t|0},t.prototype.enableAll=function(){this.mask=-1},t.prototype.toggle=function(t){this.mask^=1<<t|0},t.prototype.disable=function(t){this.mask&=~(1<<t|0)},t.prototype.disableAll=function(){this.mask=0},t.prototype.test=function(t){return 0!=(this.mask&t.mask)},t}();e.VisibleLayers=n},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.CAGVertex=void 0;var n=r(6),i=function(){function t(t){this.pos=t}return t.prototype.toString=function(){return"("+this.pos.x.toFixed(2)+","+this.pos.y.toFixed(2)+")"},t.prototype.getTag=function(){var t=this.tag;return t||(t=n.CSG.getTag(),this.tag=t),t},t}();e.CAGVertex=i},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.CAGSide=void 0;var n=r(55),i=r(14),o=r(29),s=r(30),a=r(6),u=r(7),p=r(8),h=r(9),c=function(){function t(t,e){if(!(t instanceof n.CAGVertex))throw new Error("Assertion failed");if(!(e instanceof n.CAGVertex))throw new Error("Assertion failed");this.vertex0=t,this.vertex1=e}return t._fromFakePolygon=function(e){if(e.vertices.forEach((function(t){if(!(t.pos.z>=-1.001&&t.pos.z<-.999||t.pos.z>=.999&&t.pos.z<1.001))throw"Assertion failed: _fromFakePolygon expects abs z values of 1"})),e.vertices.length<4)return null;var r=[],o=e.vertices.filter((function(t,e){if(t.pos.z>0)return r.push(e),!0})).map((function(t){return new i.CSGVector2D(t.pos.x,t.pos.y)}));if(2!=o.length)throw"Assertion failed: _fromFakePolygon: not enough points found";var s=r[1]-r[0];if(1!=s&&3!=s)throw"Assertion failed: _fromFakePolygon: unknown index ordering";return 1==s&&o.reverse(),new t(new n.CAGVertex(o[0]),new n.CAGVertex(o[1]))},t.prototype.toString=function(){return this.vertex0+" -> "+this.vertex1},t.prototype.toPolygon3D=function(t,e){var r=[new o.CSGVertex(this.vertex0.pos.toVector3D(t)),new o.CSGVertex(this.vertex1.pos.toVector3D(t)),new o.CSGVertex(this.vertex1.pos.toVector3D(e)),new o.CSGVertex(this.vertex0.pos.toVector3D(e))];return new s.CSGPolygon(r)},t.prototype.transform=function(e){var r=this.vertex0.pos.transform(e),i=this.vertex1.pos.transform(e);return new t(new n.CAGVertex(r),new n.CAGVertex(i))},t.prototype.flipped=function(){return new t(this.vertex1,this.vertex0)},t.prototype.direction=function(){return this.vertex1.pos.minus(this.vertex0.pos)},t.prototype.getTag=function(){var t=this.tag;return t||(t=a.CSG.getTag(),this.tag=t),t},t.prototype.lengthSquared=function(){var t=this.vertex1.pos.x-this.vertex0.pos.x,e=this.vertex1.pos.y-this.vertex0.pos.y;return t*t+e*e},t.prototype.length=function(){return Math.sqrt(this.lengthSquared())},t.prototype.mirrored=function(t){return this.transform(u.CSGMatrix4x4.mirroring(t))},t.prototype.mirroredX=function(){var t=new p.CSGPlane(h.CSGVector3D.Create(1,0,0),0);return this.mirrored(t)},t.prototype.mirroredY=function(){var t=new p.CSGPlane(h.CSGVector3D.Create(0,1,0),0);return this.mirrored(t)},t.prototype.mirroredZ=function(){var t=new p.CSGPlane(h.CSGVector3D.Create(0,0,1),0);return this.mirrored(t)},t.prototype.translate=function(t){return this.transform(u.CSGMatrix4x4.translation(t))},t.prototype.scale=function(t){return this.transform(u.CSGMatrix4x4.scaling(t))},t.prototype.rotateX=function(t){return this.transform(u.CSGMatrix4x4.rotationX(t))},t.prototype.rotateY=function(t){return this.transform(u.CSGMatrix4x4.rotationY(t))},t.prototype.rotateZ=function(t){return this.transform(u.CSGMatrix4x4.rotationZ(t))},t.prototype.rotate=function(t,e,r){return this.transform(u.CSGMatrix4x4.rotation(t,e,r))},t.prototype.rotateEulerAngles=function(t,e,r,n){n=n||[0,0,0];var i=u.CSGMatrix4x4.rotationZ(t),o=u.CSGMatrix4x4.rotationX(e),s=u.CSGMatrix4x4.rotationZ(r),a=u.CSGMatrix4x4.translation(new h.CSGVector3D(n));return this.transform(s.multiply(o).multiply(i).multiply(a))},t}();e.CAGSide=c},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.CSGLine3D=void 0;var n=r(9),i=r(6),o=r(7),s=r(8),a=function(){function t(t,e){var r=new n.CSGVector3D(t);e=new n.CSGVector3D(e),this.point=r,this.direction=e.unit()}return t.fromPoints=function(e,r){new n.CSGVector3D(e),new n.CSGVector3D(r);return new t(e,r.minus(e))},t.fromPlanes=function(e,r){var o=e.normal.cross(r.normal),s=o.length();if(s<1e-10)throw new Error("Parallel planes");o=o.times(1/s);var a,u=Math.abs(o.x),p=Math.abs(o.y),h=Math.abs(o.z);if(u>=p&&u>=h){var c=i.CSG.solve2Linear(e.normal.y,e.normal.z,r.normal.y,r.normal.z,e.w,r.w);a=new n.CSGVector3D(0,c[0],c[1])}else if(p>=u&&p>=h){c=i.CSG.solve2Linear(e.normal.x,e.normal.z,r.normal.x,r.normal.z,e.w,r.w);a=new n.CSGVector3D(c[0],0,c[1])}else{c=i.CSG.solve2Linear(e.normal.x,e.normal.y,r.normal.x,r.normal.y,e.w,r.w);a=new n.CSGVector3D(c[0],c[1],0)}return new t(a,o)},t.prototype.intersectWithPlane=function(t){var e=(t.w-t.normal.dot(this.point))/t.normal.dot(this.direction);return this.point.plus(this.direction.times(e))},t.prototype.clone=function(e){return new t(this.point.clone(),this.direction.clone())},t.prototype.reverse=function(){return new t(this.point.clone(),this.direction.negated())},t.prototype.transform=function(e){var r=this.point.multiply4x4(e);return new t(r,this.point.plus(this.direction).multiply4x4(e).minus(r))},t.prototype.closestPointOnLine=function(t){var e=(t=new n.CSGVector3D(t)).minus(this.point).dot(this.direction)/this.direction.dot(this.direction);return this.point.plus(this.direction.times(e))},t.prototype.distanceToPoint=function(t){t=new n.CSGVector3D(t);var e=this.closestPointOnLine(t);return t.minus(e).length()},t.prototype.equals=function(t){return!!this.direction.equals(t.direction)&&!(this.distanceToPoint(t.point)>1e-8)},t.prototype.mirrored=function(t){return this.transform(o.CSGMatrix4x4.mirroring(t))},t.prototype.mirroredX=function(){var t=new s.CSGPlane(n.CSGVector3D.Create(1,0,0),0);return this.mirrored(t)},t.prototype.mirroredY=function(){var t=new s.CSGPlane(n.CSGVector3D.Create(0,1,0),0);return this.mirrored(t)},t.prototype.mirroredZ=function(){var t=new s.CSGPlane(n.CSGVector3D.Create(0,0,1),0);return this.mirrored(t)},t.prototype.translate=function(t){return this.transform(o.CSGMatrix4x4.translation(t))},t.prototype.scale=function(t){return this.transform(o.CSGMatrix4x4.scaling(t))},t.prototype.rotateX=function(t){return this.transform(o.CSGMatrix4x4.rotationX(t))},t.prototype.rotateY=function(t){return this.transform(o.CSGMatrix4x4.rotationY(t))},t.prototype.rotateZ=function(t){return this.transform(o.CSGMatrix4x4.rotationZ(t))},t.prototype.rotate=function(t,e,r){return this.transform(o.CSGMatrix4x4.rotation(t,e,r))},t.prototype.rotateEulerAngles=function(t,e,r,i){i=i||[0,0,0];var s=o.CSGMatrix4x4.rotationZ(t),a=o.CSGMatrix4x4.rotationX(e),u=o.CSGMatrix4x4.rotationZ(r),p=o.CSGMatrix4x4.translation(new n.CSGVector3D(i));return this.transform(u.multiply(a).multiply(s).multiply(p))},t}();e.CSGLine3D=a},function(t,e,r){"use strict";var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(e,"__esModule",{value:!0}),e.TextureRaw=void 0;var o=r(23),s=r(12),a=function(t){function e(e,r,n,i,o,a,u,p){void 0===i&&(i=!1),void 0===o&&(o=!0),void 0===a&&(a=s.Constants.RGBAFormat),void 0===u&&(u=s.Constants.UnsignedByteType),void 0===p&&(p=!1);var h=t.call(this)||this;return h.buffer=e,h.deleteBuffer=i,h.width=r,h.height=n,h.unpackAlignment=h.width%4!=0?1:4,h.generateMipmaps=o,h.format=a,h.type=u,h._flipY=p,h}return i(e,t),e.prototype.clone=function(){return new e(this.buffer,this.width,this.height,this.deleteBuffer).copy(this)},e.prototype.copy=function(e){return t.prototype.copy.call(this,e),this},e.prototype.dispose=function(){t.prototype.dispose.call(this),this.deleteBuffer&&delete this.buffer},e}(o.Texture);e.TextureRaw=a},function(t,e,r){"use strict";var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(e,"__esModule",{value:!0}),e.Float64BufferAttribute=e.Float32BufferAttribute=e.UInt32BufferAttribute=e.Int32BufferAttribute=e.UInt16BufferAttribute=e.Int16BufferAttribute=e.UInt8ClampedBufferAttribute=e.UInt8BufferAttribute=e.Int8BufferAttribute=void 0;var o=r(22),s=function(t){function e(e,r,n){return void 0===n&&(n=!1),t.call(this,new Int8Array(e),r,n)||this}return i(e,t),e}(o.BufferAttribute);e.Int8BufferAttribute=s;var a=function(t){function e(e,r,n){return void 0===n&&(n=!1),t.call(this,new Uint8Array(e),r,n)||this}return i(e,t),e}(o.BufferAttribute);e.UInt8BufferAttribute=a;var u=function(t){function e(e,r,n){return void 0===n&&(n=!1),t.call(this,new Uint8ClampedArray(e),r,n)||this}return i(e,t),e}(o.BufferAttribute);e.UInt8ClampedBufferAttribute=u;var p=function(t){function e(e,r,n){return void 0===n&&(n=!1),t.call(this,new Int16Array(e),r,n)||this}return i(e,t),e}(o.BufferAttribute);e.Int16BufferAttribute=p;var h=function(t){function e(e,r,n){return void 0===n&&(n=!1),t.call(this,new Uint16Array(e),r,n)||this}return i(e,t),e}(o.BufferAttribute);e.UInt16BufferAttribute=h;var c=function(t){function e(e,r,n){return void 0===n&&(n=!1),t.call(this,new Int32Array(e),r,n)||this}return i(e,t),e}(o.BufferAttribute);e.Int32BufferAttribute=c;var l=function(t){function e(e,r,n){return void 0===n&&(n=!1),t.call(this,new Uint32Array(e),r,n)||this}return i(e,t),e}(o.BufferAttribute);e.UInt32BufferAttribute=l;var f=function(t){function e(e,r,n){return void 0===n&&(n=!1),t.call(this,new Float32Array(e),r,n)||this}return i(e,t),e}(o.BufferAttribute);e.Float32BufferAttribute=f;var y=function(t){function e(e,r,n){return void 0===n&&(n=!1),t.call(this,new Float64Array(e),r,n)||this}return i(e,t),e}(o.BufferAttribute);e.Float64BufferAttribute=y},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.BufferAttributeKind=void 0;var n=function(){function t(){}return t.IndicesKind="indices",t.PositionKind="position",t.NormalKind="normal",t.TangentKind="tangent",t.UVKind="uv",t.UV2Kind="uv2",t.UV3Kind="uv3",t.UV4Kind="uv4",t.UV5Kind="uv5",t.UV6Kind="uv6",t.ColorKind="color",t}();e.BufferAttributeKind=n},function(t,e,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(t,e,r,n){void 0===n&&(n=r),Object.defineProperty(t,n,{enumerable:!0,get:function(){return e[r]}})}:function(t,e,r,n){void 0===n&&(n=r),t[n]=e[r]}),i=this&&this.__exportStar||function(t,e){for(var r in t)"default"===r||e.hasOwnProperty(r)||n(e,t,r)};Object.defineProperty(e,"__esModule",{value:!0}),i(r(149),e),i(r(22),e),i(r(80),e),i(r(150),e),i(r(62),e)},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.defaultValue=void 0,e.defaultValue=function(t,e){return null==t?e:t}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.EulerOrder=void 0,function(t){t[t.XYZ=0]="XYZ",t[t.YZX=1]="YZX",t[t.ZXY=2]="ZXY",t[t.XZY=3]="XZY",t[t.YXZ=4]="YXZ",t[t.ZYX=5]="ZYX"}(e.EulerOrder||(e.EulerOrder={}))},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.CatmullRomType=void 0,function(t){t[t.Centripetal=0]="Centripetal",t[t.Chordal=1]="Chordal",t[t.Catmullrom=2]="Catmullrom"}(e.CatmullRomType||(e.CatmullRomType={}))},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.SphereSphereIntersectType=void 0,function(t){t[t.NONE=0]="NONE",t[t.POINT=1]="POINT",t[t.SPHERE=2]="SPHERE",t[t.SPHERE0_IN_SPHERE1=3]="SPHERE0_IN_SPHERE1",t[t.SPHERE0_IN_SPHERE1_POINT=4]="SPHERE0_IN_SPHERE1_POINT",t[t.SPHERE1_IN_SPHERE0=5]="SPHERE1_IN_SPHERE0",t[t.SPHERE1_IN_SPHERE0_POINT=6]="SPHERE1_IN_SPHERE0_POINT"}(e.SphereSphereIntersectType||(e.SphereSphereIntersectType={}))},function(t,e,r){"use strict";var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(e,"__esModule",{value:!0}),e.ArcCurve=void 0;var o=function(t){function e(e,r,n,i,o,s){void 0===e&&(e=0),void 0===r&&(r=0),void 0===n&&(n=1),void 0===i&&(i=0),void 0===o&&(o=2*Math.PI),void 0===s&&(s=!1);var a=t.call(this,e,r,n,n,i,o,s)||this;return a.type="ArcCurve",a}return i(e,t),e.prototype.clone=function(){return(new e).copy(this)},e.prototype.copy=function(e){return t.prototype.copy.call(this,e)},e}(r(27).EllipseCurve);e.ArcCurve=o},function(t,e,r){"use strict";var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(e,"__esModule",{value:!0}),e.CatmullRomCurve=void 0;var o=r(10),s=r(2),a=r(5),u=r(34),p=function(){function t(){this.c0=0,this.c1=0,this.c2=0,this.c3=0}return t.prototype.init=function(t,e,r,n){this.c0=t,this.c1=r,this.c2=-3*t+3*e-2*r-n,this.c3=2*t-2*e+r+n},t.prototype.initCatmullRom=function(t,e,r,n,i){this.init(e,r,i*(r-t),i*(n-e))},t.prototype.initNonuniformCatmullRom=function(t,e,r,n,i,o,s){var a=(e-t)/i-(r-t)/(i+o)+(r-e)/o,u=(r-e)/o-(n-e)/(o+s)+(n-r)/s;a*=o,u*=o,this.init(e,r,a,u)},t.prototype.calc=function(t){var e=t*t,r=e*t;return this.c0+this.c1*t+this.c2*e+this.c3*r},t}(),h=new p,c=new p,l=function(t){function e(e,r,n,i){void 0===e&&(e=[]),void 0===r&&(r=!1),void 0===n&&(n=u.CatmullRomType.Centripetal),void 0===i&&(i=.5);var o=t.call(this)||this;return o.type="CatmullRomCurve",o.points=e,o.closed=r,o.curveType=n,o.tension=i,o}return i(e,t),e.prototype.getPoint=function(t,e){void 0===e&&(e=null);var r,n,i,o,p=a.MathTmp.Vector2[0],l=null!=e?e:new s.Vector2,f=this.points,y=f.length,d=(y-(this.closed?0:1))*t,_=Math.floor(d),m=d-_;if(this.closed?_+=_>0?0:(Math.floor(Math.abs(_)/y)+1)*y:0==m&&_==y-1&&(_=y-2,m=1),this.closed||_>0?r=f[(_-1)%y]:(p.subVectors(f[0],f[1]).add(f[0]),r=p),n=f[_%y],i=f[(_+1)%y],this.closed||_+2<y?o=f[(_+2)%y]:(p.subVectors(f[y-1],f[y-2]).add(f[y-1]),o=p),this.curveType==u.CatmullRomType.Centripetal||this.curveType==u.CatmullRomType.Chordal){var g=this.curveType==u.CatmullRomType.Chordal?.5:.25,v=Math.pow(r.distanceToSquared(n),g),x=Math.pow(n.distanceToSquared(i),g),b=Math.pow(i.distanceToSquared(o),g);x<1e-4&&(x=1),v<1e-4&&(v=x),b<1e-4&&(b=x),h.initNonuniformCatmullRom(r.x,n.x,i.x,o.x,v,x,b),c.initNonuniformCatmullRom(r.y,n.y,i.y,o.y,v,x,b)}else this.curveType==u.CatmullRomType.Catmullrom&&(h.initCatmullRom(r.x,n.x,i.x,o.x,this.tension),c.initCatmullRom(r.y,n.y,i.y,o.y,this.tension));return l.set(h.calc(m),c.calc(m)),l},e.prototype.clone=function(){return(new e).copy(this)},e.prototype.copy=function(e){t.prototype.copy.call(this,e),this.points=[];for(var r=0,n=e.points.length;r<n;r++){var i=e.points[r];this.points.push(i.clone())}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this},e.prototype.toJSON=function(){var e=t.prototype.toJSON.call(this);e.points=[];for(var r=0,n=this.points.length;r<n;r++){var i=this.points[r];e.points.push(i.toArray())}return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e},e.prototype.fromJSON=function(e){t.prototype.fromJSON.call(this,e),this.points=[];for(var r=0,n=e.points.length;r<n;r++){var i=e.points[r];this.points.push((new s.Vector2).fromArray(i))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this},e.prototype.toDataBuffer=function(e){return t.prototype.toDataBuffer.call(this,e),e.writeBoolean(this.closed),e.writeInt8(this.curveType),e.writeFloat32(this.tension),e.writeUint16(this.points.length),this.points.forEach((function(t){return t.toDataBuffer(e)})),this},e.prototype.fromDataBuffer=function(e){t.prototype.fromDataBuffer.call(this,e),this.closed=e.readBoolean(),this.curveType=e.readUint8(),this.tension=e.readFloat32();for(var r=e.readUint16(),n=0;n<r;++n)this.points.push((new s.Vector2).fromDataBuffer(e));return this},e}(o.Curve);e.CatmullRomCurve=l},function(t,e,r){"use strict";var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(e,"__esModule",{value:!0}),e.CatmullRomCurve3=void 0;var o=r(10),s=r(0),a=r(5),u=r(64),p=function(){function t(){this.c0=0,this.c1=0,this.c2=0,this.c3=0}return t.prototype.init=function(t,e,r,n){this.c0=t,this.c1=r,this.c2=-3*t+3*e-2*r-n,this.c3=2*t-2*e+r+n},t.prototype.initCatmullRom=function(t,e,r,n,i){this.init(e,r,i*(r-t),i*(n-e))},t.prototype.initNonuniformCatmullRom=function(t,e,r,n,i,o,s){var a=(e-t)/i-(r-t)/(i+o)+(r-e)/o,u=(r-e)/o-(n-e)/(o+s)+(n-r)/s;a*=o,u*=o,this.init(e,r,a,u)},t.prototype.calc=function(t){var e=t*t,r=e*t;return this.c0+this.c1*t+this.c2*e+this.c3*r},t}(),h=new p,c=new p,l=new p,f=function(t){function e(e,r,n,i){void 0===e&&(e=[]),void 0===r&&(r=!1),void 0===n&&(n=u.CatmullRomType.Centripetal),void 0===i&&(i=.5);var o=t.call(this)||this;return o.type="CatmullRomCurve3",o.points=e,o.closed=r,o.curveType=n,o.tension=i,o}return i(e,t),e.prototype.getPoint=function(t,e){void 0===e&&(e=null);var r,n,i,o,p=a.MathTmp.Vector3[0],f=null!=e?e:new s.Vector3,y=this.points,d=y.length,_=(d-(this.closed?0:1))*t,m=Math.floor(_),g=_-m;if(this.closed?m+=m>0?0:(Math.floor(Math.abs(m)/d)+1)*d:0==g&&m==d-1&&(m=d-2,g=1),this.closed||m>0?r=y[(m-1)%d]:(p.subVectors(y[0],y[1]).add(y[0]),r=p),n=y[m%d],i=y[(m+1)%d],this.closed||m+2<d?o=y[(m+2)%d]:(p.subVectors(y[d-1],y[d-2]).add(y[d-1]),o=p),this.curveType==u.CatmullRomType.Centripetal||this.curveType==u.CatmullRomType.Chordal){var v=this.curveType==u.CatmullRomType.Chordal?.5:.25,x=Math.pow(r.distanceToSquared(n),v),b=Math.pow(n.distanceToSquared(i),v),S=Math.pow(i.distanceToSquared(o),v);b<1e-4&&(b=1),x<1e-4&&(x=b),S<1e-4&&(S=b),h.initNonuniformCatmullRom(r.x,n.x,i.x,o.x,x,b,S),c.initNonuniformCatmullRom(r.y,n.y,i.y,o.y,x,b,S),l.initNonuniformCatmullRom(r.z,n.z,i.z,o.z,x,b,S)}else this.curveType==u.CatmullRomType.Catmullrom&&(h.initCatmullRom(r.x,n.x,i.x,o.x,this.tension),c.initCatmullRom(r.y,n.y,i.y,o.y,this.tension),l.initCatmullRom(r.z,n.z,i.z,o.z,this.tension));return f.set(h.calc(g),c.calc(g),l.calc(g)),f},e.prototype.clone=function(){return(new e).copy(this)},e.prototype.copy=function(e){t.prototype.copy.call(this,e),this.points=[];for(var r=0,n=e.points.length;r<n;r++){var i=e.points[r];this.points.push(i.clone())}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this},e.prototype.toJSON=function(){var e=t.prototype.toJSON.call(this);e.points=[];for(var r=0,n=this.points.length;r<n;r++){var i=this.points[r];e.points.push(i.toArray())}return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e},e.prototype.fromJSON=function(e){t.prototype.fromJSON.call(this,e),this.points=[];for(var r=0,n=e.points.length;r<n;r++){var i=e.points[r];this.points.push((new s.Vector3).fromArray(i))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this},e.prototype.toDataBuffer=function(e){return t.prototype.toDataBuffer.call(this,e),e.writeBoolean(this.closed),e.writeInt8(this.curveType),e.writeFloat32(this.tension),e.writeUint16(this.points.length),this.points.forEach((function(t){return t.toDataBuffer(e)})),this},e.prototype.fromDataBuffer=function(e){t.prototype.fromDataBuffer.call(this,e),this.closed=e.readBoolean(),this.curveType=e.readUint8(),this.tension=e.readFloat32();for(var r=e.readUint16(),n=0;n<r;++n)this.points.push((new s.Vector3).fromDataBuffer(e));return this},e}(o.Curve);e.CatmullRomCurve3=f},function(t,e,r){"use strict";var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(e,"__esModule",{value:!0}),e.CubicBezierCurve3=void 0;var o=r(10),s=r(0),a=r(28),u=function(t){function e(e,r,n,i){void 0===e&&(e=null),void 0===r&&(r=null),void 0===n&&(n=null),void 0===i&&(i=null);var o=t.call(this)||this;return o.v0=new s.Vector3,o.v1=new s.Vector3,o.v2=new s.Vector3,o.v3=new s.Vector3,o.type="CubicBezierCurve3",e&&o.v0.copy(e),r&&o.v1.copy(r),n&&o.v2.copy(n),i&&o.v3.copy(i),o}return i(e,t),e.prototype.getPoint=function(t,e){void 0===e&&(e=null);var r=null!=e?e:new s.Vector3,n=this.v0,i=this.v1,o=this.v2,u=this.v3;return r.set(a.BezierCurveFunc.CubicBezier(t,n.x,i.x,o.x,u.x),a.BezierCurveFunc.CubicBezier(t,n.y,i.y,o.y,u.y),a.BezierCurveFunc.CubicBezier(t,n.z,i.z,o.z,u.z)),r},e.prototype.clone=function(){return(new e).copy(this)},e.prototype.copy=function(e){return t.prototype.copy.call(this,e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this},e.prototype.toJSON=function(){var e=t.prototype.toJSON.call(this);return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e},e.prototype.fromJSON=function(e){return t.prototype.fromJSON.call(this,e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this},e.prototype.toDataBuffer=function(e){return t.prototype.toDataBuffer.call(this,e),this.v0.toDataBuffer(e),this.v1.toDataBuffer(e),this.v2.toDataBuffer(e),this.v3.toDataBuffer(e),this},e.prototype.fromDataBuffer=function(e){return t.prototype.fromDataBuffer.call(this,e),this.v0.fromDataBuffer(e),this.v1.fromDataBuffer(e),this.v2.fromDataBuffer(e),this.v3.fromDataBuffer(e),this},e}(o.Curve);e.CubicBezierCurve3=u},function(t,e,r){"use strict";var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(e,"__esModule",{value:!0}),e.CurvePath=void 0;var o=r(10),s=r(2),a=r(0),u=r(27),p=r(38),h=r(39),c=r(49),l=r(109),f=function(t){function e(){var e=t.call(this)||this;return e.type="CurvePath",e.curves=[],e.autoClose=!1,e}return i(e,t),e.prototype.isEmpty=function(){return this.curves.length<=0},e.prototype.add=function(t){return this.curves.push(t),this},e.prototype.closePath=function(){var t=this.curves[0].getPoint(0),e=this.curves[this.curves.length-1].getPoint(1);return t.equals(e)||(t instanceof s.Vector2&&e instanceof s.Vector2?this.curves.push(new p.LineCurve(e,t)):t instanceof a.Vector3&&e instanceof a.Vector3&&this.curves.push(new c.LineCurve3(e,t))),this},e.prototype.getLength=function(){var t=this.getCurveLengths();return t[t.length-1]},e.prototype.updateArcLengths=function(){return this.needsUpdate=!0,this.cacheLengths.length=0,this.getCurveLengths()},e.prototype.getCurveLengths=function(){if(this.cacheLengths&&this.cacheLengths.length==this.curves.length)return this.cacheLengths;for(var t=[],e=0,r=0,n=this.curves.length;r<n;r++)e+=this.curves[r].getLength(),t.push(e);return this.cacheLengths=t,t},e.prototype.getSpacedPoints=function(t){void 0===t&&(t=40);for(var e=[],r=0;r<=t;r++)e.push(this.getPoint(r/t));return this.autoClose&&e.push(e[0]),e},e.prototype.getPoints=function(t){void 0===t&&(t=12);for(var e,r=[],n=0,i=this.curves;n<i.length;n++)for(var o=i[n],s=o instanceof u.EllipseCurve?2*t:o&&(o instanceof p.LineCurve||o instanceof c.LineCurve3)?1:o&&o instanceof h.SplineCurve?t*o.points.length:t,a=o.getPoints(s),l=0;l<a.length;l++){var f=a[l];e&&e.equals(f)||(r.push(f),e=f)}return this.autoClose&&r.length>1&&!r[r.length-1].equals(r[0])&&r.push(r[0]),r},e.prototype.clone=function(){return(new e).copy(this)},e.prototype.copy=function(e){t.prototype.copy.call(this,e),this.curves=[];for(var r=0,n=e.curves.length;r<n;r++){var i=e.curves[r];this.curves.push(i.clone())}return this.autoClose=e.autoClose,this},e.prototype.toJSON=function(){var e=t.prototype.toJSON.call(this);e.autoClose=this.autoClose,e.curves=[];for(var r=0,n=this.curves.length;r<n;r++){var i=this.curves[r];e.curves.push(i.toJSON())}return e},e.prototype.fromJSON=function(e){t.prototype.fromJSON.call(this,e),this.autoClose=e.autoClose,this.curves=[];for(var r=0,n=e.curves.length;r<n;r++){var i=e.curves[r],o=l.createCurve(i.type);this.curves.push(o.fromJSON(i))}return this},e.prototype.toDataBuffer=function(e){t.prototype.toDataBuffer.call(this,e),e.writeBoolean(this.autoClose),e.writeUint16(this.curves.length);for(var r=0,n=this.curves.length;r<n;r++){this.curves[r].toDataBuffer(e)}return this},e.prototype.fromDataBuffer=function(e){t.prototype.fromDataBuffer.call(this,e),this.autoClose=e.readBoolean();for(var r=e.readUint16(),n=0;n<r;++n){var i=e.readString(),o=l.createCurve(i);this.curves.push(o.fromDataBuffer(e))}return this},e}(o.Curve);e.CurvePath=f},function(t,e,r){"use strict";var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(e,"__esModule",{value:!0}),e.QuadraticBezierCurve3=void 0;var o=r(10),s=r(0),a=r(28),u=function(t){function e(e,r,n){void 0===e&&(e=null),void 0===r&&(r=null),void 0===n&&(n=null);var i=t.call(this)||this;return i.v0=new s.Vector3,i.v1=new s.Vector3,i.v2=new s.Vector3,i.type="QuadraticBezierCurve3",e&&i.v0.copy(e),r&&i.v1.copy(r),n&&i.v2.copy(n),i}return i(e,t),e.prototype.getPoint=function(t,e){void 0===e&&(e=null);var r=null!=e?e:new s.Vector3,n=this.v0,i=this.v1,o=this.v2;return r.set(a.BezierCurveFunc.QuadraticBezier(t,n.x,i.x,o.x),a.BezierCurveFunc.QuadraticBezier(t,n.y,i.y,o.y),a.BezierCurveFunc.QuadraticBezier(t,n.z,i.z,o.z)),r},e.prototype.clone=function(){return(new e).copy(this)},e.prototype.copy=function(e){return t.prototype.copy.call(this,e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this},e.prototype.toJSON=function(){var e=t.prototype.toJSON.call(this);return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e},e.prototype.fromJSON=function(e){return t.prototype.fromJSON.call(this,e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this},e.prototype.toDataBuffer=function(e){return t.prototype.toDataBuffer.call(this,e),this.v0.toDataBuffer(e),this.v1.toDataBuffer(e),this.v2.toDataBuffer(e),this},e.prototype.fromDataBuffer=function(e){return t.prototype.fromDataBuffer.call(this,e),this.v0.fromDataBuffer(e),this.v1.fromDataBuffer(e),this.v2.fromDataBuffer(e),this},e}(o.Curve);e.QuadraticBezierCurve3=u},function(t,e,r){"use strict";var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(e,"__esModule",{value:!0}),e.Shape=void 0;var o=r(51),s=r(1),a=function(t){function e(e){void 0===e&&(e=null);var r=t.call(this,e)||this;return r.uuid=s.MathUtils.generateUUID(),r.type="Shape",r.holes=[],r}return i(e,t),e.prototype.getPointsHoles=function(t){for(var e=[],r=0,n=this.holes.length;r<n;r++)e[r]=this.holes[r].getPoints(t);return e},e.prototype.extractPoints=function(t){return{shape:this.getPoints(t),holes:this.getPointsHoles(t)}},e.prototype.clone=function(){return(new e).copy(this)},e.prototype.copy=function(e){t.prototype.copy.call(this,e),this.holes=[];for(var r=0,n=e.holes.length;r<n;r++){var i=e.holes[r];this.holes.push(i.clone())}return this},e.prototype.toJSON=function(){var e=t.prototype.toJSON.call(this);e.uuid=this.uuid,e.holes=[];for(var r=0,n=this.holes.length;r<n;r++){var i=this.holes[r];e.holes.push(i.toJSON())}return e},e.prototype.fromJSON=function(e){t.prototype.fromJSON.call(this,e),this.uuid=e.uuid,this.holes=[];for(var r=0,n=e.holes.length;r<n;r++){var i=e.holes[r];this.holes.push((new o.Path).fromJSON(i))}return this},e.prototype.toDataBuffer=function(e){return t.prototype.toDataBuffer.call(this,e),e.writeUint16(this.holes.length),this.holes.forEach((function(t){t.toDataBuffer(e)})),this},e.prototype.fromDataBuffer=function(e){t.prototype.fromDataBuffer.call(this,e);for(var r=e.readUint16(),n=0;n<r;++n){var i=(new o.Path).fromDataBuffer(e);this.holes.push(i)}return this},e}(o.Path);e.Shape=a},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ShapeUtils=void 0;var n=r(52),i=function(){function t(){}return t.area=function(t){for(var e=t.length,r=0,n=e-1,i=0;i<e;n=i++)r+=t[n].x*t[i].y-t[i].x*t[n].y;return.5*r},t.isContainsPoint=function(t,e){for(var r=!1,n=0,i=t.length-1;n<t.length;i=n++)(t[n].y<=e.y&&e.y<t[i].y||t[i].y<=e.y&&e.y<t[n].y)&&e.x<(t[i].x-t[n].x)*(e.y-t[n].y)/(t[i].y-t[n].y)+t[n].x&&(r=!r);return r},t.isClockWise=function(e){return t.area(e)<0},t.triangulateArea=function(t,e){void 0===e&&(e=null);var r=new Array,i=[];if(o(t),s(r,t),e){var a=t.length;e.forEach(o);for(var u=0;u<e.length;u++)i.push(a),a+=e[u].length,s(r,e[u])}var p=n.Earcut.earcut(r,i,2);return n.Earcut.trianglesArea(r,p,2)},t.triangulateShape=function(t,e){void 0===e&&(e=null);var r=new Array,i=[],a=[];if(o(t),s(r,t),e){var u=t.length;e.forEach(o);for(var p=0;p<e.length;p++)i.push(u),u+=e[p].length,s(r,e[p])}var h=n.Earcut.earcut(r,i,2);for(p=0;p<h.length;p+=3)a.push(h.slice(p,p+3));return a},t}();function o(t){var e=t.length;e>2&&t[e-1].equals(t[0])&&t.pop()}function s(t,e){for(var r=0;r<e.length;r++)t.push(e[r].x),t.push(e[r].y)}e.ShapeUtils=i},function(t,e,r){"use strict";var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(e,"__esModule",{value:!0}),e.AbstractObject=void 0;var o=r(1),s=r(21),a=r(54),u=0,p=function(t){function e(e,r,n){var i;void 0===r&&(r=null),void 0===n&&(n="");var s=t.call(this)||this;return s._parent=null,s._children=[],s._visible=!0,s._visibleLayers=new a.VisibleLayers,s._sceneRootNodesIndex=-1,s.id=u++,s.name=n,s.uuid=o.MathUtils.generateUUID(),s._scene=e,s._parent=r,null===(i=s._parent)||void 0===i||i.add(s),s}return i(e,t),Object.defineProperty(e.prototype,"isInScene",{get:function(){return null!=this._scene},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"scene",{get:function(){return this._scene},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"children",{get:function(){return this._children},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){return this._parent},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"visibleLayers",{get:function(){return this._visibleLayers},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"visible",{get:function(){return this._visible},set:function(t){if(this._visible!=t){var e=this._visible;this._visible=t,this.onVisibleChanged(e,this._visible)}},enumerable:!1,configurable:!0}),e.prototype.dispose=function(){t.prototype.dispose.call(this),this.dispatchEvent(new s.Event("dispose"))},e.prototype.onVisibleChanged=function(t,e){},e.prototype.add=function(t){return this._children.push(t),t.onAddSelf(),this},e.prototype.remove=function(t){var e=this._children.indexOf(t);return-1!=e&&(t.onRemoveSelf(),t._parent=null,this._children.splice(e,1)),this},e.prototype.removeFromParent=function(){this._parent&&this._parent.remove(this)},e.prototype.onAddSelf=function(){},e.prototype.onRemoveSelf=function(){},e.prototype.onAddScene=function(){},e.prototype.onRemoveScene=function(){},e.prototype.getObjectById=function(t){return this.getObjectByProperty("id",t)},e.prototype.getObjectByUUID=function(t){return this.getObjectByProperty("uuid",t)},e.prototype.getObjectByName=function(t){return this.getObjectByProperty("name",t)},e.prototype.getObjectByProperty=function(t,e){if(this[t]==e)return this;for(var r=0,n=this.children.length;r<n;r++){var i=this.children[r].getObjectByProperty(t,e);if(i)return i}return null},e.prototype.traverse=function(t){t(this);for(var e=this.children,r=0,n=e.length;r<n;r++)e[r].traverse(t);return this},e.prototype.traverseVisible=function(t){if(!this._visible)return this;t(this);for(var e=this.children,r=0,n=e.length;r<n;r++)e[r].traverseVisible(t);return this},e.prototype.traverseAncestors=function(t){var e=this._parent;return null!=e&&(t(e),e.traverseAncestors(t)),this},e.prototype._addToSceneRootNodes=function(){-1==this._sceneRootNodesIndex&&(this._sceneRootNodesIndex=this._scene.rootNodes.length,this._scene.rootNodes.push(this))},e.prototype._removeFromSceneRootNodes=function(){if(-1!=this._sceneRootNodesIndex){var t=this._scene.rootNodes,e=t.length-1;t[this._sceneRootNodesIndex]=t[e],t[this._sceneRootNodesIndex]._sceneRootNodesIndex=this._sceneRootNodesIndex,this._scene.rootNodes.pop(),this._sceneRootNodesIndex=-1}},e.prototype.copy=function(t){return this},e}(s.EventDispatcher);e.AbstractObject=p},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.CSGConnector=void 0;var n=r(9),i=r(8),o=r(57),s=r(40),a=r(7),u=r(6),p=function(){function t(t,e,r){this.point=new n.CSGVector3D(t),this.axisvector=new n.CSGVector3D(e).unit(),this.normalvector=new n.CSGVector3D(r).unit()}return t.prototype.normalized=function(){var e=this.axisvector.unit(),r=this.normalvector.cross(e).unit(),n=e.cross(r);return new t(this.point,e,n)},t.prototype.transform=function(e){var r=this.point.multiply4x4(e);return new t(r,this.point.plus(this.axisvector).multiply4x4(e).minus(r),this.point.plus(this.normalvector).multiply4x4(e).minus(r))},t.prototype.getTransformationTo=function(t,e,r){e=!!e,r=r?Number(r):0;var o=this.normalized();t=t.normalized();var p=a.CSGMatrix4x4.translation(this.point.negated()),h=i.CSGPlane.anyPlaneFromVector3Ds(new n.CSGVector3D(0,0,0),o.axisvector,t.axisvector),c=new s.CSGOrthoNormalBasis(h),l=c.to2D(o.axisvector).angle(),f=c.to2D(t.axisvector).angle(),y=180*(f-l)/Math.PI;e&&(y+=180),p=(p=(p=p.multiply(c.getProjectionMatrix())).multiply(u.CSG.Matrix4x4.rotationZ(y))).multiply(c.getInverseProjectionMatrix());var d=o.transform(p),_=i.CSGPlane.fromNormalAndPoint(t.axisvector,new n.CSGVector3D(0,0,0)),m=new s.CSGOrthoNormalBasis(_);return l=m.to2D(d.normalvector).angle(),y=180*((f=m.to2D(t.normalvector).angle())-l)/Math.PI,y+=r,p=(p=(p=(p=p.multiply(m.getProjectionMatrix())).multiply(a.CSGMatrix4x4.rotationZ(y))).multiply(m.getInverseProjectionMatrix())).multiply(a.CSGMatrix4x4.translation(t.point))},t.prototype.axisLine=function(){return new o.CSGLine3D(this.point,this.axisvector)},t.prototype.extend=function(e){return new t(this.point.plus(this.axisvector.unit().times(e)),this.axisvector,this.normalvector)},t.prototype.mirrored=function(t){return this.transform(a.CSGMatrix4x4.mirroring(t))},t.prototype.mirroredX=function(){var t=new i.CSGPlane(n.CSGVector3D.Create(1,0,0),0);return this.mirrored(t)},t.prototype.mirroredY=function(){var t=new i.CSGPlane(n.CSGVector3D.Create(0,1,0),0);return this.mirrored(t)},t.prototype.mirroredZ=function(){var t=new i.CSGPlane(n.CSGVector3D.Create(0,0,1),0);return this.mirrored(t)},t.prototype.translate=function(t){return this.transform(a.CSGMatrix4x4.translation(t))},t.prototype.scale=function(t){return this.transform(a.CSGMatrix4x4.scaling(t))},t.prototype.rotateX=function(t){return this.transform(a.CSGMatrix4x4.rotationX(t))},t.prototype.rotateY=function(t){return this.transform(a.CSGMatrix4x4.rotationY(t))},t.prototype.rotateZ=function(t){return this.transform(a.CSGMatrix4x4.rotationZ(t))},t.prototype.rotate=function(t,e,r){return this.transform(a.CSGMatrix4x4.rotation(t,e,r))},t.prototype.rotateEulerAngles=function(t,e,r,i){i=i||[0,0,0];var o=a.CSGMatrix4x4.rotationZ(t),s=a.CSGMatrix4x4.rotationX(e),u=a.CSGMatrix4x4.rotationZ(r),p=a.CSGMatrix4x4.translation(new n.CSGVector3D(i));return this.transform(u.multiply(s).multiply(o).multiply(p))},t}();e.CSGConnector=p},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.CSGLine2D=void 0;var n=r(14),i=r(6),o=r(7),s=r(8),a=r(9),u=function(){function t(t,e){var r=e.toString();t=new n.CSGVector2D(t),e=parseFloat(r);var i=t.length();e*=i,t=t.times(1/i),this.normal=t,this.w=e}return t.fromPoints=function(e,r){var i=new n.CSGVector2D(e),o=new n.CSGVector2D(r).minus(i).normal().negated().unit();return new t(o,i.dot(o))},t.prototype.reverse=function(){return new t(this.normal.negated(),-this.w)},t.prototype.equals=function(t){return t.normal.equals(this.normal)&&t.w==this.w},t.prototype.origin=function(){return this.normal.times(this.w)},t.prototype.direction=function(){return this.normal.normal()},t.prototype.xAtY=function(t){return(this.w-this.normal._y*t)/this.normal.x},t.prototype.absDistanceToPoint=function(t){var e=(t=new n.CSGVector2D(t)).dot(this.normal);return Math.abs(e-this.w)},t.prototype.intersectWithLine=function(t){var e=i.CSG.solve2Linear(this.normal.x,this.normal.y,t.normal.x,t.normal.y,this.w,t.w);return new n.CSGVector2D(e)},t.prototype.transform=function(e){var r=new n.CSGVector2D(0,0),i=this.normal.times(this.w),o=r.multiply4x4(e),s=this.normal.multiply4x4(e).minus(o),a=i.multiply4x4(e),u=s.dot(a);return new t(s,u)},t.prototype.mirrored=function(t){return this.transform(o.CSGMatrix4x4.mirroring(t))},t.prototype.mirroredX=function(){var t=new s.CSGPlane(a.CSGVector3D.Create(1,0,0),0);return this.mirrored(t)},t.prototype.mirroredY=function(){var t=new s.CSGPlane(a.CSGVector3D.Create(0,1,0),0);return this.mirrored(t)},t.prototype.mirroredZ=function(){var t=new s.CSGPlane(a.CSGVector3D.Create(0,0,1),0);return this.mirrored(t)},t.prototype.translate=function(t){return this.transform(o.CSGMatrix4x4.translation(t))},t.prototype.scale=function(t){return this.transform(o.CSGMatrix4x4.scaling(t))},t.prototype.rotateX=function(t){return this.transform(o.CSGMatrix4x4.rotationX(t))},t.prototype.rotateY=function(t){return this.transform(o.CSGMatrix4x4.rotationY(t))},t.prototype.rotateZ=function(t){return this.transform(o.CSGMatrix4x4.rotationZ(t))},t.prototype.rotate=function(t,e,r){return this.transform(o.CSGMatrix4x4.rotation(t,e,r))},t.prototype.rotateEulerAngles=function(t,e,r,n){n=n||[0,0,0];var i=o.CSGMatrix4x4.rotationZ(t),s=o.CSGMatrix4x4.rotationX(e),u=o.CSGMatrix4x4.rotationZ(r),p=o.CSGMatrix4x4.translation(new a.CSGVector3D(n));return this.transform(u.multiply(s).multiply(i).multiply(p))},t}();e.CSGLine2D=u},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.CSGFuzzyFactory=void 0;var n=function(){function t(t,e){this.lookuptable={},this.multiplier=1/e}return t.prototype.lookupOrCreate=function(t,e){var r="",n=this.multiplier;if(t.forEach((function(t){var e=Math.round(t*n);r+=e+"/"})),r in this.lookuptable)return this.lookuptable[r];for(var i=e(t),o=t.map((function(t){var e=Math.floor(t*n);return[e+"/",e+1+"/"]})),s=1<<t.length,a=function(t){var e=t;r="",o.forEach((function(t){r+=t[1&e],e>>=1})),u.lookuptable[r]=i},u=this,p=0;p<s;++p)a(p);return i},t}();e.CSGFuzzyFactory=n},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.CSGPolygonShared=void 0;var n=r(6),i=function(){function t(t){if(null!=t&&4!=t.length)throw new Error("Expecting 4 element array");this.color=t}return t.fromColor=function(e){var r;if(1==arguments.length)r=arguments[0].slice();else{r=[];for(var n=0;n<arguments.length;n++)r.push(arguments[n])}if(3==r.length)r.push(1);else if(4!=r.length)throw new Error("setColor expects either an array with 3 or 4 elements, or 3 or 4 parameters.");return new t(r)},t.fromObject=function(e){return new t(e.color)},t.prototype.getTag=function(){var t=this.tag;return t||(t=n.CSG.getTag(),this.tag=t),t},t.prototype.getHash=function(){return this.color?this.color.join("/"):"null"},t}();e.CSGPolygonShared=i},function(t,e,r){"use strict";var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(e,"__esModule",{value:!0}),e.TextureCube=void 0;var o=function(t){function e(e,r,n,i,o,s,a){void 0===e&&(e=null),void 0===r&&(r=!1),void 0===n&&(n=!1),void 0===i&&(i=!0);var u=t.call(this)||this;return u.buffers=[],u.deleteBuffer=!1,u.deleteBuffer=r,u.generateMipmaps=n,o&&(u.format=o),u._flipY=i,s&&(u._wrapU=s),a&&(u._wrapV=a),e&&e.length>0&&(u.buffers=e,u.width=e[0].width,u.height=e[0].height,u.unpackAlignment=u.width%4!=0?1:4),u}return i(e,t),Object.defineProperty(e.prototype,"isReady",{get:function(){return this.buffers.length>0&&this.buffers[0].width>0&&this.buffers[0].height>0},enumerable:!1,configurable:!0}),e.prototype.updateBuffer=function(t){this.buffers=t,this.width=t[0].width,this.height=t[0].height,this.unpackAlignment=this.width%4!=0?1:4,this.needsUpdate=!0},e.prototype.updateMipmaps=function(t){this.mipmaps=t,this.needsUpdate=!0},e.prototype.clone=function(){return new e(this.buffers,this.deleteBuffer).copy(this)},e.prototype.copy=function(e){return t.prototype.copy.call(this,e),this},e.prototype.dispose=function(){var e=this;t.prototype.dispose.call(this),this.deleteBuffer&&(this.buffers.forEach((function(t,r){delete e.buffers[r]})),this.buffers.length=0)},e}(r(23).Texture);e.TextureCube=o},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.DataTypeFormat=void 0;var n=r(11),i=function(){function t(){}return t.dataTypeFromTypedArray=function(t){switch(ArrayBuffer.isView(t)?t.constructor:t){case Float64Array:return n.Constants.DoubleType;case Float32Array:return n.Constants.FloatType;case Uint16Array:return n.Constants.UnsignedShortType;case Uint32Array:return n.Constants.UnsignedIntType;case Uint8Array:case Uint8ClampedArray:return n.Constants.UnsignedByteType;case Int8Array:return n.Constants.ByteType;case Int16Array:return n.Constants.ShortType;case Int32Array:return n.Constants.IntType;default:return 0}},t.typedArrayFromDataType=function(t){switch(t){case n.Constants.DoubleType:return Float64Array;case n.Constants.FloatType:return Float32Array;case n.Constants.UnsignedShortType:case n.Constants.UnsignedShort565Type:case n.Constants.UnsignedShort4444Type:case n.Constants.UnsignedShort5551Type:return Uint16Array;case n.Constants.UnsignedIntType:return Uint32Array;case n.Constants.UnsignedByteType:return Uint8Array;case n.Constants.ByteType:return Int8Array;case n.Constants.ShortType:return Int16Array;case n.Constants.IntType:return Int32Array;default:return null}},t.createTypedArrayFromDataType=function(t,e){switch(t){case n.GLConstants.BYTE:return new Int8Array(e);case n.GLConstants.UNSIGNED_BYTE:return new Uint8Array(e);case n.GLConstants.SHORT:return new Int16Array(e);case n.GLConstants.UNSIGNED_SHORT:return new Uint16Array(e);case n.GLConstants.INT:return new Int32Array(e);case n.GLConstants.UNSIGNED_INT:return new Uint32Array(e);case n.GLConstants.FLOAT:return new Float32Array(e);case n.GLConstants.DOUBLE:return new Float64Array(e);default:return null}},t.createTypedArrayFromDataTypeValues=function(t,e){switch(t){case n.GLConstants.BYTE:return new Int8Array(e);case n.GLConstants.UNSIGNED_BYTE:return new Uint8Array(e);case n.GLConstants.SHORT:return new Int16Array(e);case n.GLConstants.UNSIGNED_SHORT:return new Uint16Array(e);case n.GLConstants.INT:return new Int32Array(e);case n.GLConstants.UNSIGNED_INT:return new Uint32Array(e);case n.GLConstants.FLOAT:return new Float32Array(e);case n.GLConstants.DOUBLE:return new Float64Array(e);default:return null}},t.glDataTypeFromName=function(t){switch(t){case"BYTE":return n.GLConstants.BYTE;case"UNSIGNED_BYTE":return n.GLConstants.UNSIGNED_BYTE;case"SHORT":return n.GLConstants.SHORT;case"UNSIGNED_SHORT":return n.GLConstants.UNSIGNED_SHORT;case"INT":return n.GLConstants.INT;case"UNSIGNED_INT":return n.GLConstants.UNSIGNED_INT;case"FLOAT":return n.GLConstants.FLOAT;case"DOUBLE":return n.GLConstants.DOUBLE;default:throw 0}},t.glDataTypeInBytes=function(t){switch(t){case n.GLConstants.BYTE:return Int8Array.BYTES_PER_ELEMENT;case n.GLConstants.UNSIGNED_BYTE:return Uint8Array.BYTES_PER_ELEMENT;case n.GLConstants.SHORT:return Int16Array.BYTES_PER_ELEMENT;case n.GLConstants.UNSIGNED_SHORT:return Uint16Array.BYTES_PER_ELEMENT;case n.GLConstants.INT:return Int32Array.BYTES_PER_ELEMENT;case n.GLConstants.UNSIGNED_INT:return Uint32Array.BYTES_PER_ELEMENT;case n.GLConstants.FLOAT:return Float32Array.BYTES_PER_ELEMENT;case n.GLConstants.DOUBLE:return Float64Array.BYTES_PER_ELEMENT;default:return 0}},t.validateGLDataType=function(t){return t==n.GLConstants.BYTE||t==n.GLConstants.UNSIGNED_BYTE||t==n.GLConstants.SHORT||t==n.GLConstants.UNSIGNED_SHORT||t==n.GLConstants.INT||t==n.GLConstants.UNSIGNED_INT||t==n.GLConstants.FLOAT||t==n.GLConstants.DOUBLE},t.createTypedArrayFromGLDataType=function(t,e){switch(t){case n.GLConstants.BYTE:return new Int8Array(e);case n.GLConstants.UNSIGNED_BYTE:return new Uint8Array(e);case n.GLConstants.SHORT:return new Int16Array(e);case n.GLConstants.UNSIGNED_SHORT:return new Uint16Array(e);case n.GLConstants.INT:return new Int32Array(e);case n.GLConstants.UNSIGNED_INT:return new Uint32Array(e);case n.GLConstants.FLOAT:return new Float32Array(e);case n.GLConstants.DOUBLE:return new Float64Array(e);default:return null}},t.createArrayBufferFromGLDataType=function(e,r,i,o){switch(void 0===i&&(i=null),void 0===o&&(o=null),null==i&&(i=0),null==o&&(o=(r.byteLength-i)/t.glDataTypeInBytes(e)),e){case n.GLConstants.BYTE:return new Int8Array(r,i,o);case n.GLConstants.UNSIGNED_BYTE:return new Uint8Array(r,i,o);case n.GLConstants.SHORT:return new Int16Array(r,i,o);case n.GLConstants.UNSIGNED_SHORT:return new Uint16Array(r,i,o);case n.GLConstants.INT:return new Int32Array(r,i,o);case n.GLConstants.UNSIGNED_INT:return new Uint32Array(r,i,o);case n.GLConstants.FLOAT:return new Float32Array(r,i,o);case n.GLConstants.DOUBLE:return new Float64Array(r,i,o);default:return null}},t}();e.DataTypeFormat=i},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.InterleavedBuffer=void 0;var n=r(4),i=r(11),o=r(61),s=function(){function t(t,e){this.uuid=n.MathUtils.generateUUID(),this.array=t,this.stride=e,this.count=t.length/e,this.type=o.DataTypeFormat.dataTypeFromTypedArray(t),this.target=i.Constants.ArrayBufferTarget,this.usage=i.Constants.StaticDrawUsage,this.updateRange={offset:0,count:-1},this._version=0,this._reference=0,this._glBuffer=null}return Object.defineProperty(t.prototype,"glBuffer",{get:function(){return this._glBuffer},set:function(t){this._glBuffer!=t&&(this._glBuffer&&this._glBuffer.dispose(),this._glBuffer=t,this._glBuffer&&this._glBuffer.addReference())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"version",{get:function(){return this._version},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"reference",{get:function(){return this._reference},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"needsUpdate",{set:function(t){t&&this._version++},enumerable:!1,configurable:!0}),t.prototype.dispose=function(){this._reference--,0==this._reference&&this._glBuffer&&(this._glBuffer.dispose(),this._glBuffer=null)},t.prototype.addReference=function(){this._reference++},t.prototype.setArray=function(t){return this.array=t,this.count=this.array.length/this.stride,this},t.prototype.setUsage=function(t){return this.usage=t,this},t.prototype.clone=function(e){var r=e.cacheKey.get(this.array);r||(r=n.MathUtils.generateUUID(),e.cacheKey.set(this.array,r));var i=e.arrayBuffers[r];return i||(i=this.array.slice(0).buffer,e.arrayBuffers[r]=i),new t(o.DataTypeFormat.createTypedArrayFromDataTypeValues(this.type,i),this.stride).setUsage(this.usage),this},t.prototype.copy=function(t){return this.usage=t.usage,this},t.prototype.copyAt=function(t,e,r){t*=this.stride,r*=e.stride;for(var n=0,i=this.stride;n<i;n++)this.array[t+n]=e.array[r+n];return this},t.prototype.set=function(t,e){return void 0===e&&(e=0),this.array.set(t,e),this},t}();e.InterleavedBuffer=s},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.InterleavedBufferAttribute=void 0;var n=r(4),i=new n.Vector3,o=new n.Vector2,s=function(){function t(t,e,r,n){void 0===n&&(n=!1),this.buffer=t,this.itemSize=e,this.offset=r,this.normalized=n}return Object.defineProperty(t.prototype,"glBuffer",{get:function(){return this.buffer.glBuffer},set:function(t){this.buffer.glBuffer=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"target",{get:function(){return this.buffer.target},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"usage",{get:function(){return this.buffer.usage},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"updateRange",{get:function(){return this.buffer.updateRange},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"version",{get:function(){return this.buffer.version},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"count",{get:function(){return this.buffer.count},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"array",{get:function(){return this.buffer.array},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"needsUpdate",{set:function(t){t&&(this.buffer.needsUpdate=t)},enumerable:!1,configurable:!0}),t.prototype.dispose=function(){this.buffer.dispose()},t.prototype.addReference=function(){this.buffer.addReference()},t.prototype.clone=function(e){var r=e.interleavedBuffers[this.buffer.uuid];return r||(r=this.buffer.clone(e),e.interleavedBuffers[this.buffer.uuid]=r),new t(r,this.itemSize,this.offset,this.normalized)},t.prototype.copy=function(t){return this.buffer=t.buffer,this.itemSize=t.itemSize,this.offset=t.offset,this.normalized=t.normalized,this},t.prototype.applyMatrix3=function(t){if(2==this.itemSize)for(var e=0,r=this.count;e<r;e++)o.fromBufferAttribute(this,e),o.applyMatrix3(t),this.setXY(e,o.x,o.y);else if(3==this.itemSize)for(e=0,r=this.count;e<r;e++)i.fromBufferAttribute(this,e),i.applyMatrix3(t),this.setXYZ(e,i.x,i.y,i.z);return this},t.prototype.applyMatrix4=function(t){if(3==this.itemSize)for(var e=0,r=this.count;e<r;e++)i.fromBufferAttribute(this,e),i.applyMatrix4(t),this.setXYZ(e,i.x,i.y,i.z);return this},t.prototype.applyNormalMatrix=function(t){if(3==this.itemSize)for(var e=0,r=this.count;e<r;e++)i.fromBufferAttribute(this,e),i.applyNormalMatrix(t),this.setXYZ(e,i.x,i.y,i.z);return this},t.prototype.transformDirection=function(t){if(3==this.itemSize)for(var e=0,r=this.count;e<r;e++)i.fromBufferAttribute(this,e),t.transformVector3(i,i),this.setXYZ(e,i.x,i.y,i.z);return this},t.prototype.transformPoint=function(t){if(3==this.itemSize)for(var e=0,r=this.count;e<r;e++)i.fromBufferAttribute(this,e),t.transformPoint(i,i),this.setXYZ(e,i.x,i.y,i.z);return this},t.prototype.get=function(t){return this.array[t]},t.prototype.set=function(t,e){return void 0===e&&(e=0),this.array.set(t,e),this},t.prototype.getX=function(t){return this.array[t*this.itemSize]},t.prototype.setX=function(t,e){return this.array[t*this.itemSize]=e,this},t.prototype.getY=function(t){return this.array[t*this.itemSize+1]},t.prototype.setY=function(t,e){return this.array[t*this.itemSize+1]=e,this},t.prototype.getZ=function(t){return this.array[t*this.itemSize+2]},t.prototype.setZ=function(t,e){return this.array[t*this.itemSize+2]=e,this},t.prototype.getW=function(t){return this.array[t*this.itemSize+3]},t.prototype.setW=function(t,e){return this.array[t*this.itemSize+3]=e,this},t.prototype.setXY=function(t,e,r){return t*=this.itemSize,this.array[t+0]=e,this.array[t+1]=r,this},t.prototype.setXYZ=function(t,e,r,n){return t*=this.itemSize,this.array[t+0]=e,this.array[t+1]=r,this.array[t+2]=n,this},t.prototype.setXYZW=function(t,e,r,n,i){return t*=this.itemSize,this.array[t+0]=e,this.array[t+1]=r,this.array[t+2]=n,this.array[t+3]=i,this},t}();e.InterleavedBufferAttribute=s},function(t,e,r){"use strict";var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(e,"__esModule",{value:!0}),e.MeshBasicMaterial=void 0;var o=r(3),s=r(4),a=r(11),u=function(t){function e(){var e=t.call(this)||this;return e._color=new s.ColorRGB,e._map=null,e._lightMap=null,e._lightMapIntensity=1,e._aoMap=null,e._aoMapIntensity=1,e._specularMap=null,e._alphaMap=null,e._envMap=null,e._combine=a.Constants.MultiplyOperation,e._reflectivity=1,e._refractionRatio=.98,e._wireframe=!1,e._wireframeLineWidth=1,e._wireframeLineCap="round",e._wireframeLineJoin="round",e._skinning=!1,e._morphTargets=!1,e}return i(e,t),Object.defineProperty(e.prototype,"color",{get:function(){return this._color},set:function(t){this._color.equals(t)||(this._color.copy(t),this.needsUpdate=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"map",{get:function(){return this._map},set:function(t){this._map!=t&&(this._map&&this._map.dispose(),this._map=t,this._map&&this._map.addReference(),this.needsUpdate=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"lightMap",{get:function(){return this._lightMap},set:function(t){this._lightMap!=t&&(this._lightMap&&this._lightMap.dispose(),this._lightMap=t,this._lightMap&&this._lightMap.addReference(),this.needsUpdate=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"lightMapIntensity",{get:function(){return this._lightMapIntensity},set:function(t){this._lightMapIntensity!=t&&(this._lightMapIntensity=t,this.needsUpdate=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"aoMap",{get:function(){return this._aoMap},set:function(t){this._aoMap!=t&&(this._aoMap&&this._aoMap.dispose(),this._aoMap=t,this._aoMap&&this._aoMap.addReference(),this.needsUpdate=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"aoMapIntensity",{get:function(){return this._aoMapIntensity},set:function(t){this._aoMapIntensity!=t&&(this._aoMapIntensity=t,this.needsUpdate=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"specularMap",{get:function(){return this._specularMap},set:function(t){this._specularMap!=t&&(this._specularMap&&this._specularMap.dispose(),this._specularMap=t,this._specularMap&&this._specularMap.addReference(),this.needsUpdate=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"alphaMap",{get:function(){return this._alphaMap},set:function(t){this._alphaMap!=t&&(this._alphaMap&&this._alphaMap.dispose(),this._alphaMap=t,this._alphaMap&&this._alphaMap.addReference(),this.needsUpdate=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"envMap",{get:function(){return this._envMap},set:function(t){this._envMap!=t&&(this._envMap&&this._envMap.dispose(),this._envMap=t,this._envMap&&this._envMap.addReference(),this.needsUpdate=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"combine",{get:function(){return this._combine},set:function(t){this._combine!=t&&(this._combine=t,this.needsUpdate=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"reflectivity",{get:function(){return this._reflectivity},set:function(t){this._reflectivity!=t&&(this._reflectivity=t,this.needsUpdate=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"refractionRatio",{get:function(){return this._refractionRatio},set:function(t){this._refractionRatio!=t&&(this._refractionRatio=t,this.needsUpdate=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"wireframe",{get:function(){return this._wireframe},set:function(t){this._wireframe!=t&&(this._wireframe=t,this.needsUpdate=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"wireframeLineWidth",{get:function(){return this._wireframeLineWidth},set:function(t){this._wireframeLineWidth!=t&&(this._wireframeLineWidth=t,this.needsUpdate=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"wireframeLineCap",{get:function(){return this._wireframeLineCap},set:function(t){this._wireframeLineCap!=t&&(this._wireframeLineCap=t,this.needsUpdate=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"wireframeLineJoin",{get:function(){return this._wireframeLineJoin},set:function(t){this._wireframeLineJoin!=t&&(this._wireframeLineJoin=t,this.needsUpdate=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"skinning",{get:function(){return this._skinning},set:function(t){this._skinning!=t&&(this._skinning=t,this.needsUpdate=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"morphTargets",{get:function(){return this._morphTargets},set:function(t){this._morphTargets!=t&&(this._morphTargets=t,this.needsUpdate=!0)},enumerable:!1,configurable:!0}),e.prototype.clone=function(){return(new e).copy(this)},e.prototype.copy=function(e){return t.prototype.copy.call(this,e),this._color.copy(e.color),this._map=e.map,this._lightMap=e.lightMap,this._lightMapIntensity=e.lightMapIntensity,this._aoMap=e.aoMap,this._aoMapIntensity=e.aoMapIntensity,this._specularMap=e.specularMap,this._alphaMap=e.alphaMap,this._envMap=e.envMap,this._combine=e.combine,this._reflectivity=e.reflectivity,this._refractionRatio=e.refractionRatio,this._wireframe=e.wireframe,this._wireframeLineWidth=e.wireframeLineWidth,this._wireframeLineCap=e.wireframeLineCap,this._wireframeLineJoin=e.wireframeLineJoin,this._skinning=e.skinning,this._morphTargets=e.morphTargets,this},e}(o.Material);e.MeshBasicMaterial=u},function(t,e,r){"use strict";var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(e,"__esModule",{value:!0}),e.Renderable=void 0;var o=r(24),s=r(54),a=function(t){function e(e,r,n){void 0===r&&(r=null),void 0===n&&(n="");var i=t.call(this,e,r,n,!1)||this;return i._classifyID=0,i._castShadow=!1,i._receiveShadow=!1,i._frustumCulled=!0,i._renderOrder=0,i._pickable=!0,i._lightLayers=new s.VisibleLayers,i._lightSources=new Array,i._renderingGroup=null,i._distanceToCamera=0,i._renderingGroupId=0,i}return i(e,t),Object.defineProperty(e.prototype,"lightLayers",{get:function(){return this._lightLayers},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"lightSources",{get:function(){return this._lightSources},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"renderingGroupId",{get:function(){return this._renderingGroupId},set:function(t){this._renderingGroupId=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"classifyID",{get:function(){return this._classifyID},set:function(t){if(this._classifyID!=t){var e=this._classifyID;this._classifyID=t,this.onClassifyIDChanged(e,this._classifyID)}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"castShadow",{get:function(){return this._castShadow},set:function(t){if(this._castShadow!=t){var e=this._castShadow;this._castShadow=t,this.onCastShadowChanged(e,this._castShadow)}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"receiveShadow",{get:function(){return this._receiveShadow},set:function(t){if(this._receiveShadow!=t){var e=this._receiveShadow;this._receiveShadow=t,this.onReceiveShadowChanged(e,this._receiveShadow)}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"frustumCulled",{get:function(){return this._frustumCulled},set:function(t){if(this._frustumCulled!=t){var e=this._frustumCulled;this._frustumCulled=t,this.onFrustumCulledChanged(e,this._frustumCulled)}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"renderOrder",{get:function(){return this._renderOrder},set:function(t){if(this._renderOrder!=t){var e=this._renderOrder;this._renderOrder=t,this.onRenderOrderChanged(e,this._renderOrder)}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"pickable",{get:function(){return this._pickable},set:function(t){if(this._pickable!=t){var e=this._pickable;this._pickable=t,this.onPickableChanged(e,this._pickable)}},enumerable:!1,configurable:!0}),e.prototype.onClassifyIDChanged=function(t,e){},e.prototype.onCastShadowChanged=function(t,e){},e.prototype.onReceiveShadowChanged=function(t,e){},e.prototype.onFrustumCulledChanged=function(t,e){},e.prototype.onRenderOrderChanged=function(t,e){},e.prototype.onPickableChanged=function(t,e){},e.prototype._resyncLightSources=function(){this._lightSources.length=0;for(var t=0,e=this.getScene().lights;t<e.length;t++){var r=e[t];r.visible&&(r.canAffectMesh(this)&&this._lightSources.push(r))}},e.prototype._resyncLightSource=function(t){var e=t.visible&&t.canAffectMesh(this),r=this._lightSources.indexOf(t);if(-1==r){if(!e)return;this._lightSources.push(t)}else{if(e)return;!0,this._lightSources.splice(r,1)}},e.prototype._removeLightSource=function(t,e){var r=this._lightSources.indexOf(t);-1!=r&&this._lightSources.splice(r,1)},e.prototype.render=function(t){return this},e}(o.TransformObject);e.Renderable=a},function(t,e,r){"use strict";var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(e,"__esModule",{value:!0}),e.Mesh=void 0;var o=r(84),s=r(32),a=r(83),u=function(t){function e(e,r,n,i,o){void 0===r&&(r=null),void 0===n&&(n=""),void 0===i&&(i=new s.Geometry),void 0===o&&(o=new a.MeshBasicMaterial);var u=t.call(this,e,r,n)||this;return u.geometry=i,u.material=o,u.scene.addMesh(u),u}return i(e,t),e.prototype.dispose=function(){t.prototype.dispose.call(this),this._geometry.dispose(),this._material.dispose()},Object.defineProperty(e.prototype,"material",{get:function(){return this._material},set:function(t){this._material!=t&&(this._material.dispose(),this._material=t,this._material.addReference())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"geometry",{get:function(){return this._geometry},set:function(t){this._geometry!=t&&(this._geometry.dispose(),this._geometry=t,this._geometry.addReference())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"boundingSphere",{get:function(){return this._geometry.boundingSphere||this._geometry.computeBoundingSphere(),this._geometry.boundingSphere},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"boundingBox",{get:function(){return this._geometry.boundingBox||this._geometry.computeBoundingBox(),this._geometry.boundingBox},enumerable:!1,configurable:!0}),e.prototype.clone=function(){return new e(this._scene,this._parent).copy(this)},e.prototype.copy=function(t){return this},e.prototype.render=function(t){return this},e}(o.Renderable);e.Mesh=u},function(t,e,r){"use strict";var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(e,"__esModule",{value:!0}),e.SmartArrayNoDuplicate=e.SmartArray=void 0;var o=function(){function t(e){this.length=0,this.data=new Array(e),this._id=t._GlobalId++}return t.prototype.push=function(t){this.data[this.length++]=t,this.length>this.data.length&&(this.data.length*=2)},t.prototype.forEach=function(t){for(var e=0;e<this.length;e++)t(this.data[e])},t.prototype.sort=function(t){this.data.sort(t)},t.prototype.reset=function(){this.length=0},t.prototype.dispose=function(){this.reset(),this.data&&(this.data.length=0,this.data=[])},t.prototype.concat=function(t){if(0!=t.length){this.length+t.length>this.data.length&&(this.data.length=2*(this.length+t.length));for(var e=0;e<t.length;e++)this.data[this.length++]=(t.data||t)[e]}},t.prototype.indexOf=function(t){var e=this.data.indexOf(t);return e>=this.length?-1:e},t.prototype.contains=function(t){return-1!=this.indexOf(t)},t._GlobalId=0,t}();e.SmartArray=o;var s=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._duplicateId=0,e}return i(e,t),e.prototype.push=function(e){t.prototype.push.call(this,e),e.__smartArrayFlags||(e.__smartArrayFlags={}),e.__smartArrayFlags[this._id]=this._duplicateId},e.prototype.pushNoDuplicate=function(t){return(!t.__smartArrayFlags||t.__smartArrayFlags[this._id]!=this._duplicateId)&&(this.push(t),!0)},e.prototype.reset=function(){t.prototype.reset.call(this),this._duplicateId++},e.prototype.concatWithNoDuplicate=function(t){if(0!=t.length){this.length+t.length>this.data.length&&(this.data.length=2*(this.length+t.length));for(var e=0;e<t.length;e++){var r=(t.data||t)[e];this.pushNoDuplicate(r)}}},e}(o);e.SmartArrayNoDuplicate=s},function(t,e,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(t,e,r,n){void 0===n&&(n=r),Object.defineProperty(t,n,{enumerable:!0,get:function(){return e[r]}})}:function(t,e,r,n){void 0===n&&(n=r),t[n]=e[r]}),i=this&&this.__exportStar||function(t,e){for(var r in t)"default"===r||e.hasOwnProperty(r)||n(e,t,r)};Object.defineProperty(e,"__esModule",{value:!0}),i(r(88),e),i(r(89),e),i(r(92),e),i(r(118),e),i(r(11),e),i(r(34),e),i(r(21),e),i(r(152),e),i(r(52),e),i(r(162),e),i(r(169),e),i(r(4),e),i(r(61),e),i(r(187),e)},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0})},function(t,e,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(t,e,r,n){void 0===n&&(n=r),Object.defineProperty(t,n,{enumerable:!0,get:function(){return e[r]}})}:function(t,e,r,n){void 0===n&&(n=r),t[n]=e[r]}),i=this&&this.__exportStar||function(t,e){for(var r in t)"default"===r||e.hasOwnProperty(r)||n(e,t,r)};Object.defineProperty(e,"__esModule",{value:!0}),i(r(90),e),i(r(91),e)},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.AnimationBlendMode=void 0;var n=function(){function t(){}return t.NormalAnimationBlendMode=2500,t.AdditiveAnimationBlendMode=2501,t}();e.AnimationBlendMode=n},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.AnimationLoopMode=void 0;var n=function(){function t(){}return t.LoopOnce=2200,t.LoopRepeat=2201,t.LoopPingPong=2202,t}();e.AnimationLoopMode=n},function(t,e,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(t,e,r,n){void 0===n&&(n=r),Object.defineProperty(t,n,{enumerable:!0,get:function(){return e[r]}})}:function(t,e,r,n){void 0===n&&(n=r),t[n]=e[r]}),i=this&&this.__exportStar||function(t,e){for(var r in t)"default"===r||e.hasOwnProperty(r)||n(e,t,r)};Object.defineProperty(e,"__esModule",{value:!0}),i(r(41),e),i(r(116),e),i(r(117),e)},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0})},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0})},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Cylindrical=void 0;var n=function(){function t(t,e,r){void 0===t&&(t=1),void 0===e&&(e=0),void 0===r&&(r=0),this.radius=t,this.theta=e,this.y=r}return t.prototype.set=function(t,e,r){return this.radius=t,this.theta=e,this.y=r,this},t.prototype.setFromCartesianCoords=function(t,e,r){return this.radius=Math.sqrt(t*t+r*r),this.theta=Math.atan2(t,r),this.y=e,this},t.prototype.setFromVector3=function(t){return this.setFromCartesianCoords(t.x,t.y,t.z)},t.prototype.clone=function(){return(new t).copy(this)},t.prototype.copy=function(t){return this.radius=t.radius,this.theta=t.theta,this.y=t.y,this},t}();e.Cylindrical=n},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Ellipsoid=void 0;var n=function(){};e.Ellipsoid=n},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Frustum=void 0;var n=r(45),i=r(20),o=new(r(0).Vector3),s=new i.Sphere,a=function(){function t(t,e,r,i,o,s){void 0===t&&(t=null),void 0===e&&(e=null),void 0===r&&(r=null),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),this._p=[new n.Plane,new n.Plane,new n.Plane,new n.Plane,new n.Plane,new n.Plane],this._planeData=[],t&&this._p[0].copy(t),e&&this._p[1].copy(e),r&&this._p[2].copy(r),i&&this._p[3].copy(i),o&&this._p[4].copy(o),s&&this._p[5].copy(s),this._updateArrayPlaneData()}return Object.defineProperty(t.prototype,"planes",{get:function(){return this._p},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"planeData",{get:function(){return this._planeData},enumerable:!1,configurable:!0}),t.prototype.set=function(t,e,r,n,i,o){return this._p[0].copy(t),this._p[1].copy(e),this._p[2].copy(r),this._p[3].copy(n),this._p[4].copy(i),this._p[5].copy(o),this._updateArrayPlaneData(),this},t.prototype.setFromProjectionMatrix=function(t){var e=this.planes,r=t.elements,n=r[0],i=r[1],o=r[2],s=r[3],a=r[4],u=r[5],p=r[6],h=r[7],c=r[8],l=r[9],f=r[10],y=r[11],d=r[12],_=r[13],m=r[14],g=r[15];return e[0].setFromXYZW(s-n,h-a,y-c,g-d).normalize(),e[1].setFromXYZW(s+n,h+a,y+c,g+d).normalize(),e[2].setFromXYZW(s+i,h+u,y+l,g+_).normalize(),e[3].setFromXYZW(s-i,h-u,y-l,g-_).normalize(),e[4].setFromXYZW(s-o,h-p,y-f,g-m).normalize(),e[5].setFromXYZW(s+o,h+p,y+f,g+m).normalize(),this._updateArrayPlaneData(),this},t.prototype.clone=function(){return(new t).copy(this)},t.prototype.copy=function(t){for(var e=this.planes,r=0;r<6;r++)e[r].copy(t.planes[r]);return this._updateArrayPlaneData(),this},t.prototype.intersectsObject=function(t){return s.copy(t.boundingSphere).applyMatrix4(t.matrixWorld),this.intersectsSphere(s)},t.prototype.intersectsSphere=function(t,e){void 0===e&&(e=null);for(var r=this.planes,n=t.center,i=-t.radius,o=0,s=0;s<6;s++){var a=r[s].distanceToPoint(n);if(a<i)return!1;e&&(e.planes.push({index:s,distance:a}),a>=t.radius&&o++)}return e&&(e.fullVisible=6==o),!0},t.prototype.intersectsBox=function(t,e){void 0===e&&(e=null),t.getBoundingSphere(s);for(var r=this.planes,n=0,i=0;i<6;i++){var a=r[i];o.x=a.normal.x>0?t.max.x:t.min.x,o.y=a.normal.y>0?t.max.y:t.min.y,o.z=a.normal.z>0?t.max.z:t.min.z;var u=a.distanceToPoint(o);if(u<0)return!1;e&&(e.planes.push({index:i,distance:u}),u>=s.radius&&n++)}return e&&(e.fullVisible=6==n),!0},t.prototype._updateArrayPlaneData=function(){this._planeData.length=0;for(var t=this.planes,e=0;e<6;e++)this._planeData.push(t[e].normal.x,t[e].normal.x,t[e].normal.x,t[e].constant)},t}();e.Frustum=a},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.HeadingPitchRang=void 0;var n=r(1),i=function(){function t(t,e,r){void 0===t&&(t=0),void 0===e&&(e=0),void 0===r&&(r=0),this.heading=t,this.pitch=e,this.range=r}return t.prototype.copy=function(t){return this.heading=t.heading,this.pitch=t.pitch,this.range=t.range,this},t.prototype.clone=function(){return new t(this.heading,this.pitch,this.range)},t.prototype.equals=function(t){return this.heading==t.heading&&this.pitch==t.pitch&&this.range==t.range},t.prototype.equalsEpsilon=function(t,e,r){return n.MathUtils.equalsEpsilon(this.heading,t.heading,e,r)&&n.MathUtils.equalsEpsilon(this.pitch,t.pitch,e,r)&&n.MathUtils.equalsEpsilon(this.range,t.range,e,r)},t}();e.HeadingPitchRang=i},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.HeadingPitchRoll=void 0;var n=r(1),i=function(){function t(t,e,r){void 0===t&&(t=0),void 0===e&&(e=0),void 0===r&&(r=0),this.heading=t,this.pitch=e,this.roll=r}return t.prototype.setFromDegrees=function(t,e,r){return this.heading=n.MathUtils.degToRad(t),this.pitch=n.MathUtils.degToRad(e),this.roll=n.MathUtils.degToRad(r),this},t.prototype.setFromQuaternion=function(t){var e=2*(t.w*t.z-t.y*t.x),r=1-2*(t.x*t.x+t.z*t.z),i=2*(t.w*t.x+t.z*t.y),o=1-2*(t.z*t.z+t.y*t.y),s=2*(t.w*t.y+t.x*t.z);return this.heading=-Math.atan2(s,o),this.roll=Math.atan2(i,r),this.pitch=-n.MathUtils.asinClamped(e),this},t.prototype.copy=function(t){return this.heading=t.heading,this.pitch=t.pitch,this.roll=t.roll,this},t.prototype.clone=function(){return new t(this.heading,this.pitch,this.roll)},t.prototype.equals=function(t){return this.heading==t.heading&&this.pitch==t.pitch&&this.roll==t.roll},t.prototype.equalsEpsilon=function(t,e,r){return n.MathUtils.equalsEpsilon(this.heading,t.heading,e,r)&&n.MathUtils.equalsEpsilon(this.pitch,t.pitch,e,r)&&n.MathUtils.equalsEpsilon(this.roll,t.roll,e,r)},t}();e.HeadingPitchRoll=i},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.LineSegment2=void 0;var n,i,o,s,a,u,p,h,c,l,f,y,d,_=r(1),m=r(2),g=r(47),v=r(19),x=new m.Vector2,b=new m.Vector2,S=new m.Vector2,T=new m.Vector2,C=new m.Vector2,E=(new m.Vector2,function(){function t(t,e){void 0===t&&(t=null),void 0===e&&(e=null),this._p=[new m.Vector2,new m.Vector2],t&&this._p[0].copy(t),e&&this._p[1].copy(e)}return Object.defineProperty(t.prototype,"p",{get:function(){return this._p},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"start",{get:function(){return this._p[0]},set:function(t){this._p[0].copy(t)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"end",{get:function(){return this._p[1]},set:function(t){this._p[1].copy(t)},enumerable:!1,configurable:!0}),t.prototype.set=function(t,e){return this.start.copy(t),this.end.copy(e),this},t.prototype.clone=function(){return(new t).copy(this)},t.prototype.copy=function(t){return this.start.copy(t.start),this.end.copy(t.end),this},t.prototype.getCenter=function(t){return void 0===t&&(t=new m.Vector2),t.addVectors(this.start,this.end).multiplyScalar(.5)},t.prototype.delta=function(t){return void 0===t&&(t=new m.Vector2),t.subVectors(this.end,this.start)},t.prototype.distanceSq=function(){return this.start.distanceToSquared(this.end)},t.prototype.distance=function(){return this.start.distanceTo(this.end)},t.prototype.at=function(t,e){return void 0===e&&(e=new m.Vector2),this.delta(e).multiplyScalar(t).add(this.start)},t.prototype.closestPointToPointParameter=function(t,e){void 0===e&&(e=!1),x.subVectors(t,this.start),b.subVectors(this.end,this.start);var r=b.dot(b),n=b.dot(x)/r;return e&&(n=_.MathUtils.clamp(n,0,1)),n},t.prototype.closestPointToPoint=function(t,e,r){void 0===e&&(e=!1),void 0===r&&(r=new m.Vector2);var n=this.closestPointToPointParameter(t,e);return this.delta(r).multiplyScalar(n).add(this.start)},t.prototype.setCenteredForm=function(t,e,r){return this._p[0].copy(e).multiplyScalar(r).subVectors(t,this._p[0]),this._p[1].copy(e).multiplyScalar(r).add(t),this},t.prototype.getCenteredForm=function(t,e){t.addVectors(this._p[0],this._p[1]).multiplyScalar(.5),e.subVectors(this._p[1],this._p[0]);var r=.5*e.length();return e.normalize(),r},t.prototype.distanceSqToPoint=function(t,e,r){void 0===e&&(e=null),void 0===r&&(r=null);var n,i=x.subVectors(this.p[1],this.p[0]),o=b.subVectors(t,this.p[1]),s=i.dot(o),a=0;if(s>=0)a=1,n=this.p[1];else if(o.subVectors(t,this.p[0]),(s=i.dot(o))<=0)a=0,n=this.p[0];else{var u=i.dot(i);u>0?(a=s/=u,n=S.copy(i).multiplyScalar(s).add(this.p[0])):(a=0,n=this.p[0])}return e&&e.copy(n),r&&(r.segmentParameter=a),o.subVectors(t,n),o.dot(o)},t.prototype.distanceToPoint=function(t,e,r){return void 0===e&&(e=null),void 0===r&&(r=null),Math.sqrt(this.distanceSqToPoint(t,e,r))},t.prototype.distanceSqToSegment=function(t,e,r,_){void 0===e&&(e=null),void 0===r&&(r=null),void 0===_&&(_=null);var m=this.start,g=this.end,v=t.start,E=t.end,w=x.subVectors(g,m),P=b.subVectors(E,v),A=S.subVectors(m,v);n=w.dot(w),i=w.dot(P),o=P.dot(P),s=w.dot(A),a=P.dot(A),h=(u=s)-i,c=(p=u+n)-i,y=(l=-a)+o,d=(f=l-i)+o;var O=[0,0];if(n>0&&o>0){var R=[0,0];R[0]=M(n,u,p),R[1]=M(n,h,c);for(var B=[0,0],I=0;I<2;++I)R[I]<=0?B[I]=-1:R[I]>=1?B[I]=1:B[I]=0;if(-1==B[0]&&-1==B[1])O[0]=0,O[1]=M(o,l,y);else if(1==B[0]&&1==B[1])O[0]=1,O[1]=M(o,f,d);else{var N=[0,0],F=[[0,0],[0,0]];!function(t,e,r,n){e[0]<0?(r[0]=0,n[0][0]=0,n[0][1]=u/i,(n[0][1]<0||n[0][1]>1)&&(n[0][1]=.5),0==e[1]?(r[1]=3,n[1][0]=t[1],n[1][1]=1):(r[1]=1,n[1][0]=1,n[1][1]=p/i,(n[1][1]<0||n[1][1]>1)&&(n[1][1]=.5))):0==e[0]?(r[0]=2,n[0][0]=t[0],n[0][1]=0,e[1]<0?(r[1]=0,n[1][0]=0,n[1][1]=u/i,(n[1][1]<0||n[1][1]>1)&&(n[1][1]=.5)):0==e[1]?(r[1]=3,n[1][0]=t[1],n[1][1]=1):(r[1]=1,n[1][0]=1,n[1][1]=p/i,(n[1][1]<0||n[1][1]>1)&&(n[1][1]=.5))):(r[0]=1,n[0][0]=1,n[0][1]=p/i,(n[0][1]<0||n[0][1]>1)&&(n[0][1]=.5),0==e[1]?(r[1]=3,n[1][0]=t[1],n[1][1]=1):(r[1]=0,n[1][0]=0,n[1][1]=u/i,(n[1][1]<0||n[1][1]>1)&&(n[1][1]=.5)))}(R,B,N,F),function(t,e,r){var n=e[1][1]-e[0][1],s=n*(-i*e[0][0]+o*e[0][1]-a);if(s>=0)0==t[0]?(r[0]=0,r[1]=M(o,l,y)):1==t[0]?(r[0]=1,r[1]=M(o,f,d)):(r[0]=e[0][0],r[1]=e[0][1]);else{var u=n*(-i*e[1][0]+o*e[1][1]-a);if(u<=0)0==t[1]?(r[0]=0,r[1]=M(o,l,y)):1==t[1]?(r[0]=1,r[1]=M(o,f,d)):(r[0]=e[1][0],r[1]=e[1][1]);else{var p=Math.min(Math.max(s/(s-u),0),1),h=1-p;r[0]=h*e[0][0]+p*e[1][0],r[1]=h*e[0][1]+p*e[1][1]}}}(N,F,O)}}else n>0?(O[0]=M(n,u,p),O[1]=0):o>0?(O[0]=0,O[1]=M(o,l,y)):(O[0]=0,O[1]=0);T.addVectors(x.copy(m).multiplyScalar(1-O[0]),b.copy(g).multiplyScalar(O[0])),C.addVectors(x.copy(v).multiplyScalar(1-O[1]),b.copy(E).multiplyScalar(O[1])),e&&e.copy(T),r&&r.copy(C),_&&(_.parameter=O);var G=S.subVectors(T,C);return G.dot(G)},t.prototype.distanceToSegment=function(t,e,r,n){return void 0===e&&(e=null),void 0===r&&(r=null),void 0===n&&(n=null),Math.sqrt(this.distanceSqToSegment(t,e,r,n))},t.prototype.intersectsBox=function(e){var r=x,n=b;e.getCenter(r),e.getExtent(n);var i=new t(S.subVectors(this.p[0],r),T.subVectors(this.p[1],r)),o=S,s=T,a=i.getCenteredForm(o,s);return t.intersectsBox(o,s,a,n)},t.intersectsBox=function(t,e,r,n){for(var i=0;i<2;++i){if(Math.abs(t.p[i])>n.p[i]+r*Math.abs(e.p[i]))return!1}return g.Line2.intersectsBox(t,e,n)},t.prototype.intersectBox=function(e){var r=x,n=b;e.getCenter(r),e.getExtent(n);var i=new t(S.subVectors(this.p[0],r),T.subVectors(this.p[1],r)),o=S,s=T,a=i.getCenteredForm(o,s),u={intersect:!1,numIntersections:0,parameter:new Array(2),point:new Array(2),cdeParameter:new Array(2)};t.intersectBox(o,s,a,n,u);for(var p=0;p<u.numIntersections;++p)u.point[p]=(new m.Vector2).copy(s).multiplyScalar(u.parameter[p]).add(o).add(r),u.cdeParameter[p]=u.parameter[p],u.parameter[p]=.5*(u.parameter[p]/a+1);return u},t.intersectBox=function(t,e,r,n,i){if(g.Line2.intersectBox(t,e,n,i),i.intersect){var o=[-r,r],s=v.Intervals.staticQuery(i.parameter,o);i.intersect=s.intersect,i.numIntersections=s.numIntersections,i.parameter=s.overlap}},t.prototype.intersectsSegment=function(t){var e=t,r=x,n=b,i=S,o=T,s=this.getCenteredForm(r,n),a=e.getCenteredForm(i,o),u=new g.Line2(r,n),p=new g.Line2(i,o),h=u.intersectLine(p);if(1==h.numIntersections)return Math.abs(h.line0Parameter[0])<=s&&Math.abs(h.line1Parameter[0])<=a;if(h.numIntersections==1/0){var c=C.subVectors(i,r),l=n.dot(c),f=[-s,s],y=[l-a,l+a];return v.Intervals.staticQuery(f,y).intersect}return!1},t.prototype.intersectSegment=function(t){var e={intersect:!1,numIntersections:0,segment0Parameter:new Array(2),segment1Parameter:new Array(2),point:new Array(2)},r=t,n=x,i=b,o=S,s=T,a=this.getCenteredForm(n,i),u=r.getCenteredForm(o,s),p=new g.Line2(n,i),h=new g.Line2(o,s),c=p.intersectLine(h);if(1==c.numIntersections)Math.abs(c.line0Parameter[0])<=a&&Math.abs(c.line1Parameter[0])<=u?(e.intersect=!0,e.numIntersections=1,e.segment0Parameter[0]=c.line0Parameter[0],e.segment1Parameter[0]=c.line1Parameter[0],e.point[0]=c.point):(e.intersect=!1,e.numIntersections=0);else if(c.numIntersections==1/0){var l=C.subVectors(o,n),f=i.dot(l),y=[-a,a],d=[f-u,f+u],_=v.Intervals.staticQuery(y,d);if(_.intersect){e.intersect=!0,e.numIntersections=_.numIntersections;for(var E=0;E<_.numIntersections;++E)e.segment0Parameter[E]=_.overlap[E],e.segment1Parameter[E]=_.overlap[E]-f,e.point[E]=(new m.Vector2).copy(i).multiplyScalar(e.segment0Parameter[E]).add(n)}else e.intersect=!1,e.numIntersections=0}else e.intersect=!1,e.numIntersections=0;return e},t.prototype.equals=function(t){return t.start.equals(this.start)&&t.end.equals(this.end)},t}());function M(t,e,r){var n;return e<0?r>0?(n=-e/t)>1&&(n=.5):n=1:n=0,n}e.LineSegment2=E},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Matrix2D=void 0;var n=r(1),i=r(2),o=function(){function t(t){void 0===t&&(t=[]),this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,t.length>0&&this.fromArray(t)}return Object.defineProperty(t,"identity",{get:function(){return t._identityReadOnly},enumerable:!1,configurable:!0}),Object.defineProperty(t,"IDENTITY",{get:function(){return t._identityReadOnly},enumerable:!1,configurable:!0}),t.prototype.setValues=function(t,e,r,n,i,o){return this.a=null==t?1:t,this.b=e||0,this.c=r||0,this.d=null==n?1:n,this.tx=i||0,this.ty=o||0,this},t.prototype.append=function(t,e,r,n,i,o){var s=this.a,a=this.b,u=this.c,p=this.d;return 1==t&&0==e&&0==r&&1==n||(this.a=s*t+u*e,this.b=a*t+p*e,this.c=s*r+u*n,this.d=a*r+p*n),this.tx=s*i+u*o+this.tx,this.ty=a*i+p*o+this.ty,this},t.prototype.prepend=function(t,e,r,n,i,o){var s=this.a,a=this.c,u=this.tx;return this.a=t*s+r*this.b,this.b=e*s+n*this.b,this.c=t*a+r*this.d,this.d=e*a+n*this.d,this.tx=t*u+r*this.ty+i,this.ty=e*u+n*this.ty+o,this},t.prototype.getComponent=function(t){switch(t){case 0:return this.a;case 1:return this.b;case 2:return this.c;case 3:return this.d;case 4:return this.tx;case 5:return this.ty;default:return 0}},t.prototype.setComponent=function(t,e){switch(t){case 0:this.a=e;break;case 1:this.b=e;break;case 2:this.c=e;break;case 3:this.d=e;break;case 4:this.tx=e;break;case 5:this.ty=e}return this},t.prototype.appendMatrix=function(t){return this.append(t.a,t.b,t.c,t.d,t.tx,t.ty)},t.prototype.prependMatrix=function(t){return this.prepend(t.a,t.b,t.c,t.d,t.tx,t.ty)},t.prototype.appendTransform=function(t,e,r,i,o,s,a,u,p){var h,c;if(o%360){var l=o*n.MathUtils.DEG2RAD;h=Math.cos(l),c=Math.sin(l)}else h=1,c=0;return s||a?(s*=n.MathUtils.DEG2RAD,a*=n.MathUtils.DEG2RAD,this.append(Math.cos(a),Math.sin(a),-Math.sin(s),Math.cos(s),t,e),this.append(h*r,c*r,-c*i,h*i,0,0)):this.append(h*r,c*r,-c*i,h*i,t,e),(u||p)&&(this.tx-=u*this.a+p*this.c,this.ty-=u*this.b+p*this.d),this},t.prototype.prependTransform=function(t,e,r,i,o,s,a,u,p){var h,c;if(o%360){var l=o*n.MathUtils.DEG2RAD;h=Math.cos(l),c=Math.sin(l)}else h=1,c=0;return(u||p)&&(this.tx-=u,this.ty-=p),s||a?(s*=n.MathUtils.DEG2RAD,a*=n.MathUtils.DEG2RAD,this.prepend(h*r,c*r,-c*i,h*i,0,0),this.prepend(Math.cos(a),Math.sin(a),-Math.sin(s),Math.cos(s),t,e)):this.prepend(h*r,c*r,-c*i,h*i,t,e),this},t.prototype.rotate=function(t){t*=n.MathUtils.DEG2RAD;var e=Math.cos(t),r=Math.sin(t),i=this.a,o=this.b;return this.a=i*e+this.c*r,this.b=o*e+this.d*r,this.c=-i*r+this.c*e,this.d=-o*r+this.d*e,this},t.prototype.skew=function(t,e){return t*=n.MathUtils.DEG2RAD,e*=n.MathUtils.DEG2RAD,this.append(Math.cos(e),Math.sin(e),-Math.sin(t),Math.cos(t),0,0),this},t.prototype.scale=function(t,e){return this.a*=t,this.b*=t,this.c*=e,this.d*=e,this},t.prototype.translate=function(t,e){return this.tx+=this.a*t+this.c*e,this.ty+=this.b*t+this.d*e,this},t.prototype.identity=function(){return this.a=this.d=1,this.b=this.c=this.tx=this.ty=0,this},t.prototype.invert=function(){var t=this.a,e=this.b,r=this.c,n=this.d,i=this.tx,o=t*n-e*r;return this.a=n/o,this.b=-e/o,this.c=-r/o,this.d=t/o,this.tx=(r*this.ty-n*i)/o,this.ty=-(t*this.ty-e*i)/o,this},t.prototype.isIdentity=function(){return 0==this.tx&&0==this.ty&&1==this.a&&0==this.b&&0==this.c&&1==this.d},t.prototype.applyXY=function(t,e,r){return void 0===r&&(r=new i.Vector2),r.x=this.a*t+this.c*e+this.tx,r.y=this.b*t+this.d*e+this.ty,r},t.prototype.apply=function(t,e){void 0===e&&(e=new i.Vector2);var r=t.x,n=t.y;return e.x=this.a*r+this.c*n+this.tx,e.y=this.b*r+this.d*n+this.ty,e},t.prototype.applyInverseXY=function(t,e,r){void 0===r&&(r=new i.Vector2);var n=1/(this.a*this.d+this.c*-this.b);return r.x=this.d*n*t+-this.c*n*e+(this.ty*this.c-this.tx*this.d)*n,r.y=this.a*n*e+-this.b*n*t+(-this.ty*this.a+this.tx*this.b)*n,r},t.prototype.applyInverse=function(t,e){void 0===e&&(e=new i.Vector2);var r=1/(this.a*this.d+this.c*-this.b),n=t.x,o=t.y;return e.x=this.d*r*n+-this.c*r*o+(this.ty*this.c-this.tx*this.d)*r,e.y=this.a*r*o+-this.b*r*n+(-this.ty*this.a+this.tx*this.b)*r,e},t.prototype.equals=function(t){return this.tx==t.tx&&this.ty==t.ty&&this.a==t.a&&this.b==t.b&&this.c==t.c&&this.d==t.d},t.prototype.decompose=function(t){void 0===t&&(t={x:0,y:0,scaleX:0,scaleY:0,skewX:0,skewY:0,rotation:0}),t.x=this.tx,t.y=this.ty,t.scaleX=Math.sqrt(this.a*this.a+this.b*this.b),t.scaleY=Math.sqrt(this.c*this.c+this.d*this.d),t.rotation=0;var e=Math.atan2(-this.c,this.d),r=Math.atan2(this.b,this.a);return Math.abs(1-e/r)<1e-5?(t.rotation=r/n.MathUtils.DEG2RAD,this.a<0&&this.d>=0&&(t.rotation+=t.rotation<=0?180:-180),t.skewX=t.skewY=0):(t.skewX=e/n.MathUtils.DEG2RAD,t.skewY=r/n.MathUtils.DEG2RAD),t},t.prototype.copy=function(t){return this.setValues(t.a,t.b,t.c,t.d,t.tx,t.ty)},t.prototype.clone=function(){return new t([this.a,this.b,this.c,this.d,this.tx,this.ty])},t.prototype.fromArray=function(t,e){return void 0===e&&(e=0),this.a=t[e],this.b=t[1+e],this.c=t[2+e],this.d=t[3+e],this.tx=t[4+e],this.ty=t[5+e],this},t.prototype.toArray=function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this.a,t[e+1]=this.b,t[e+2]=this.c,t[e+3]=this.d,t[e+4]=this.tx,t[e+5]=this.ty,t},t._identityReadOnly=new t,t}();e.Matrix2D=o},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.OBB=void 0;var n=r(18),i=r(0),o=r(2),s=r(20),a=r(25),u=r(35),p=r(43),h=new i.Vector3,c=new i.Vector3,l=new i.Vector3,f=new i.Vector3,y=new i.Vector3,d=new u.Quaternion,_=new u.Quaternion,m=new u.Quaternion,g=new n.Matrix3,v=new Array(3),x=new Array(3),b=function(){function t(t,e,r){void 0===t&&(t=null),void 0===e&&(e=null),void 0===r&&(r=null),this.matrix3=new n.Matrix3,this.center=new i.Vector3,this.extent=new i.Vector3,t&&this.center.copy(t),e&&this.matrix3.copy(e);var o=this.matrix3.getX(),s=this.matrix3.getY(),a=this.matrix3.getZ();r?this.extent.copy(r):this.extent.set(o.length(),s.length(),a.length()),this.axis=[o.normalize(),s.normalize(),a.normalize()]}return t.prototype.clone=function(){return(new t).copy(this)},t.prototype.copy=function(t){return this.matrix3.copy(t.matrix3),this.center.copy(t.center),this.extent.copy(t.extent),this.axis[0].copy(t.axis[0]),this.axis[1].copy(t.axis[1]),this.axis[2].copy(t.axis[2]),this},t.prototype.set=function(t,e,r){this.matrix3.copy(e),this.center.copy(t);var n=this.matrix3.getX(),i=this.matrix3.getY(),o=this.matrix3.getZ();return r?this.extent.copy(r):this.extent.set(n.length(),i.length(),o.length()),this.axis=[n.normalize(),i.normalize(),o.normalize()],this},t.prototype.makeEmpty=function(){return this.matrix3.identity(),this.center.set(0,0,0),this.extent.set(0,0,0),this.axis.forEach((function(t){return t.set(0,0,0)})),this},t.prototype.getCenter=function(t){return void 0===t&&(t=new i.Vector3),t.copy(this.center),t},t.prototype.getExtent=function(t){return void 0===t&&(t=new i.Vector3),t.copy(this.extent),t},t.prototype.getBoundingSphere=function(t){void 0===t&&(t=new s.Sphere);var e=this.matrix3,r=e.getColumn(0),n=e.getColumn(1),i=e.getColumn(2);return r.add(n),r.add(i),t.center=this.center.clone(),t.radius=r.length(),t},t.prototype.getBoundingBox=function(t){return void 0===t&&(t=new a.Box3),t.setFromCenterAndSize(this.center,this.extent)},t.prototype.axisProjectionMinMax=function(t,e){void 0===e&&(e=new o.Vector2);var r=t.dot(this.center),n=Math.abs(this.extent.x*t.dot(this.axis[0]))+Math.abs(this.extent.y*t.dot(this.axis[1]))+Math.abs(this.extent.z*t.dot(this.axis[2]));return e.x=r-n,e.y=r+n,e},t.prototype.union=function(t){var e=h.copy(this.center).add(t.center).multiplyScalar(.5),r=[],o=[],s=new n.Matrix3,a=new n.Matrix3;s.setColumn(0,this.axis[0]),s.setColumn(1,this.axis[1]),s.setColumn(2,this.axis[2]),a.setColumn(0,t.axis[0]),a.setColumn(1,t.axis[1]),a.setColumn(2,t.axis[2]);var u=d.setFromRotationMatrix(s),p=_.setFromRotationMatrix(a);u.dot(p)<0&&p.inverse();var f=m.addQuaternions(u,p);f.normalize();for(var y=g.makeRotationFromQuaternion(f),v=0;v<3;++v)r[v]=y.getColumn(v);var x=[],b=[0,0,0],S=[0,0,0];this._getPoints(x);for(var T=0;T<8;++T){var C=c.subVectors(x[T],e);for(v=0;v<3;++v){(E=C.dot(r[v]))>S[v]?S[v]=E:E<b[v]&&(b[v]=E)}}t._getPoints(x);for(T=0;T<8;++T)for(C=(new i.Vector3).subVectors(x[T],e),v=0;v<3;++v){var E;(E=C.dot(r[v]))>S[v]?S[v]=E:E<b[v]&&(b[v]=E)}for(v=0;v<3;++v)e.add(l.copy(r[v]).multiplyScalar(.5*(S[v]+b[v]))),o[v]=.5*(S[v]-b[v]);return this.axis=r,this.center.copy(e),this.extent.set(o[0],o[1],o[2]),this},t.prototype.containsPoint=function(t){for(var e=h.copy(t).sub(this.center),r=0;r<3;++r){var n=e.dot(this.axis[r]);if(Math.abs(n)>this.extent.p[r])return!1}return!0},t.prototype.distanceSqToPoint=function(t,e){void 0===e&&(e=null);for(var r=this.extent,n=h.subVectors(t,this.center),i=c,o=0;o<3;++o)i.p[o]=n.dot(this.axis[o]);var s=0;for(o=0;o<3;++o){if(i.p[o]<-r.p[o])s+=(a=i.p[o]+r.p[o])*a,i.p[o]=-r.p[o];else if(i.p[o]>r.p[o]){var a;s+=(a=i.p[o]-r.p[o])*a,i.p[o]=r.p[o]}}if(e){e.copy(this.center);for(o=0;o<3;++o)e.add(l.copy(this.axis[o]).multiplyScalar(i.p[o]))}return s},t.prototype.distanceToPoint=function(t,e){return void 0===e&&(e=null),Math.sqrt(this.distanceSqToPoint(t,e))},t.prototype.distanceSqToOBB=function(t,e,r,n){void 0===e&&(e=null),void 0===r&&(r=null),void 0===n&&(n=null);for(var i=t,o=h.subVectors(i.center,this.center),s=0;s<3;++s)o.add(c.copy(this.axis[s]).multiplyScalar(this.extent.p[s])),o.sub(l.copy(i.axis[s]).multiplyScalar(i.extent.p[s]));var a=c,u=l;for(s=0;s<3;++s)a.p[s]=this.axis[s].dot(o),u.p[s]=i.axis[s].dot(o);for(var d=[[],[],[]],_=0;_<3;++_)for(var m=0;m<3;++m)d[_][m]=this.axis[_].dot(i.axis[m]);var g=f.copy(this.extent).multiplyScalar(2),v=y.copy(i.extent).multiplyScalar(2),x=[-a.x,-a.y,-a.z,u.x,u.y,u.z,g.x,g.y,g.z,v.x,v.y,v.z],b=-1,S=[[1,0,0,-d[0][0],-d[0][1],-d[0][2],1,0,0,0,0,0],[0,1,0,-d[1][0],-d[1][1],-d[1][2],0,1,0,0,0,0],[0,0,1,-d[2][0],-d[2][1],-d[2][2],0,0,1,0,0,0],[-d[0][0],-d[1][0],-d[2][0],1,0,0,0,0,0,1,0,0],[-d[0][1],-d[1][1],-d[2][1],0,1,0,0,0,0,0,1,0],[-d[0][2],-d[1][2],-d[2][2],0,0,1,0,0,0,0,0,1],[b,0,0,0,0,0,0,0,0,0,0,0],[0,b,0,0,0,0,0,0,0,0,0,0],[0,0,b,0,0,0,0,0,0,0,0,0],[0,0,0,b,0,0,0,0,0,0,0,0],[0,0,0,0,b,0,0,0,0,0,0,0],[0,0,0,0,0,b,0,0,0,0,0,0]],T=new Array(12),C=new Array(12),E=new p.LCPSolver(12);if(E.solve(x,S,T,C)){n&&(n.queryIsSuccessful=!0,n.numLCPIterations=E.getNumIterations()),h.copy(this.center);for(s=0;s<3;++s){var M=C[s]-this.extent.p[s];n&&(n.box0Parameter[s]=M),h.add(l.copy(this.axis[s]).multiplyScalar(M))}c.copy(i.center);s=0;for(var w=3;s<3;++s,++w){M=C[w]-i.extent.p[s];n&&(n.box1Parameter[s]=M),c.add(l.copy(i.axis[s]).multiplyScalar(M))}e&&e.copy(h),r&&r.copy(c);var P=l.subVectors(c,h);return P.dot(P)}return n&&(n.queryIsSuccessful=!1,n.numLCPIterations=0),NaN},t.prototype.distanceToOBB=function(t,e,r,n){return void 0===e&&(e=null),void 0===r&&(r=null),void 0===n&&(n=null),Math.sqrt(this.distanceSqToOBB(t,e,r,n))},t.prototype.intersectsOBB=function(t){for(var e,r,n=this.center,i=this.axis,o=this.extent.toArray(v),s=t.center,a=t.axis,u=t.extent.toArray(x),p=!1,c=h.subVectors(s,n),l=[[],[],[]],f=[[],[],[]],y=[],d=0;d<3;++d)l[0][d]=i[0].dot(a[d]),f[0][d]=Math.abs(l[0][d]),f[0][d]>1&&(p=!0);if(y[0]=c.dot(i[0]),r=Math.abs(y[0]),e=u[0]*f[0][0]+u[1]*f[0][1]+u[2]*f[0][2],r>o[0]+e)return!1;for(d=0;d<3;++d)l[1][d]=i[1].dot(a[d]),f[1][d]=Math.abs(l[1][d]),f[1][d]>1&&(p=!0);if(y[1]=c.dot(i[1]),r=Math.abs(y[1]),e=u[0]*f[1][0]+u[1]*f[1][1]+u[2]*f[1][2],r>o[1]+e)return!1;for(d=0;d<3;++d)l[2][d]=i[2].dot(a[d]),f[2][d]=Math.abs(l[2][d]),f[2][d]>1&&(p=!0);return y[2]=c.dot(i[2]),r=Math.abs(y[2]),e=u[0]*f[2][0]+u[1]*f[2][1]+u[2]*f[2][2],!(r>o[2]+e)&&(!((r=Math.abs(c.dot(a[0])))>o[0]*f[0][0]+o[1]*f[1][0]+o[2]*f[2][0]+u[0])&&(!((r=Math.abs(c.dot(a[1])))>o[0]*f[0][1]+o[1]*f[1][1]+o[2]*f[2][1]+u[1])&&(!((r=Math.abs(c.dot(a[2])))>o[0]*f[0][2]+o[1]*f[1][2]+o[2]*f[2][2]+u[2])&&(!!p||!((r=Math.abs(y[2]*l[1][0]-y[1]*l[2][0]))>o[1]*f[2][0]+o[2]*f[1][0]+(e=u[1]*f[0][2]+u[2]*f[0][1]))&&(!((r=Math.abs(y[2]*l[1][1]-y[1]*l[2][1]))>o[1]*f[2][1]+o[2]*f[1][1]+(e=u[0]*f[0][2]+u[2]*f[0][0]))&&(!((r=Math.abs(y[2]*l[1][2]-y[1]*l[2][2]))>o[1]*f[2][2]+o[2]*f[1][2]+(e=u[0]*f[0][1]+u[1]*f[0][0]))&&(!((r=Math.abs(y[0]*l[2][0]-y[2]*l[0][0]))>o[0]*f[2][0]+o[2]*f[0][0]+(e=u[1]*f[1][2]+u[2]*f[1][1]))&&(!((r=Math.abs(y[0]*l[2][1]-y[2]*l[0][1]))>o[0]*f[2][1]+o[2]*f[0][1]+(e=u[0]*f[1][2]+u[2]*f[1][0]))&&(!((r=Math.abs(y[0]*l[2][2]-y[2]*l[0][2]))>o[0]*f[2][2]+o[2]*f[0][2]+(e=u[0]*f[1][1]+u[1]*f[1][0]))&&(!((r=Math.abs(y[1]*l[0][0]-y[0]*l[1][0]))>o[0]*f[1][0]+o[1]*f[0][0]+(e=u[1]*f[2][2]+u[2]*f[2][1]))&&(!((r=Math.abs(y[1]*l[0][1]-y[0]*l[1][1]))>o[0]*f[1][1]+o[1]*f[0][1]+(e=u[0]*f[2][2]+u[2]*f[2][0]))&&!((r=Math.abs(y[1]*l[0][2]-y[0]*l[1][2]))>o[0]*f[1][2]+o[1]*f[0][2]+(e=u[0]*f[2][1]+u[1]*f[2][0])))))))))))))},t.prototype.intersectsSphere=function(t){return this.distanceToPoint(t.center)<=t.radius},t.prototype._getPoints=function(t){void 0===t&&(t=[]);for(var e=[h,c,l],r=0;r<3;++r)e[r].copy(this.axis[r]).multiplyScalar(this.extent.p[r]);for(var n=0;n<8;++n){t[n]=this.center.clone();r=0;for(var i=1;r<3;++r,i<<=1){var o=n&i?1:-1;t[n].add(f.copy(e[r]).multiplyScalar(o))}}return t},t.prototype.equals=function(t){for(var e=!0,r=0;r<3;++r)this.axis[r].equals(t.axis[r])||(e=!1);return e&&this.center.equals(t.center)&&this.extent.equals(t.extent)},t}();e.OBB=b},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Polygon=void 0;var n=r(36),i=function(){function t(t){void 0===t&&(t=null),this.polygon=t?t.slice(0):[]}return t.prototype.set=function(t){return this.polygon=t.slice(0),this},t.prototype.setFromVector2=function(t){this.polygon=[];for(var e=0;e<t.length;++e)this.polygon.push(t[e].x,t[e].y);return this},t.prototype.add=function(t,e){return this.polygon.push(t,e),this},t.prototype.addFromVector2=function(t){return this.polygon.push(t.x,t.y),this},t.prototype.isSimple=function(){var t=this.polygon,e=t.length>>1;if(e<4)return!0;for(var r=o(),n=o(),i=o(),a=o(),u=o(),p=0;p<e;p++){r.x=t[2*p],r.y=t[2*p+1],p==e-1?(n.x=t[0],n.y=t[1]):(n.x=t[2*p+2],n.y=t[2*p+3]);for(var h=0;h<e;h++)if(!(Math.abs(p-h)<2||h==e-1&&0==p||p==e-1&&0==h||(i.x=t[2*h],i.y=t[2*h+1],h==e-1?(a.x=t[0],a.y=t[1]):(a.x=t[2*h+2],a.y=t[2*h+3]),null==s(r,n,i,a,u))))return!1}return!0},t.prototype.isConvex=function(){var t=this.polygon;if(t.length<6)return!0;for(var e=t.length-4,r=0;r<e;r+=2)if(!u(t[r],t[r+1],t[r+2],t[r+3],t[r+4],t[r+5]))return!1;return!!u(t[e],t[e+1],t[e+2],t[e+3],t[0],t[1])&&!!u(t[e+2],t[e+3],t[0],t[1],t[2],t[3])},t.prototype.getArea=function(){var t=this.polygon;if(t.length<6)return 0;for(var e=t.length-2,r=0,n=0;n<e;n+=2)r+=(t[n+2]-t[n])*(t[n+1]+t[n+3]);return.5*-(r+=(t[0]-t[e])*(t[e+1]+t[1]))},t.prototype.getAABB=function(t){void 0===t&&(t=new n.Box2);for(var e=this.polygon,r=1/0,i=1/0,o=-r,s=-i,a=0;a<e.length;a+=2)r=Math.min(r,e[a]),o=Math.max(o,e[a]),i=Math.min(i,e[a+1]),s=Math.max(s,e[a+1]);return t.min.x=r,t.min.y=i,t.max.x=o,t.max.y=s,t},t.prototype.containsPoint=function(t,e){for(var r,n,i=this.polygon,o=t,s=e,a=i.length>>1,u=i[2*a-3]-s,p=i[2*a-2]-o,h=i[2*a-1]-s,c=0;c<a;c++)r=p,u=h,p=i[2*c]-o,u!=(h=i[2*c+1]-s)&&(n=h>u);for(var l=0,f=0;f<a;f++)if(r=p,u=h,p=i[2*f]-o,h=i[2*f+1]-s,!(u<0&&h<0||u>0&&h>0||r<0&&p<0)){if(u==h&&Math.min(r,p)<=0)return!0;if(u!=h){var y=r+(p-r)*-u/(h-u);if(0==y)return!0;y>0&&l++,0==u&&n&&h>u&&l--,0==u&&!n&&h<u&&l--,n=h>u}}return 1==(1&l)},t.prototype.triangulate=function(){var t=this.polygon,e=t.length>>1;if(e<3)return[];for(var r=[],n=[],i=0;i<e;i++)n.push(i);for(var o=0,s=e;s>3;){var a=n[(o+0)%s],h=n[(o+1)%s],c=n[(o+2)%s],l=t[2*a],f=t[2*a+1],y=t[2*h],d=t[2*h+1],_=t[2*c],m=t[2*c+1],g=!1;if(u(l,f,y,d,_,m)){g=!0;for(var v=0;v<s;v++){var x=n[v];if(x!=a&&x!=h&&x!=c&&p(t[2*x],t[2*x+1],l,f,y,d,_,m)){g=!1;break}}}if(g)r.push(a,h,c),n.splice((o+1)%s,1),s--,o=0;else if(o++>3*s)break}return r.push(n[0],n[1],n[2]),r},t.prototype.slice=function(t,e,r,n){var i=this.polygon,a=t,u=e,p=r,f=n;if(this.containsPoint(a,u)||this.containsPoint(p,f))return[i.slice(0)];for(var y=o(a,u),d=o(p,f),_=[],m=[],g=0;g<i.length;g+=2)m.push(o(i[g],i[g+1]));for(var v=0;v<m.length;v++){var x=o();x=s(y,d,m[v],m[(v+1)%m.length],x);var b=_[0],S=_[_.length-1];x&&(null==b||h(x,b)>1e-10)&&(null==S||h(x,S)>1e-10)&&(x.flag=!0,_.push(x),m.splice(v+1,0,x),v++)}if(_.length<2)return[i.slice(0)];_.sort((function(t,e){return function(t,e,r){return h(t,e)-h(t,r)}(y,t,e)}));for(var T=[],C=0;_.length>0;){var E=_[0],M=_[1],w=m.indexOf(E),P=m.indexOf(M),A=!1;if(l(m,w)==P?A=!0:(E=_[1],M=_[0],w=m.indexOf(E),P=m.indexOf(M),l(m,w)==P&&(A=!0)),A){C--;var O=c(m,w,P);T.push(O),m=c(m,P,w),E.flag=M.flag=!1,_.splice(0,2),0==_.length&&T.push(m)}else C++,_.reverse();if(C>1)break}for(var R=[],B=0;B<T.length;B++){for(var I=T[B],N=[],F=0;F<I.length;F++)N.push(I[F].x,I[F].y);R.push(N)}return R},t.prototype.reverse=function(){for(var t=this.polygon,e=[],r=t.length-2;r>=0;r-=2)e.push(t[r],t[r+1]);return e},t}();function o(t,e){return void 0===t&&(t=0),void 0===e&&(e=0),{x:t,y:e,flag:!1}}function s(t,e,r,n,i){var o=t.x-e.x,s=r.x-n.x,u=t.y-e.y,p=r.y-n.y,h=o*p-u*s;if(0==h)return null;var c=t.x*e.y-t.y*e.x,l=r.x*n.y-r.y*n.x,f=i;return f.x=(c*s-o*l)/h,f.y=(c*p-u*l)/h,a(f,t,e)&&a(f,r,n)?f:null}function a(t,e,r){var n=Math.min(e.x,r.x),i=Math.max(e.x,r.x),o=Math.min(e.y,r.y),s=Math.max(e.y,r.y);return n==i?o<=t.y&&t.y<=s:o==s?n<=t.x&&t.x<=i:n<=t.x+1e-10&&t.x-1e-10<=i&&o<=t.y+1e-10&&t.y-1e-10<=s}function u(t,e,r,n,i,o){return(e-n)*(i-r)+(r-t)*(o-n)>=0}function p(t,e,r,n,i,o,s,a){var u=s-r,p=a-n,h=i-r,c=o-n,l=t-r,f=e-n,y=u*u+p*p,d=u*h+p*c,_=u*l+p*f,m=h*h+c*c,g=h*l+c*f,v=1/(y*m-d*d),x=(m*_-d*g)*v,b=(y*g-d*_)*v;return x>=0&&b>=0&&x+b<1}function h(t,e){var r=e.x-t.x,n=e.y-t.y;return Math.sqrt(r*r+n*n)}function c(t,e,r){var n=t.length,i=[];r<e&&(r+=n);for(var o=e;o<=r;o++)i.push(t[o%n]);return i}function l(t,e){for(var r=t.length;;)if(t[e=(e+1)%r].flag)return e}e.Polygon=i},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Ray2=void 0;var n=r(2),i=r(47),o=r(19),s=new n.Vector2,a=new n.Vector2,u=new n.Vector2,p=new n.Vector2,h=new n.Vector2,c=(new n.Vector2,new n.Vector2,new Array(2),function(){function t(t,e){void 0===t&&(t=null),void 0===e&&(e=null),this.origin=new n.Vector2,this.direction=new n.Vector2(-1,0),t&&this.origin.copy(t),e&&this.direction.copy(e)}return t.prototype.set=function(t,e){return this.origin.copy(t),this.direction.copy(e),this},t.prototype.clone=function(){return(new t).copy(this)},t.prototype.copy=function(t){return this.origin.copy(t.origin),this.direction.copy(t.direction),this},t.prototype.at=function(t,e){return void 0===e&&(e=new n.Vector2),e.copy(this.direction).multiplyScalar(t).add(this.origin)},t.prototype.lookAt=function(t){return this.direction.copy(t).sub(this.origin).normalize(),this},t.prototype.recast=function(t){return this.origin.copy(this.at(t,s)),this},t.prototype.closestPointToPoint=function(t,e){void 0===e&&(e=new n.Vector2),e.subVectors(t,this.origin);var r=e.dot(this.direction);return r<0?e.copy(this.origin):e.copy(this.direction).multiplyScalar(r).add(this.origin)},t.prototype.distanceSqToPoint=function(t,e){void 0===e&&(e=null);var r=s.subVectors(t,this.origin),n=this.direction.dot(r);return n>0?a.copy(this.direction).multiplyScalar(n).add(this.origin):a.copy(this.origin),e&&e.copy(a),r.subVectors(t,a),r.dot(r)},t.prototype.distanceToPoint=function(t,e){return void 0===e&&(e=null),Math.sqrt(this.distanceSqToPoint(t,e))},t.prototype.distanceSqToRay=function(t,e,r,n){void 0===e&&(e=null),void 0===r&&(r=null),void 0===n&&(n=null);var i,o,p,h=t,c=s.subVectors(this.origin,h.origin),l=-this.direction.dot(h.direction),f=c.dot(this.direction);if(Math.abs(l)<1)if(p=l*f-(i=-c.dot(h.direction)),(o=l*i-f)>=0)if(p>=0){var y=1-l*l;o/=y,p/=y}else p=0,o=f>=0?0:-f;else p>=0?(o=0,p=i>=0?0:-i):f<0?(o=-f,p=0):(o=0,p=i>=0?0:-i);else l>0?(p=0,o=f>=0?0:-f):f>=0?(o=0,p=-(i=-c.dot(h.direction))):(o=-f,p=0);return a.copy(this.direction).multiplyScalar(o).add(this.origin),u.copy(h.direction).multiplyScalar(p).add(h.origin),e&&e.copy(a),r&&r.copy(u),n&&(n.parameter=[o,p]),c.subVectors(a,u),c.dot(c)},t.prototype.distanceToRay=function(t,e,r,n){return void 0===e&&(e=null),void 0===r&&(r=null),void 0===n&&(n=null),this.distanceSqToRay(t,e,r,n)},t.prototype.distanceSqToSegment=function(t,e,r,n){void 0===e&&(e=null),void 0===r&&(r=null),void 0===n&&(n=null);var i,o,c=s,l=a,f=t.getCenteredForm(c,l),y=u.subVectors(this.origin,c),d=-this.direction.dot(l),_=y.dot(this.direction);if(Math.abs(d)<1){var m=1-d*d,g=f*m,v=-y.dot(l);o=d*_-v,(i=d*v-_)>=0?o>=-g?o<=g?(i/=m,o/=m):(o=f,i=Math.max(-(d*o+_),0)):(o=-f,i=Math.max(-(d*o+_),0)):o<=-g?(i=-(-d*f+_))>0?o=-f:(i=0,(o=-v)<-f?o=-f:o>f&&(o=f)):o<=g?(i=0,(o=-v)<-f?o=-f:o>f&&(o=f)):(i=-(d*f+_))>0?o=f:(i=0,(o=-v)<-f?o=-f:o>f&&(o=f))}else o=d>0?-f:f,i=Math.max(-(d*o+_),0);return p.copy(this.direction).multiplyScalar(i).add(this.origin),h.copy(l).multiplyScalar(o).add(c),e&&e.copy(p),r&&r.copy(h),n&&(n.parameter=[i,o]),y.subVectors(p,h),y.dot(y)},t.prototype.distanceToSegment=function(t,e,r,n){return void 0===e&&(e=null),void 0===r&&(r=null),void 0===n&&(n=null),Math.sqrt(this.distanceSqToSegment(t,e,r,n))},t.prototype.intersectsBox=function(e){var r=e.getCenter(s),n=e.getExtent(a),i=u.subVectors(this.origin,r);return t.intersectsBox(i,this.direction,n)},t.intersectsBox=function(t,e,r){for(var n=0;n<2;++n)if(Math.abs(t.p[n])>r.p[n]&&t.p[n]*e.p[n]>=0)return!1;return i.Line2.intersectsBox(t,e,r)},t.prototype.intersectBox=function(e){var r=e.getCenter(s),i=e.getExtent(a),o=u.subVectors(this.origin,r),p={intersect:!1,numIntersections:0,parameter:new Array(2),point:new Array(2)};t.intersectBox(o,this.direction,i,p);for(var h=0;h<p.numIntersections;++h)p.point[h]=(new n.Vector2).copy(this.direction).multiplyScalar(p.parameter[h]).add(this.origin);return p},t.intersectBox=function(t,e,r,n){if(i.Line2.intersectBox(t,e,r,n),n.intersect){var s=[0,1/0],a=o.Intervals.staticQuery(n.parameter,s);n.intersect=a.intersect,n.numIntersections=a.numIntersections,n.parameter=a.overlap}},t.prototype.intersectsSegment=function(t){var e=s,r=a,n=t.getCenteredForm(e,r),o=new i.Line2(this.origin,this.direction),p=new i.Line2(e,r),h=o.intersectLine(p);if(1==h.numIntersections)return h.line0Parameter[0]>=0&&Math.abs(h.line1Parameter[0])<=n;if(h.numIntersections==1/0){var c=u.subVectors(e,this.origin),l=this.direction.dot(c)+n;return l>0||!(l<0)}return!1},t.prototype.intersectSegment=function(t){var e=s,r=a,p=t.getCenteredForm(e,r),h={intersect:!1,numIntersections:0,rayParameter:new Array(2),segmentParameter:new Array(2),point:new Array(2)},c=new i.Line2(this.origin,this.direction),l=new i.Line2(e,r),f=c.intersectLine(l);if(1==f.numIntersections)f.line0Parameter[0]>=0&&Math.abs(f.line1Parameter[0])<=p?(h.intersect=!0,h.numIntersections=1,h.rayParameter[0]=f.line0Parameter[0],h.segmentParameter[0]=f.line1Parameter[0],h.point[0]=f.point):(h.intersect=!1,h.numIntersections=0);else if(f.numIntersections==1/0){var y=u.subVectors(e,this.origin),d=this.direction.dot(y),_=[0,1/0],m=[d-p,d+p],g=o.Intervals.staticQuery(_,m);if(g.intersect){h.intersect=!0,h.numIntersections=g.numIntersections;for(var v=0;v<g.numIntersections;++v)h.rayParameter[v]=g.overlap[v],h.segmentParameter[v]=g.overlap[v]-d,h.point[v]=(new n.Vector2).copy(this.direction).multiplyScalar(h.rayParameter[v]).add(this.origin)}else h.intersect=!1,h.numIntersections=0}else h.intersect=!1,h.numIntersections=0;return h},t.prototype.intersectsRay=function(t){var e=new i.Line2(this.origin,this.direction),r=new i.Line2(t.origin,t.direction),n=e.intersectLine(r);if(1==n.numIntersections)return n.line0Parameter[0]>=0&&n.line1Parameter[0]>=0;if(n.numIntersections==1/0){if(this.direction.dot(t.direction)>0)return!0;var o=s.subVectors(t.origin,this.origin),a=this.direction.dot(o);return a>0||!(a<0)}return!1},t.prototype.intersectRay=function(t){var e=t,r={intersect:!1,numIntersections:0,ray0Parameter:new Array(2),ray1Parameter:new Array(2),point:new Array(2)},n=new i.Line2(this.origin,this.direction),o=new i.Line2(t.origin,t.direction),a=n.intersectLine(o);if(1==a.numIntersections)a.line0Parameter[0]>=0&&a.line1Parameter[0]>=0?(r.intersect=!0,r.numIntersections=1,r.ray0Parameter[0]=a.line0Parameter[0],r.ray1Parameter[0]=a.line1Parameter[0],r.point[0]=a.point):(r.intersect=!1,r.numIntersections=0);else if(a.numIntersections==1/0){var u=s.subVectors(e.origin,this.origin),p=this.direction.dot(u);this.direction.dot(e.direction)>0?(r.intersect=!0,r.numIntersections=1/0,p>=0?(r.ray0Parameter[0]=p,r.ray0Parameter[1]=1/0,r.ray1Parameter[0]=0,r.ray1Parameter[1]=1/0,r.point[0]=e.origin):(r.ray0Parameter[0]=0,r.ray0Parameter[1]=1/0,r.ray1Parameter[0]=-p,r.ray1Parameter[1]=1/0,r.point[0]=this.origin)):p>=0?(r.intersect=!0,r.numIntersections=2,r.ray0Parameter[0]=0,r.ray0Parameter[1]=p,r.ray1Parameter[0]=0,r.ray1Parameter[1]=p,r.point[0]=this.origin,r.point[1]=e.origin):(r.intersect=!1,r.numIntersections=0)}else r.intersect=!1,r.numIntersections=0;return r},t.prototype.equals=function(t){return t.origin.equals(this.origin)&&t.direction.equals(this.direction)},t}());e.Ray2=c},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Ray3=void 0;var n=r(0),i=r(37),o=r(19),s=new n.Vector3,a=new n.Vector3,u=new n.Vector3,p=new n.Vector3,h=new n.Vector3,c=(new n.Vector3,new n.Vector3,new Array(3),function(){function t(t,e){void 0===t&&(t=null),void 0===e&&(e=null),this.origin=new n.Vector3,this.direction=new n.Vector3(0,0,-1),t&&this.origin.copy(t),e&&this.direction.copy(e)}return t.prototype.set=function(t,e){return this.origin.copy(t),this.direction.copy(e),this},t.prototype.clone=function(){return(new t).copy(this)},t.prototype.copy=function(t){return this.origin.copy(t.origin),this.direction.copy(t.direction),this},t.prototype.at=function(t,e){return void 0===e&&(e=new n.Vector3),e.copy(this.direction).multiplyScalar(t).add(this.origin)},t.prototype.lookAt=function(t){return this.direction.copy(t).sub(this.origin).normalize(),this},t.prototype.recast=function(t){return this.origin.copy(this.at(t,s)),this},t.prototype.closestPointToPoint=function(t,e){void 0===e&&(e=new n.Vector3),e.subVectors(t,this.origin);var r=e.dot(this.direction);return r<0?e.copy(this.origin):e.copy(this.direction).multiplyScalar(r).add(this.origin)},t.prototype.distanceSqToPoint=function(t,e){void 0===e&&(e=null);var r=s.subVectors(t,this.origin),n=this.direction.dot(r);return n>0?a.copy(this.direction).multiplyScalar(n).add(this.origin):a.copy(this.origin),e&&e.copy(a),r.subVectors(t,a),r.dot(r)},t.prototype.distanceToPoint=function(t,e){return void 0===e&&(e=null),Math.sqrt(this.distanceSqToPoint(t,e))},t.prototype.distanceSqToRay=function(t,e,r,n){void 0===e&&(e=null),void 0===r&&(r=null),void 0===n&&(n=null);var i,o,p,h=t,c=s.subVectors(this.origin,h.origin),l=-this.direction.dot(h.direction),f=c.dot(this.direction);if(Math.abs(l)<1)if(p=l*f-(i=-c.dot(h.direction)),(o=l*i-f)>=0)if(p>=0){var y=1-l*l;o/=y,p/=y}else p=0,o=f>=0?0:-f;else p>=0?(o=0,p=i>=0?0:-i):f<0?(o=-f,p=0):(o=0,p=i>=0?0:-i);else l>0?(p=0,o=f>=0?0:-f):f>=0?(o=0,p=-(i=-c.dot(h.direction))):(o=-f,p=0);return a.copy(this.direction).multiplyScalar(o).add(this.origin),u.copy(h.direction).multiplyScalar(p).add(h.origin),e&&e.copy(a),r&&r.copy(u),n&&(n.parameter=[o,p]),c.subVectors(a,u),c.dot(c)},t.prototype.distanceToRay=function(t,e,r,n){return void 0===e&&(e=null),void 0===r&&(r=null),void 0===n&&(n=null),this.distanceSqToRay(t,e,r,n)},t.prototype.distanceSqToSegment=function(t,e,r,n){void 0===e&&(e=null),void 0===r&&(r=null),void 0===n&&(n=null);var i,o,c=s,l=a,f=t.getCenteredForm(c,l),y=u.subVectors(this.origin,c),d=-this.direction.dot(l),_=y.dot(this.direction);if(Math.abs(d)<1){var m=1-d*d,g=f*m,v=-y.dot(l);o=d*_-v,(i=d*v-_)>=0?o>=-g?o<=g?(i/=m,o/=m):(o=f,i=Math.max(-(d*o+_),0)):(o=-f,i=Math.max(-(d*o+_),0)):o<=-g?(i=-(-d*f+_))>0?o=-f:(i=0,(o=-v)<-f?o=-f:o>f&&(o=f)):o<=g?(i=0,(o=-v)<-f?o=-f:o>f&&(o=f)):(i=-(d*f+_))>0?o=f:(i=0,(o=-v)<-f?o=-f:o>f&&(o=f))}else o=d>0?-f:f,i=Math.max(-(d*o+_),0);return p.copy(this.direction).multiplyScalar(i).add(this.origin),h.copy(l).multiplyScalar(o).add(c),e&&e.copy(p),r&&r.copy(h),n&&(n.parameter=[i,o]),y.subVectors(p,h),y.dot(y)},t.prototype.distanceToSegment=function(t,e,r,n){return void 0===e&&(e=null),void 0===r&&(r=null),void 0===n&&(n=null),Math.sqrt(this.distanceSqToSegment(t,e,r,n))},t.prototype.distanceSqToTriangle=function(t,e,r,n){void 0===e&&(e=null),void 0===r&&(r=null),void 0===n&&(n=null);var o={lineParameter:0,triangleParameter:[]},s=new i.Line3(this.origin,this.direction).distanceSqToTriangle(t,e,r,o);if(o.lineParameter>=0)return n&&(n.rayParameter=o.lineParameter,n.triangleParameter[0]=o.triangleParameter[0],n.triangleParameter[1]=o.triangleParameter[1],n.triangleParameter[2]=o.triangleParameter[2]),s;var a={parameter:[]};return s=t.distanceSqToPoint(this.origin,r,a),e&&e.copy(this.origin),n&&(n.rayParameter=0,n.triangleParameter[0]=a.parameter[0],n.triangleParameter[1]=a.parameter[1],n.triangleParameter[2]=a.parameter[2]),s},t.prototype.distanceToTriangle=function(t,e,r,n){return void 0===e&&(e=null),void 0===r&&(r=null),void 0===n&&(n=null),Math.sqrt(this.distanceSqToTriangle(t,e,r,n))},t.prototype.distanceSqToBox=function(t,e,r,n){void 0===e&&(e=null),void 0===r&&(r=null),void 0===n&&(n=null);var o={sqrDistance:0,lineParameter:0},s=new i.Line3(this.origin,this.direction).distanceSqToBox(t,e,r,o);return o.lineParameter>=0?(n&&(n.rayParameter=o.lineParameter),s):(s=t.distanceSqToPoint(this.origin,r),e&&e.copy(this.origin),n&&(n.rayParameter=o.lineParameter),s)},t.prototype.distanceToBox=function(t,e,r,n){return void 0===e&&(e=null),void 0===r&&(r=null),void 0===n&&(n=null),Math.sqrt(this.distanceSqToBox(t,e,r,n))},t.prototype.distanceSqToOBB=function(t,e,r,n){void 0===e&&(e=null),void 0===r&&(r=null),void 0===n&&(n=null);var o={sqrDistance:0,lineParameter:0},s=new i.Line3(this.origin,this.direction).distanceSqToOBB(t,e,r,o);return o.lineParameter>=0?(n&&(n.rayParameter=o.lineParameter),s):(s=t.distanceSqToPoint(this.origin,r),e&&e.copy(this.origin),n&&(n.rayParameter=o.lineParameter),s)},t.prototype.distanceToOBB=function(t,e,r,n){return void 0===e&&(e=null),void 0===r&&(r=null),void 0===n&&(n=null),Math.sqrt(this.distanceSqToOBB(t,e,r,n))},t.prototype.intersecsTriangle=function(t){var e,r=s.subVectors(this.origin,t.p[0]),n=a.subVectors(t.p[1],t.p[0]),i=u.subVectors(t.p[2],t.p[0]),o=p.crossVectors(n,i),h=this.direction.dot(o);if(h>0)e=1;else{if(!(h<0))return!1;e=-1,h=-h}var c=e*this.direction.dotCross(r,i);if(c>=0){var l=e*this.direction.dotCross(n,r);if(l>=0)if(c+l<=h)if(-e*r.dot(o)>=0)return!0}return!1},t.prototype.intersecTriangle=function(t){var e,r=s.subVectors(this.origin,t.p[0]),i=a.subVectors(t.p[1],t.p[0]),o=u.subVectors(t.p[2],t.p[0]),h=p.crossVectors(i,o),c=this.direction.dot(h);if(c>0)e=1;else{if(!(c<0))return{intersect:!1};e=-1,c=-c}var l=e*this.direction.dotCross(r,o);if(l>=0){var f=e*this.direction.dotCross(i,r);if(f>=0&&l+f<=c){var y=-e*r.dot(h);if(y>=0){var d=1/c,_={intersect:!0,parameter:0,triangleBary:new Array,point:new n.Vector3};return _.parameter=y*d,_.triangleBary[1]=l*d,_.triangleBary[2]=f*d,_.triangleBary[0]=1-_.triangleBary[1]-_.triangleBary[2],_.point.copy(this.direction).multiplyScalar(_.parameter).add(this.origin),_}}}return{intersect:!1}},t.prototype.intersecsSphere=function(t){var e=s.subVectors(this.origin,t.center),r=e.dot(e)-t.radius*t.radius;if(r<=0)return!0;var n=this.direction.dot(e);return!(n>=0)&&n*n-r>=0},t.prototype.intersecSphere=function(t){var e={intersect:!1,numIntersections:0,parameter:new Array(2),point:new Array(2)};if(i.Line3.intersectSphere(this.origin,this.direction,t,e),e.intersect){var r=[0,1/0],s=o.Intervals.staticQuery(e.parameter,r);s.intersect?(e.numIntersections=s.numIntersections,e.parameter=s.overlap):(e.intersect=!1,e.numIntersections=0)}for(var a=0;a<e.numIntersections;++a)e.point[a]=(new n.Vector3).copy(this.direction).multiplyScalar(e.parameter[a]).add(this.origin);return e},t.prototype.intersecsPlane=function(t){var e=t.distanceToPoint(this.origin),r=this.direction.dot(t.normal);return r>0?e<=0:r<0?e>=0:0==Math.abs(e)},t.prototype.intersecPlane=function(t){var e={intersect:!1,numIntersections:0,parameter:0,point:new n.Vector3};return i.Line3.intersectPlane(this.origin,this.direction,t,e),e.intersect&&e.parameter<0&&(e.intersect=!1,e.numIntersections=0),e.intersect&&e.point.copy(this.direction).multiplyScalar(e.parameter).add(this.origin),e},t.prototype.intersecsBox=function(e){var r=e.getCenter(s),n=e.getExtent(a),i=u.subVectors(this.origin,r);return t.intersecsBox(i,this.direction,n)},t.intersecsBox=function(t,e,r){for(var n=0;n<3;++n)if(Math.abs(t.p[n])>r.p[n]&&t.p[n]*e.p[n]>=0)return!1;return i.Line3.intersectsBox(t,e,r)},t.prototype.intersecBox=function(e){var r=e.getCenter(s),i=e.getExtent(a),o=u.subVectors(this.origin,r),p={intersect:!1,numPoints:0,lineParameter:new Array(2),point:new Array(2)};t.intersecBox(o,this.direction,i,p);for(var h=0;h<p.numPoints;++h)p.point[h]=(new n.Vector3).copy(this.direction).multiplyScalar(p.lineParameter[h]).add(this.origin);return p},t.intersecBox=function(t,e,r,n){i.Line3.intersectBox(t,e,r,n),n.intersect&&(n.lineParameter[1]>=0?n.lineParameter[0]<0&&(n.lineParameter[0]=0):(n.intersect=!1,n.numPoints=0))},t.prototype.intersecsOBB=function(e){var r=s.subVectors(this.origin,e.center),n=a.set(r.dot(e.axis[0]),r.dot(e.axis[1]),r.dot(e.axis[2])),i=u.set(this.direction.dot(e.axis[0]),this.direction.dot(e.axis[1]),this.direction.dot(e.axis[2])),o=e.getExtent(p);return t.intersecsBox(n,i,o)},t.prototype.intersecOBB=function(e){var r=s.subVectors(this.origin,e.center),i=a.set(r.dot(e.axis[0]),r.dot(e.axis[1]),r.dot(e.axis[2])),o=u.set(this.direction.dot(e.axis[0]),this.direction.dot(e.axis[1]),this.direction.dot(e.axis[2])),h=e.getExtent(p),c={intersect:!1,numPoints:0,lineParameter:new Array(2),point:new Array(2)};t.intersecBox(i,o,h,c);for(var l=0;l<c.numPoints;++l)c.point[l]=(new n.Vector3).copy(this.direction).multiplyScalar(c.lineParameter[l]).add(this.origin);return c},t.prototype.applyMatrix4=function(t){return this.origin.applyMatrix4(t),t.transformVector3(this.direction,this.direction),this},t.prototype.equals=function(t){return t.origin.equals(this.origin)&&t.direction.equals(this.direction)},t}());e.Ray3=c},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Spherical=void 0;var n=r(1),i=function(){function t(t,e,r){void 0===t&&(t=null),void 0===e&&(e=null),void 0===r&&(r=null),this.radius=1,this.phi=0,this.theta=0,t&&(this.radius=t),e&&(this.phi=e),r&&(this.theta=r)}return t.prototype.set=function(t,e,r){return this.radius=t,this.phi=e,this.theta=r,this},t.prototype.copy=function(t){return this.radius=t.radius,this.phi=t.phi,this.theta=t.theta,this},t.prototype.clone=function(){return(new t).copy(this)},t.prototype.makeSafe=function(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this},t.prototype.setFromVector3=function(t){return this.setFromCartesianCoords(t.x,t.y,t.z)},t.prototype.setFromCartesianCoords=function(t,e,r){return this.radius=Math.sqrt(t*t+e*e+r*r),0==this.radius?(this.theta=0,this.phi=0):(this.theta=Math.atan2(t,r),this.phi=Math.acos(n.MathUtils.clamp(e/this.radius,-1,1))),this},t}();e.Spherical=i},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.SphericalHarmonics3=void 0;var n=r(0),i=function(){function t(){this.coefficients=[];for(var t=0;t<9;t++)this.coefficients.push(new n.Vector3)}return t.prototype.set=function(t){for(var e=0;e<9;e++)this.coefficients[e].copy(t[e]);return this},t.prototype.zero=function(){for(var t=0;t<9;t++)this.coefficients[t].set(0,0,0);return this},t.prototype.getAt=function(t,e){void 0===e&&(e=new n.Vector3);var r=t.x,i=t.y,o=t.z,s=this.coefficients;return e.copy(s[0]).multiplyScalar(.282095),e.addScaledVector(s[1],.488603*i),e.addScaledVector(s[2],.488603*o),e.addScaledVector(s[3],.488603*r),e.addScaledVector(s[4],r*i*1.092548),e.addScaledVector(s[5],i*o*1.092548),e.addScaledVector(s[6],.315392*(3*o*o-1)),e.addScaledVector(s[7],r*o*1.092548),e.addScaledVector(s[8],.546274*(r*r-i*i)),e},t.prototype.getIrradianceAt=function(t,e){void 0===e&&(e=new n.Vector3);var r=t.x,i=t.y,o=t.z,s=this.coefficients;return e.copy(s[0]).multiplyScalar(.886227),e.addScaledVector(s[1],1.023328*i),e.addScaledVector(s[2],1.023328*o),e.addScaledVector(s[3],1.023328*r),e.addScaledVector(s[4],.858086*r*i),e.addScaledVector(s[5],.858086*i*o),e.addScaledVector(s[6],.743125*o*o-.247708),e.addScaledVector(s[7],.858086*r*o),e.addScaledVector(s[8],.429043*(r*r-i*i)),e},t.prototype.add=function(t){for(var e=0;e<9;e++)this.coefficients[e].add(t.coefficients[e]);return this},t.prototype.addScaledSH=function(t,e){for(var r=0;r<9;r++)this.coefficients[r].addScaledVector(t.coefficients[r],e);return this},t.prototype.lerp=function(t,e){for(var r=0;r<9;r++)this.coefficients[r].lerp(t.coefficients[r],e);return this},t.prototype.equals=function(t){for(var e=0;e<9;e++)if(!this.coefficients[e].equals(t.coefficients[e]))return!1;return!0},t.prototype.copy=function(t){return this.set(t.coefficients)},t.prototype.clone=function(){return(new t).copy(this)},t}();e.SphericalHarmonics3=i},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Triangle=void 0;var n=r(0),i=r(2),o=r(45),s=r(43),a=r(42),u=r(46),p=new n.Vector3,h=new n.Vector3,c=new n.Vector3,l=new n.Vector3,f=new n.Vector3,y=new n.Vector3,d=new n.Vector3,_=new n.Vector3,m=new n.Vector3,g=new n.Vector3,v=new i.Vector2,x=function(){function t(t,e,r){void 0===t&&(t=null),void 0===e&&(e=null),void 0===r&&(r=null),this._p=[new n.Vector3,new n.Vector3,new n.Vector3],t&&this._p[0].copy(t),e&&this._p[1].copy(e),r&&this._p[2].copy(r)}return Object.defineProperty(t.prototype,"p",{get:function(){return this._p},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"a",{get:function(){return this._p[0]},set:function(t){this._p[0].copy(t)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"b",{get:function(){return this._p[1]},set:function(t){this._p[1].copy(t)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"c",{get:function(){return this._p[2]},set:function(t){this._p[2].copy(t)},enumerable:!1,configurable:!0}),t.getNormal=function(t,e,r,i){void 0===i&&(i=new n.Vector3),i.subVectors(r,e),p.subVectors(t,e),i.cross(p);var o=i.lengthSq();return o>0?i.multiplyScalar(1/Math.sqrt(o)):i.set(0,0,0)},t.getBarycoord=function(t,e,r,i,o){void 0===o&&(o=new n.Vector3),p.subVectors(i,e),h.subVectors(r,e),c.subVectors(t,e);var s=p.dot(p),a=p.dot(h),u=p.dot(c),l=h.dot(h),f=h.dot(c),y=s*l-a*a;if(0==y)return o.set(-2,-1,-1);var d=1/y,_=(l*u-a*f)*d,m=(s*f-a*u)*d;return o.set(1-_-m,m,_)},t.containsPoint=function(e,r,n,i){return t.getBarycoord(e,r,n,i,h),h.x>=0&&h.y>=0&&h.x+h.y<=1},t.getUV=function(e,r,n,o,s,a,u,p){return void 0===p&&(p=new i.Vector2),t.getBarycoord(e,r,n,o,l),p.set(0,0),p.addScaledVector(s,l.x),p.addScaledVector(a,l.y),p.addScaledVector(u,l.z),p},t.isFrontFacing=function(t,e,r,n){return p.subVectors(r,e),h.subVectors(t,e),p.cross(h).dot(n)<0},t.prototype.set=function(t,e,r){return this.a.copy(t),this.b.copy(e),this.c.copy(r),this},t.prototype.clone=function(){return new t(this.a,this.b,this.c)},t.prototype.copy=function(t){return this.a.copy(t.a),this.b.copy(t.b),this.c.copy(t.c),this},t.prototype.setComponent=function(t,e){switch(t){case 0:this.a.copy(e);break;case 1:this.b.copy(e);break;case 2:this.c.copy(e);break;default:throw new Error("index is out of range: "+t)}return this},t.prototype.getComponent=function(t){switch(t){case 0:return this.a;case 1:return this.b;case 2:return this.c;default:throw new Error("index is out of range: "+t)}},t.prototype.getArea=function(){return p.subVectors(this.c,this.b),h.subVectors(this.a,this.b),.5*p.cross(h).length()},t.prototype.getMidpoint=function(t){return void 0===t&&(t=new n.Vector3),t.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)},t.prototype.getNormal=function(e){return void 0===e&&(e=new n.Vector3),t.getNormal(this.a,this.b,this.c,e)},t.prototype.getPlane=function(t){return void 0===t&&(t=new o.Plane),t.setFromCoplanarPoints(this.a,this.b,this.c)},t.prototype.getBarycoord=function(e,r){return void 0===r&&(r=new n.Vector3),t.getBarycoord(e,this.a,this.b,this.c,r)},t.prototype.getUV=function(e,r,n,o,s){return void 0===s&&(s=new i.Vector2),t.getUV(e,this.a,this.b,this.c,r,n,o,s)},t.prototype.axisProjectionMinMax=function(t,e){void 0===e&&(e=new i.Vector2);var r=[t.dot(this.a),t.dot(this.b),t.dot(this.c)];return e.x=r[0],e.y=e.x,r[1]<e.x?e.x=r[1]:r[1]>e.y&&(e.y=r[1]),r[2]<e.x?e.x=r[2]:r[2]>e.y&&(e.y=r[2]),e},t.prototype.containsPoint=function(e){return t.containsPoint(e,this.a,this.b,this.c)},t.prototype.closestPointToPoint=function(t,e){void 0===e&&(e=new n.Vector3);var r,i,o=this.a,s=this.b,a=this.c;f.subVectors(s,o),y.subVectors(a,o),_.subVectors(t,o);var u=f.dot(_),p=y.dot(_);if(u<=0&&p<=0)return e.copy(o);m.subVectors(t,s);var h=f.dot(m),c=y.dot(m);if(h>=0&&c<=h)return e.copy(s);var l=u*c-h*p;if(l<=0&&u>=0&&h<=0)return r=u/(u-h),e.copy(o).addScaledVector(f,r);g.subVectors(t,a);var v=f.dot(g),x=y.dot(g);if(x>=0&&v<=x)return e.copy(a);var b=v*p-u*x;if(b<=0&&p>=0&&x<=0)return i=p/(p-x),e.copy(o).addScaledVector(y,i);var S=h*x-v*c;if(S<=0&&c-h>=0&&v-x>=0)return d.subVectors(a,s),i=(c-h)/(c-h+(v-x)),e.copy(s).addScaledVector(d,i);var T=1/(S+b+l);return r=b*T,i=l*T,e.copy(o).addScaledVector(f,r).addScaledVector(y,i)},t.prototype.distanceSqToPoint=function(t,e,r){void 0===e&&(e=null),void 0===r&&(r=null);var n,i,o,s=p.subVectors(t,this.a),a=h.subVectors(this.b,this.a),u=c.subVectors(this.c,this.a),d=a.dot(a),m=a.dot(u),v=u.dot(u),x=-s.dot(a),C=-s.dot(u),E=x,M=x+d,w=x+m,P=f,A=y,O=_;return E>=0?w>=0?b(v,C,O):(P.x=0,P.y=E/(E-w),A.x=w/(w-M),A.y=1-A.x,(i=(n=A.y-P.y)*(v*P.y+C))>=0?b(v,C,O):(o=n*(m*A.x+v*A.y+C))<=0?S(m,v,C,M,w,O):T(P,i,A,o,O)):w<=0?M<=0?S(m,v,C,M,w,O):(P.x=E/(E-M),P.y=0,A.x=w/(w-M),A.y=1-A.x,(i=A.y*(m*P.x+C))>=0?O=P:(o=A.y*(m*A.x+v*A.y+C))<=0?S(m,v,C,M,w,O):T(P,i,A,o,O)):M<=0?(P.x=0,P.y=E/(E-w),A.x=w/(w-M),A.y=1-A.x,(i=(n=A.y-P.y)*(v*P.y+C))>=0?b(v,C,O):(o=n*(m*A.x+v*A.y+C))<=0?S(m,v,C,M,w,O):T(P,i,A,o,O)):(P.x=E/(E-M),P.y=0,A.x=0,A.y=E/(E-w),(i=A.y*(m*P.x+C))>=0?O=P:(o=A.y*(v*A.y+C))<=0?b(v,C,O):T(P,i,A,o,O)),g.copy(this.a).add(l.copy(a).multiplyScalar(O.x)).add(l.copy(u).multiplyScalar(O.y)),e&&e.copy(g),r&&(r.parameter[0]=1-O.x-O.y,r.parameter[1]=O.x,r.parameter[2]=O.y),s.subVectors(t,g),s.dot(s)},t.prototype.distanceToPoint=function(t,e,r){return void 0===e&&(e=null),void 0===r&&(r=null),Math.sqrt(this.distanceSqToPoint(t,e,r))},t.prototype.distanceSqToTriangle=function(t,e,r,n){void 0===e&&(e=null),void 0===r&&(r=null),void 0===n&&(n=null);for(var i=t,o=1/0,s=2,a=0;a<3;s=a++){var f=p.addVectors(this.p[s],this.p[a]).multiplyScalar(.5),y=.5*(m=h.subVectors(this.p[a],this.p[s])).length();m.normalize(),(g=new u.LineSegment3).setCenteredForm(f,m,y);var d={segmentParameter:0,triangleParameter:[]};if((v=g.distanceSqToTriangle(i,c,l,d))<o){if(o=v,n){var _=d.segmentParameter/y;n.triangle0Parameter[s]=.5*(1-_),n.triangle0Parameter[a]=1-n.triangle0Parameter[s],n.triangle0Parameter[3-s-a]=0,n.triangle1Parameter[0]=d.triangleParameter[0],n.triangle1Parameter[1]=d.triangleParameter[1],n.triangle1Parameter[2]=d.triangleParameter[2]}e&&e.copy(c),r&&r.copy(l)}}for(s=2,a=0;a<3;s=a++){var m,g;f=p.addVectors(i.p[s],i.p[a]).multiplyScalar(.5),y=.5*(m=h.subVectors(i.p[a],i.p[s])).length();m.normalize(),(g=new u.LineSegment3).setCenteredForm(f,m,y);var v;d={segmentParameter:0,triangleParameter:[]};if((v=g.distanceSqToTriangle(this,c,l,d))<o){if(o=v,n){_=d.segmentParameter/y;n.triangle0Parameter[0]=d.triangleParameter[0],n.triangle0Parameter[1]=d.triangleParameter[1],n.triangle0Parameter[2]=d.triangleParameter[2],n.triangle1Parameter[s]=.5*(1-_),n.triangle1Parameter[a]=1-n.triangle1Parameter[s],n.triangle1Parameter[3-s-a]=0}e&&e.copy(c),r&&r.copy(l)}}return o},t.prototype.distanceToTriangle=function(t,e,r,n){return void 0===e&&(e=null),void 0===r&&(r=null),void 0===n&&(n=null),Math.sqrt(this.distanceSqToTriangle(t,e,r,n))},t.prototype.distanceSqToBox=function(t,e,r,n){void 0===e&&(e=null),void 0===r&&(r=null),void 0===n&&(n=null);var i=p.subVectors(t.max,t.min),o=h.subVectors(this.a,t.min),a=c.subVectors(this.b,this.a),u=l.subVectors(this.c,this.a),d=o.dot(a),m=o.dot(u),g=a.dot(a),v=a.dot(u),x=u.dot(u),b=[-o.x,-o.y,-o.z,d,m,i.x,i.y,i.z,1],S=[[1,0,0,-a.x,-u.x,1,0,0,0],[0,1,0,-a.y,-u.y,0,1,0,0],[0,0,1,-a.z,-u.z,0,0,1,0],[-a.x,-a.y,-a.z,g,v,0,0,0,1],[-u.x,-u.y,-u.z,v,x,0,0,0,1],[-1,0,0,0,0,0,0,0,0],[0,-1,0,0,0,0,0,0,0],[0,0,-1,0,0,0,0,0,0],[0,0,0,-1,-1,0,0,0,0]],T=new Array(9),C=new Array(9),E=new s.LCPSolver(9);if(E.solve(b,S,T,C)){f.copy(this.a).add(a.multiplyScalar(C[3])).add(u.multiplyScalar(C[4])),n&&(n.queryIsSuccessful=!0,n.numLCPIterations=E.getNumIterations(),n.triangleParameter[0]=1-C[3]-C[4],n.triangleParameter[1]=C[3],n.triangleParameter[2]=C[4]);for(var M=0;M<3;++M)y.p[M]=C[M]+t.min.p[M],n&&(n.boxParameter[M]=y.p[M]);e&&e.copy(f),r&&r.copy(y);var w=_.subVectors(y,f);return w.dot(w)}return n&&(n.queryIsSuccessful=!1,n.numLCPIterations=E.getNumIterations()),NaN},t.prototype.distanceToBox=function(t,e,r,n){return void 0===e&&(e=null),void 0===r&&(r=null),void 0===n&&(n=null),Math.sqrt(this.distanceSqToBox(t,e,r,n))},t.prototype.distanceSqToOBB=function(t,e,r,n){void 0===e&&(e=null),void 0===r&&(r=null),void 0===n&&(n=null);for(var i=f.copy(t.extent).multiplyScalar(2),o=y.subVectors(this.a,t.center),a=_.subVectors(this.b,this.a),u=g.subVectors(this.c,this.a),d=p,m=h,v=c,x=0;x<3;++x)d.p[x]=t.axis[x].dot(o)+t.extent.p[x],m.p[x]=t.axis[x].dot(a),v.p[x]=t.axis[x].dot(u);var b=d.dot(m),S=d.dot(v),T=m.dot(m),C=m.dot(v),E=v.dot(v),M=[-d.x,-d.y,-d.z,b,S,i.x,i.y,i.z,1],w=[[1,0,0,-m.x,-v.x,1,0,0,0],[0,1,0,-m.y,-v.y,0,1,0,0],[0,0,1,-m.z,-v.z,0,0,1,0],[-m.x,-m.y,-m.z,T,C,0,0,0,1],[-v.x,-v.y,-v.z,C,E,0,0,0,1],[-1,0,0,0,0,0,0,0,0],[0,-1,0,0,0,0,0,0,0],[0,0,-1,0,0,0,0,0,0],[0,0,0,-1,-1,0,0,0,0]],P=new Array(9),A=new Array(9),O=new s.LCPSolver(9);if(O.solve(M,w,P,A)){n&&(n.queryIsSuccessful=!0,n.numLCPIterations=O.getNumIterations(),n.triangleParameter[0]=1-A[3]-A[4],n.triangleParameter[1]=A[3],n.triangleParameter[2]=A[4]),h.copy(this.a).add(a.multiplyScalar(A[3])).add(u.multiplyScalar(A[4])),c.copy(t.center);for(x=0;x<3;++x){var R=A[x]-t.extent.p[x];n&&(n.boxParameter[x]=R),c.add(p.copy(t.axis[x]).multiplyScalar(R))}e&&e.copy(h),r&&r.copy(c);var B=l.subVectors(c,h);return B.dot(B)}return n&&(n.queryIsSuccessful=!1,n.numLCPIterations=O.getNumIterations()),NaN},t.prototype.distanceToOBB=function(t,e,r,n){return void 0===e&&(e=null),void 0===r&&(r=null),void 0===n&&(n=null),Math.sqrt(this.distanceSqToOBB(t,e,r,n))},t.prototype.intersectsOBB=function(t){var e,r,n,i=g,o=[f,y,_];if(o[0].subVectors(this.b,this.a),o[1].subVectors(this.c,this.a),i.crossVectors(o[0],o[1]),r=e=i.dot(this.a),t.axisProjectionMinMax(i,v),n=v.x,v.y<e||r<n)return!1;for(var s=0;s<3;++s){i.copy(t.axis[s]),this.axisProjectionMinMax(i,v),e=v.x,r=v.y;var a=i.dot(t.center);if(n=a-t.extent.p[s],a+t.extent.p[s]<e||r<n)return!1}o[2].subVectors(o[1],o[0]);for(var u=0;u<3;++u)for(var p=0;p<3;++p)if(i.crossVectors(o[u],t.axis[p]),this.axisProjectionMinMax(i,v),e=v.x,r=v.y,t.axisProjectionMinMax(i,v),n=v.x,v.y<e||r<n)return!1;return!0},t.prototype.intersectOBB=function(t){for(var e={insidePolygon:[(new n.Vector3).copy(this.a),(new n.Vector3).copy(this.b),(new n.Vector3).copy(this.c)],outsidePolygons:new Array},r=new o.Plane,i=-1;i<=1;i+=2)for(var s=0;s<3;++s){r.normal.copy(t.axis[s]).multiplyScalar(i),r.constant=r.normal.dot(t.center)-t.extent.p[s];var u=r.intersectPolygon(e.insidePolygon);switch(u.type){case a.PlanePolygonIntersectType.SPLIT:e.insidePolygon=u.positivePolygon,e.outsidePolygons.push(u.negativePolygon);break;case a.PlanePolygonIntersectType.POSITIVE_SIDE_VERTEX:case a.PlanePolygonIntersectType.POSITIVE_SIDE_EDGE:case a.PlanePolygonIntersectType.POSITIVE_SIDE_STRICT:e.insidePolygon=u.positivePolygon;break;case a.PlanePolygonIntersectType.NEGATIVE_SIDE_VERTEX:case a.PlanePolygonIntersectType.NEGATIVE_SIDE_EDGE:case a.PlanePolygonIntersectType.NEGATIVE_SIDE_STRICT:return e.insidePolygon.length=0,e.outsidePolygons.push(u.negativePolygon),e;case a.PlanePolygonIntersectType.CONTAINED:e.insidePolygon=u.intersection;break;default:e.insidePolygon.length=0,e.outsidePolygons.length=0}}return e},t.prototype.equals=function(t){return t.a.equals(this.a)&&t.b.equals(this.b)&&t.c.equals(this.c)},t}();function b(t,e,r){r.x=0,r.y=e>=0?0:t+e<=0?1:-e/t}function S(t,e,r,n,i,o){var s=t+r-n;if(s>=0)o.y=0;else{var a=e+r-i;o.y=a<=0?1:s/(s-a)}o.x=1-o.y}function T(t,e,r,n,i){var o=e/(e-n);i.addVectors(m.copy(t).multiplyScalar(1-o),d.copy(r).multiplyScalar(o))}e.Triangle=x},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.createCurve=void 0;var n=r(27),i=r(66),o=r(48),s=r(69),a=r(38),u=r(49),p=r(50),h=r(71),c=r(39),l=r(67),f=r(68);e.createCurve=function(t){switch(t){case"EllipseCurve":return new n.EllipseCurve;case"ArcCurve":return new i.ArcCurve;case"CubicBezierCurve":return new o.CubicBezierCurve;case"CubicBezierCurve3":return new s.CubicBezierCurve3;case"LineCurve":return new a.LineCurve;case"LineCurve3":return new u.LineCurve3;case"QuadraticBezierCurve":return new p.QuadraticBezierCurve;case"QuadraticBezierCurve3":return new h.QuadraticBezierCurve3;case"SplineCurve":return new c.SplineCurve;case"CatmullRomCurve":return new l.CatmullRomCurve;case"CatmullRomCurve3":return new f.CatmullRomCurve3;default:throw Error("createCurve error!")}}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ShapePath=void 0;var n=r(26),i=r(51),o=r(72),s=r(73),a=function(){function t(){this.color=new n.ColorRGB,this.subPaths=[],this.currentPath=null}return t.prototype.moveTo=function(t,e){return this.currentPath=new i.Path,this.subPaths.push(this.currentPath),this.currentPath.moveTo(t,e),this},t.prototype.lineTo=function(t,e){var r;return null===(r=this.currentPath)||void 0===r||r.lineTo(t,e),this},t.prototype.arc=function(t,e,r,n,i,o){var s;return null===(s=this.currentPath)||void 0===s||s.arc(t,e,r,n,i,o),this},t.prototype.absarc=function(t,e,r,n,i,o){var s;return null===(s=this.currentPath)||void 0===s||s.absarc(t,e,r,n,i,o),this},t.prototype.ellipse=function(t,e,r,n,i,o,s,a){var u;return void 0===a&&(a=0),null===(u=this.currentPath)||void 0===u||u.ellipse(t,e,r,n,i,o,s,a),this},t.prototype.absellipse=function(t,e,r,n,i,o,s,a){var u;return void 0===a&&(a=0),null===(u=this.currentPath)||void 0===u||u.absellipse(t,e,r,n,i,o,s,a),this},t.prototype.quadraticCurveTo=function(t,e,r,n){var i;return null===(i=this.currentPath)||void 0===i||i.quadraticCurveTo(t,e,r,n),this},t.prototype.bezierCurveTo=function(t,e,r,n,i,o){var s;return null===(s=this.currentPath)||void 0===s||s.bezierCurveTo(t,e,r,n,i,o),this},t.prototype.splineThru=function(t){var e;return null===(e=this.currentPath)||void 0===e||e.splineThru(t),this},t.prototype.toShapes=function(t,e){function r(t){for(var e=[],r=0,n=t.length;r<n;r++){var i=t[r],s=new o.Shape;s.curves=i.curves,e.push(s)}return e}function n(t,e){for(var r=e.length,n=!1,i=r-1,o=0;o<r;i=o++){var s=e[i],a=e[o],u=a.x-s.x,p=a.y-s.y;if(Math.abs(p)>Number.EPSILON){if(p<0&&(s=e[o],u=-u,a=e[i],p=-p),t.y<s.y||t.y>a.y)continue;if(t.y==s.y){if(t.x==s.x)return!0}else{var h=p*(t.x-s.x)-u*(t.y-s.y);if(0==h)return!0;if(h<0)continue;n=!n}}else{if(t.y!=s.y)continue;if(a.x<=t.x&&t.x<=s.x||s.x<=t.x&&t.x<=a.x)return!0}}return n}var i,a,u,p=s.ShapeUtils.isClockWise,h=this.subPaths;if(0==h.length)return[];if(e)return r(h);var c=[];if(1==h.length)return a=h[0],(u=new o.Shape).curves=a.curves,c.push(u),c;var l=!p(h[0].getPoints());l=t?!l:l;var f,y,d=[],_=[],m=[],g=0;_[g]=void 0,m[g]=[];for(var v=0,x=h.length;v<x;v++)i=p(f=(a=h[v]).getPoints()),(i=t?!i:i)?(!l&&_[g]&&g++,_[g]={s:new o.Shape,p:f},_[g].s.curves=a.curves,l&&g++,m[g]=[]):m[g].push({h:a,p:f[0]});if(!_[0])return r(h);if(_.length>1){for(var b=!1,S=[],T=0,C=_.length;T<C;T++)d[T]=[];for(T=0,C=_.length;T<C;T++)for(var E=m[T],M=0;M<E.length;M++){for(var w=E[M],P=!0,A=0;A<_.length;A++)n(w.p,_[A].p)&&(T!=A&&S.push({froms:T,tos:A,hole:M}),P?(P=!1,d[A].push(w)):b=!0);P&&d[T].push(w)}S.length>0&&(b||(m=d))}v=0;for(var O=_.length;v<O;v++){u=_[v].s,c.push(u);for(var R=0,B=(y=m[v]).length;R<B;R++)u.holes.push(y[R].h)}return c},t.prototype.toJSON=function(){for(var t={subPaths:new Array},e=0,r=this.subPaths.length;e<r;e++){var n=this.subPaths[e];t.subPaths.push(n.toJSON())}return t},t.prototype.fromJSON=function(t){this.subPaths=[];for(var e=0,r=t.subPaths.length;e<r;e++){var n=t.subPaths[e];this.subPaths.push((new i.Path).fromJSON(n)),this.currentPath=this.subPaths[this.subPaths.length-1]}return this},t.prototype.toDataBuffer=function(t){return t.writeUint16(this.subPaths.length),this.subPaths.forEach((function(e){e.toDataBuffer(t)})),this},t.prototype.fromDataBuffer=function(t){for(var e=t.readUint16(),r=0;r<e;++r){var n=(new i.Path).fromDataBuffer(t);this.subPaths.push(n),this.currentPath=this.subPaths[this.subPaths.length-1]}return this},t}();e.ShapePath=a},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.IOBuffer=void 0;var n=r(53),i=function(){function t(e){var r=!1;"number"==typeof e?e=new ArrayBuffer(e):(r=!0,this.lastWrittenByte=e.byteLength);var n=e.byteLength-0,i=0;(ArrayBuffer.isView(e)||e instanceof t)&&(e.byteLength!=e.buffer.byteLength&&(i=e.byteOffset+0),e=e.buffer),this.lastWrittenByte=r?n:0,this.buffer=e,this.length=n,this.byteLength=n,this.byteOffset=i,this.offset=0,this.littleEndian=!0,this._data=new DataView(this.buffer,i,n),this._mark=0,this._marks=[]}return t.prototype.available=function(t){return void 0===t&&(t=1),this.offset+t<=this.length},t.prototype.isLittleEndian=function(){return this.littleEndian},t.prototype.setLittleEndian=function(){return this.littleEndian=!0,this},t.prototype.isBigEndian=function(){return!this.littleEndian},t.prototype.setBigEndian=function(){return this.littleEndian=!1,this},t.prototype.skip=function(t){return void 0===t&&(t=1),this.offset+=t,this},t.prototype.seek=function(t){return this.offset=t,this},t.prototype.mark=function(){return this._mark=this.offset,this},t.prototype.reset=function(){return this.offset=this._mark,this},t.prototype.pushMark=function(){return this._marks.push(this.offset),this},t.prototype.popMark=function(){var t=this._marks.pop();if(null==t)throw new Error("Mark stack empty");return this.seek(t),this},t.prototype.rewind=function(){return this.offset=0,this},t.prototype.ensureAvailable=function(t){if(void 0===t&&(t=1),!this.available(t)){var e=2*(this.offset+t),r=new Uint8Array(e);r.set(new Uint8Array(this.buffer)),this.buffer=r.buffer,this.length=this.byteLength=e,this._data=new DataView(this.buffer)}return this},t.prototype.readBoolean=function(){return 0!=this.readUint8()},t.prototype.readInt8=function(){return this._data.getInt8(this.offset++)},t.prototype.readUint8=function(){return this._data.getUint8(this.offset++)},t.prototype.readByte=function(){return this.readUint8()},t.prototype.readBytes=function(t){void 0===t&&(t=1);for(var e=new Uint8Array(t),r=0;r<t;r++)e[r]=this.readByte();return e},t.prototype.readInt16=function(){var t=this._data.getInt16(this.offset,this.littleEndian);return this.offset+=2,t},t.prototype.readUint16=function(){var t=this._data.getUint16(this.offset,this.littleEndian);return this.offset+=2,t},t.prototype.readInt32=function(){var t=this._data.getInt32(this.offset,this.littleEndian);return this.offset+=4,t},t.prototype.readUint32=function(){var t=this._data.getUint32(this.offset,this.littleEndian);return this.offset+=4,t},t.prototype.readFloat32=function(){var t=this._data.getFloat32(this.offset,this.littleEndian);return this.offset+=4,t},t.prototype.readFloat64=function(){var t=this._data.getFloat64(this.offset,this.littleEndian);return this.offset+=8,t},t.prototype.readChar=function(){return String.fromCharCode(this.readInt8())},t.prototype.readChars=function(t){void 0===t&&(t=1);for(var e="",r=0;r<t;r++)e+=this.readChar();return e},t.prototype.readUtf8=function(t){void 0===t&&(t=1);var e=this.readChars(t);return n.decode(e)},t.prototype.writeBoolean=function(t){return this.writeUint8(t?255:0),this},t.prototype.writeInt8=function(t){return this.ensureAvailable(1),this._data.setInt8(this.offset++,t),this._updateLastWrittenByte(),this},t.prototype.writeUint8=function(t){return this.ensureAvailable(1),this._data.setUint8(this.offset++,t),this._updateLastWrittenByte(),this},t.prototype.writeByte=function(t){return this.writeUint8(t)},t.prototype.writeBytes=function(t){this.ensureAvailable(t.length);for(var e=0;e<t.length;e++)this._data.setUint8(this.offset++,t[e]);return this._updateLastWrittenByte(),this},t.prototype.writeInt16=function(t){return this.ensureAvailable(2),this._data.setInt16(this.offset,t,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this},t.prototype.writeUint16=function(t){return this.ensureAvailable(2),this._data.setUint16(this.offset,t,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this},t.prototype.writeInt32=function(t){return this.ensureAvailable(4),this._data.setInt32(this.offset,t,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this},t.prototype.writeUint32=function(t){return this.ensureAvailable(4),this._data.setUint32(this.offset,t,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this},t.prototype.writeFloat32=function(t){return this.ensureAvailable(4),this._data.setFloat32(this.offset,t,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this},t.prototype.writeFloat64=function(t){return this.ensureAvailable(8),this._data.setFloat64(this.offset,t,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this},t.prototype.writeChar=function(t){return this.writeUint8(t.charCodeAt(0))},t.prototype.writeChars=function(t){for(var e=0;e<t.length;e++)this.writeUint8(t.charCodeAt(e));return this},t.prototype.writeUtf8=function(t){var e=n.encode(t);return this.writeChars(e)},t.prototype.toArray=function(){return new Uint8Array(this.buffer,this.byteOffset,this.lastWrittenByte)},t.prototype._updateLastWrittenByte=function(){this.offset>this.lastWrittenByte&&(this.lastWrittenByte=this.offset)},t}();e.IOBuffer=i},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Earcut=void 0;var n=function(){function t(){}return t.earcut=function(t,e,r){void 0===e&&(e=null),void 0===r&&(r=2);var n,i,u,p,h,c,y,d=e&&e.length,m=d&&e?e[0]*r:t.length,g=o(t,0,m,r,!0),v=new Array;if(!g||g.next==g.prev)return v;if(d&&e&&(g=function(t,e,r,n){var i,a,u,p,h,c=[];for(i=0,a=e.length;i<a;i++)u=e[i]*n,p=i<a-1?e[i+1]*n:t.length,(h=o(t,u,p,n,!1))==h.next&&(h.steiner=!0),c.push(_(h));for(c.sort(l),i=0;i<c.length;i++)f(c[i],r),r=s(r,r.next);return r}(t,e,g,r)),t.length>80*r){n=u=t[0],i=p=t[1];for(var x=r;x<m;x+=r)(h=t[x])<n&&(n=h),(c=t[x+1])<i&&(i=c),h>u&&(u=h),c>p&&(p=c);y=0!=(y=Math.max(u-n,p-i))?1/y:0}return a(g,v,r,n,i,y),v},t.trianglesArea=function(t,e,r){void 0===r&&(r=2);for(var n=0,i=0;i<e.length;i+=3){var o=e[i]*r,s=e[i+1]*r,a=e[i+2]*r;n+=Math.abs((t[o]-t[a])*(t[s+1]-t[o+1])-(t[o]-t[s])*(t[a+1]-t[o+1]))}return.5*n},t.deviation=function(t,e,r,n){void 0===r&&(r=2);var i=e&&e.length,o=i?e[0]*r:t.length,s=Math.abs(P(t,0,o,r));if(i)for(var a=0,u=e.length;a<u;a++){var p=e[a]*r,h=a<u-1?e[a+1]*r:t.length;s-=Math.abs(P(t,p,h,r))}var c=0;for(a=0;a<n.length;a+=3){var l=n[a]*r,f=n[a+1]*r,y=n[a+2]*r;c+=Math.abs((t[l]-t[y])*(t[f+1]-t[l+1])-(t[l]-t[f])*(t[y+1]-t[l+1]))}return 0==s&&0==c?0:Math.abs((c-s)/s)},t.flatten=function(t){for(var e=t[0][0].length,r={vertices:new Array,holes:new Array,dimensions:e},n=0,i=0;i<t.length;i++){for(var o=0;o<t[i].length;o++)for(var s=0;s<e;s++)r.vertices.push(t[i][o][s]);i>0&&(n+=t[i-1].length,r.holes.push(n))}return r},t}();e.Earcut=n;var i=function(t,e,r){this.i=t,this.x=e,this.y=r,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1};function o(t,e,r,n,i){var o=null;if(i==P(t,e,r,n)>0)for(var s=e;s<r;s+=n)o=M(s,t[s],t[s+1],o);else for(s=r-n;s>=e;s-=n)o=M(s,t[s],t[s+1],o);return o&&x(o,o.next)&&(w(o),o=o.next),o}function s(t,e){if(void 0===e&&(e=null),!t)return t;e||(e=t);var r,n=t;do{if(r=!1,n.steiner||!x(n,n.next)&&0!=v(n.prev,n,n.next))n=n.next;else{if(w(n),(n=e=n.prev)==n.next)break;r=!0}}while(r||n!=e);return e}function a(t,e,r,n,i,o,l){if(void 0===l&&(l=0),t){!l&&o&&function(t,e,r,n){var i=t;do{null==i.z&&(i.z=d(i.x,i.y,e,r,n)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next}while(i!=t);i.prevZ.nextZ=null,i.prevZ=null,function(t){var e,r,n,i,o,s,a,u,p=1;do{for(r=t,t=null,o=null,s=0;r;){for(s++,n=r,a=0,e=0;e<p&&(a++,n=n.nextZ);e++);for(u=p;a>0||u>0&&n;)0!=a&&(0==u||!n||r.z<=n.z)?(i=r,r=r.nextZ,a--):(i=n,n=n.nextZ,u--),o?o.nextZ=i:t=i,i.prevZ=o,o=i;r=n}o.nextZ=null,p*=2}while(s>1)}(i)}(t,n,i,o);for(var f,y,_=t;t.prev!=t.next;)if(f=t.prev,y=t.next,o?p(t,n,i,o):u(t))e.push(f.i/r),e.push(t.i/r),e.push(y.i/r),w(t),t=y.next,_=y.next;else if((t=y)==_){l?1==l?a(t=h(s(t),e,r),e,r,n,i,o,2):2==l&&c(t,e,r,n,i,o):a(s(t),e,r,n,i,o,1);break}}}function u(t){var e=t.prev,r=t,n=t.next;if(v(e,r,n)>=0)return!1;for(var i=t.next.next;i!=t.prev;){if(m(e.x,e.y,r.x,r.y,n.x,n.y,i.x,i.y)&&v(i.prev,i,i.next)>=0)return!1;i=i.next}return!0}function p(t,e,r,n){var i=t.prev,o=t,s=t.next;if(v(i,o,s)>=0)return!1;for(var a=i.x<o.x?i.x<s.x?i.x:s.x:o.x<s.x?o.x:s.x,u=i.y<o.y?i.y<s.y?i.y:s.y:o.y<s.y?o.y:s.y,p=i.x>o.x?i.x>s.x?i.x:s.x:o.x>s.x?o.x:s.x,h=i.y>o.y?i.y>s.y?i.y:s.y:o.y>s.y?o.y:s.y,c=d(a,u,e,r,n),l=d(p,h,e,r,n),f=t.prevZ,y=t.nextZ;f&&f.z>=c&&y&&y.z<=l;){if(f!=t.prev&&f!=t.next&&m(i.x,i.y,o.x,o.y,s.x,s.y,f.x,f.y)&&v(f.prev,f,f.next)>=0)return!1;if(f=f.prevZ,y!=t.prev&&y!=t.next&&m(i.x,i.y,o.x,o.y,s.x,s.y,y.x,y.y)&&v(y.prev,y,y.next)>=0)return!1;y=y.nextZ}for(;f&&f.z>=c;){if(f!=t.prev&&f!=t.next&&m(i.x,i.y,o.x,o.y,s.x,s.y,f.x,f.y)&&v(f.prev,f,f.next)>=0)return!1;f=f.prevZ}for(;y&&y.z<=l;){if(y!=t.prev&&y!=t.next&&m(i.x,i.y,o.x,o.y,s.x,s.y,y.x,y.y)&&v(y.prev,y,y.next)>=0)return!1;y=y.nextZ}return!0}function h(t,e,r){var n=t;do{var i=n.prev,o=n.next.next;!x(i,o)&&b(i,n,n.next,o)&&C(i,o)&&C(o,i)&&(e.push(i.i/r),e.push(n.i/r),e.push(o.i/r),w(n),w(n.next),n=t=o),n=n.next}while(n!=t);return s(n)}function c(t,e,r,n,i,o){var u=t;do{for(var p=u.next.next;p!=u.prev;){if(u.i!=p.i&&g(u,p)){var h=E(u,p);return u=s(u,u.next),h=s(h,h.next),a(u,e,r,n,i,o),void a(h,e,r,n,i,o)}p=p.next}u=u.next}while(u!=t)}function l(t,e){return t.x-e.x}function f(t,e){var r=function(t,e){var r,n=e,i=t.x,o=t.y,s=-1/0;do{if(o<=n.y&&o>=n.next.y&&n.next.y!=n.y){var a=n.x+(o-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(a<=i&&a>s){if(s=a,a==i){if(o==n.y)return n;if(o==n.next.y)return n.next}r=n.x<n.next.x?n:n.next}}n=n.next}while(n!=e);if(!r)return null;if(i==s)return r;var u,p=r,h=r.x,c=r.y,l=1/0;n=r;do{i>=n.x&&n.x>=h&&i!=n.x&&m(o<c?i:s,o,h,c,o<c?s:i,o,n.x,n.y)&&(u=Math.abs(o-n.y)/(i-n.x),C(n,t)&&(u<l||u==l&&(n.x>r.x||n.x==r.x&&y(r,n)))&&(r=n,l=u)),n=n.next}while(n!=p);return r}(t,e);if(r){var n=E(r,t);s(r,r.next),s(n,n.next)}}function y(t,e){return v(t.prev,t,e.prev)<0&&v(e.next,t,t.next)<0}function d(t,e,r,n,i){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-r)*i)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-n)*i)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function _(t){var e=t,r=t;do{(e.x<r.x||e.x==r.x&&e.y<r.y)&&(r=e),e=e.next}while(e!=t);return r}function m(t,e,r,n,i,o,s,a){return(i-s)*(e-a)-(t-s)*(o-a)>=0&&(t-s)*(n-a)-(r-s)*(e-a)>=0&&(r-s)*(o-a)-(i-s)*(n-a)>=0}function g(t,e){return t.next.i!=e.i&&t.prev.i!=e.i&&!function(t,e){var r=t;do{if(r.i!=t.i&&r.next.i!=t.i&&r.i!=e.i&&r.next.i!=e.i&&b(r,r.next,t,e))return!0;r=r.next}while(r!=t);return!1}(t,e)&&(C(t,e)&&C(e,t)&&function(t,e){var r=t,n=!1,i=(t.x+e.x)/2,o=(t.y+e.y)/2;do{r.y>o!=r.next.y>o&&r.next.y!=r.y&&i<(r.next.x-r.x)*(o-r.y)/(r.next.y-r.y)+r.x&&(n=!n),r=r.next}while(r!=t);return n}(t,e)&&(v(t.prev,t,e.prev)||v(t,e.prev,e))||x(t,e)&&v(t.prev,t,t.next)>0&&v(e.prev,e,e.next)>0)}function v(t,e,r){return(e.y-t.y)*(r.x-e.x)-(e.x-t.x)*(r.y-e.y)}function x(t,e){return t.x==e.x&&t.y==e.y}function b(t,e,r,n){var i=T(v(t,e,r)),o=T(v(t,e,n)),s=T(v(r,n,t)),a=T(v(r,n,e));return i!=o&&s!=a||(!(0!=i||!S(t,r,e))||(!(0!=o||!S(t,n,e))||(!(0!=s||!S(r,t,n))||!(0!=a||!S(r,e,n)))))}function S(t,e,r){return e.x<=Math.max(t.x,r.x)&&e.x>=Math.min(t.x,r.x)&&e.y<=Math.max(t.y,r.y)&&e.y>=Math.min(t.y,r.y)}function T(t){return t>0?1:t<0?-1:0}function C(t,e){return v(t.prev,t,t.next)<0?v(t,e,t.next)>=0&&v(t,t.prev,e)>=0:v(t,e,t.prev)<0||v(t,t.next,e)<0}function E(t,e){var r=new i(t.i,t.x,t.y),n=new i(e.i,e.x,e.y),o=t.next,s=e.prev;return t.next=e,e.prev=t,r.next=o,o.prev=r,n.next=r,r.prev=n,s.next=n,n.prev=s,n}function M(t,e,r,n){var o=new i(t,e,r);return n?(o.next=n.next,o.prev=n,n.next.prev=o,n.next=o):(o.prev=o,o.next=o),o}function w(t){t.next&&(t.next.prev=t.prev),t.prev&&(t.prev.next=t.next),t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function P(t,e,r,n){for(var i=0,o=e,s=r-n;o<r;o+=n)i+=(t[s]-t[o])*(t[o+1]+t[s+1]),s=o;return i}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Event=void 0;var n=function(){function t(t){this.type=t,this.removed=!1,this.propagationStopped=!1}return t.prototype.remove=function(){return this.removed=!0,this},t}();e.Event=n},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.EventDispatcher=void 0;var n=function(){function t(){this._listeners=new Map}return t.prototype.hasEventListener=function(t){return this._listeners.has(t)},t.prototype.addEventListener=function(t,e){var r=this._listeners,n=r.get(t);return n&&(this.removeEventListener(t,e),n=r.get(t)),n||(n=new Array,r.set(t,n)),n.push(e),e},t.prototype.removeEventListener=function(t,e){var r=this._listeners;if(r){var n=r.get(t);if(n){var i=n.indexOf(e);i>=0&&n.splice(i,1),n.length<=0&&r.delete(t)}}},t.prototype.removeAllEventListeners=function(t){t?this._listeners&&this._listeners.delete(t):this._listeners.clear()},t.prototype.dispatchEvent=function(t){t.target=this,t.removed=!1;var e=this._listeners.get(t.type);if(e&&!(e.length<=0))for(var r=(e=e.slice()).length,n=0;n<r&&!t.propagationStopped;n++){var i=e[n];null!=i.handleEvent?i.handleEvent(t):(i=i)(t),t.removed&&(this.removeEventListener(t.type,i),t.removed=!1)}},t.prototype.dispose=function(){this._listeners.clear(),delete this._listeners},t}();e.EventDispatcher=n},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Viewport=void 0;var n=function(){function t(t,e,r,n){this.x=t,this.y=e,this.width=r,this.height=n}return t.prototype.toGlobal=function(e,r){return new t(this.x*e,this.y*r,this.width*e,this.height*r)},t.prototype.toGlobalToRef=function(t,e,r){return r.x=this.x*t,r.y=this.y*e,r.width=this.width*t,r.height=this.height*e,this},t.prototype.clone=function(){return new t(this.x,this.y,this.width,this.height)},t}();e.Viewport=n},function(t,e,r){"use strict";var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(e,"__esModule",{value:!0}),e.OrthographicCamera=void 0;var o=function(t){function e(e,r,n,i,o,s,a,u,p,h){void 0===r&&(r=!0),void 0===n&&(n=null),void 0===i&&(i=""),void 0===o&&(o=-1),void 0===s&&(s=1),void 0===a&&(a=1),void 0===u&&(u=-1),void 0===p&&(p=.1),void 0===h&&(h=2e3);var c=t.call(this,e,r,n,i)||this;return c.left=o,c.right=s,c.top=a,c.bottom=u,c.near=p,c.far=h,c.aspect=(c.right-c.left)/(c.top-c.bottom),c}return i(e,t),Object.defineProperty(e.prototype,"left",{get:function(){return this._left},set:function(t){this._left!=t&&(this._left=t,this._needsUpdateCameraMatrix=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"right",{get:function(){return this._right},set:function(t){this._right!=t&&(this._right=t,this._needsUpdateCameraMatrix=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"top",{get:function(){return this._top},set:function(t){this._top!=t&&(this._top=t,this._needsUpdateCameraMatrix=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"bottom",{get:function(){return this._bottom},set:function(t){this._bottom!=t&&(this._bottom=t,this._needsUpdateCameraMatrix=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"near",{get:function(){return this._near},set:function(t){this._near!=t&&(this._near=t,this._needsUpdateCameraMatrix=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"far",{get:function(){return this._far},set:function(t){this._far!=t&&(this._far=t,this._needsUpdateCameraMatrix=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"aspect",{get:function(){return this._aspect},set:function(t){this._aspect!=t&&(this._aspect=t,this._needsUpdateCameraMatrix=!0)},enumerable:!1,configurable:!0}),e.prototype.updateProjectionMatrix=function(){this._needsUpdateCameraMatrix=!1;var t=(this.right-this.left)/2,e=(this.top-this.bottom)/2,r=(this.right+this.left)/2,n=(this.top+this.bottom)/2,i=r-t,o=r+t,s=n+e,a=n-e;this._projectionMatrix.makeOrthographic(i,o,s,a,this.near,this.far),this._projectionMatrixInverse.getInverse(this._projectionMatrix),this._viewProjectionMatrix.multiplyMatrices(this._projectionMatrix,this._matrixWorldInverse),this._viewProjectionMatrixInverse.getInverse(this._viewProjectionMatrix),this._frustum.setFromProjectionMatrix(this._viewProjectionMatrix)},e}(r(41).Camera);e.OrthographicCamera=o},function(t,e,r){"use strict";var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(e,"__esModule",{value:!0}),e.PerspectiveCamera=void 0;var o=r(41),s=r(4),a=function(t){function e(e,r,n,i,o,s,a,u){void 0===r&&(r=!0),void 0===n&&(n=null),void 0===i&&(i=""),void 0===o&&(o=50),void 0===s&&(s=1),void 0===a&&(a=.1),void 0===u&&(u=2e3);var p=t.call(this,e,r,n,i)||this;return p._fov=o,p._aspect=s,p._near=a,p._far=u,p._filmGauge=35,p._filmOffset=0,p.updateProjectionMatrix(),p}return i(e,t),Object.defineProperty(e.prototype,"fov",{get:function(){return this._fov},set:function(t){this._fov!=t&&(this._fov=t,this._needsUpdateCameraMatrix=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"aspect",{get:function(){return this._aspect},set:function(t){this._aspect!=t&&(this._aspect=t,this._needsUpdateCameraMatrix=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"near",{get:function(){return this._near},set:function(t){this._near!=t&&(this._near=t,this._needsUpdateCameraMatrix=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"far",{get:function(){return this._far},set:function(t){this._far!=t&&(this._far=t,this._needsUpdateCameraMatrix=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"filmGauge",{get:function(){return this._filmGauge},set:function(t){this._filmGauge!=t&&(this._filmGauge=t,this._needsUpdateCameraMatrix=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"filmOffset",{get:function(){return this._filmOffset},set:function(t){this._filmOffset!=t&&(this._filmOffset=t,this._needsUpdateCameraMatrix=!0)},enumerable:!1,configurable:!0}),e.prototype.setFocalLength=function(t){var e=.5*this.getFilmHeight()/t;return this.fov=2*s.MathUtils.RAD2DEG*Math.atan(e),this.updateProjectionMatrix(),this},e.prototype.getFocalLength=function(){var t=Math.tan(.5*s.MathUtils.DEG2RAD*this.fov);return.5*this.getFilmHeight()/t},e.prototype.getEffectiveFOV=function(){return 2*s.MathUtils.RAD2DEG*Math.atan(Math.tan(.5*s.MathUtils.DEG2RAD*this.fov))},e.prototype.getFilmWidth=function(){return this.filmGauge*Math.min(this.aspect,1)},e.prototype.getFilmHeight=function(){return this.filmGauge/Math.max(this.aspect,1)},e.prototype.updateProjectionMatrix=function(){this._needsUpdateCameraMatrix=!1;var t=this.near,e=t*Math.tan(.5*s.MathUtils.DEG2RAD*this.fov)/this.zoom,r=2*e,n=this.aspect*r,i=-.5*n,o=this.filmOffset;0!=o&&(i+=t*o/this.getFilmWidth()),this._projectionMatrix.makePerspective(i,i+n,e,e-r,t,this.far),this._projectionMatrixInverse.getInverse(this._projectionMatrix),this._viewProjectionMatrix.multiplyMatrices(this._projectionMatrix,this._matrixWorldInverse),this._viewProjectionMatrixInverse.getInverse(this._viewProjectionMatrix),this._frustum.setFromProjectionMatrix(this._viewProjectionMatrix)},e}(o.Camera);e.PerspectiveCamera=a},function(t,e,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(t,e,r,n){void 0===n&&(n=r),Object.defineProperty(t,n,{enumerable:!0,get:function(){return e[r]}})}:function(t,e,r,n){void 0===n&&(n=r),t[n]=e[r]}),i=this&&this.__exportStar||function(t,e){for(var r in t)"default"===r||e.hasOwnProperty(r)||n(e,t,r)};Object.defineProperty(e,"__esModule",{value:!0}),i(r(6),e),i(r(31),e)},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.CSGProperties=void 0;var n=function(){function t(){}return t.transformObj=function(e,r,n){for(var i in e)if("_transform"!=i&&"_merge"!=i){var o=e[i],s=o;"object"==typeof o&&("transform"in o&&"function"==typeof o.transform?s=o.transform(n):o instanceof Array?(s=[],t.transformObj(o,s,n)):o instanceof t&&(s=new t,t.transformObj(o,s,n))),r[i]=s}},t.cloneObj=function(e,r){for(var n in e)if("_transform"!=n&&"_merge"!=n){var i=e[n],o=i;if("object"==typeof i)if(i instanceof Array){o=[];for(var s=0;s<i.length;s++)o.push(i[s])}else i instanceof t&&(o=new t,t.cloneObj(i,o));r[n]=o}},t.addFrom=function(e,r){for(var n in r)"_transform"!=n&&"_merge"!=n&&(n in e&&"object"==typeof e[n]&&e[n]instanceof t&&"object"==typeof r[n]&&r[n]instanceof t?t.addFrom(e[n],r[n]):n in e||(e[n]=r[n]))},t.prototype._transform=function(e){var r=new t;return t.transformObj(this,r,e),r},t.prototype._merge=function(e){var r=new t;return t.cloneObj(this,r),t.addFrom(r,e),r},t}();e.CSGProperties=n},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.CAGFuzzyFactory=void 0;var n=r(77),i=r(56),o=r(31),s=function(){function t(){this.vertexfactory=new n.CSGFuzzyFactory(2,1e-5)}return t.prototype.getVertex=function(t){var e=[t.pos._x,t.pos._y];return this.vertexfactory.lookupOrCreate(e,(function(e){return t}))},t.prototype.getSide=function(t){var e=this.getVertex(t.vertex0),r=this.getVertex(t.vertex1);return new i.CAGSide(e,r)},t.prototype.getCAG=function(t){var e=this,r=t.sides.map((function(t){return e.getSide(t)})).filter((function(t){return t.length()>1e-5}));return o.CAG.fromSides(r)},t}();e.CAGFuzzyFactory=s},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.CSGPath2D=void 0;var n=r(14),i=r(7),o=r(8),s=r(9),a=r(55),u=r(56),p=r(6),h=r(31),c=function(){function t(t,e){t=t||[];var r=null;(e=!!e)&&t.length>0&&(r=new n.CSGVector2D(t[t.length-1]));var i=[];t.map((function(t){var e=new n.CSGVector2D(t),o=!1;null!=r&&(o=e.distanceTo(r)<1e-5);o||i.push(e),r=e})),this.points=i,this.closed=e}return t.arc=function(e){for(var r=p.CSG.parseOptionAs2DVector(e,"center",0),i=p.CSG.parseOptionAsFloat(e,"radius",1),o=p.CSG.parseOptionAsFloat(e,"startangle",0),s=p.CSG.parseOptionAsFloat(e,"endangle",360),a=p.CSG.parseOptionAsInt(e,"resolution",p.CSG.defaultResolution2D),u=p.CSG.parseOptionAsBool(e,"maketangent",!1);s-o>=720;)s-=360;for(;s-o<=-720;)s+=360;var h,c=[],l=Math.abs(s-o);if(l<1e-5)h=n.CSGVector2D.fromAngle(o/180*Math.PI).times(i),c.push(h.plus(r));else{var f=Math.floor(a*l/360)+1,y=.5*f/l;y>.25&&(y=.25);for(var d=u?f+2:f,_=0;_<=d;_++){var m=_;u&&((m=(_-1)*(f-2*y)/f+y)<0&&(m=0),m>f&&(m=f));var g=o+m*(s-o)/f;h=n.CSGVector2D.fromAngle(g/180*Math.PI).times(i),c.push(h.plus(r))}}return new t(c,!1)},t.prototype.concat=function(e){if(this.closed||e.closed)throw new Error("Paths must not be closed");return new t(this.points.concat(e.points))},t.prototype.appendPoint=function(e){if(this.closed)throw new Error("Path must not be closed");return e=new n.CSGVector2D(e),new t(this.points.concat([e]))},t.prototype.appendPoints=function(e){if(this.closed)throw new Error("Path must not be closed");var r=this.points;return e.forEach((function(t){r.push(new n.CSGVector2D(t))})),new t(r)},t.prototype.close=function(){return new t(this.points,!0)},t.prototype.rectangularExtrude=function(t,e,r){return this.expandToCAG(t/2,r).extrude({offset:[0,0,e]})},t.prototype.expandToCAG=function(t,e){var r,n=[],i=this.points.length,o=0;this.closed&&i>2&&(o=-1);for(var s=o;s<i;s++){var p=s;p<0&&(p=i-1);var c=this.points[p],l=new a.CAGVertex(c);if(s>o){var f=new u.CAGSide(r,l);n.push(f)}r=l}return h.CAG.fromSides(n).expandedShell(t,e)},t.prototype.innerToCAG=function(){if(!this.closed)throw new Error("The path should be closed!");return h.CAG.fromPoints(this.points)},t.prototype.transform=function(e){return new t(this.points.map((function(t){return t.multiply4x4(e)})),this.closed)},t.prototype.appendBezier=function(e,r){if(arguments.length<2&&(r={}),this.closed)throw new Error("Path must not be closed");if(!(e instanceof Array))throw new Error("appendBezier: should pass an array of control points");if(e.length<1)throw new Error("appendBezier: need at least 1 control point");if(this.points.length<1)throw new Error("appendBezier: path must already contain a point (the endpoint of the path is used as the starting point for the bezier curve)");var i=p.CSG.parseOptionAsInt(r,"resolution",p.CSG.defaultResolution2D);i<4&&(i=4);var o=[],s=[];s.push(this.points[this.points.length-1]);for(var a=0;a<e.length;++a){var u=e[a];if(null==u){if(0!=a)throw new Error("appendBezier: null can only be passed as the first control point");if(e.length<2)throw new Error("appendBezier: null can only be passed if there is at least one more control point");var h=void 0;"lastBezierControlPoint"in this&&(h=this.lastBezierControlPoint),u=this.points[this.points.length-1].times(2).minus(h)}else u=new n.CSGVector2D(u);s.push(u)}var c=s.length-1,l=1;for(a=0;a<=c;++a)a>0&&(l*=a),o.push(l);var f=[];for(a=0;a<=c;++a){var y=o[c]/(o[a]*o[c-a]);f.push(y)}var d=function(t){for(var e=1,r=Math.pow(1-t,c),i=1!=t?1/(1-t):1,o=new n.CSGVector2D(0,0),a=0;a<=c;++a){a==c&&(r=1);var u=f[a]*e*r;o=o.plus(s[a].times(u)),e*=t,r*=i}return o},_=[],m=[],g=c+1;for(a=0;a<g;++a){var v=a/(g-1),x=d(v);_.push(x),m.push(v)}for(var b=1,S=2*Math.PI/i,T=Math.sin(S);b<_.length-1;){var C=_[b].minus(_[b-1]).unit(),E=_[b+1].minus(_[b]).unit(),M=C.cross(E);if(Math.abs(M)>T){var w=m[b-1],P=m[b+1],A=w+1*(P-w)/3,O=w+2*(P-w)/3,R=d(A),B=d(O);_.splice(b,1,R,B),m.splice(b,1,A,O),--b<1&&(b=1)}else++b}var I=new t(_=this.points.concat(_.slice(1)));return I.lastBezierControlPoint=s[s.length-2],I},t.prototype.appendArc=function(e,r){var i=1e5;if(arguments.length<2&&(r={}),this.closed)throw new Error("Path must not be closed");if(this.points.length<1)throw new Error("appendArc: path must already contain a point (the endpoint of the path is used as the starting point for the arc)");var o,s,a=p.CSG.parseOptionAsInt(r,"resolution",p.CSG.defaultResolution2D);if(a<4&&(a=4),"xradius"in r||"yradius"in r){if("radius"in r)throw new Error("Should either give an xradius and yradius parameter, or a radius parameter");o=p.CSG.parseOptionAsFloat(r,"xradius",0),s=p.CSG.parseOptionAsFloat(r,"yradius",0)}else s=o=p.CSG.parseOptionAsFloat(r,"radius",0);var u=p.CSG.parseOptionAsFloat(r,"xaxisrotation",0),h=p.CSG.parseOptionAsBool(r,"clockwise",!1),c=p.CSG.parseOptionAsBool(r,"large",!1),l=this.points[this.points.length-1];e=new n.CSGVector2D(e),o=Math.round(o*i)/i,s=Math.round(s*i)/i,e=new n.CSGVector2D(Math.round(e.x*i)/i,Math.round(e.y*i)/i);var f=!h,y=[];if(0==o||0==s)y.push(e);else{o=Math.abs(o),s=Math.abs(s);var d=u*Math.PI/180,_=Math.cos(d),m=Math.sin(d),g=l.minus(e).times(.5),v=Math.round((_*g.x+m*g.y)*i)/i,x=Math.round((-m*g.x+_*g.y)*i)/i,b=new n.CSGVector2D(v,x),S=b.x*b.x/(o*o)+b.y*b.y/(s*s);if(S>1){var T=Math.sqrt(S);o*=T,s*=T,o=Math.round(o*i)/i,s=Math.round(s*i)/i}var C=Math.sqrt((o*o*s*s-o*o*b.y*b.y-s*s*b.x*b.x)/(o*o*b.y*b.y+s*s*b.x*b.x));f==c&&(C=-C);var E=new n.CSGVector2D(o*b.y/s,-s*b.x/o).times(C),M=new n.CSGVector2D(_*E.x-m*E.y,m*E.x+_*E.y).plus(l.plus(e).times(.5)),w=new n.CSGVector2D((b.x-E.x)/o,(b.y-E.y)/s),P=new n.CSGVector2D((-b.x-E.x)/o,(-b.y-E.y)/s),A=w.angleRadians(),O=P.angleRadians(),R=O-A;R%=2*Math.PI,!f&&R>0?R-=2*Math.PI:f&&R<0&&(R+=2*Math.PI);var B=Math.ceil(Math.abs(R)/(2*Math.PI)*a)+1;B<1&&(B=1);for(var I=1;I<=B;I++){var N=A+I/B*R,F=Math.cos(N),G=Math.sin(N),D=new n.CSGVector2D(_*o*F-m*s*G,m*o*F+_*s*G).plus(M);y.push(D)}}var V=new t(y=this.points.concat(y));return V},t.prototype.mirrored=function(t){return this.transform(i.CSGMatrix4x4.mirroring(t))},t.prototype.mirroredX=function(){var t=new o.CSGPlane(s.CSGVector3D.Create(1,0,0),0);return this.mirrored(t)},t.prototype.mirroredY=function(){var t=new o.CSGPlane(s.CSGVector3D.Create(0,1,0),0);return this.mirrored(t)},t.prototype.mirroredZ=function(){var t=new o.CSGPlane(s.CSGVector3D.Create(0,0,1),0);return this.mirrored(t)},t.prototype.translate=function(t){return this.transform(i.CSGMatrix4x4.translation(t))},t.prototype.scale=function(t){return this.transform(i.CSGMatrix4x4.scaling(t))},t.prototype.rotateX=function(t){return this.transform(i.CSGMatrix4x4.rotationX(t))},t.prototype.rotateY=function(t){return this.transform(i.CSGMatrix4x4.rotationY(t))},t.prototype.rotateZ=function(t){return this.transform(i.CSGMatrix4x4.rotationZ(t))},t.prototype.rotate=function(t,e,r){return this.transform(i.CSGMatrix4x4.rotation(t,e,r))},t.prototype.rotateEulerAngles=function(t,e,r,n){n=n||[0,0,0];var o=i.CSGMatrix4x4.rotationZ(t),a=i.CSGMatrix4x4.rotationX(e),u=i.CSGMatrix4x4.rotationZ(r),p=i.CSGMatrix4x4.translation(new s.CSGVector3D(n));return this.transform(u.multiply(a).multiply(o).multiply(p))},t}();e.CSGPath2D=c},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.CSGTree=void 0;var n=r(123),i=r(124),o=function(){function t(t){this.polygonTree=new n.CSGPolygonTreeNode,this.rootnode=new i.CSGNode(null),t&&this.addPolygons(t)}return t.prototype.invert=function(){this.polygonTree.invert(),this.rootnode.invert()},t.prototype.clipTo=function(t,e){e=!!e,this.rootnode.clipTo(t,e)},t.prototype.allPolygons=function(){var t=[];return this.polygonTree.getPolygons(t),t},t.prototype.addPolygons=function(t){var e=this,r=t.map((function(t){return e.polygonTree.addChild(t)}));this.rootnode.addPolygonTreeNodes(r)},t}();e.CSGTree=o},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.CSGPolygonTreeNode=void 0;var n=function(){function t(){this.parent=null,this.children=[],this.polygon=null,this.removed=!1}return t.prototype.addPolygons=function(t){if(!this.isRootNode())throw new Error("Assertion failed");var e=this;t.map((function(t){e.addChild(t)}))},t.prototype.remove=function(){if(!this.removed){this.removed=!0;var t=this.parent.children,e=t.indexOf(this);if(e<0)throw new Error("Assertion failed");t.splice(e,1),this.parent.recursivelyInvalidatePolygon()}},t.prototype.isRemoved=function(){return this.removed},t.prototype.isRootNode=function(){return!this.parent},t.prototype.invert=function(){if(!this.isRootNode())throw new Error("Assertion failed");this.invertSub()},t.prototype.getPolygon=function(){if(!this.polygon)throw new Error("Assertion failed");return this.polygon},t.prototype.getPolygons=function(t){var e,r,n,i,o=[this],s=[o];for(e=0;e<s.length;++e)for(r=0,n=(o=s[e]).length;r<n;r++)(i=o[r]).polygon?t.push(i.polygon):s.push(i.children)},t.prototype.splitByPlane=function(t,e,r,n,i){if(this.children.length){var o=[this.children],s=void 0,a=void 0,u=void 0,p=void 0,h=void 0;for(s=0;s<o.length;s++)for(a=0,u=(h=o[s]).length;a<u;a++)(p=h[a]).children.length?o.push(p.children):p._splitByPlane(t,e,r,n,i)}else this._splitByPlane(t,e,r,n,i)},t.prototype._splitByPlane=function(t,e,r,n,i){var o=this.polygon;if(o){var s=o.boundingSphere(),a=s[1]+1e-4,u=t.normal,p=s[0],h=u.dot(p)-t.w;if(h>a)n.push(this);else if(h<-a)i.push(this);else{var c=t.splitPolygon(o);switch(c.type){case 0:e.push(this);break;case 1:r.push(this);break;case 2:n.push(this);break;case 3:i.push(this);break;case 4:if(c.front){var l=this.addChild(c.front);n.push(l)}if(c.back){var f=this.addChild(c.back);i.push(f)}}}}},t.prototype.addChild=function(e){var r=new t;return r.parent=this,r.polygon=e,this.children.push(r),r},t.prototype.invertSub=function(){var t,e,r,n,i=[this],o=[i];for(t=0;t<o.length;t++)for(e=0,r=(i=o[t]).length;e<r;e++)(n=i[e]).polygon&&(n.polygon=n.polygon.flipped()),o.push(n.children)},t.prototype.recursivelyInvalidatePolygon=function(){for(var t=this;t.polygon;)t.polygon=null,t.parent&&(t=t.parent)},t}();e.CSGPolygonTreeNode=n},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.CSGNode=void 0;var n=function(){function t(t){this.polygontreenodes=[],this.parent=t}return t.prototype.invert=function(){for(var t,e=[this],r=0;r<e.length;r++){(t=e[r]).plane&&(t.plane=t.plane.flipped()),t.front&&e.push(t.front),t.back&&e.push(t.back);var n=t.front;t.front=t.back,t.back=n}},t.prototype.clipPolygons=function(t,e){var r,n={node:this,polygontreenodes:t},i=[];do{if(r=n.node,t=n.polygontreenodes,r.plane){for(var o=[],s=[],a=e?o:s,u=r.plane,p=t.length,h=0;h<p;h++){var c=t[h];c.isRemoved()||c.splitByPlane(u,a,o,s,o)}r.front&&s.length>0&&i.push({node:r.front,polygontreenodes:s});var l=o.length;if(r.back&&l>0)i.push({node:r.back,polygontreenodes:o});else for(h=0;h<l;h++)o[h].remove()}n=i.pop()}while(void 0!==n)},t.prototype.clipTo=function(t,e){var r=this,n=[];do{r.polygontreenodes.length>0&&t.rootnode.clipPolygons(r.polygontreenodes,e),r.front&&n.push(r.front),r.back&&n.push(r.back),r=n.pop()}while(void 0!==r)},t.prototype.addPolygonTreeNodes=function(e){var r,n={node:this,polygontreenodes:e},i=[];do{if(r=n.node,0!=(e=n.polygontreenodes).length){var o=r;if(!r.plane){var s=e[0].getPolygon().plane;r.plane=s}for(var a=[],u=[],p=0,h=e.length;p<h;++p)e[p].splitByPlane(o.plane,o.polygontreenodes,u,a,u);a.length>0&&(r.front||(r.front=new t(r)),i.push({node:r.front,polygontreenodes:a})),u.length>0&&(r.back||(r.back=new t(r)),i.push({node:r.back,polygontreenodes:u})),n=i.pop()}else n=i.pop()}while(void 0!==n)},t.prototype.getParentPlaneNormals=function(t,e){e>0&&this.parent&&(t.push(this.parent.plane.normal),this.parent.getParentPlaneNormals(t,e-1))},t}();e.CSGNode=n},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.CSGFuzzyCSGFactory=void 0;var n=r(77),i=r(30),o=r(6),s=function(){function t(){this.vertexfactory=new n.CSGFuzzyFactory(3,1e-5),this.planefactory=new n.CSGFuzzyFactory(4,1e-5),this.polygonsharedfactory={}}return t.prototype.getPolygonShared=function(t){var e=t.getHash();return e in this.polygonsharedfactory?this.polygonsharedfactory[e]:(this.polygonsharedfactory[e]=t,t)},t.prototype.getVertex=function(t){var e=[t.pos._x,t.pos._y,t.pos._z];return this.vertexfactory.lookupOrCreate(e,(function(e){return t}))},t.prototype.getPlane=function(t){var e=[t.normal._x,t.normal._y,t.normal._z,t.w];return this.planefactory.lookupOrCreate(e,(function(e){return t}))},t.prototype.getPolygon=function(t){var e=this.getPlane(t.plane),r=this.getPolygonShared(t.shared),n=this,o=t.vertices.map((function(t){return n.getVertex(t)})),s=[];if(o.length>0){var a=o[o.length-1].getTag();o.forEach((function(t){var e=t.getTag();e!=a&&s.push(t),a=e}))}return s.length<3&&(s=[]),new i.CSGPolygon(s,r,e)},t.prototype.getCSG=function(t){var e=this,r=[];return t.polygons.forEach((function(t){var n=e.getPolygon(t);n.vertices.length>=3&&r.push(n)})),o.CSG.fromPolygons(r)},t}();e.CSGFuzzyCSGFactory=s},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.GLConstants=void 0;var n=function(){function t(){}return t.glErrorString=function(e){switch(e){case t.NO_ERROR:return"NO_ERROR";case t.INVALID_ENUM:return"INVALID_ENUM";case t.INVALID_VALUE:return"INVALID_VALUE";case t.INVALID_OPERATION:return"INVALID_OPERATION";case t.OUT_OF_MEMORY:return"OUT_OF_MEMORY";default:return"UNKNOWN_ERROR"}},t.DEPTH_BUFFER_BIT=256,t.STENCIL_BUFFER_BIT=1024,t.COLOR_BUFFER_BIT=16384,t.POINTS=0,t.LINES=1,t.LINE_LOOP=2,t.LINE_STRIP=3,t.TRIANGLES=4,t.TRIANGLE_STRIP=5,t.TRIANGLE_FAN=6,t.ZERO=0,t.ONE=1,t.SRC_COLOR=768,t.ONE_MINUS_SRC_COLOR=769,t.SRC_ALPHA=770,t.ONE_MINUS_SRC_ALPHA=771,t.DST_ALPHA=772,t.ONE_MINUS_DST_ALPHA=773,t.DST_COLOR=774,t.ONE_MINUS_DST_COLOR=775,t.SRC_ALPHA_SATURATE=776,t.FUNC_ADD=32774,t.BLEND_EQUATION=32777,t.BLEND_EQUATION_RGB=32777,t.BLEND_EQUATION_ALPHA=34877,t.FUNC_SUBTRACT=32778,t.FUNC_REVERSE_SUBTRACT=32779,t.BLEND_DST_RGB=32968,t.BLEND_SRC_RGB=32969,t.BLEND_DST_ALPHA=32970,t.BLEND_SRC_ALPHA=32971,t.CONSTANT_COLOR=32769,t.ONE_MINUS_CONSTANT_COLOR=32770,t.CONSTANT_ALPHA=32771,t.ONE_MINUS_CONSTANT_ALPHA=32772,t.BLEND_COLOR=32773,t.ARRAY_BUFFER=34962,t.ELEMENT_ARRAY_BUFFER=34963,t.ARRAY_BUFFER_BINDING=34964,t.ELEMENT_ARRAY_BUFFER_BINDING=34965,t.STREAM_DRAW=35040,t.STATIC_DRAW=35044,t.DYNAMIC_DRAW=35048,t.BUFFER_SIZE=34660,t.BUFFER_USAGE=34661,t.CURRENT_VERTEX_ATTRIB=34342,t.FRONT=1028,t.BACK=1029,t.FRONT_AND_BACK=1032,t.CULL_FACE=2884,t.BLEND=3042,t.DITHER=3024,t.STENCIL_TEST=2960,t.DEPTH_TEST=2929,t.SCISSOR_TEST=3089,t.POLYGON_OFFSET_FILL=32823,t.SAMPLE_ALPHA_TO_COVERAGE=32926,t.SAMPLE_COVERAGE=32928,t.NO_ERROR=0,t.INVALID_ENUM=1280,t.INVALID_VALUE=1281,t.INVALID_OPERATION=1282,t.OUT_OF_MEMORY=1285,t.CW=2304,t.CCW=2305,t.LINE_WIDTH=2849,t.ALIASED_POINT_SIZE_RANGE=33901,t.ALIASED_LINE_WIDTH_RANGE=33902,t.CULL_FACE_MODE=2885,t.FRONT_FACE=2886,t.DEPTH_RANGE=2928,t.DEPTH_WRITEMASK=2930,t.DEPTH_CLEAR_VALUE=2931,t.DEPTH_FUNC=2932,t.STENCIL_CLEAR_VALUE=2961,t.STENCIL_FUNC=2962,t.STENCIL_FAIL=2964,t.STENCIL_PASS_DEPTH_FAIL=2965,t.STENCIL_PASS_DEPTH_PASS=2966,t.STENCIL_REF=2967,t.STENCIL_VALUE_MASK=2963,t.STENCIL_WRITEMASK=2968,t.STENCIL_BACK_FUNC=34816,t.STENCIL_BACK_FAIL=34817,t.STENCIL_BACK_PASS_DEPTH_FAIL=34818,t.STENCIL_BACK_PASS_DEPTH_PASS=34819,t.STENCIL_BACK_REF=36003,t.STENCIL_BACK_VALUE_MASK=36004,t.STENCIL_BACK_WRITEMASK=36005,t.VIEWPORT=2978,t.SCISSOR_BOX=3088,t.COLOR_CLEAR_VALUE=3106,t.COLOR_WRITEMASK=3107,t.UNPACK_ALIGNMENT=3317,t.PACK_ALIGNMENT=3333,t.MAX_TEXTURE_SIZE=3379,t.MAX_VIEWPORT_DIMS=3386,t.SUBPIXEL_BITS=3408,t.RED_BITS=3410,t.GREEN_BITS=3411,t.BLUE_BITS=3412,t.ALPHA_BITS=3413,t.DEPTH_BITS=3414,t.STENCIL_BITS=3415,t.POLYGON_OFFSET_UNITS=10752,t.POLYGON_OFFSET_FACTOR=32824,t.TEXTURE_BINDING_2D=32873,t.SAMPLE_BUFFERS=32936,t.SAMPLES=32937,t.SAMPLE_COVERAGE_VALUE=32938,t.SAMPLE_COVERAGE_INVERT=32939,t.COMPRESSED_TEXTURE_FORMATS=34467,t.DONT_CARE=4352,t.FASTEST=4353,t.NICEST=4354,t.GENERATE_MIPMAP_HINT=33170,t.BYTE=5120,t.UNSIGNED_BYTE=5121,t.SHORT=5122,t.UNSIGNED_SHORT=5123,t.INT=5124,t.UNSIGNED_INT=5125,t.FLOAT=5126,t.DEPTH_COMPONENT=6402,t.ALPHA=6406,t.RGB=6407,t.RGBA=6408,t.LUMINANCE=6409,t.LUMINANCE_ALPHA=6410,t.UNSIGNED_SHORT_4_4_4_4=32819,t.UNSIGNED_SHORT_5_5_5_1=32820,t.UNSIGNED_SHORT_5_6_5=33635,t.FRAGMENT_SHADER=35632,t.VERTEX_SHADER=35633,t.MAX_VERTEX_ATTRIBS=34921,t.MAX_VERTEX_UNIFORM_VECTORS=36347,t.MAX_VARYING_VECTORS=36348,t.MAX_COMBINED_TEXTURE_IMAGE_UNITS=35661,t.MAX_VERTEX_TEXTURE_IMAGE_UNITS=35660,t.MAX_TEXTURE_IMAGE_UNITS=34930,t.MAX_FRAGMENT_UNIFORM_VECTORS=36349,t.SHADER_TYPE=35663,t.DELETE_STATUS=35712,t.LINK_STATUS=35714,t.VALIDATE_STATUS=35715,t.ATTACHED_SHADERS=35717,t.ACTIVE_UNIFORMS=35718,t.ACTIVE_ATTRIBUTES=35721,t.SHADING_LANGUAGE_VERSION=35724,t.CURRENT_PROGRAM=35725,t.NEVER=512,t.LESS=513,t.EQUAL=514,t.LEQUAL=515,t.GREATER=516,t.NOTEQUAL=517,t.GEQUAL=518,t.ALWAYS=519,t.KEEP=7680,t.REPLACE=7681,t.INCR=7682,t.DECR=7683,t.INVERT=5386,t.INCR_WRAP=34055,t.DECR_WRAP=34056,t.VENDOR=7936,t.RENDERER=7937,t.VERSION=7938,t.NEAREST=9728,t.LINEAR=9729,t.NEAREST_MIPMAP_NEAREST=9984,t.LINEAR_MIPMAP_NEAREST=9985,t.NEAREST_MIPMAP_LINEAR=9986,t.LINEAR_MIPMAP_LINEAR=9987,t.TEXTURE_MAG_FILTER=10240,t.TEXTURE_MIN_FILTER=10241,t.TEXTURE_WRAP_S=10242,t.TEXTURE_WRAP_T=10243,t.TEXTURE_2D=3553,t.TEXTURE=5890,t.TEXTURE_CUBE_MAP=34067,t.TEXTURE_BINDING_CUBE_MAP=34068,t.TEXTURE_CUBE_MAP_POSITIVE_X=34069,t.TEXTURE_CUBE_MAP_NEGATIVE_X=34070,t.TEXTURE_CUBE_MAP_POSITIVE_Y=34071,t.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072,t.TEXTURE_CUBE_MAP_POSITIVE_Z=34073,t.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074,t.MAX_CUBE_MAP_TEXTURE_SIZE=34076,t.TEXTURE0=33984,t.TEXTURE1=33985,t.TEXTURE2=33986,t.TEXTURE3=33987,t.TEXTURE4=33988,t.TEXTURE5=33989,t.TEXTURE6=33990,t.TEXTURE7=33991,t.TEXTURE8=33992,t.TEXTURE9=33993,t.TEXTURE10=33994,t.TEXTURE11=33995,t.TEXTURE12=33996,t.TEXTURE13=33997,t.TEXTURE14=33998,t.TEXTURE15=33999,t.TEXTURE16=34e3,t.TEXTURE17=34001,t.TEXTURE18=34002,t.TEXTURE19=34003,t.TEXTURE20=34004,t.TEXTURE21=34005,t.TEXTURE22=34006,t.TEXTURE23=34007,t.TEXTURE24=34008,t.TEXTURE25=34009,t.TEXTURE26=34010,t.TEXTURE27=34011,t.TEXTURE28=34012,t.TEXTURE29=34013,t.TEXTURE30=34014,t.TEXTURE31=34015,t.ACTIVE_TEXTURE=34016,t.REPEAT=10497,t.CLAMP_TO_EDGE=33071,t.MIRRORED_REPEAT=33648,t.FLOAT_VEC2=35664,t.FLOAT_VEC3=35665,t.FLOAT_VEC4=35666,t.INT_VEC2=35667,t.INT_VEC3=35668,t.INT_VEC4=35669,t.BOOL=35670,t.BOOL_VEC2=35671,t.BOOL_VEC3=35672,t.BOOL_VEC4=35673,t.FLOAT_MAT2=35674,t.FLOAT_MAT3=35675,t.FLOAT_MAT4=35676,t.SAMPLER_2D=35678,t.SAMPLER_CUBE=35680,t.VERTEX_ATTRIB_ARRAY_ENABLED=34338,t.VERTEX_ATTRIB_ARRAY_SIZE=34339,t.VERTEX_ATTRIB_ARRAY_STRIDE=34340,t.VERTEX_ATTRIB_ARRAY_TYPE=34341,t.VERTEX_ATTRIB_ARRAY_NORMALIZED=34922,t.VERTEX_ATTRIB_ARRAY_POINTER=34373,t.VERTEX_ATTRIB_ARRAY_BUFFER_BINDING=34975,t.IMPLEMENTATION_COLOR_READ_TYPE=35738,t.IMPLEMENTATION_COLOR_READ_FORMAT=35739,t.COMPILE_STATUS=35713,t.LOW_FLOAT=36336,t.MEDIUM_FLOAT=36337,t.HIGH_FLOAT=36338,t.LOW_INT=36339,t.MEDIUM_INT=36340,t.HIGH_INT=36341,t.FRAMEBUFFER=36160,t.RENDERBUFFER=36161,t.RGBA4=32854,t.RGB5_A1=32855,t.RGB565=36194,t.DEPTH_COMPONENT16=33189,t.STENCIL_INDEX=6401,t.STENCIL_INDEX8=36168,t.DEPTH_STENCIL=34041,t.RENDERBUFFER_WIDTH=36162,t.RENDERBUFFER_HEIGHT=36163,t.RENDERBUFFER_INTERNAL_FORMAT=36164,t.RENDERBUFFER_RED_SIZE=36176,t.RENDERBUFFER_GREEN_SIZE=36177,t.RENDERBUFFER_BLUE_SIZE=36178,t.RENDERBUFFER_ALPHA_SIZE=36179,t.RENDERBUFFER_DEPTH_SIZE=36180,t.RENDERBUFFER_STENCIL_SIZE=36181,t.FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE=36048,t.FRAMEBUFFER_ATTACHMENT_OBJECT_NAME=36049,t.FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL=36050,t.FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE=36051,t.COLOR_ATTACHMENT0=36064,t.DEPTH_ATTACHMENT=36096,t.STENCIL_ATTACHMENT=36128,t.DEPTH_STENCIL_ATTACHMENT=33306,t.NONE=0,t.FRAMEBUFFER_COMPLETE=36053,t.FRAMEBUFFER_INCOMPLETE_ATTACHMENT=36054,t.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT=36055,t.FRAMEBUFFER_INCOMPLETE_DIMENSIONS=36057,t.FRAMEBUFFER_UNSUPPORTED=36061,t.FRAMEBUFFER_BINDING=36006,t.RENDERBUFFER_BINDING=36007,t.MAX_RENDERBUFFER_SIZE=34024,t.INVALID_FRAMEBUFFER_OPERATION=1286,t.UNPACK_FLIP_Y_WEBGL=37440,t.UNPACK_PREMULTIPLY_ALPHA_WEBGL=37441,t.CONTEXT_LOST_WEBGL=37442,t.UNPACK_COLORSPACE_CONVERSION_WEBGL=37443,t.BROWSER_DEFAULT_WEBGL=37444,t.COMPRESSED_RGB_S3TC_DXT1_EXT=33776,t.COMPRESSED_RGBA_S3TC_DXT1_EXT=33777,t.COMPRESSED_RGBA_S3TC_DXT3_EXT=33778,t.COMPRESSED_RGBA_S3TC_DXT5_EXT=33779,t.COMPRESSED_RGB_PVRTC_4BPPV1_IMG=35840,t.COMPRESSED_RGB_PVRTC_2BPPV1_IMG=35841,t.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG=35842,t.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG=35843,t.COMPRESSED_RGB_ETC1_WEBGL=36196,t.HALF_FLOAT_OES=36193,t.DOUBLE=5130,t.READ_BUFFER=3074,t.UNPACK_ROW_LENGTH=3314,t.UNPACK_SKIP_ROWS=3315,t.UNPACK_SKIP_PIXELS=3316,t.PACK_ROW_LENGTH=3330,t.PACK_SKIP_ROWS=3331,t.PACK_SKIP_PIXELS=3332,t.COLOR=6144,t.DEPTH=6145,t.STENCIL=6146,t.RED=6403,t.RGB8=32849,t.RGBA8=32856,t.RGB10_A2=32857,t.TEXTURE_BINDING_3D=32874,t.UNPACK_SKIP_IMAGES=32877,t.UNPACK_IMAGE_HEIGHT=32878,t.TEXTURE_3D=32879,t.TEXTURE_WRAP_R=32882,t.MAX_3D_TEXTURE_SIZE=32883,t.UNSIGNED_INT_2_10_10_10_REV=33640,t.MAX_ELEMENTS_VERTICES=33e3,t.MAX_ELEMENTS_INDICES=33001,t.TEXTURE_MIN_LOD=33082,t.TEXTURE_MAX_LOD=33083,t.TEXTURE_BASE_LEVEL=33084,t.TEXTURE_MAX_LEVEL=33085,t.MIN=32775,t.MAX=32776,t.DEPTH_COMPONENT24=33190,t.MAX_TEXTURE_LOD_BIAS=34045,t.TEXTURE_COMPARE_MODE=34892,t.TEXTURE_COMPARE_FUNC=34893,t.CURRENT_QUERY=34917,t.QUERY_RESULT=34918,t.QUERY_RESULT_AVAILABLE=34919,t.STREAM_READ=35041,t.STREAM_COPY=35042,t.STATIC_READ=35045,t.STATIC_COPY=35046,t.DYNAMIC_READ=35049,t.DYNAMIC_COPY=35050,t.MAX_DRAW_BUFFERS=34852,t.DRAW_BUFFER0=34853,t.DRAW_BUFFER1=34854,t.DRAW_BUFFER2=34855,t.DRAW_BUFFER3=34856,t.DRAW_BUFFER4=34857,t.DRAW_BUFFER5=34858,t.DRAW_BUFFER6=34859,t.DRAW_BUFFER7=34860,t.DRAW_BUFFER8=34861,t.DRAW_BUFFER9=34862,t.DRAW_BUFFER10=34863,t.DRAW_BUFFER11=34864,t.DRAW_BUFFER12=34865,t.DRAW_BUFFER13=34866,t.DRAW_BUFFER14=34867,t.DRAW_BUFFER15=34868,t.MAX_FRAGMENT_UNIFORM_COMPONENTS=35657,t.MAX_VERTEX_UNIFORM_COMPONENTS=35658,t.SAMPLER_3D=35679,t.SAMPLER_2D_SHADOW=35682,t.FRAGMENT_SHADER_DERIVATIVE_HINT=35723,t.PIXEL_PACK_BUFFER=35051,t.PIXEL_UNPACK_BUFFER=35052,t.PIXEL_PACK_BUFFER_BINDING=35053,t.PIXEL_UNPACK_BUFFER_BINDING=35055,t.FLOAT_MAT2x3=35685,t.FLOAT_MAT2x4=35686,t.FLOAT_MAT3x2=35687,t.FLOAT_MAT3x4=35688,t.FLOAT_MAT4x2=35689,t.FLOAT_MAT4x3=35690,t.SRGB=35904,t.SRGB8=35905,t.SRGB8_ALPHA8=35907,t.COMPARE_REF_TO_TEXTURE=34894,t.RGBA32F=34836,t.RGB32F=34837,t.RGBA16F=34842,t.RGB16F=34843,t.VERTEX_ATTRIB_ARRAY_INTEGER=35069,t.MAX_ARRAY_TEXTURE_LAYERS=35071,t.MIN_PROGRAM_TEXEL_OFFSET=35076,t.MAX_PROGRAM_TEXEL_OFFSET=35077,t.MAX_VARYING_COMPONENTS=35659,t.TEXTURE_2D_ARRAY=35866,t.TEXTURE_BINDING_2D_ARRAY=35869,t.R11F_G11F_B10F=35898,t.UNSIGNED_INT_10F_11F_11F_REV=35899,t.RGB9_E5=35901,t.UNSIGNED_INT_5_9_9_9_REV=35902,t.TRANSFORM_FEEDBACK_BUFFER_MODE=35967,t.MAX_TRANSFORM_FEEDBACK_SEPARATE_COMPONENTS=35968,t.TRANSFORM_FEEDBACK_VARYINGS=35971,t.TRANSFORM_FEEDBACK_BUFFER_START=35972,t.TRANSFORM_FEEDBACK_BUFFER_SIZE=35973,t.TRANSFORM_FEEDBACK_PRIMITIVES_WRITTEN=35976,t.RASTERIZER_DISCARD=35977,t.MAX_TRANSFORM_FEEDBACK_INTERLEAVED_COMPONENTS=35978,t.MAX_TRANSFORM_FEEDBACK_SEPARATE_ATTRIBS=35979,t.INTERLEAVED_ATTRIBS=35980,t.SEPARATE_ATTRIBS=35981,t.TRANSFORM_FEEDBACK_BUFFER=35982,t.TRANSFORM_FEEDBACK_BUFFER_BINDING=35983,t.RGBA32UI=36208,t.RGB32UI=36209,t.RGBA16UI=36214,t.RGB16UI=36215,t.RGBA8UI=36220,t.RGB8UI=36221,t.RGBA32I=36226,t.RGB32I=36227,t.RGBA16I=36232,t.RGB16I=36233,t.RGBA8I=36238,t.RGB8I=36239,t.RED_INTEGER=36244,t.RGB_INTEGER=36248,t.RGBA_INTEGER=36249,t.SAMPLER_2D_ARRAY=36289,t.SAMPLER_2D_ARRAY_SHADOW=36292,t.SAMPLER_CUBE_SHADOW=36293,t.UNSIGNED_INT_VEC2=36294,t.UNSIGNED_INT_VEC3=36295,t.UNSIGNED_INT_VEC4=36296,t.INT_SAMPLER_2D=36298,t.INT_SAMPLER_3D=36299,t.INT_SAMPLER_CUBE=36300,t.INT_SAMPLER_2D_ARRAY=36303,t.UNSIGNED_INT_SAMPLER_2D=36306,t.UNSIGNED_INT_SAMPLER_3D=36307,t.UNSIGNED_INT_SAMPLER_CUBE=36308,t.UNSIGNED_INT_SAMPLER_2D_ARRAY=36311,t.DEPTH_COMPONENT32F=36012,t.DEPTH32F_STENCIL8=36013,t.FLOAT_32_UNSIGNED_INT_24_8_REV=36269,t.FRAMEBUFFER_ATTACHMENT_COLOR_ENCODING=33296,t.FRAMEBUFFER_ATTACHMENT_COMPONENT_TYPE=33297,t.FRAMEBUFFER_ATTACHMENT_RED_SIZE=33298,t.FRAMEBUFFER_ATTACHMENT_GREEN_SIZE=33299,t.FRAMEBUFFER_ATTACHMENT_BLUE_SIZE=33300,t.FRAMEBUFFER_ATTACHMENT_ALPHA_SIZE=33301,t.FRAMEBUFFER_ATTACHMENT_DEPTH_SIZE=33302,t.FRAMEBUFFER_ATTACHMENT_STENCIL_SIZE=33303,t.FRAMEBUFFER_DEFAULT=33304,t.UNSIGNED_INT_24_8=34042,t.DEPTH24_STENCIL8=35056,t.UNSIGNED_NORMALIZED=35863,t.DRAW_FRAMEBUFFER_BINDING=36006,t.READ_FRAMEBUFFER=36008,t.DRAW_FRAMEBUFFER=36009,t.READ_FRAMEBUFFER_BINDING=36010,t.RENDERBUFFER_SAMPLES=36011,t.FRAMEBUFFER_ATTACHMENT_TEXTURE_LAYER=36052,t.MAX_COLOR_ATTACHMENTS=36063,t.COLOR_ATTACHMENT1=36065,t.COLOR_ATTACHMENT2=36066,t.COLOR_ATTACHMENT3=36067,t.COLOR_ATTACHMENT4=36068,t.COLOR_ATTACHMENT5=36069,t.COLOR_ATTACHMENT6=36070,t.COLOR_ATTACHMENT7=36071,t.COLOR_ATTACHMENT8=36072,t.COLOR_ATTACHMENT9=36073,t.COLOR_ATTACHMENT10=36074,t.COLOR_ATTACHMENT11=36075,t.COLOR_ATTACHMENT12=36076,t.COLOR_ATTACHMENT13=36077,t.COLOR_ATTACHMENT14=36078,t.COLOR_ATTACHMENT15=36079,t.FRAMEBUFFER_INCOMPLETE_MULTISAMPLE=36182,t.MAX_SAMPLES=36183,t.HALF_FLOAT=5131,t.RG=33319,t.RG_INTEGER=33320,t.R8=33321,t.RG8=33323,t.R16F=33325,t.R32F=33326,t.RG16F=33327,t.RG32F=33328,t.R8I=33329,t.R8UI=33330,t.R16I=33331,t.R16UI=33332,t.R32I=33333,t.R32UI=33334,t.RG8I=33335,t.RG8UI=33336,t.RG16I=33337,t.RG16UI=33338,t.RG32I=33339,t.RG32UI=33340,t.VERTEX_ARRAY_BINDING=34229,t.R8_SNORM=36756,t.RG8_SNORM=36757,t.RGB8_SNORM=36758,t.RGBA8_SNORM=36759,t.SIGNED_NORMALIZED=36764,t.COPY_READ_BUFFER=36662,t.COPY_WRITE_BUFFER=36663,t.COPY_READ_BUFFER_BINDING=36662,t.COPY_WRITE_BUFFER_BINDING=36663,t.UNIFORM_BUFFER=35345,t.UNIFORM_BUFFER_BINDING=35368,t.UNIFORM_BUFFER_START=35369,t.UNIFORM_BUFFER_SIZE=35370,t.MAX_VERTEX_UNIFORM_BLOCKS=35371,t.MAX_FRAGMENT_UNIFORM_BLOCKS=35373,t.MAX_COMBINED_UNIFORM_BLOCKS=35374,t.MAX_UNIFORM_BUFFER_BINDINGS=35375,t.MAX_UNIFORM_BLOCK_SIZE=35376,t.MAX_COMBINED_VERTEX_UNIFORM_COMPONENTS=35377,t.MAX_COMBINED_FRAGMENT_UNIFORM_COMPONENTS=35379,t.UNIFORM_BUFFER_OFFSET_ALIGNMENT=35380,t.ACTIVE_UNIFORM_BLOCKS=35382,t.UNIFORM_TYPE=35383,t.UNIFORM_SIZE=35384,t.UNIFORM_BLOCK_INDEX=35386,t.UNIFORM_OFFSET=35387,t.UNIFORM_ARRAY_STRIDE=35388,t.UNIFORM_MATRIX_STRIDE=35389,t.UNIFORM_IS_ROW_MAJOR=35390,t.UNIFORM_BLOCK_BINDING=35391,t.UNIFORM_BLOCK_DATA_SIZE=35392,t.UNIFORM_BLOCK_ACTIVE_UNIFORMS=35394,t.UNIFORM_BLOCK_ACTIVE_UNIFORM_INDICES=35395,t.UNIFORM_BLOCK_REFERENCED_BY_VERTEX_SHADER=35396,t.UNIFORM_BLOCK_REFERENCED_BY_FRAGMENT_SHADER=35398,t.INVALID_INDEX=4294967295,t.MAX_VERTEX_OUTPUT_COMPONENTS=37154,t.MAX_FRAGMENT_INPUT_COMPONENTS=37157,t.MAX_SERVER_WAIT_TIMEOUT=37137,t.OBJECT_TYPE=37138,t.SYNC_CONDITION=37139,t.SYNC_STATUS=37140,t.SYNC_FLAGS=37141,t.SYNC_FENCE=37142,t.SYNC_GPU_COMMANDS_COMPLETE=37143,t.UNSIGNALED=37144,t.SIGNALED=37145,t.ALREADY_SIGNALED=37146,t.TIMEOUT_EXPIRED=37147,t.CONDITION_SATISFIED=37148,t.WAIT_FAILED=37149,t.SYNC_FLUSH_COMMANDS_BIT=1,t.VERTEX_ATTRIB_ARRAY_DIVISOR=35070,t.ANY_SAMPLES_PASSED=35887,t.ANY_SAMPLES_PASSED_CONSERVATIVE=36202,t.SAMPLER_BINDING=35097,t.RGB10_A2UI=36975,t.INT_2_10_10_10_REV=36255,t.TRANSFORM_FEEDBACK=36386,t.TRANSFORM_FEEDBACK_PAUSED=36387,t.TRANSFORM_FEEDBACK_ACTIVE=36388,t.TRANSFORM_FEEDBACK_BINDING=36389,t.COMPRESSED_R11_EAC=37488,t.COMPRESSED_SIGNED_R11_EAC=37489,t.COMPRESSED_RG11_EAC=37490,t.COMPRESSED_SIGNED_RG11_EAC=37491,t.COMPRESSED_RGB8_ETC2=37492,t.COMPRESSED_SRGB8_ETC2=37493,t.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2=37494,t.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2=37495,t.COMPRESSED_RGBA8_ETC2_EAC=37496,t.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC=37497,t.TEXTURE_IMMUTABLE_FORMAT=37167,t.MAX_ELEMENT_INDEX=36203,t.TEXTURE_IMMUTABLE_LEVELS=33503,t.MAX_TEXTURE_MAX_ANISOTROPY_EXT=34047,t}();e.GLConstants=n},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0})},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0})},function(t,e,r){"use strict";var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(e,"__esModule",{value:!0}),e.BaseEngine=void 0;var o=r(21),s=r(130),a=function(t){function e(e,r,n){var i;void 0===n&&(n=!1);var o=t.call(this)||this;o._contextWasLost=!1,o._devicePixelRatio=1,o._renderLoopLaunched=!1,o._activeRenderLoops=new Array,o._frameId=0,o._windowIsBackground=!1,o._cachedQueries=[],o._cachedTextures=[],o._currentRenderTarget=null,o._cachedScenes=[],o.forcePOTTextures=!1,o.renderEvenInBackground=!0,o.validateShaderPrograms=!1;var s=null;if(!e)return o;r=r||{},e.getContext?(s=e,o._renderingCanvas=s,null==r.alpha&&(r.alpha=!0),null==r.antialias&&(r.antialias=!0),null==r.depth&&(r.depth=!0),null==r.stencil&&(r.stencil=!0),null==r.premultipliedAlpha&&(r.premultipliedAlpha=!1),null==r.xrCompatible&&(r.xrCompatible=!0),r.powerPreference="high-performance",o._onContextLost=o.onContextLost.bind(o),o._onContextRestored=o.onContextRestored.bind(o),o._creationOptions=r,o._InitGL()):(o._gl=e,o._renderingCanvas=o._gl.canvas);var a=window.devicePixelRatio||1,u=r.limitDeviceRatio||a;if(o._devicePixelRatio=n?a:Math.min(u,a),o.resize(null!==(i=r.fullScreen)&&void 0!==i&&i,!0),o._initGLContext(),"undefined"!=typeof window){var p=o.getHostWindow();p.addEventListener("blur",(function(){o._windowIsBackground=!0})),p.addEventListener("focus",(function(){o._windowIsBackground=!1}))}return o._renderingCanvas.addEventListener("webglcontextlost",o._onContextLost,!1),o._renderingCanvas.addEventListener("webglcontextrestored",o._onContextRestored,!1),o}return i(e,t),Object.defineProperty(e.prototype,"gl",{get:function(){return this._gl},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"webGLVersion",{get:function(){return this._webGLVersion},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"caps",{get:function(){return this._caps},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"currentViewport",{get:function(){return this._cachedViewport},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"needPOTTextures",{get:function(){return this._webGLVersion<2||this.forcePOTTextures},enumerable:!1,configurable:!0}),e.prototype.getRenderingCanvas=function(){return this._renderingCanvas},e.prototype.getCurrentFrameId=function(){return this._frameId},e.prototype.getDevicePixelRatio=function(){return this._devicePixelRatio},e.prototype.setDevicePixelRatio=function(t){return this._devicePixelRatio!=t&&(this._devicePixelRatio=t,this.resize(!1,!1))},e.prototype.getRenderWidth=function(t){return void 0===t&&(t=!1),!t&&this._currentRenderTarget?this._currentRenderTarget.width:this._gl.drawingBufferWidth},e.prototype.getRenderHeight=function(t){return void 0===t&&(t=!1),!t&&this._currentRenderTarget?this._currentRenderTarget.height:this._gl.drawingBufferHeight},e.prototype.setViewport=function(t,e,r){void 0===e&&(e=null),void 0===r&&(r=null);var n=e||this.getRenderWidth(),i=r||this.getRenderHeight(),o=t.x||0,s=t.y||0;return this._cachedViewport=t,this._viewport(o*n,s*i,n*t.width,i*t.height),this},e.prototype._viewport=function(t,e,r,n){},e.prototype.resize=function(t,e){var r,n;return void 0===e&&(e=!1),t&&"undefined"!=typeof window?(r=window.innerWidth,n=window.innerHeight):!t&&this._renderingCanvas&&this._renderingCanvas.parentElement?(r=this._renderingCanvas.parentElement.clientWidth,n=this._renderingCanvas.parentElement.clientHeight):(r=this._renderingCanvas?this._renderingCanvas.clientWidth||this._renderingCanvas.width:100,n=this._renderingCanvas?this._renderingCanvas.clientHeight||this._renderingCanvas.height:100),this.setSize(r,n,e)},e.prototype.setSize=function(t,e,r){return void 0===r&&(r=!1),!!this._renderingCanvas&&(t|=0,e|=0,this._renderingCanvas.width=Math.floor(t*this._devicePixelRatio),this._renderingCanvas.height=Math.floor(e*this._devicePixelRatio),r&&(this._renderingCanvas.style.width=t+"px",this._renderingCanvas.style.height=e+"px"),!0)},e.prototype.clear=function(t,e,r){return void 0===t&&(t=!0),void 0===e&&(e=!0),void 0===r&&(r=!0),this},e.prototype.runRenderLoop=function(t){-1==this._activeRenderLoops.indexOf(t)&&(this._activeRenderLoops.push(t),this._renderLoopLaunched||(this._renderLoopLaunched=!0,this._boundRenderFunction=this._renderLoop.bind(this),this._frameHandler=this._queueNewFrame(this._boundRenderFunction,this.getHostWindow())))},e.prototype.stopRenderLoop=function(t){if(t){var e=this._activeRenderLoops.indexOf(t);e>=0&&this._activeRenderLoops.splice(e,1)}else this._activeRenderLoops=[]},e.prototype._queueNewFrame=function(t,r){return e.QueueNewFrame(t,r)},e.prototype._renderLoop=function(){if(!this._contextWasLost){var t=!0;!this.renderEvenInBackground&&this._windowIsBackground&&(t=!1),t&&(this._frameId++,this.beginFrame(),this.render(),this.endFrame())}this._activeRenderLoops.length>0?this._frameHandler=this._queueNewFrame(this._boundRenderFunction,this.getHostWindow()):this._renderLoopLaunched=!1},e.prototype.getHostWindow=function(){return"undefined"==typeof window?null:this._renderingCanvas&&this._renderingCanvas.ownerDocument&&this._renderingCanvas.ownerDocument.defaultView?this._renderingCanvas.ownerDocument.defaultView:window},e.prototype.getError=function(){return 0},e.prototype.onContextLost=function(t){t.preventDefault(),this._contextWasLost=!0,console.warn("WebGL context lost.")},e.prototype.onContextRestored=function(t){this._contextWasLost=!1,console.warn("WebGL context restored.")},e.prototype.beginFrame=function(){},e.prototype.endFrame=function(){},e.prototype.render=function(){for(var t=0;t<this._activeRenderLoops.length;t++){(0,this._activeRenderLoops[t])()}},e.prototype._InitGL=function(){},e.prototype._initGLContext=function(){},e.prototype._identifyGPUVendor=function(t,e){return t.match(/NVIDIA/i)||e.match(/NVIDIA/i)?"NVIDIA":t.match(/INTEL/i)||e.match(/INTEL/i)?"INTEL":t.match(/AMD/i)||e.match(/AMD/i)||t.match(/ATI/i)||e.match(/ATI/i)?"AMD":"UNKNOWN GPU"},e.prototype._getWebGLTextureType=function(t){return 0},e.prototype._getInternalFormat=function(t){return 0},e.prototype._getRGBABufferInternalSizedFormat=function(t,e){return 0},e.prototype._getRGBAMultiSampleBufferFormat=function(t){return 0},e.prototype._getDepthBufferInternalFormat=function(t,e){return 0},e.prototype._initColorState=function(){return this},e.prototype.setColorStateMask=function(t,e,r,n){return this},e.prototype.setColorStateLocked=function(t){return this},e.prototype.setColorStateClear=function(t,e,r,n,i){return this},e.prototype.setColorStateReset=function(){return this},e.prototype._initDepthState=function(){return this},e.prototype.setDepthTest=function(t){return this},e.prototype.setDepthMask=function(t){return this},e.prototype.setDepthFunc=function(t){return this},e.prototype.setDepthLock=function(t){return this},e.prototype.setDepthClear=function(t){return this},e.prototype.setDepthReset=function(){return this},e.prototype._initStencilState=function(){return this},e.prototype.setStencilTest=function(t){return this},e.prototype.getStencilTest=function(){return!1},e.prototype.setStencilhMask=function(t){return this},e.prototype.setStencilFunc=function(t,e,r){return this},e.prototype.setStencilOp=function(t,e,r){return this},e.prototype.setStencilLock=function(t){return this},e.prototype.setStencilClear=function(t){return this},e.prototype.setStencilReset=function(){return this},e.prototype._initBlendingState=function(){return this},e.prototype.setBlending=function(t){return this},e.prototype.setBlendingColor=function(t){return this},e.prototype.setBlendingEquation=function(t,e){return this},e.prototype.setBlendingFunc=function(t,e,r,n){return this},e.prototype._initCullState=function(){return this},e.prototype.setCullFace=function(t){return this},e.prototype.setFrontFace=function(t){return this},e.prototype.setPolygonOffset=function(t,e,r){return this},e.prototype.setScissorTest=function(t){return this},e.prototype.setDithering=function(t){return this},e.prototype.setRasterizer=function(t){return this},e.prototype.createTransformFeedback=function(){},e.prototype.deleteTransformFeedback=function(t){return this},e.prototype.bindTransformFeedback=function(t){return this},e.prototype.beginTransformFeedback=function(t){return void 0===t&&(t=!0),this},e.prototype.endTransformFeedback=function(){return this},e.prototype.pauseTransformFeedback=function(){return this},e.prototype.resumeTransformFeedback=function(){return this},e.prototype.setTranformFeedbackVaryings=function(t,e,r){return void 0===r&&(r=!1),this},e.prototype.bindTransformFeedbackBuffer=function(t,e){return void 0===e&&(e=0),this},e.prototype._updateQuery=function(){},e.prototype.createQuery=function(t){void 0===t&&(t=!0)},e.prototype.deleteQuery=function(t){return this},e.prototype.beginQuery=function(t){return!1},e.prototype.endQuery=function(t){return!1},e.prototype._initDataBufferState=function(){return this},e.prototype._bindDataBuffer=function(t,e,r,n,i){return void 0===e&&(e=null),void 0===r&&(r=-1),void 0===n&&(n=0),void 0===i&&(i=null),this},e.prototype._unbindDataBuffer=function(t,e,r){return void 0===e&&(e=null),void 0===r&&(r=-1),this},e.prototype._setBufferAttribute=function(t){return!1},e.prototype._releaseBufferAttribute=function(t){},e.prototype._setTexture=function(t,e){return void 0===e&&(e=null),!1},e.prototype._releaseTexture=function(t){},e.prototype._initTextureState=function(){return this},e.prototype._allocateTextureUnit=function(){return 0},e.prototype._resetTextureUnits=function(){return this},e.prototype._activeTexture=function(t){return void 0===t&&(t=null),this},e.prototype._bindTexture=function(t){return this},e.prototype._unbindTexture=function(){return this},e.prototype.bindFramebuffer=function(t,e,r,n,i,o,s){return void 0===e&&(e=0),void 0===r&&(r=null),void 0===n&&(n=null),void 0===i&&(i=!1),void 0===o&&(o=0),void 0===s&&(s=0),this},e.prototype.unBindFramebuffer=function(){return this},e.prototype.restoreDefaultFramebuffer=function(){return this},e.prototype.createPipelineContext=function(){var t=new s.GLPipelineContext;return t.engine=this,this._caps.parallelShaderCompile&&(t.isParallelCompiled=!0),t},e.prototype.deletePipelineContext=function(t){return this},e.prototype.createShaderProgram=function(t,e,r,n,i){return void 0===i&&(i=null),this},e.prototype.setInt=function(t,e){return this},e.prototype.setIntArray=function(t,e){return this},e.prototype.setIntArray2=function(t,e){return this},e.prototype.setIntArray3=function(t,e){return this},e.prototype.setIntArray4=function(t,e){return this},e.prototype.setArray=function(t,e){return this},e.prototype.setArray2=function(t,e){return this},e.prototype.setArray3=function(t,e){return this},e.prototype.setArray4=function(t,e){return this},e.prototype.setMatrices=function(t,e){return this},e.prototype.setMatrix3x3=function(t,e){return this},e.prototype.setMatrix2x2=function(t,e){return this},e.prototype.setFloat=function(t,e){return this},e.prototype.setFloat2=function(t,e,r){return this},e.prototype.setFloat3=function(t,e,r,n){return this},e.prototype.setFloat4=function(t,e,r,n,i){return this},e.QueueNewFrame=function(t,e){return"undefined"==typeof window?"undefined"!=typeof requestAnimationFrame?requestAnimationFrame(t):setTimeout(t,16):(e||(e=window),e.requestPostAnimationFrame?e.requestPostAnimationFrame(t):e.requestAnimationFrame?e.requestAnimationFrame(t):e.msRequestAnimationFrame?e.msRequestAnimationFrame(t):e.webkitRequestAnimationFrame?e.webkitRequestAnimationFrame(t):e.mozRequestAnimationFrame?e.mozRequestAnimationFrame(t):e.oRequestAnimationFrame?e.oRequestAnimationFrame(t):window.setTimeout(t,16))},e}(o.EventDispatcher);e.BaseEngine=a},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.GLPipelineContext=void 0;var n=function(){function t(){this.vertexCompilationError=null,this.fragmentCompilationError=null,this.programLinkError=null,this.programValidationError=null}return Object.defineProperty(t.prototype,"isAsync",{get:function(){return this.isParallelCompiled},enumerable:!1,configurable:!0}),t}();e.GLPipelineContext=n},function(t,e,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(t,e,r,n){void 0===n&&(n=r),Object.defineProperty(t,n,{enumerable:!0,get:function(){return e[r]}})}:function(t,e,r,n){void 0===n&&(n=r),t[n]=e[r]}),i=this&&this.__exportStar||function(t,e){for(var r in t)"default"===r||e.hasOwnProperty(r)||n(e,t,r)};Object.defineProperty(e,"__esModule",{value:!0}),i(r(132),e),i(r(133),e),i(r(134),e),i(r(135),e),i(r(136),e),i(r(137),e),i(r(139),e),i(r(142),e)},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(13),i=r(16),o=r(4),s=r(12),a=r(5);n.WebGLEngine.prototype._initBlendingState=function(){var t,e;this.currentBlending=s.Constants.NoBlending,this.currentBlendEquation=-1,this.currentBlendSrc=-1,this.currentBlendDst=-1,this.currentBlendEquationAlpha=-1,this.currentBlendSrcAlpha=-1,this.currentBlendDstAlpha=-1,this.currentBlendColor=new i.Vector4;var r=this.gl;return r.disable(r.BLEND),this.equationToGL=((t={})[s.Constants.AddEquation]=r.FUNC_ADD,t[s.Constants.SubtractEquation]=r.FUNC_SUBTRACT,t[s.Constants.ReverseSubtractEquation]=r.FUNC_REVERSE_SUBTRACT,t[s.Constants.MinEquation]=r.MIN,t[s.Constants.MaxEquation]=r.MAX,t),this.factorToGL=((e={})[s.Constants.ZeroFactor]=r.ZERO,e[s.Constants.OneFactor]=r.ONE,e[s.Constants.SrcColorFactor]=r.SRC_COLOR,e[s.Constants.SrcAlphaFactor]=r.SRC_ALPHA,e[s.Constants.SrcAlphaSaturateFactor]=r.SRC_ALPHA_SATURATE,e[s.Constants.DstColorFactor]=r.DST_COLOR,e[s.Constants.DstAlphaFactor]=r.DST_ALPHA,e[s.Constants.OneMinusSrcColorFactor]=r.ONE_MINUS_SRC_COLOR,e[s.Constants.OneMinusSrcAlphaFactor]=r.ONE_MINUS_SRC_ALPHA,e[s.Constants.OneMinusDstColorFactor]=r.ONE_MINUS_DST_COLOR,e[s.Constants.OneMinusDstAlphaFactor]=r.ONE_MINUS_DST_ALPHA,e),this},n.WebGLEngine.prototype.setBlending=function(t){var e=this.gl;if(this.currentBlending!=t)switch(t==s.Constants.NoBlending?e.disable(e.BLEND):e.enable(e.BLEND),this.currentBlending=t,t){case s.Constants.PremultipliedBlending:this.setBlendingFunc(this.gl.ONE,this.gl.ONE_MINUS_SRC_ALPHA,this.gl.ONE,this.gl.ONE);break;case s.Constants.PremultipliedPorterDuffBlending:this.setBlendingFunc(this.gl.ONE,this.gl.ONE_MINUS_SRC_ALPHA,this.gl.ONE,this.gl.ONE_MINUS_SRC_ALPHA);break;case s.Constants.CombineBlending:this.setBlendingFunc(this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA,this.gl.ONE,this.gl.ONE);break;case s.Constants.OneOneBlending:this.setBlendingFunc(this.gl.ONE,this.gl.ONE,this.gl.ZERO,this.gl.ONE);break;case s.Constants.AddBlending:this.setBlendingFunc(this.gl.SRC_ALPHA,this.gl.ONE,this.gl.ZERO,this.gl.ONE);break;case s.Constants.SubtractBlending:this.setBlendingFunc(this.gl.ZERO,this.gl.ONE_MINUS_SRC_COLOR,this.gl.ONE,this.gl.ONE);break;case s.Constants.MultiplyBlending:this.setBlendingFunc(this.gl.DST_COLOR,this.gl.ZERO,this.gl.ONE,this.gl.ONE);break;case s.Constants.MaximizedBlending:this.setBlendingFunc(this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_COLOR,this.gl.ONE,this.gl.ONE);break;case s.Constants.InterpolateBlending:this.setBlendingFunc(this.gl.CONSTANT_COLOR,this.gl.ONE_MINUS_CONSTANT_COLOR,this.gl.CONSTANT_ALPHA,this.gl.ONE_MINUS_CONSTANT_ALPHA);break;case s.Constants.ScreenModeBlending:this.setBlendingFunc(this.gl.ONE,this.gl.ONE_MINUS_SRC_COLOR,this.gl.ONE,this.gl.ONE_MINUS_SRC_ALPHA);break;case s.Constants.OneOneOneOneBlending:this.setBlendingFunc(this.gl.ONE,this.gl.ONE,this.gl.ONE,this.gl.ONE);break;case s.Constants.AlphaToColorBlending:this.setBlendingFunc(this.gl.DST_ALPHA,this.gl.ONE,this.gl.ZERO,this.gl.ZERO);break;case s.Constants.ReverseOneMinusBlending:this.setBlendingFunc(this.gl.ONE_MINUS_DST_COLOR,this.gl.ONE_MINUS_SRC_COLOR,this.gl.ONE_MINUS_DST_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA);break;case s.Constants.SrcDstOneMinusSrcAlphaBlending:this.setBlendingFunc(this.gl.ONE,this.gl.ONE_MINUS_SRC_ALPHA,this.gl.ONE,this.gl.ONE_MINUS_SRC_ALPHA);break;case s.Constants.OneOneOneZeroBlending:this.setBlendingFunc(this.gl.ONE,this.gl.ONE,this.gl.ONE,this.gl.ZERO);break;case s.Constants.ExclusionBlending:this.setBlendingFunc(this.gl.ONE_MINUS_DST_COLOR,this.gl.ONE_MINUS_SRC_COLOR,this.gl.ZERO,this.gl.ONE)}return this},n.WebGLEngine.prototype.setBlendingColor=function(t){t instanceof o.ColorRGBA?a.MathTmp.Vector4[0].set(t.r,t.g,t.b,t.a):a.MathTmp.Vector4[0].set(t.r,t.g,t.b,1);var e=this.gl;return a.MathTmp.Vector4[0].equals(this.currentBlendColor)||(this.currentBlendColor.copy(a.MathTmp.Vector4[0]),e.blendColor(this.currentBlendColor.x,this.currentBlendColor.y,this.currentBlendColor.z,this.currentBlendColor.w)),this},n.WebGLEngine.prototype.setBlendingEquation=function(t,e){void 0===e&&(e=null);var r=this.gl;return this.currentBlendEquation==t&&this.currentBlendEquationAlpha==e||(null!=e?r.blendEquationSeparate(this.equationToGL[t],this.equationToGL[e]):r.blendEquation(this.equationToGL[t]),this.currentBlendEquation=t,this.currentBlendEquationAlpha=null!=e?e:-1),this},n.WebGLEngine.prototype.setBlendingFunc=function(t,e,r,n){void 0===r&&(r=null),void 0===n&&(n=null);var i=this.gl;return this.currentBlendSrc==t&&this.currentBlendDst==e&&this.currentBlendSrcAlpha==r&&this.currentBlendDstAlpha==n||(null!=r&&null!=n?i.blendFuncSeparate(this.factorToGL[t],this.factorToGL[e],this.factorToGL[r],this.factorToGL[n]):i.blendFunc(this.factorToGL[t],this.factorToGL[e]),this.currentBlendSrc=t,this.currentBlendDst=e,this.currentBlendSrcAlpha=null!=r?r:-1,this.currentBlendDstAlpha=null!=n?n:-1),this}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(13),i=r(16),o=r(5);n.WebGLEngine.prototype._initColorState=function(){var t=this.gl;return this.colorLocked=!1,this.colorState=new i.Vector4,this.currentColorMask=new i.Vector4(1,1,1,1),this.currentColorClear=new i.Vector4(1,1,1,1),t.colorMask(!0,!0,!0,!0),t.clearColor(1,1,1,1),this},n.WebGLEngine.prototype.setColorStateMask=function(t,e,r,n){var i=this.gl;return e=null!=e?e:t,r=null!=r?r:t,n=null!=n?n:t,o.MathTmp.Vector4[0].set(t?1:0,e?1:0,r?1:0,n?1:0),this.currentColorMask.equals(o.MathTmp.Vector4[0])||this.colorLocked||(i.colorMask(t,e,r,n),this.currentColorMask.copy(o.MathTmp.Vector4[0])),this},n.WebGLEngine.prototype.setColorStateLocked=function(t){return this.colorLocked=t,this},n.WebGLEngine.prototype.setColorStateClear=function(t,e,r,n,i){var o=this.gl;return i&&(t*=n,e*=n,r*=n),this.colorState.set(t,e,r,n),this.currentColorClear.equals(this.colorState)||(o.clearColor(t,e,r,n),this.currentColorClear.copy(this.colorState)),this},n.WebGLEngine.prototype.setColorStateReset=function(){return this.colorLocked=!1,this.currentColorMask.set(-1,0,0,0),this.currentColorClear.set(-1,0,0,0),this}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(13),i=r(12);n.WebGLEngine.prototype._initCullState=function(){this.currentCullFace=i.Constants.CullFaceBack,this.currentFrontFace=!1,this.currentPolygonOffset=!1,this.currentPolygonOffsetFactor=0,this.currentPolygonOffsetUnits=0;var t=this.gl;return t.enable(t.CULL_FACE),t.cullFace(t.BACK),t.frontFace(t.CCW),t.disable(t.POLYGON_OFFSET_FILL),this},n.WebGLEngine.prototype.setCullFace=function(t){var e=this.gl;return this.currentCullFace!=t&&(t!=i.Constants.CullFaceNone?(e.enable(e.CULL_FACE),t==i.Constants.CullFaceBack?e.cullFace(e.BACK):t==i.Constants.CullFaceFront?e.cullFace(e.FRONT):e.cullFace(e.FRONT_AND_BACK)):e.disable(e.CULL_FACE),this.currentCullFace=t),this},n.WebGLEngine.prototype.setFrontFace=function(t){var e=this.gl;return this.currentFrontFace!=t&&(t?e.frontFace(e.CW):e.frontFace(e.CCW),this.currentFrontFace=t),this},n.WebGLEngine.prototype.setPolygonOffset=function(t,e,r){var n=this.gl;return this.currentPolygonOffset!=t&&(t?(n.enable(n.POLYGON_OFFSET_FILL),this.currentPolygonOffsetFactor==e&&this.currentPolygonOffsetUnits==r||(n.polygonOffset(e,r),this.currentPolygonOffsetFactor=e,this.currentPolygonOffsetUnits=r)):n.disable(n.POLYGON_OFFSET_FILL),this.currentPolygonOffset=t),this}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(13),i=r(12);n.WebGLEngine.prototype._initDepthState=function(){this.depthLocked=!1,this.currentDepthTest=!0,this.currentDepthMask=!0,this.currentDepthClear=0,this.currentDepthFunc=i.Constants.LessEqualDepth;var t=this.gl;return t.enable(t.DEPTH_TEST),t.depthMask(!0),t.depthFunc(t.LEQUAL),this},n.WebGLEngine.prototype.setDepthTest=function(t){var e=this.gl;return this.currentDepthTest!=t&&(t?e.enable(e.DEPTH_TEST):e.disable(e.DEPTH_TEST),this.currentDepthTest=t),this},n.WebGLEngine.prototype.setDepthMask=function(t){var e=this.gl;return this.currentDepthMask==t||this.depthLocked||(e.depthMask(t),this.currentDepthMask=t),this},n.WebGLEngine.prototype.setDepthFunc=function(t){var e=this.gl;if(this.currentDepthFunc!=t){if(t)switch(t){case i.Constants.NeverDepth:e.depthFunc(e.NEVER);break;case i.Constants.AlwaysDepth:e.depthFunc(e.ALWAYS);break;case i.Constants.LessDepth:e.depthFunc(e.LESS);break;case i.Constants.LessEqualDepth:e.depthFunc(e.LEQUAL);break;case i.Constants.EqualDepth:e.depthFunc(e.EQUAL);break;case i.Constants.GreaterEqualDepth:e.depthFunc(e.GEQUAL);break;case i.Constants.GreaterDepth:e.depthFunc(e.GREATER);break;case i.Constants.NotEqualDepth:e.depthFunc(e.NOTEQUAL);break;default:e.depthFunc(e.LEQUAL)}else e.depthFunc(e.LEQUAL);this.currentDepthFunc=t}return this},n.WebGLEngine.prototype.setDepthLock=function(t){return this.depthLocked=t,this},n.WebGLEngine.prototype.setDepthClear=function(t){var e=this.gl;return this.currentDepthClear!=t&&(e.clearDepth(t),this.currentDepthClear=t),this},n.WebGLEngine.prototype.setDepthReset=function(){return this.depthLocked=!1,this.currentDepthMask=!0,this.currentDepthFunc=-1,this.currentDepthClear=-1,this}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(13);n.WebGLEngine.prototype._initStencilState=function(){this.stencilLocked=!1,this.currentStencilTest=!1,this.currentStencilMask=-1,this.currentStencilFunc=-1,this.currentStencilRef=-1,this.currentStencilFuncMask=-1,this.currentStencilFail=-1,this.currentStencilZFail=-1,this.currentStencilZPass=-1,this.currentStencilClear=-1;var t=this.gl;return t.disable(t.STENCIL_TEST),t.stencilMask(0),this},n.WebGLEngine.prototype.setStencilTest=function(t){var e=this.gl;return this.stencilLocked||this.currentStencilTest==t||(t?e.enable(e.STENCIL_TEST):e.disable(e.STENCIL_TEST),this.currentStencilTest=t),this},n.WebGLEngine.prototype.setStencilhMask=function(t){var e=this.gl;return this.currentStencilMask==t||this.stencilLocked||(e.stencilMask(t),this.currentStencilMask=t),this},n.WebGLEngine.prototype.setStencilFunc=function(t,e,r){var n=this.gl;return this.currentStencilFunc==t&&this.currentStencilRef==e&&this.currentStencilFuncMask==r||(n.stencilFunc(t,e,r),this.currentStencilFunc=t,this.currentStencilRef=e,this.currentStencilFuncMask=r),this},n.WebGLEngine.prototype.setStencilOp=function(t,e,r){var n=this.gl;return this.currentStencilFail==t&&this.currentStencilZFail==e&&this.currentStencilZPass==r||(n.stencilOp(t,e,r),this.currentStencilFail=t,this.currentStencilZFail=e,this.currentStencilZPass=r),this},n.WebGLEngine.prototype.setStencilLock=function(t){return this.stencilLocked=t,this},n.WebGLEngine.prototype.setStencilClear=function(t){var e=this.gl;return this.currentStencilClear!=t&&(e.clearStencil(t),this.currentStencilClear=t),this},n.WebGLEngine.prototype.setStencilReset=function(){return this.stencilLocked=!1,this.currentStencilMask=-1,this.currentStencilFunc=-1,this.currentStencilRef=-1,this.currentStencilFuncMask=-1,this.currentStencilFail=-1,this.currentStencilZFail=-1,this.currentStencilZPass=-1,this.currentStencilClear=-1,this},n.WebGLEngine.prototype.getStencilTest=function(){return this.currentStencilTest}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(13),i=r(138);n.WebGLEngine.prototype._updateQuery=function(){var t=this;this._cachedQueries.forEach((function(e){e.pending&&t.gl.getQueryParameter(e.handler,t.gl.QUERY_RESULT_AVAILABLE)&&(e.result=t.gl.getQueryParameter(e.handler,t.gl.QUERY_RESULT),e.pending=!1)}))},n.WebGLEngine.prototype.createQuery=function(t){var e=new i.GLQuery(this.gl.createQuery(),t?this.gl.ANY_SAMPLES_PASSED_CONSERVATIVE:this.gl.ANY_SAMPLES_PASSED);return this._cachedQueries.push(e),e},n.WebGLEngine.prototype.deleteQuery=function(t){var e=this._cachedQueries.indexOf(t);return this._cachedQueries.splice(e,1),this.gl.deleteQuery(t.handler),this},n.WebGLEngine.prototype.beginQuery=function(t){return!t.pending&&(this.gl.beginQuery(t.target,t.handler),!0)},n.WebGLEngine.prototype.endQuery=function(t){return!t.pending&&(t.pending=!0,this.gl.endQuery(t.target),!0)}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.GLQuery=void 0;var n=0,i=function(t,e){this.id=n++,this.handler=t,this.target=e,this.pending=!1,this.result=null};e.GLQuery=i},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(13),i=r(11),o=r(140),s=r(141);n.WebGLEngine.prototype._initTextureState=function(){return this.maxTextures=this.caps.maxCombinedTexturesImageUnits,this.currentTextureSlot=0,this.currentBoundTextures={},this},n.WebGLEngine.prototype._allocateTextureUnit=function(){var t=this.currentTextureUnits;return t>=this.maxTextures&&console.warn(t+" 纹理单元大于 "+this.maxTextures+"!"),this.currentTextureUnits+=1,t},n.WebGLEngine.prototype._resetTextureUnits=function(){return this.currentTextureUnits=0,this},n.WebGLEngine.prototype._activeTexture=function(t){var e;return void 0===t&&(t=null),e=t?this.gl.TEXTURE0+t:this.gl.TEXTURE0+this.maxTextures-1,this.currentTextureSlot!=e&&(this.gl.activeTexture(e),this.currentTextureSlot=e),this},n.WebGLEngine.prototype._bindTexture=function(t){var e=this._getTextureTarget(t),r=this.currentBoundTextures[this.currentTextureSlot];return r||(r={target:-1,texture:null},this.currentBoundTextures[this.currentTextureSlot]=r),r.target==e&&r.texture==t._glTexture||(this.gl.bindTexture(e,t._glTexture),r.target=e,r.texture=t._glTexture),this},n.WebGLEngine.prototype._unbindTexture=function(){var t=this.currentBoundTextures[this.currentTextureSlot];return t&&t.texture&&(this.gl.bindTexture(t.target,null),t.target=-1,t.texture=null),this},n.WebGLEngine.prototype._setTexture=function(t,e){return(t.type!=i.Constants.FloatType||this.caps.textureFloatLinearFiltering)&&(t.type!=i.Constants.HalfFloatType||this.caps.textureHalfFloatLinearFiltering)||(t.filter=i.Constants.NearestNearestFilter),t.type!=i.Constants.FloatType||this.caps.textureFloat||(t.type=i.Constants.UnsignedIntType),t instanceof i.TextureRawCube?this.setTextureRawCube(t,e):t instanceof i.TextureRaw3D?this.setTextureRaw3D(t,e):t instanceof i.TextureRaw2DArray?this.setTextureRaw2DArray(t,e):t instanceof i.TextureRaw?this.setTextureRaw(t,e):t instanceof i.TextureCube?this.setTextureCube(t,e):t instanceof i.TextureCanvas?this.setTextureCanvas(t,e):t instanceof i.TextureVideo?this.setTextureVideo(t,e):t instanceof i.Texture2D?this.setTexture2D(t,e):this.setTexture(t,e)},n.WebGLEngine.prototype._releaseTexture=function(t){},n.WebGLEngine.prototype.setTexture=function(t,e){return t.glTexture||(t.glTexture=new o.GLTexture(this,s.GLTextureSource.Raw),t.glTexture.baseWidth=t.width,t.glTexture.baseHeight=t.height,t.glTexture.width=t.width,t.glTexture.height=t.height,t.glTexture.isCompression=t.compression,t.glTexture.format=t.format,t.glTexture.type=t.type),t.glTexture._glTexture||(t.glTexture._glTexture=this.gl.createTexture()),this._activeTexture(e),this._bindTexture(t.glTexture),t.glTexture._version==t.version||this._uploadTexture(t)},n.WebGLEngine.prototype.setTexture2D=function(t,e){return t.glTexture||(t.glTexture=new o.GLTexture(this,s.GLTextureSource.Url),t.glTexture.baseWidth=t.width,t.glTexture.baseHeight=t.height,t.glTexture.width=t.width,t.glTexture.height=t.height,t.glTexture.isCompression=t.compression,t.glTexture.format=t.format,t.glTexture.type=t.type),t.glTexture._glTexture||(t.glTexture._glTexture=this.gl.createTexture()),this._activeTexture(e),this._bindTexture(t.glTexture),t.glTexture._version==t.version||this._uploadTexture2D(t)},n.WebGLEngine.prototype.setTextureCube=function(t,e){return t.glTexture||(t.glTexture=new o.GLTexture(this,s.GLTextureSource.Cube),t.glTexture.baseWidth=t.width,t.glTexture.baseHeight=t.height,t.glTexture.width=t.width,t.glTexture.height=t.height,t.glTexture.isCompression=t.compression,t.glTexture.isCube=!0,t.glTexture.format=t.format,t.glTexture.type=t.type),t.glTexture._glTexture||(t.glTexture._glTexture=this.gl.createTexture()),this._activeTexture(e),this._bindTexture(t.glTexture),t.glTexture._version==t.version||this._uploadTextureCube(t)},n.WebGLEngine.prototype.setTextureCanvas=function(t,e){return t.glTexture||(t.glTexture=new o.GLTexture(this,s.GLTextureSource.Dynamic),t.glTexture.baseWidth=t.width,t.glTexture.baseHeight=t.height,t.glTexture.width=t.width,t.glTexture.height=t.height,t.glTexture.isCompression=t.compression,t.glTexture.format=t.format,t.glTexture.type=t.type),t.glTexture._glTexture||(t.glTexture._glTexture=this.gl.createTexture()),this._activeTexture(e),this._bindTexture(t.glTexture),t.glTexture._version==t.version||this._uploadTextureCanvas(t)},n.WebGLEngine.prototype.setTextureVideo=function(t,e){return t.glTexture||(t.glTexture=new o.GLTexture(this,s.GLTextureSource.Dynamic),t.glTexture.baseWidth=t.width,t.glTexture.baseHeight=t.height,t.glTexture.width=t.width,t.glTexture.height=t.height,t.glTexture.isCompression=t.compression,t.glTexture.format=t.format,t.glTexture.type=t.type),t.glTexture._glTexture||(t.glTexture._glTexture=this.gl.createTexture()),this._activeTexture(e),this._bindTexture(t.glTexture),t.glTexture._version==t.version||this._uploadTextureVideo(t)},n.WebGLEngine.prototype.setTextureRaw=function(t,e){return t.glTexture||(t.glTexture=new o.GLTexture(this,s.GLTextureSource.Raw),t.glTexture.baseWidth=t.width,t.glTexture.baseHeight=t.height,t.glTexture.width=t.width,t.glTexture.height=t.height,t.glTexture.isCompression=t.compression,t.glTexture.format=t.format,t.glTexture.type=t.type),t.glTexture._glTexture||(t.glTexture._glTexture=this.gl.createTexture()),this._activeTexture(e),this._bindTexture(t.glTexture),t.glTexture._version==t.version||this._uploadTextureRaw(t)},n.WebGLEngine.prototype.setTextureRawCube=function(t,e){return t.glTexture||(t.glTexture=new o.GLTexture(this,s.GLTextureSource.CubeRaw),t.glTexture.baseWidth=t.width,t.glTexture.baseHeight=t.height,t.glTexture.width=t.width,t.glTexture.height=t.height,t.glTexture.isCompression=t.compression,t.glTexture.isCube=!0,t.glTexture.format=t.format,t.glTexture.type=t.type),t.glTexture._glTexture||(t.glTexture._glTexture=this.gl.createTexture()),this._activeTexture(e),this._bindTexture(t.glTexture),t.glTexture._version==t.version||this._uploadTextureRawCube(t)},n.WebGLEngine.prototype.setTextureRaw2DArray=function(t,e){return t.glTexture||(t.glTexture=new o.GLTexture(this,s.GLTextureSource.Raw2DArray),t.glTexture.baseWidth=t.width,t.glTexture.baseHeight=t.height,t.glTexture.baseDepth=t.depth,t.glTexture.width=t.width,t.glTexture.height=t.height,t.glTexture.depth=t.depth,t.glTexture.isCompression=t.compression,t.glTexture.is2DArray=!0,t.glTexture.format=t.format,t.glTexture.type=t.type),t.glTexture._glTexture||(t.glTexture._glTexture=this.gl.createTexture()),this._activeTexture(e),this._bindTexture(t.glTexture),t.glTexture._version==t.version||this._uploadTextureRaw2DArray(t)},n.WebGLEngine.prototype.setTextureRaw3D=function(t,e){return t.glTexture||(t.glTexture=new o.GLTexture(this,s.GLTextureSource.Raw3D),t.glTexture.baseWidth=t.width,t.glTexture.baseHeight=t.height,t.glTexture.baseDepth=t.depth,t.glTexture.width=t.width,t.glTexture.height=t.height,t.glTexture.depth=t.depth,t.glTexture.isCompression=t.compression,t.glTexture.is3D=!0,t.glTexture.format=t.format,t.glTexture.type=t.type),t.glTexture._glTexture||(t.glTexture._glTexture=this.gl.createTexture()),this._activeTexture(e),this._bindTexture(t.glTexture),t.glTexture._version==t.version||this._uploadTextureRaw3D(t)},n.WebGLEngine.prototype._uploadTexture=function(t){var e=this.gl,r=t.glTexture;e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,t.flipY),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t.premultiplyAlpha),e.pixelStorei(e.UNPACK_ALIGNMENT,t.unpackAlignment),this._updateTextureFilterMode(t),this._updateTextureWrapMode(t);var n=this._getRGBABufferInternalSizedFormat(t.type,t.format),i=this._getInternalFormat(t.format),o=this._getWebGLTextureType(t.type);return e.texImage2D(e.TEXTURE_2D,0,n,r.width,r.height,0,i,o,null),t.generateMipmaps&&e.generateMipmap(e.TEXTURE_2D),!0},n.WebGLEngine.prototype._uploadTexture2D=function(t){var e=this.gl;t.glTexture;e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,t.flipY),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t.premultiplyAlpha),e.pixelStorei(e.UNPACK_ALIGNMENT,t.unpackAlignment),this._updateTextureFilterMode(t),this._updateTextureWrapMode(t);var r=this._getRGBABufferInternalSizedFormat(t.type,t.format),n=this._getInternalFormat(t.format),i=this._getWebGLTextureType(t.type);if(e.texImage2D(e.TEXTURE_2D,0,r,n,i,t.buffer),t.mipmaps.length>0)for(var o=0,s=t.mipmaps.length;o<s;++o)e.texImage2D(e.TEXTURE_2D,o+1,r,n,i,t.mipmaps[o]);return t.generateMipmaps&&e.generateMipmap(e.TEXTURE_2D),!0},n.WebGLEngine.prototype._uploadTextureCube=function(t){var e=this.gl;t.glTexture;e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,t.flipY),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t.premultiplyAlpha),e.pixelStorei(e.UNPACK_ALIGNMENT,t.unpackAlignment),this._updateTextureFilterMode(t),this._updateTextureWrapMode(t);for(var r=this._getRGBABufferInternalSizedFormat(t.type,t.format),n=this._getInternalFormat(t.format),i=this._getWebGLTextureType(t.type),o=0,s=t.buffers.length;o<s;++o)e.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+o,0,r,n,i,t.buffers[o]);if(t.mipmaps.length>0)for(o=0,s=t.mipmaps.length;o<s;++o)for(var a=0,u=t.mipmaps[o].length;a<u;++a)e.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+o,a+1,r,n,i,t.mipmaps[o][a]);return t.generateMipmaps&&e.generateMipmap(e.TEXTURE_CUBE_MAP),!0},n.WebGLEngine.prototype._uploadTextureCanvas=function(t){var e=this.gl;t.glTexture;e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,t.flipY),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t.premultiplyAlpha),e.pixelStorei(e.UNPACK_ALIGNMENT,t.unpackAlignment);var r=this._getInternalFormat(t.format);return e.texImage2D(e.TEXTURE_2D,0,r,r,e.UNSIGNED_BYTE,t.canvas),this._updateTextureFilterMode(t),this._updateTextureWrapMode(t),t.generateMipmaps&&e.generateMipmap(e.TEXTURE_2D),!0},n.WebGLEngine.prototype._uploadTextureVideo=function(t){var e=this.gl;t.glTexture;e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,t.flipY),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t.premultiplyAlpha),e.pixelStorei(e.UNPACK_ALIGNMENT,t.unpackAlignment);var r=this._getInternalFormat(t.format);return e.texImage2D(e.TEXTURE_2D,0,r,r,e.UNSIGNED_BYTE,t.video),this._updateTextureFilterMode(t),this._updateTextureWrapMode(t),t.generateMipmaps&&e.generateMipmap(e.TEXTURE_2D),!0},n.WebGLEngine.prototype._uploadTextureRaw=function(t){var e=this.gl,r=t.glTexture;e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,t.flipY),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t.premultiplyAlpha),e.pixelStorei(e.UNPACK_ALIGNMENT,t.unpackAlignment),this._updateTextureFilterMode(t),this._updateTextureWrapMode(t);var n=this._getRGBABufferInternalSizedFormat(t.type,t.format),i=this._getInternalFormat(t.format),o=this._getWebGLTextureType(t.type);if(r.isCompression?e.compressedTexImage2D(e.TEXTURE_2D,0,t.format,r.width,r.height,0,t.buffer):e.texImage2D(e.TEXTURE_2D,0,n,r.width,r.height,0,i,o,t.buffer),t.mipmaps.length>0)for(var s=0,a=t.mipmaps.length;s<a;++s)r.isCompression?e.compressedTexImage2D(e.TEXTURE_2D,s+1,t.format,t.mipmaps[s].width,t.mipmaps[s].height,0,t.mipmaps[s].buffer):e.texImage2D(e.TEXTURE_2D,s+1,n,t.mipmaps[s].width,t.mipmaps[s].height,0,i,o,t.mipmaps[s].buffer);return t.generateMipmaps&&e.generateMipmap(e.TEXTURE_2D),!0},n.WebGLEngine.prototype._uploadTextureRawCube=function(t){var e=this.gl,r=t.glTexture;e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,t.flipY),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t.premultiplyAlpha),e.pixelStorei(e.UNPACK_ALIGNMENT,t.unpackAlignment),this._updateTextureFilterMode(t),this._updateTextureWrapMode(t);for(var n=this._getRGBABufferInternalSizedFormat(t.type,t.format),i=this._getInternalFormat(t.format),o=this._getWebGLTextureType(t.type),s=0,a=t.bufferRaws.length;s<a;++s)r.isCompression?e.compressedTexImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+s,0,t.format,r.width,r.height,0,t.bufferRaws[s]):e.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+s,0,n,r.width,r.height,0,i,o,t.bufferRaws[s]);if(t.mipmapRaws.length>0)for(s=0,a=t.mipmapRaws.length;s<a;++s)for(var u=0,p=t.mipmapRaws[s].length;u<p;++u)r.isCompression?e.compressedTexImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+s,u+1,t.format,t.mipmapRaws[s][u].width,t.mipmapRaws[s][u].height,0,t.bufferRaws[s]):e.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+s,u+1,n,t.mipmapRaws[s][u].width,t.mipmapRaws[s][u].height,0,i,o,t.mipmapRaws[s][u].buffer);return t.generateMipmaps&&e.generateMipmap(e.TEXTURE_CUBE_MAP),!0},n.WebGLEngine.prototype._uploadTextureRaw2DArray=function(t){var e=this.gl,r=t.glTexture;e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,t.flipY),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t.premultiplyAlpha),e.pixelStorei(e.UNPACK_ALIGNMENT,t.unpackAlignment),this._updateTextureFilterMode(t),this._updateTextureWrapMode(t);var n=this._getRGBABufferInternalSizedFormat(t.type,t.format),i=this._getInternalFormat(t.format),o=this._getWebGLTextureType(t.type);if(r.isCompression?e.compressedTexImage3D(e.TEXTURE_2D_ARRAY,0,t.format,r.width,r.height,r.depth,0,t.buffer):e.texImage3D(e.TEXTURE_2D_ARRAY,0,n,r.width,r.height,r.depth,0,i,o,t.buffer),t.mipmaps.length>0)for(var s=0,a=t.mipmaps.length;s<a;++s)r.isCompression?e.compressedTexImage3D(e.TEXTURE_2D_ARRAY,s+1,t.format,t.mipmaps[s].width,t.mipmaps[s].height,t.mipmaps[s].depth,0,t.mipmaps[s].buffer):e.texImage3D(e.TEXTURE_2D_ARRAY,s+1,n,t.mipmaps[s].width,t.mipmaps[s].height,t.mipmaps[s].depth,0,i,o,t.mipmaps[s].buffer);return t.generateMipmaps&&e.generateMipmap(e.TEXTURE_2D),!0},n.WebGLEngine.prototype._uploadTextureRaw3D=function(t){var e=this.gl,r=t.glTexture;e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,t.flipY),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t.premultiplyAlpha),e.pixelStorei(e.UNPACK_ALIGNMENT,t.unpackAlignment),this._updateTextureFilterMode(t),this._updateTextureWrapMode(t);var n=this._getRGBABufferInternalSizedFormat(t.type,t.format),i=this._getInternalFormat(t.format),o=this._getWebGLTextureType(t.type);if(r.isCompression?e.compressedTexImage3D(e.TEXTURE_3D,0,t.format,r.width,r.height,r.depth,0,t.buffer):e.texImage3D(e.TEXTURE_3D,0,n,r.width,r.height,r.depth,0,i,o,t.buffer),t.mipmaps.length>0)for(var s=0,a=t.mipmaps.length;s<a;++s)r.isCompression?e.compressedTexImage3D(e.TEXTURE_3D,s+1,t.format,t.mipmaps[s].width,t.mipmaps[s].height,t.mipmaps[s].depth,0,t.mipmaps[s].buffer):e.texImage3D(e.TEXTURE_3D,s+1,n,t.mipmaps[s].width,t.mipmaps[s].height,t.mipmaps[s].depth,0,i,o,t.mipmaps[s].buffer);return t.generateMipmaps&&e.generateMipmap(e.TEXTURE_2D),!0},n.WebGLEngine.prototype._getTextureTarget=function(t){var e;switch(t._source){case s.GLTextureSource.Depth:case s.GLTextureSource.Url:case s.GLTextureSource.Raw:case s.GLTextureSource.Dynamic:e=this.gl.TEXTURE_2D;break;case s.GLTextureSource.Raw3D:e=this.gl.TEXTURE_3D;break;case s.GLTextureSource.Raw2DArray:e=this.gl.TEXTURE_2D_ARRAY;break;case s.GLTextureSource.Cube:case s.GLTextureSource.CubeRaw:e=this.gl.TEXTURE_CUBE_MAP;break;default:e=this.gl.TEXTURE_2D}return e},n.WebGLEngine.prototype._getFilterParameters=function(t){var e=this.gl,r=t.generateMipmaps,n=e.NEAREST,o=e.NEAREST;switch(t.filter){case i.Constants.LinearLinearMipNearestFilter:n=e.LINEAR,o=r?e.LINEAR_MIPMAP_NEAREST:e.LINEAR;break;case i.Constants.LinearLinearMipLinearFilter:n=e.LINEAR,o=r?e.LINEAR_MIPMAP_LINEAR:e.LINEAR;break;case i.Constants.NearestNearestMipLinearFilter:n=e.NEAREST,o=r?e.NEAREST_MIPMAP_LINEAR:e.NEAREST;break;case i.Constants.NearestNearestMipNearestFilter:n=e.NEAREST,o=r?e.NEAREST_MIPMAP_NEAREST:e.NEAREST;break;case i.Constants.NearestLinearMipNearestFilter:n=e.NEAREST,o=r?e.LINEAR_MIPMAP_NEAREST:e.LINEAR;break;case i.Constants.NearestLinearMipLinearFilter:n=e.NEAREST,o=r?e.LINEAR_MIPMAP_LINEAR:e.LINEAR;break;case i.Constants.NearestLinearFilter:n=e.NEAREST,o=e.LINEAR;break;case i.Constants.NearestNearestFilter:n=e.NEAREST,o=e.NEAREST;break;case i.Constants.LinearNearestMipNearestFilter:n=e.LINEAR,o=r?e.NEAREST_MIPMAP_NEAREST:e.NEAREST;break;case i.Constants.LinearNearestMipLinearFilter:n=e.LINEAR,o=r?e.NEAREST_MIPMAP_LINEAR:e.NEAREST;break;case i.Constants.LinearLinearFilter:n=e.LINEAR,o=e.LINEAR;break;case i.Constants.LinearNearestFilter:n=e.LINEAR,o=e.NEAREST}return{min:o,mag:n}},n.WebGLEngine.prototype._getTextureWrapMode=function(t){var e=this.gl;switch(t){case i.Constants.RepeatWrapping:return e.REPEAT;case i.Constants.ClampToEdgeWrapping:return e.CLAMP_TO_EDGE;case i.Constants.MirroredRepeatWrapping:return e.MIRRORED_REPEAT}return e.REPEAT},n.WebGLEngine.prototype._updateTextureFilterMode=function(t){var e=this.gl,r=t.glTexture,n=this._getTextureTarget(r),i=this._getFilterParameters(t);e.texParameteri(n,e.TEXTURE_MAG_FILTER,i.mag),e.texParameteri(n,e.TEXTURE_MIN_FILTER,i.min)},n.WebGLEngine.prototype._updateTextureWrapMode=function(t){var e=this.gl,r=t.glTexture,n=this._getTextureTarget(r);e.texParameteri(n,e.TEXTURE_WRAP_S,this._getTextureWrapMode(t.wrapU)),e.texParameteri(n,e.TEXTURE_WRAP_T,this._getTextureWrapMode(t.wrapV)),(r.is3D||r.is2DArray)&&e.texParameteri(n,e.TEXTURE_WRAP_R,t.wrapR)}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.GLTexture=void 0;var n=function(){function t(t,e){this.isCube=!1,this.is3D=!1,this.is2DArray=!1,this.isCompression=!1,this.baseWidth=0,this.baseHeight=0,this.baseDepth=0,this.width=0,this.height=0,this.depth=0,this.format=-1,this.type=-1,this._version=-1,this._references=0,this._framebuffer=null,this._MSAAFramebuffer=null,this._MSAARenderBuffer=null,this._glTexture=null,this._glRenderbuffer=null,this._colorBuffers=null,this._colorAttachments=null,this._engine=t,this._source=e}return t.prototype.addReference=function(){this._references++},t.prototype.dispose=function(){this._references--,0==this._references&&this._engine._releaseTexture(this)},t}();e.GLTexture=n},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.GLTextureSource=void 0,function(t){t[t.Unknown=0]="Unknown",t[t.Url=1]="Url",t[t.Temp=2]="Temp",t[t.Raw=3]="Raw",t[t.Dynamic=4]="Dynamic",t[t.RenderTarget=5]="RenderTarget",t[t.MultiRenderTarget=6]="MultiRenderTarget",t[t.Cube=7]="Cube",t[t.CubeRaw=8]="CubeRaw",t[t.Raw3D=9]="Raw3D",t[t.Raw2DArray=10]="Raw2DArray",t[t.Depth=11]="Depth"}(e.GLTextureSource||(e.GLTextureSource={}))},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(13);n.WebGLEngine.prototype.createTransformFeedback=function(){return this.gl.createTransformFeedback()},n.WebGLEngine.prototype.deleteTransformFeedback=function(t){return this.gl.deleteTransformFeedback(t),this},n.WebGLEngine.prototype.bindTransformFeedback=function(t){return this.gl.bindTransformFeedback(this.gl.TRANSFORM_FEEDBACK,t),this},n.WebGLEngine.prototype.beginTransformFeedback=function(t){return void 0===t&&(t=!0),this.gl.beginTransformFeedback(t?this.gl.POINTS:this.gl.TRIANGLES),this},n.WebGLEngine.prototype.endTransformFeedback=function(){return this.gl.endTransformFeedback(),this},n.WebGLEngine.prototype.pauseTransformFeedback=function(){return this.gl.pauseTransformFeedback(),this},n.WebGLEngine.prototype.resumeTransformFeedback=function(){return this.gl.resumeTransformFeedback(),this},n.WebGLEngine.prototype.setTranformFeedbackVaryings=function(t,e,r){return void 0===r&&(r=!1),this.gl.transformFeedbackVaryings(t,e,r?this.gl.SEPARATE_ATTRIBS:this.gl.INTERLEAVED_ATTRIBS),this},n.WebGLEngine.prototype.bindTransformFeedbackBuffer=function(t,e){return void 0===e&&(e=0),this.gl.bindBufferBase(this.gl.TRANSFORM_FEEDBACK_BUFFER,e,t),this}},function(t,e,r){"use strict";var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(e,"__esModule",{value:!0}),e.Texture2D=void 0;var o=function(t){function e(e,r,n,i,o,s,a){void 0===e&&(e=null),void 0===r&&(r=!1),void 0===n&&(n=!1),void 0===i&&(i=!0);var u=t.call(this)||this;return u.buffer=null,u.deleteBuffer=!1,u.deleteBuffer=r,u.generateMipmaps=n,o&&(u.format=o),u._flipY=i,s&&(u._wrapU=s),a&&(u._wrapV=a),e&&(u.buffer=e,u.width=e.width,u.height=e.height),u}return i(e,t),Object.defineProperty(e.prototype,"isReady",{get:function(){return null!=this.buffer&&this.buffer.width>0&&this.buffer.height>0},enumerable:!1,configurable:!0}),e.prototype.updateBuffer=function(t){this.buffer=t,this.width=t.width,this.height=t.height,this.unpackAlignment=this.width%4!=0?1:4,this.needsUpdate=!0},e.prototype.updateMipmaps=function(t){this.mipmaps=t,this.needsUpdate=!0},e.prototype.clone=function(){return new e(this.buffer,this.deleteBuffer).copy(this)},e.prototype.copy=function(e){return t.prototype.copy.call(this,e),this},e.prototype.dispose=function(){t.prototype.dispose.call(this),this.deleteBuffer&&delete this.buffer},e}(r(23).Texture);e.Texture2D=o},function(t,e,r){"use strict";var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(e,"__esModule",{value:!0}),e.TextureCanvas=void 0;var o=function(t){function e(e,r){void 0===r&&(r=!1);var n=t.call(this)||this;return n.generateMipmaps=r,e.getContext?n.canvas=e:(n.canvas=document.createElement("canvas"),e.width||0==e.width?(n.canvas.width=e.width,n.canvas.height=e.height):(n.canvas.width=e,n.canvas.height=e)),n}return i(e,t),Object.defineProperty(e.prototype,"width",{get:function(){var t;return null===(t=this.canvas)||void 0===t?void 0:t.width},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){var t;return null===(t=this.canvas)||void 0===t?void 0:t.height},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isReady",{get:function(){return null!=this.canvas},enumerable:!1,configurable:!0}),e.prototype.clone=function(){return new e(this.canvas).copy(this)},e.prototype.copy=function(e){return t.prototype.copy.call(this,e),this},e}(r(23).Texture);e.TextureCanvas=o},function(t,e,r){"use strict";var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(e,"__esModule",{value:!0}),e.TextureRaw2DArray=void 0;var o=r(58),s=r(12),a=function(t){function e(e,r,n,i,o,a,u,p,h){void 0===o&&(o=!1),void 0===a&&(a=!0),void 0===u&&(u=s.Constants.RGBAFormat),void 0===p&&(p=s.Constants.UnsignedByteType),void 0===h&&(h=!1);var c=t.call(this,e,r,n,o,a,u,p,h)||this;return c.depth=i,c}return i(e,t),e.prototype.clone=function(){return new e(this.buffer,this.width,this.height,this.depth,this.deleteBuffer).copy(this)},e.prototype.copy=function(e){return t.prototype.copy.call(this,e),this},e}(o.TextureRaw);e.TextureRaw2DArray=a},function(t,e,r){"use strict";var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(e,"__esModule",{value:!0}),e.TextureRaw3D=void 0;var o=r(58),s=r(12),a=function(t){function e(e,r,n,i,o,a,u,p,h){void 0===o&&(o=!1),void 0===a&&(a=!0),void 0===u&&(u=s.Constants.RGBAFormat),void 0===p&&(p=s.Constants.UnsignedByteType),void 0===h&&(h=!1);var c=t.call(this,e,r,n,o,a,u,p,h)||this;return c.depth=i,c}return i(e,t),e.prototype.clone=function(){return new e(this.buffer,this.width,this.height,this.depth,this.deleteBuffer).copy(this)},e.prototype.copy=function(e){return t.prototype.copy.call(this,e),this},e}(o.TextureRaw);e.TextureRaw3D=a},function(t,e,r){"use strict";var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(e,"__esModule",{value:!0}),e.TextureRawCube=void 0;var o=function(t){function e(e,r,n,i,o,s,a,u){void 0===n&&(n=!1),void 0===i&&(i=!1),void 0===o&&(o=!1);var p=t.call(this,null,n,i,o,s,a,u)||this;return p.bufferRaws=[],p.width=r,p.height=r,p.bufferRaws=e,p.unpackAlignment=p.width%4!=0?1:4,p}return i(e,t),Object.defineProperty(e.prototype,"isReady",{get:function(){return this.bufferRaws.length>0},enumerable:!1,configurable:!0}),e.prototype.clone=function(){return new e(this.bufferRaws,this.width,this.deleteBuffer).copy(this)},e.prototype.copy=function(e){return t.prototype.copy.call(this,e),this},e.prototype.dispose=function(){var e=this;t.prototype.dispose.call(this),this.deleteBuffer&&(this.bufferRaws.forEach((function(t,r){delete e.bufferRaws[r]})),this.bufferRaws.length=0)},e}(r(79).TextureCube);e.TextureRawCube=o},function(t,e,r){"use strict";var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(e,"__esModule",{value:!0}),e.TextureVideo=void 0;var o=function(t){function e(e,r,n,i,o){void 0===r&&(r=!0),void 0===n&&(n=!0),void 0===i&&(i=!1),void 0===o&&(o=!1);var s=t.call(this)||this;return s.currentSrc=e,s.video=s._getVideo(e),s.video.autoplay=!0,s.video.loop=!0,s.video.muted=!0,s.video.setAttribute("playsinline",""),s}return i(e,t),Object.defineProperty(e.prototype,"width",{get:function(){var t;return null===(t=this.video)||void 0===t?void 0:t.width},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){var t;return null===(t=this.video)||void 0===t?void 0:t.height},enumerable:!1,configurable:!0}),e.prototype._getVideo=function(t){if(t instanceof HTMLVideoElement)return t;var e=document.createElement("video");return"string"==typeof t?e.src=t:t.forEach((function(t){var r=document.createElement("source");r.src=t,e.appendChild(r)})),e},Object.defineProperty(e.prototype,"isReady",{get:function(){return null!=this.video},enumerable:!1,configurable:!0}),e.prototype.clone=function(){return new e(this.currentSrc,this.autoPlay,this.loop).copy(this)},e.prototype.copy=function(e){return t.prototype.copy.call(this,e),this.autoUpdateTexture=e.autoUpdateTexture,this},e.prototype.dispose=function(){t.prototype.dispose.call(this),this.currentSrc=null,this.video.pause()},e}(r(23).Texture);e.TextureVideo=o},function(t,e,r){"use strict";var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(e,"__esModule",{value:!0}),e.BinaryBuffer=void 0;var o=r(52),s=r(26),a=r(44),u=r(2),p=r(0),h=r(16),c=r(18),l=r(17),f=r(35),y=r(33),d=r(36),_=r(25),m=r(53),g=function(t){function e(e){void 0===e&&(e=102400);var r=t.call(this,e)||this;return r._growCount=0,r}return i(e,t),e.prototype.readChars=function(){var e=this.readUint32();return e>0?t.prototype.readChars.call(this,e):""},e.prototype.readString=function(){var t=this.readUint32();return t>0?this.readUtf8(t):""},e.prototype.readColorRGB=function(t){return void 0===t&&(t=new s.ColorRGB),t.fromDataBuffer(this),t},e.prototype.readColorRGBA=function(t){return void 0===t&&(t=new a.ColorRGBA),t.fromDataBuffer(this),t},e.prototype.readVector2=function(t){return void 0===t&&(t=new u.Vector2),t.fromDataBuffer(this),t},e.prototype.readVector3=function(t){return void 0===t&&(t=new p.Vector3),t.fromDataBuffer(this),t},e.prototype.readVector4=function(t){return void 0===t&&(t=new h.Vector4),t.fromDataBuffer(this),t},e.prototype.readMatrix3=function(t){return void 0===t&&(t=new c.Matrix3),t.fromDataBuffer(this),t},e.prototype.readMatrix4=function(t){return void 0===t&&(t=new l.Matrix4),t.fromDataBuffer(this),t},e.prototype.readQuaternion=function(t){return void 0===t&&(t=new f.Quaternion),t.fromDataBuffer(this),t},e.prototype.readEuler=function(t){return void 0===t&&(t=new y.Euler),t.fromDataBuffer(this),t},e.prototype.readBox2=function(t){return void 0===t&&(t=new d.Box2),t.min.fromDataBuffer(this),t.max.fromDataBuffer(this),t},e.prototype.readBox3=function(t){return void 0===t&&(t=new _.Box3),t.min.fromDataBuffer(this),t.max.fromDataBuffer(this),t},e.prototype.writeBoolean=function(e){return this._growBuffer(1),t.prototype.writeBoolean.call(this,e)},e.prototype.writeInt8=function(e){return this._growBuffer(1),t.prototype.writeInt8.call(this,e)},e.prototype.writeUint8=function(e){return this._growBuffer(1),t.prototype.writeUint8.call(this,e)},e.prototype.writeByte=function(e){return this._growBuffer(1),t.prototype.writeByte.call(this,e)},e.prototype.writeBytes=function(e){return this._growBuffer(e.length),t.prototype.writeBytes.call(this,e)},e.prototype.writeInt16=function(e){return this._growBuffer(2),t.prototype.writeInt16.call(this,e)},e.prototype.writeUint16=function(e){return this._growBuffer(2),t.prototype.writeUint16.call(this,e)},e.prototype.writeInt32=function(e){return this._growBuffer(4),t.prototype.writeInt32.call(this,e)},e.prototype.writeUint32=function(e){return this._growBuffer(4),t.prototype.writeUint32.call(this,e)},e.prototype.writeFloat32=function(e){return this._growBuffer(4),t.prototype.writeFloat32.call(this,e)},e.prototype.writeFloat64=function(e){return this._growBuffer(8),t.prototype.writeFloat64.call(this,e)},e.prototype.writeChar=function(e){return this._growBuffer(1),t.prototype.writeChar.call(this,e)},e.prototype.writeChars=function(e){return this._growBuffer(e.length),this.writeUint32(e.length),t.prototype.writeChars.call(this,e)},e.prototype.writeString=function(t){var e=m.encode(t);return this._growBuffer(e.length),this.writeUint32(e.length),this.writeChars(e),this},e.prototype.writeColorRGB=function(t){return t.toDataBuffer(this),this},e.prototype.writeColorRGBA=function(t){return t.toDataBuffer(this),this},e.prototype.writeVector2=function(t){return t.toDataBuffer(this),this},e.prototype.writeVector3=function(t){return t.toDataBuffer(this),this},e.prototype.writeVector4=function(t){return t.toDataBuffer(this),this},e.prototype.writeMatrix3=function(t){return t.toDataBuffer(this),this},e.prototype.writeMatrix4=function(t){return t.toDataBuffer(this),this},e.prototype.writeQuaternion=function(t){return t.toDataBuffer(this),this},e.prototype.writeEuler=function(t){return t.toDataBuffer(this),this},e.prototype.writeBox2=function(t){return t.min.toDataBuffer(this),t.max.toDataBuffer(this),this},e.prototype.writeBox3=function(t){return t.min.toDataBuffer(this),t.max.toDataBuffer(this),this},e.prototype._growBuffer=function(t){if(!this.available(t)){this._growCount++;var e=Math.max(102400*this._growCount,t);this.ensureAvailable(t<e?e:2*t)}},e}(o.IOBuffer);e.BinaryBuffer=g},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.PixelFormat=void 0;var n=r(11),i=function(){function t(){}return t.formatComponentsLength=function(t){switch(t){case n.Constants.RGBFormat:case n.Constants.RGBIntegerFormat:return 3;case n.Constants.RGBAFormat:case n.Constants.RGBAIntegerFormat:return 4;case n.Constants.RGFormat:case n.Constants.RGIntegerFormat:case n.Constants.LuminanceAlphaFormat:return 2;default:return 1}},t.compressedTextureSizeInBytes=function(t,e,r){switch(t){case n.Constants.RGB_S3TC_DXT1_Format:case n.Constants.RGBA_S3TC_DXT1_Format:case n.Constants.RGB_ETC1_Format:case n.Constants.RGB_ETC2_Format:return Math.floor((e+3)/4)*Math.floor((r+3)/4)*8;case n.Constants.RGBA_S3TC_DXT3_Format:case n.Constants.RGBA_S3TC_DXT5_Format:return Math.floor((e+3)/4)*Math.floor((r+3)/4)*16;case n.Constants.RGB_PVRTC_4BPPV1_Format:case n.Constants.RGBA_PVRTC_4BPPV1_Format:return Math.floor((Math.max(e,8)*Math.max(r,8)*4+7)/8);case n.Constants.RGB_PVRTC_2BPPV1_Format:case n.Constants.RGBA_PVRTC_2BPPV1_Format:return Math.floor((Math.max(e,16)*Math.max(r,8)*2+7)/8);default:return 0}},t.textureSizeInBytes=function(e,r,n,i){var o=t.formatComponentsLength(e);return t.dataTypeIsPacked(r)&&(o=1),o*t.dataTypeSizeInBytes(r)*n*i},t.alignmentInBytes=function(e,r,n){var i=t.textureSizeInBytes(e,r,n,1)%4;return 0==i?4:2==i?2:1},t.dataTypeIsPacked=function(t){return t==n.Constants.UnsignedInt248Type||t==n.Constants.UnsignedShort4444Type||t==n.Constants.UnsignedShort5551Type||t==n.Constants.UnsignedShort565Type},t.dataTypeSizeInBytes=function(t){switch(t){case n.Constants.ByteType:case n.Constants.UnsignedByteType:return 1;case n.Constants.ShortType:case n.Constants.UnsignedShortType:case n.Constants.UnsignedShort4444Type:case n.Constants.UnsignedShort5551Type:case n.Constants.UnsignedShort565Type:case n.Constants.HalfFloatType:return 2;case n.Constants.IntType:case n.Constants.UnsignedIntType:case n.Constants.FloatType:case n.Constants.UnsignedInt248Type:return 4;case n.Constants.DoubleType:return 8}return 0},t}();e.PixelFormat=i},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ArrayUtils=void 0;var n=function(){function t(){}return t.arrayMin=function(t){if(0==t.length)return 1/0;for(var e=t[0],r=1,n=t.length;r<n;++r)t[r]<e&&(e=t[r]);return e},t.arrayMax=function(t){if(0==t.length)return-1/0;for(var e=t[0],r=1,n=t.length;r<n;++r)t[r]>e&&(e=t[r]);return e},t}();e.ArrayUtils=n},function(t,e,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(t,e,r,n){void 0===n&&(n=r),Object.defineProperty(t,n,{enumerable:!0,get:function(){return e[r]}})}:function(t,e,r,n){void 0===n&&(n=r),t[n]=e[r]}),i=this&&this.__exportStar||function(t,e){for(var r in t)"default"===r||e.hasOwnProperty(r)||n(e,t,r)};Object.defineProperty(e,"__esModule",{value:!0}),i(r(22),e),i(r(60),e),i(r(153),e),i(r(32),e),i(r(154),e),i(r(155),e),i(r(156),e),i(r(157),e),i(r(158),e),i(r(159),e),i(r(81),e),i(r(82),e),i(r(160),e),i(r(59),e),i(r(161),e)},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0})},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0})},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0})},function(t,e,r){"use strict";var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(e,"__esModule",{value:!0}),e.InstancedBufferAttribute=void 0;var o=function(t){function e(e,r,n,i){void 0===n&&(n=!1),void 0===i&&(i=1);var o=t.call(this,e,r,n)||this;return o.meshPerAttribute=i,o}return i(e,t),e.prototype.clone=function(){return new e(this.array,this.itemSize,this.normalized,this.meshPerAttribute).copy(this)},e.prototype.copy=function(e){return t.prototype.copy.call(this,e),this},e}(r(22).BufferAttribute);e.InstancedBufferAttribute=o},function(t,e,r){"use strict";var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(e,"__esModule",{value:!0}),e.InstancedBufferGeometry=void 0;var o=function(t){function e(){var e=t.call(this)||this;return e.instanceCount=null,e}return i(e,t),e}(r(32).Geometry);e.InstancedBufferGeometry=o},function(t,e,r){"use strict";var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(e,"__esModule",{value:!0}),e.InstancedInterleavedBuffer=void 0;var o=function(t){function e(e,r,n){void 0===n&&(n=1);var i=t.call(this,e,r)||this;return i.meshPerAttribute=n,i}return i(e,t),e.prototype.clone=function(){return new e(this.array,this.stride,this.meshPerAttribute).copy(this)},e.prototype.copy=function(e){return t.prototype.copy.call(this,e),this},e}(r(81).InterleavedBuffer);e.InstancedInterleavedBuffer=o},function(t,e,r){"use strict";var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(e,"__esModule",{value:!0}),e.InstancedInterleavedBufferAttribute=void 0;var o=function(t){function e(e,r,n,i,o){void 0===i&&(i=!1),void 0===o&&(o=1);var s=t.call(this,e,r,n,i)||this;return s.meshPerAttribute=o,s}return i(e,t),e.prototype.clone=function(){return new e(this.buffer,this.itemSize,this.offset,this.normalized,this.meshPerAttribute)},e.prototype.copy=function(e){return t.prototype.copy.call(this,e),this},e}(r(82).InterleavedBufferAttribute);e.InstancedInterleavedBufferAttribute=o},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0})},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.BoxGeometryBuilder=void 0;var n=r(4),i=r(32),o=r(59),s=function(){function t(){}return t.build=function(t,e,r,s,a,u,p){void 0===t&&(t=1),void 0===e&&(e=1),void 0===r&&(r=1),void 0===s&&(s=1),void 0===a&&(a=1),void 0===u&&(u=1),void 0===p&&(p=!0);var h=new Array,c=new Array,l=new Array,f=new Array,y=0,d=0,_=new i.Geometry;function m(t,e,r,i,o,s,a,u,m,g,v){var x,b,S=s/m,T=a/g,C=s/2,E=a/2,M=u/2,w=m+1,P=g+1,A=0,O=0,R=new n.Vector3;for(b=0;b<P;b++){var B=b*T-E;for(x=0;x<w;x++){var I=x*S-C;R.setComponent(t,I*i),R.setComponent(e,B*o),R.setComponent(r,M),c.push(R.x,R.y,R.z),R.setComponent(t,0),R.setComponent(e,0),R.setComponent(r,u>0?1:-1),l.push(R.x,R.y,R.z),f.push(x/m),f.push(1-b/g),0==p&&(f[f.length-2]=f[f.length-2]*s,f[f.length-1]=f[f.length-1]*a),A+=1}}for(b=0;b<g;b++)for(x=0;x<m;x++){var N=y+x+w*b,F=y+x+w*(b+1),G=y+(x+1)+w*(b+1),D=y+(x+1)+w*b;h.push(N,F,D),h.push(F,G,D),O+=6}_.addGroup(d,O,v),d+=O,y+=A}return m(2,1,0,-1,-1,r,e,t,u,a,0),m(2,1,0,1,-1,r,e,-t,u,a,1),m(0,2,1,1,1,t,r,e,s,u,2),m(0,2,1,1,-1,t,r,-e,s,u,3),m(0,1,2,1,-1,t,e,r,s,a,4),m(0,1,2,-1,-1,t,e,-r,s,a,5),_.setIndexAttrbute(h),_.setAttribute("position",new o.Float32BufferAttribute(c,3)),_.setAttribute("normal",new o.Float32BufferAttribute(l,3)),_.setAttribute("uv",new o.Float32BufferAttribute(f,2)),_},t}();e.BoxGeometryBuilder=s},function(t,e,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(t,e,r,n){void 0===n&&(n=r),Object.defineProperty(t,n,{enumerable:!0,get:function(){return e[r]}})}:function(t,e,r,n){void 0===n&&(n=r),t[n]=e[r]}),i=this&&this.__exportStar||function(t,e){for(var r in t)"default"===r||e.hasOwnProperty(r)||n(e,t,r)};Object.defineProperty(e,"__esModule",{value:!0}),i(r(15),e),i(r(163),e),i(r(164),e),i(r(165),e),i(r(166),e),i(r(167),e),i(r(168),e)},function(t,e,r){"use strict";var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(e,"__esModule",{value:!0}),e.AmbientLight=void 0;var o=function(t){function e(e,r,n){return void 0===r&&(r=null),void 0===n&&(n=""),t.call(this,e,r,n)||this}return i(e,t),Object.defineProperty(e.prototype,"castShadow",{set:function(t){this._castShadow=!1},enumerable:!1,configurable:!0}),e}(r(15).Light);e.AmbientLight=o},function(t,e,r){"use strict";var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(e,"__esModule",{value:!0}),e.DirectionalLight=void 0;var o=r(15),s=r(4),a=function(t){function e(e,r,n){void 0===r&&(r=null),void 0===n&&(n="");var i=t.call(this,e,r,n)||this;return i._position.set(0,1,0),i._target=new s.Vector3,i}return i(e,t),Object.defineProperty(e.prototype,"target",{get:function(){return this._target},set:function(t){this._target.copy(t)},enumerable:!1,configurable:!0}),e}(o.Light);e.DirectionalLight=a},function(t,e,r){"use strict";var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(e,"__esModule",{value:!0}),e.HemisphereLight=void 0;var o=r(15),s=r(4),a=function(t){function e(e,r,n){void 0===r&&(r=null),void 0===n&&(n="");var i=t.call(this,e,r,n)||this;return i._groundColor=new s.ColorRGB(1,1,1),i}return i(e,t),Object.defineProperty(e.prototype,"castShadow",{set:function(t){this._castShadow=!1},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"groundColor",{get:function(){return this._groundColor},set:function(t){this._groundColor.copy(t)},enumerable:!1,configurable:!0}),e}(o.Light);e.HemisphereLight=a},function(t,e,r){"use strict";var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(e,"__esModule",{value:!0}),e.PointLight=void 0;var o=function(t){function e(e,r,n){void 0===r&&(r=null),void 0===n&&(n="");var i=t.call(this,e,r,n)||this;return i._distance=0,i._decay=1,i}return i(e,t),Object.defineProperty(e.prototype,"intensity",{get:function(){return 4*this._intensity*Math.PI},set:function(t){this._intensity=t/(4*Math.PI)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"distance",{get:function(){return this._distance},set:function(t){this._distance=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"decay",{get:function(){return this._decay},set:function(t){this._decay=t},enumerable:!1,configurable:!0}),e}(r(15).Light);e.PointLight=o},function(t,e,r){"use strict";var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(e,"__esModule",{value:!0}),e.RectAreaLight=void 0;var o=function(t){function e(e,r,n){void 0===r&&(r=null),void 0===n&&(n="");var i=t.call(this,e,r,n)||this;return i._width=10,i._height=10,i}return i(e,t),Object.defineProperty(e.prototype,"width",{get:function(){return this._width},set:function(t){this._width!=t&&(this._width=t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this._height},set:function(t){this._height!=t&&(this._height=t)},enumerable:!1,configurable:!0}),e}(r(15).Light);e.RectAreaLight=o},function(t,e,r){"use strict";var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(e,"__esModule",{value:!0}),e.SpotLight=void 0;var o=r(15),s=r(4),a=function(t){function e(e,r,n){void 0===r&&(r=null),void 0===n&&(n="");var i=t.call(this,e,r,n)||this;return i._distance=0,i._angle=Math.PI/3,i._penumbra=0,i._decay=1,i._target=new s.Vector3,i._position.set(0,1,0),i}return i(e,t),Object.defineProperty(e.prototype,"intensity",{get:function(){return 4*this._intensity*Math.PI},set:function(t){this._intensity=t/Math.PI},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"distance",{get:function(){return this._distance},set:function(t){this._distance=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"angle",{get:function(){return this._angle},set:function(t){this._angle=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"penumbra",{get:function(){return this._penumbra},set:function(t){this._penumbra=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"decay",{get:function(){return this._decay},set:function(t){this._decay=t},enumerable:!1,configurable:!0}),e}(o.Light);e.SpotLight=a},function(t,e,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(t,e,r,n){void 0===n&&(n=r),Object.defineProperty(t,n,{enumerable:!0,get:function(){return e[r]}})}:function(t,e,r,n){void 0===n&&(n=r),t[n]=e[r]}),i=this&&this.__exportStar||function(t,e){for(var r in t)"default"===r||e.hasOwnProperty(r)||n(e,t,r)};Object.defineProperty(e,"__esModule",{value:!0}),i(r(170),e),i(r(171),e),i(r(172),e),i(r(3),e),i(r(83),e),i(r(173),e),i(r(174),e),i(r(175),e),i(r(176),e),i(r(177),e),i(r(178),e),i(r(179),e),i(r(180),e),i(r(181),e),i(r(182),e),i(r(183),e),i(r(184),e),i(r(185),e),i(r(186),e)},function(t,e,r){"use strict";var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(e,"__esModule",{value:!0}),e.LineBasicMaterial=void 0;var o=function(t){function e(){return t.call(this)||this}return i(e,t),e.prototype.clone=function(){return(new e).copy(this)},e}(r(3).Material);e.LineBasicMaterial=o},function(t,e,r){"use strict";var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(e,"__esModule",{value:!0}),e.LineDashedMaterial=void 0;var o=function(t){function e(){return t.call(this)||this}return i(e,t),e.prototype.clone=function(){return(new e).copy(this)},e}(r(3).Material);e.LineDashedMaterial=o},function(t,e,r){"use strict";var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(e,"__esModule",{value:!0}),e.LineFlatMaterial=void 0;var o=function(t){function e(){return t.call(this)||this}return i(e,t),e.prototype.clone=function(){return(new e).copy(this)},e}(r(3).Material);e.LineFlatMaterial=o},function(t,e,r){"use strict";var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(e,"__esModule",{value:!0}),e.MeshDepthMaterial=void 0;var o=function(t){function e(){return t.call(this)||this}return i(e,t),e.prototype.clone=function(){return(new e).copy(this)},e}(r(3).Material);e.MeshDepthMaterial=o},function(t,e,r){"use strict";var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(e,"__esModule",{value:!0}),e.MeshDistanceMaterial=void 0;var o=function(t){function e(){return t.call(this)||this}return i(e,t),e.prototype.clone=function(){return(new e).copy(this)},e}(r(3).Material);e.MeshDistanceMaterial=o},function(t,e,r){"use strict";var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(e,"__esModule",{value:!0}),e.MeshLambertMaterial=void 0;var o=function(t){function e(){return t.call(this)||this}return i(e,t),e.prototype.clone=function(){return(new e).copy(this)},e}(r(3).Material);e.MeshLambertMaterial=o},function(t,e,r){"use strict";var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(e,"__esModule",{value:!0}),e.MeshMatcapMaterial=void 0;var o=function(t){function e(){return t.call(this)||this}return i(e,t),e.prototype.clone=function(){return(new e).copy(this)},e}(r(3).Material);e.MeshMatcapMaterial=o},function(t,e,r){"use strict";var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(e,"__esModule",{value:!0}),e.MeshNormalMaterial=void 0;var o=function(t){function e(){return t.call(this)||this}return i(e,t),e.prototype.clone=function(){return(new e).copy(this)},e}(r(3).Material);e.MeshNormalMaterial=o},function(t,e,r){"use strict";var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(e,"__esModule",{value:!0}),e.MeshPhongMaterial=void 0;var o=function(t){function e(){return t.call(this)||this}return i(e,t),e.prototype.clone=function(){return(new e).copy(this)},e}(r(3).Material);e.MeshPhongMaterial=o},function(t,e,r){"use strict";var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(e,"__esModule",{value:!0}),e.MeshPhysicalMaterial=void 0;var o=function(t){function e(){return t.call(this)||this}return i(e,t),e.prototype.clone=function(){return(new e).copy(this)},e}(r(3).Material);e.MeshPhysicalMaterial=o},function(t,e,r){"use strict";var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(e,"__esModule",{value:!0}),e.MeshStandardMaterial=void 0;var o=function(t){function e(){return t.call(this)||this}return i(e,t),e.prototype.clone=function(){return(new e).copy(this)},e}(r(3).Material);e.MeshStandardMaterial=o},function(t,e,r){"use strict";var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(e,"__esModule",{value:!0}),e.MeshToonMaterial=void 0;var o=function(t){function e(){return t.call(this)||this}return i(e,t),e.prototype.clone=function(){return(new e).copy(this)},e}(r(3).Material);e.MeshToonMaterial=o},function(t,e,r){"use strict";var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(e,"__esModule",{value:!0}),e.MultiMaterial=void 0;var o=function(t){function e(){return t.call(this)||this}return i(e,t),e.prototype.clone=function(){return(new e).copy(this)},e}(r(3).Material);e.MultiMaterial=o},function(t,e,r){"use strict";var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(e,"__esModule",{value:!0}),e.PointsMaterial=void 0;var o=function(t){function e(){return t.call(this)||this}return i(e,t),e.prototype.clone=function(){return(new e).copy(this)},e}(r(3).Material);e.PointsMaterial=o},function(t,e,r){"use strict";var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(e,"__esModule",{value:!0}),e.ShaderMaterial=void 0;var o=function(t){function e(){return t.call(this)||this}return i(e,t),e.prototype.clone=function(){return(new e).copy(this)},e}(r(3).Material);e.ShaderMaterial=o},function(t,e,r){"use strict";var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(e,"__esModule",{value:!0}),e.ShadowMaterial=void 0;var o=function(t){function e(){return t.call(this)||this}return i(e,t),e.prototype.clone=function(){return(new e).copy(this)},e}(r(3).Material);e.ShadowMaterial=o},function(t,e,r){"use strict";var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(e,"__esModule",{value:!0}),e.SpriteMaterial=void 0;var o=function(t){function e(){return t.call(this)||this}return i(e,t),e.prototype.clone=function(){return(new e).copy(this)},e}(r(3).Material);e.SpriteMaterial=o},function(t,e,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(t,e,r,n){void 0===n&&(n=r),Object.defineProperty(t,n,{enumerable:!0,get:function(){return e[r]}})}:function(t,e,r,n){void 0===n&&(n=r),t[n]=e[r]}),i=this&&this.__exportStar||function(t,e){for(var r in t)"default"===r||e.hasOwnProperty(r)||n(e,t,r)};Object.defineProperty(e,"__esModule",{value:!0}),i(r(74),e),i(r(24),e),i(r(84),e),i(r(85),e),i(r(188),e)},function(t,e,r){"use strict";var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(e,"__esModule",{value:!0}),e.Scene=void 0;var o=r(85),s=r(24),a=r(4),u=r(11),p=r(21),h=r(189),c=r(191),l=function(t){function e(e){var r=t.call(this)||this;return r._rootNodes=new Array,r._cameras=new Array,r._lights=new Array,r._meshes=new Array,r._transforms=new Array,r._autoClear=!0,r._autoClearDepth=!0,r._autoClearStencil=!0,r._clearColor=new a.ColorRGBA(.2,.2,.3,1),r._fogMode=u.Constants.NoFog,r._fogColor=new a.ColorRGB(.2,.2,.3),r._fogDensity=.1,r._fogStart=1,r._fogEnd=1e3,r._activeCamera=null,r._engine=e,r._renderingManager=new h.RenderingManager(r),r._projectingManager=new c.ProjectingManager(r),r}return i(e,t),e.prototype.dispose=function(){t.prototype.dispose.call(this)},Object.defineProperty(e.prototype,"engine",{get:function(){return this._engine},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"rootNodes",{get:function(){return this._rootNodes},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"cameras",{get:function(){return this._cameras},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"lights",{get:function(){return this._lights},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"meshes",{get:function(){return this._meshes},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"transforms",{get:function(){return this._transforms},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"renderingManager",{get:function(){return this._renderingManager},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"projectingManager",{get:function(){return this._projectingManager},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"autoClear",{get:function(){return this._autoClear},set:function(t){this._autoClear=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"autoClearDepth",{get:function(){return this._autoClearDepth},set:function(t){this._autoClearDepth=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"autoClearStencil",{get:function(){return this._autoClearStencil},set:function(t){this._autoClearStencil=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"clearColor",{get:function(){return this._clearColor},set:function(t){this._clearColor.copy(t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fogMode",{get:function(){return this._fogMode},set:function(t){this._fogMode=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fogColor",{get:function(){return this._fogColor},set:function(t){this._fogColor.copy(t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fogDensity",{get:function(){return this._fogDensity},set:function(t){this._fogDensity=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fogStart",{get:function(){return this._fogStart},set:function(t){this._fogStart=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fogEnd",{get:function(){return this._fogEnd},set:function(t){this._fogEnd=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"activeCamera",{get:function(){return this._activeCamera},set:function(t){t!=this._activeCamera&&(this._activeCamera=t)},enumerable:!1,configurable:!0}),e.prototype.addMesh=function(t,e){var r=this;void 0===e&&(e=!1),this._meshes.push(t),t._resyncLightSources(),t.parent||t._addToSceneRootNodes(),t.onAddScene(),e&&t.traverse((function(t){t instanceof o.Mesh&&r.addMesh(t)}))},e.prototype.removeMesh=function(t,e){var r=this;void 0===e&&(e=!1);var n=this._meshes.indexOf(t);-1!=n&&(this._meshes[n]=this._meshes[this._meshes.length-1],this._meshes.pop(),t.parent||t._removeFromSceneRootNodes(),t.onRemoveScene()),e&&t.traverse((function(t){t instanceof o.Mesh&&r.removeMesh(t)}))},e.prototype.addTransform=function(t,e){var r=this;void 0===e&&(e=!1),this._transforms.push(t),t.parent||t._addToSceneRootNodes(),t.onAddScene(),e&&t.traverse((function(t){t instanceof s.TransformObject&&r.addTransform(t)}))},e.prototype.removeTransform=function(t,e){var r=this;void 0===e&&(e=!1);var n=this._transforms.indexOf(t);-1!=n&&(this._transforms[n]=this._transforms[this._transforms.length-1],this._transforms.pop(),t.parent||t._removeFromSceneRootNodes(),t.onRemoveScene()),e&&t.traverse((function(t){t instanceof s.TransformObject&&r.removeTransform(t)}))},e.prototype.addLight=function(t){this._lights.push(t),t.parent||t._addToSceneRootNodes(),t.onAddScene();for(var e=0,r=this._meshes;e<r.length;e++){r[e]._resyncLightSource(t)}},e.prototype.removeLight=function(t){var e=this._lights.indexOf(t);if(-1!=e){for(var r=0,n=this._meshes;r<n.length;r++){n[r]._removeLightSource(t,!1)}this._lights.splice(e,1),t.parent||t._removeFromSceneRootNodes(),t.onRemoveScene()}return e},e.prototype.addCamera=function(t){this._cameras.push(t),t.parent||t._addToSceneRootNodes(),t.onAddScene()},e.prototype.removeCamera=function(t){var e=this._cameras.indexOf(t);return-1!=e&&(this._cameras.splice(e,1),t.parent||t._removeFromSceneRootNodes(),t.onRemoveScene()),this._activeCamera==t&&(this._cameras.length>0?this._activeCamera=this._cameras[0]:this._activeCamera=null),e},e.prototype.setActiveCameraByID=function(t){var e=this.getCameraByID(t);return e?(this.activeCamera=e,e):null},e.prototype.getAbstractObjectListByProperty=function(t,e,r){for(var n=0;n<t.length;n++)if(t[n][e]==r)return t[n];return null},e.prototype.getCameraByID=function(t){return this.getAbstractObjectListByProperty(this._cameras,"id",t)},e.prototype.getCameraByUUID=function(t){return this.getAbstractObjectListByProperty(this._cameras,"uuid",t)},e.prototype.getCameraByName=function(t){return this.getAbstractObjectListByProperty(this._cameras,"name",t)},e.prototype.getLightByID=function(t){return this.getAbstractObjectListByProperty(this._lights,"id",t)},e.prototype.getLightByUUID=function(t){return this.getAbstractObjectListByProperty(this._lights,"uuid",t)},e.prototype.getLightByName=function(t){return this.getAbstractObjectListByProperty(this._lights,"name",t)},e.prototype.getMeshByID=function(t){return this.getAbstractObjectListByProperty(this._meshes,"id",t)},e.prototype.getMeshByUUID=function(t){return this.getAbstractObjectListByProperty(this._meshes,"uuid",t)},e.prototype.getMeshByName=function(t){return this.getAbstractObjectListByProperty(this._meshes,"name",t)},e.prototype.getTransformByID=function(t){return this.getAbstractObjectListByProperty(this._transforms,"id",t)},e.prototype.getTransformByUUID=function(t){return this.getAbstractObjectListByProperty(this._transforms,"uuid",t)},e.prototype.getTransformByName=function(t){return this.getAbstractObjectListByProperty(this._transforms,"name",t)},e.prototype.getNodeByID=function(t){var e=this.getCameraByID(t);if(!e)return e;var r=this.getLightByID(t);if(!r)return r;var n=this.getMeshByID(t);if(!n)return n;var i=this.getTransformByID(t);return i?null:i},e.prototype.getNodeByUUID=function(t){var e=this.getCameraByUUID(t);if(!e)return e;var r=this.getLightByUUID(t);if(!r)return r;var n=this.getMeshByUUID(t);if(!n)return n;var i=this.getTransformByUUID(t);return i?null:i},e.prototype.getNodeByName=function(t){var e=this.getCameraByName(t);if(!e)return e;var r=this.getLightByName(t);if(!r)return r;var n=this.getMeshByName(t);if(!n)return n;var i=this.getTransformByName(t);return i?null:i},e.prototype.getAutoClearDepthStencilSetup=function(t){return this._renderingManager.getAutoClearDepthStencilSetup(t)},e.prototype.render=function(){this._processTransform(),(this._autoClear||this._autoClearDepth||this._autoClearStencil)&&(this._autoClear&&this._engine.setColorStateClear(this._clearColor.r,this._clearColor.g,this._clearColor.b,this._clearColor.a,!1),this._engine.clear(this._autoClear,this._autoClearDepth,this._autoClearStencil)),this._activeCamera&&(this._bindFrameBuffer(),this._processSubCameras(this._activeCamera))},e.prototype._processTransform=function(){this._transforms.forEach((function(t){t.updateMatrixWorld()}))},e.prototype._processSubCameras=function(t){this._renderForCamera(t)},e.prototype._renderForCamera=function(t){this._engine.setViewport(t.viewport),this._projectingManager.reset(),this._renderingManager.reset(),this._projectingManager.project(t),this._renderingManager.render()},e.prototype._bindFrameBuffer=function(){this._engine.restoreDefaultFramebuffer()},e}(p.EventDispatcher);e.Scene=l},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.RenderingManager=e.RenderingGroupInfo=void 0;var n=r(190),i=function(){};e.RenderingGroupInfo=i;var o=function(){function t(e){this._useSceneAutoClearSetup=!1,this._renderingGroups=new Array,this._autoClearDepthStencil={},this._renderingGroupInfo=new i,this._customOpaqueSortCompareFn={},this._customAlphaTestSortCompareFn={},this._customTransparentSortCompareFn={},this._scene=e;for(var r=t.MIN_RENDERINGGROUPS;r<t.MAX_RENDERINGGROUPS;r++)this._autoClearDepthStencil[r]={autoClear:!0,clearDepth:!0,clearDtencil:!0}}return t.prototype.dispose=function(){this.freeRenderingGroups(),this._renderingGroups.length=0,this._renderingGroupInfo=null},t.prototype.reset=function(){for(var e=t.MIN_RENDERINGGROUPS;e<t.MAX_RENDERINGGROUPS;e++){var r=this._renderingGroups[e];r&&r.prepare()}},t.prototype.freeRenderingGroups=function(){for(var e=t.MIN_RENDERINGGROUPS;e<t.MAX_RENDERINGGROUPS;e++){var r=this._renderingGroups[e];r&&r.dispose()}},t.prototype.setRenderingAutoClearDepthStencil=function(t,e,r,n){void 0===r&&(r=!0),void 0===n&&(n=!0),this._autoClearDepthStencil[t]={autoClear:e,clearDepth:r,clearDtencil:n}},t.prototype.setRenderingOrder=function(t,e,r,n){if(void 0===e&&(e=null),void 0===r&&(r=null),void 0===n&&(n=null),this._customOpaqueSortCompareFn[t]=e,this._customAlphaTestSortCompareFn[t]=r,this._customTransparentSortCompareFn[t]=n,this._renderingGroups[t]){var i=this._renderingGroups[t];i.opaqueSortCompareFn=this._customOpaqueSortCompareFn[t],i.alphaTestSortCompareFn=this._customAlphaTestSortCompareFn[t],i.transparentSortCompareFn=this._customTransparentSortCompareFn[t]}},t.prototype.getAutoClearDepthStencilSetup=function(t){return this._autoClearDepthStencil[t]},t.prototype.render=function(){var e=this._renderingGroupInfo;e.scene=this._scene,e.camera=this._scene.activeCamera;for(var r=t.MIN_RENDERINGGROUPS;r<t.MAX_RENDERINGGROUPS;r++){var n=this._renderingGroups[r];if(n){e.renderingGroupId=r;var i=this._useSceneAutoClearSetup?this._scene.getAutoClearDepthStencilSetup(r):this._autoClearDepthStencil[r];i&&i.autoClear&&this._clearDepthStencilBuffer(i.clearDepth,i.clearDtencil),n.render()}}},t.prototype.dispatch=function(t){var e=t.renderingGroupId||0;this._prepareRenderingGroup(e),this._renderingGroups[e].dispatch(t)},t.prototype._prepareRenderingGroup=function(t){void 0===this._renderingGroups[t]&&(this._renderingGroups[t]=new n.RenderingGroup(t,this._scene,this._customOpaqueSortCompareFn[t],this._customAlphaTestSortCompareFn[t],this._customTransparentSortCompareFn[t]))},t.prototype._clearDepthStencilBuffer=function(t,e){void 0===t&&(t=!0),void 0===e&&(e=!0),this._depthStencilBufferAlreadyCleaned||(this._scene.engine.clear(!1,t,e),this._depthStencilBufferAlreadyCleaned=!0)},t.MAX_RENDERINGGROUPS=4,t.MIN_RENDERINGGROUPS=0,t}();e.RenderingManager=o},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.RenderingGroup=void 0;var n=r(86),i=r(11),o=r(4),s=r(5),a=function(){function t(t,e,r,i,o){void 0===r&&(r=null),void 0===i&&(i=null),void 0===o&&(o=null),this.index=t,this._opaqueMeshes=new n.SmartArray(256),this._transparentMeshes=new n.SmartArray(256),this._alphaTestMeshes=new n.SmartArray(256),this._depthOnlyMeshes=new n.SmartArray(256),this._scene=e,this.opaqueSortCompareFn=r,this.alphaTestSortCompareFn=i,this.transparentSortCompareFn=o}return Object.defineProperty(t.prototype,"opaqueSortCompareFn",{set:function(e){this._opaqueSortCompareFn=e,this._renderOpaque=e?this.renderOpaqueSorted:t.renderUnsorted},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"alphaTestSortCompareFn",{set:function(e){this._alphaTestSortCompareFn=e,this._renderAlphaTest=e?this.renderAlphaTestSorted:t.renderUnsorted},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"transparentSortCompareFn",{set:function(e){this._transparentSortCompareFn=e||t.defaultTransparentSortCompare,this._renderTransparent=this.renderTransparentSorted},enumerable:!1,configurable:!0}),t.prototype.dispose=function(){this._opaqueMeshes.dispose(),this._transparentMeshes.dispose(),this._alphaTestMeshes.dispose(),this._depthOnlyMeshes.dispose()},t.prototype.prepare=function(){this._opaqueMeshes.reset(),this._transparentMeshes.reset(),this._alphaTestMeshes.reset(),this._depthOnlyMeshes.reset()},t.prototype.dispatch=function(t){var e=t.material;e.needAlphaBlending()?this._transparentMeshes.push(t):e.needAlphaTesting()?this._alphaTestMeshes.push(t):this._opaqueMeshes.push(t),t._renderingGroup=this},t.prototype.render=function(){var t=this._scene.engine;0!==this._depthOnlyMeshes.length&&(t.setColorStateMask(!1),this._renderAlphaTest(this._depthOnlyMeshes),t.setColorStateMask(!0)),0!==this._opaqueMeshes.length&&this._renderOpaque(this._opaqueMeshes),0!==this._alphaTestMeshes.length&&this._renderAlphaTest(this._alphaTestMeshes);var e=t.getStencilTest();t.setStencilTest(!1),0!==this._transparentMeshes.length&&(t.setStencilTest(e),this._renderTransparent(this._transparentMeshes),t.setBlending(i.Constants.NoBlending)),t.setStencilTest(!1),t.setStencilTest(e)},t.prototype.renderOpaqueSorted=function(e){return t.renderSorted(e,this._opaqueSortCompareFn,this._scene.activeCamera,!1)},t.prototype.renderAlphaTestSorted=function(e){return t.renderSorted(e,this._alphaTestSortCompareFn,this._scene.activeCamera,!1)},t.prototype.renderTransparentSorted=function(e){return t.renderSorted(e,this._transparentSortCompareFn,this._scene.activeCamera,!0)},t.renderSorted=function(t,e,r,n){for(var i,a=0,u=r?r.getWorldPosition(s.MathTmp.Vector3[0]):o.Vector3.ZERO;a<t.length;a++)(i=t.data[a])._distanceToCamera=i.boundingSphere.center.distanceTo(u);var p=t.data.slice(0,t.length);for(e&&p.sort(e),a=0;a<p.length;a++)(i=p[a]).render(n)},t.renderUnsorted=function(t){for(var e=0;e<t.length;e++){t.data[e].render(!1)}},t.defaultTransparentSortCompare=function(e,r){return e._renderOrder>r._renderOrder?1:e._renderOrder<r._renderOrder?-1:t.backToFrontSortCompare(e,r)},t.backToFrontSortCompare=function(t,e){return t._distanceToCamera<e._distanceToCamera?1:t._distanceToCamera>e._distanceToCamera?-1:0},t.frontToBackSortCompare=function(t,e){return t._distanceToCamera<e._distanceToCamera?-1:t._distanceToCamera>e._distanceToCamera?1:0},t}();e.RenderingGroup=a},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ProjectingManager=void 0;var n=r(86),i=function(){function t(t){this._activeMeshes=new n.SmartArray(256),this._scene=t}return t.prototype.dispose=function(){},t.prototype.reset=function(){this._activeMeshes.reset()},t.prototype.project=function(t){this._projectMeshs(t)},t.prototype._projectMeshs=function(t){var e=this;this._scene.meshes.forEach((function(r){e._projectMesh(t,r)}))},t.prototype._projectMesh=function(t,e){if(e.visible){var r=this._scene.renderingManager;e.visibleLayers.test(t.visibleLayers)&&(e.frustumCulled&&!t.frustum.intersectsObject(e)||r.dispatch(e))}},t}();e.ProjectingManager=i}])}));
//# sourceMappingURL=vision.js.map